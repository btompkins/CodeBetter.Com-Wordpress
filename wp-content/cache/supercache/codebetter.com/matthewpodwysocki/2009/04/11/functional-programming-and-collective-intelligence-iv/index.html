<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Functional Programming and Collective Intelligence &#8211; IV | Matthew Podwysocki</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/matthewpodwysocki/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Functional Programming and Collective Intelligence &#8211; III' href='http://codebetter.com/matthewpodwysocki/2009/04/08/functional-programming-and-collective-intelligence-iii/' />
<link rel='next' title='From Imperative to Functional – Transposing Maps' href='http://codebetter.com/matthewpodwysocki/2009/04/14/from-imperative-to-functional-transposing-maps/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/matthewpodwysocki/?p=126' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,172] -->
<link rel="canonical" href="http://codebetter.com/matthewpodwysocki/2009/04/11/functional-programming-and-collective-intelligence-iv/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-126" class="post-126 post type-post status-publish format-standard hentry category-collective-intelligence category-f category-functional-programming category-haskell category-python">
					<h1 class="entry-title">Functional Programming and Collective Intelligence &#8211; IV</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/matthewpodwysocki/author/matthewpodwysocki/" title="View all posts by Matthew Podwysocki">Matthew Podwysocki</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/matthewpodwysocki/2009/04/11/functional-programming-and-collective-intelligence-iv/" title="5:10 am" rel="bookmark"><span class="entry-date">April 11, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/matthewpodwysocki/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/matthewpodwysocki/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>In our last post in the series, we discussed a way to get which items I should check out next through the use of the our similarity algorithms which included the Pearson Coefficient, the Euclidean Distance and Manhattan Distance among others.&#160; This time, let’s take another approach through the use of the Slope One family of algorithms.</p>
<p>Before we get started, let’s get caught up to where we are today:</p>
<ul>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2009/03/30/functional-programming-and-collective-intelligence.aspx">Part I – Finding Similar Users</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2009/04/01/functional-programming-and-collective-intelligence-ii.aspx">Part II – Finding Top Matches</a> </li>
<li><a href="http://codebetter.com/blogs/matthew.podwysocki/archive/2009/04/07/functional-programming-and-collective-intelligence-iii.aspx">Part III – Recommending Items</a> </li>
</ul>
<h2>Slope One</h2>
<p>Just as before when we were using other algorithms, the general guidelines of using these for collaboration were the following:</p>
<ol>
<li>Site has many registered&#160; users </li>
<li>Site offers many items for sale </li>
<li>Users have rated items based upon their likes and dislikes </li>
<li>We want to be able to better inform our users of items they may wish to purchase based upon their preferences. </li>
</ol>
<p>Now getting to using the Slope One, which is a family of algorithms that was introduced by <a href="http://www.daniel-lemire.com/en/">Daniel Lemire</a> and Anna Maclachlan in the paper entitled, <a href="http://www.daniel-lemire.com/fr/abstracts/SDM2005.html">“Slope One Predictors for Online Rating-Based Collaborative Filtering</a>”.&#160; In this paper, there are three mentioned slope one schemes, the Slope One Scheme, the Weighted Slope One Scheme and the Bi-Polar Slope One Scheme.&#160; </p>
<p>The Slope One Scheme takes into account both information from user who ranked the same item, and from other items rated by the same user.&#160; But, as well, it gathers its strength from things not factored in, such as only ratings by users who have rated a common item with the given user and only those item ratings that the given user has entered as part of the prediction ratings.</p>
<p>The Weighted Slope One is another scheme which takes the number of times the user rated a particular item.&#160; For example, if we want to predict the user’s rating of item A given that the user has rated both B and C.&#160; If 100x more people rated item B than item C, then the predictor for item B is going to be far better than for item C.</p>
<p>The Bi-Polar Slope One is different than the previous schemes in that it splits the prediction into two parts, the predictions from items user liked and another that they disliked.&#160; By splitting these two likes and dislikes, it effectively doubles the number of users, however, in terms of items, only deviations between two liked items or deviations from two disliked items are taken into account.&#160; Just as well, in terms of users, only deviations from pairs of users who rated items A and B and share a like or dislike&#160; or item A are used to predict the rating for item B.</p>
<p>In this implementation, I’m going to tackle the Weighted Slope One.&#160; Using the <a href="http://www.serpentine.com/blog/2007/08/27/weighted-slope-one-in-haskell-collaborative-filtering-in-29-lines-of-code/">Haskell implementation by Bryan</a> O’Sullivan as my source of inspiration.&#160; I find that going between Haskell and F# to be rather easy in some respects as they have many of the same functional data structure constructs, although the Haskell implementations tend to have much richer functions.&#160; When programming in F#, I am immutable and functional by default, imperative when I have to, such as interacting with .NET base class libraries, and object oriented to better serve my APIs to other languages.&#160; </p>
<p>In order to get full parity, I need the following utility functions:</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">#light</span><span style="color: #000000">

</span><span style="color: #0000FF">module</span><span style="color: #000000"> Option </span><span style="color: #000000">=</span><span style="color: #000000">
  </span><span style="color: #808080">///</span><span style="color: #008000"> Based upon a function returns defaultArg or some value</span><span style="color: #808080">
</span><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> some  (n:</span><span style="color: #800000">'</span><span style="color: #800000">b) (f:</span><span style="color: #800000">'</span><span style="color: #000000">a </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> </span><span style="color: #800000">'</span><span style="color: #800000">b) : </span><span style="color: #800000">'</span><span style="color: #000000">a option </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> </span><span style="color: #800000">'</span><span style="color: #800000">b = function</span><span style="color: #800000">
</span><span style="color: #000000">    </span><span style="color: #000000">|</span><span style="color: #000000"> None   </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> n
    </span><span style="color: #000000">|</span><span style="color: #000000"> Some x </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> f x    

</span><span style="color: #0000FF">module</span><span style="color: #000000"> Map </span><span style="color: #000000">=</span><span style="color: #000000">
  </span><span style="color: #808080">///</span><span style="color: #008000"> Inserts into the Map with the given function if already exists, else adds</span><span style="color: #808080">
</span><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> insertWith (f:</span><span style="color: #800000">'</span><span style="color: #800000">a -&gt; </span><span style="color: #800000">'</span><span style="color: #000000">a </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> </span><span style="color: #800000">'</span><span style="color: #800000">a) (k:</span><span style="color: #800000">'</span><span style="color: #000000">tkey) (v:</span><span style="color: #800000">'</span><span style="color: #800000">a) (m:Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">tkey, </span><span style="color: #800000">'</span><span style="color: #800000">a&gt;) =</span><span style="color: #800000">
</span><span style="color: #000000">    </span><span style="color: #0000FF">match</span><span style="color: #000000"> Map.tryfind k m </span><span style="color: #0000FF">with</span><span style="color: #000000"> 
    </span><span style="color: #000000">|</span><span style="color: #000000"> None   </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> Map.add k v m
    </span><span style="color: #000000">|</span><span style="color: #000000"> Some x </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> </span><span style="color: #0000FF">let</span><span style="color: #000000"> res </span><span style="color: #000000">=</span><span style="color: #000000"> f v x
                Map.add k res m  
  
  </span><span style="color: #808080">///</span><span style="color: #008000"> Adds or deletes from a map based on a function</span><span style="color: #808080">
</span><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> alter (f:</span><span style="color: #800000">'</span><span style="color: #800000">a option -&gt; </span><span style="color: #800000">'</span><span style="color: #000000">a option) (k:</span><span style="color: #800000">'</span><span style="color: #800000">k) (m:Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">k,</span><span style="color: #800000">'</span><span style="color: #800000">a&gt;) : Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">k,</span><span style="color: #800000">'</span><span style="color: #800000">a&gt; =</span><span style="color: #800000">
</span><span style="color: #000000">    </span><span style="color: #0000FF">match</span><span style="color: #000000"> Map.tryfind k m </span><span style="color: #0000FF">with</span><span style="color: #000000">
    </span><span style="color: #000000">|</span><span style="color: #000000"> None </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> 
        </span><span style="color: #0000FF">match</span><span style="color: #000000"> f None </span><span style="color: #0000FF">with</span><span style="color: #000000"> 
        </span><span style="color: #000000">|</span><span style="color: #000000"> None </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> m
        </span><span style="color: #000000">|</span><span style="color: #000000"> Some x </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> Map.add k x m
    </span><span style="color: #000000">|</span><span style="color: #000000"> Some v </span><span style="color: #0000FF">as</span><span style="color: #000000"> vo </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> 
        </span><span style="color: #0000FF">match</span><span style="color: #000000"> f vo </span><span style="color: #0000FF">with</span><span style="color: #000000">
        </span><span style="color: #000000">|</span><span style="color: #000000"> Some x </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> Map.add k x m
        </span><span style="color: #000000">|</span><span style="color: #000000"> None </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> Map.remove k m
  
  </span><span style="color: #808080">///</span><span style="color: #008000"> Map without the key</span><span style="color: #808080">
</span><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> map</span><span style="color: #800000">'</span><span style="color: #800000"> (f:</span><span style="color: #800000">'</span><span style="color: #000000">a </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> </span><span style="color: #800000">'</span><span style="color: #800000">b) : Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">k, </span><span style="color: #800000">'</span><span style="color: #800000">a&gt; -&gt; Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">k, </span><span style="color: #800000">'</span><span style="color: #800000">b&gt; =</span><span style="color: #800000">
</span><span style="color: #000000">    Map.mapi (</span><span style="color: #0000FF">fun</span><span style="color: #000000"> _ v </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> f v)

  </span><span style="color: #808080">///</span><span style="color: #008000"> Whether the map contains the given key</span><span style="color: #808080">
</span><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> containsKey (k:</span><span style="color: #800000">'</span><span style="color: #800000">k) (m:Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">k,</span><span style="color: #800000">'</span><span style="color: #800000">a&gt;) =</span><span style="color: #800000">
</span><span style="color: #000000">    m.ContainsKey k    </span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Now comes the actual implementation of our Weighted Slope One algorithm.&#160; Bryan has a great explanation of how it works <a href="http://www.serpentine.com/blog/2006/12/12/collaborative-filtering-made-easy/">here</a>.&#160; Once you’ve read that, let’s now line up the F# code required for the task at hand.&#160; First, we need to define the types of data we’re using.&#160; Each rating is a map of anything and a floating point number.&#160; The Slope One is a map of anything and a map of anything of an integer and floating point number tuple.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">module</span><span style="color: #000000"> SlopeOne </span><span style="color: #000000">=</span><span style="color: #000000">
  
  </span><span style="color: #0000FF">type</span><span style="color: #000000"> Rating</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a&gt; = Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">a, float</span><span style="color: #000000">&gt;</span><span style="color: #000000">
  </span><span style="color: #0000FF">type</span><span style="color: #000000"> SlopeOne</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a&gt; = Map&lt;</span><span style="color: #800000">'</span><span style="color: #000000">a, Map</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a, (int * float)&gt;&gt;</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>In order to calculate this, we need to define the update function which will fill in our matrix with ratings such as the following:</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> addT (a, b) (c, d) </span><span style="color: #000000">=</span><span style="color: #000000"> (a</span><span style="color: #000000">+</span><span style="color: #000000">c, b</span><span style="color: #000000">+</span><span style="color: #000000">d)
  
  </span><span style="color: #0000FF">let</span><span style="color: #000000"> update (s:SlopeOne</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a&gt;) : Rating&lt;</span><span style="color: #800000">'</span><span style="color: #000000">a</span><span style="color: #000000">&gt;</span><span style="color: #000000"> seq </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> SlopeOne</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a&gt; =   </span><span style="color: #800000">
</span><span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> norm (a, b) </span><span style="color: #000000">=</span><span style="color: #000000"> (a, b </span><span style="color: #000000">/</span><span style="color: #000000"> float a)
    
    </span><span style="color: #0000FF">let</span><span style="color: #000000"> update</span><span style="color: #800000">'</span><span style="color: #800000"> s rm = </span><span style="color: #800000">
</span><span style="color: #000000">      </span><span style="color: #0000FF">let</span><span style="color: #000000"> rs </span><span style="color: #000000">=</span><span style="color: #000000"> Map.to_seq rm
      </span><span style="color: #0000FF">let</span><span style="color: #000000"> prod </span><span style="color: #000000">=</span><span style="color: #000000"> seq {</span><span style="color: #0000FF">for</span><span style="color: #000000"> (a, m) </span><span style="color: #0000FF">in</span><span style="color: #000000"> rs </span><span style="color: #0000FF">do</span><span style="color: #000000"> </span><span style="color: #0000FF">for</span><span style="color: #000000">(b, n) </span><span style="color: #0000FF">in</span><span style="color: #000000"> rs </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> ((a, b), (</span><span style="color: #800080">1</span><span style="color: #000000">, m </span><span style="color: #000000">-</span><span style="color: #000000"> n))}

      </span><span style="color: #0000FF">let</span><span style="color: #000000"> insert m (a, b) v </span><span style="color: #000000">=</span><span style="color: #000000"> 
        </span><span style="color: #0000FF">let</span><span style="color: #000000"> foo </span><span style="color: #000000">=</span><span style="color: #000000"> Some </span><span style="color: #000000">&lt;&lt;</span><span style="color: #000000"> Option.some (Map.add b v Map.empty) (Map.insertWith addT b v)
        Map.alter foo a m
      
      Seq.fold(</span><span style="color: #0000FF">fun</span><span style="color: #000000"> m (k, v) </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> insert m k v) s prod     
    
    Map.map</span><span style="color: #800000">'</span><span style="color: #800000"> (Map.map</span><span style="color: #800000">'</span><span style="color: #000000"> norm) </span><span style="color: #000000">&lt;&lt;</span><span style="color: #000000"> Seq.fold update</span><span style="color: #800000">'</span><span style="color: #800000"> s  </span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>What this function does is fold the incoming slope one which then iterates to calcuate the differences between a rating and every other rating that user has made.&#160; Then we can scale each of the differentials based upon the number of times we’ve seen that rating.</p>
<p>Now that we have in place a way to build up our matrix, it’s time that we actually make a prediction.&#160; To do this, we’ll pass in our matrix we calculated from before and a rating a user has made.&#160; We will then iterate over every item the user has rated, for items that have been rated by anyone.&#160; We accumulate our total rating and then insert it into the map.&#160; We need to filter our items that we’ve already rated as well.&#160; Lastly, we&#160; normalize our ratings when they are greater than zero to give us our predictive result.</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">  </span><span style="color: #0000FF">let</span><span style="color: #000000"> predict (matrixIn:SlopeOne</span><span style="color: #000000">&lt;</span><span style="color: #800000">'</span><span style="color: #800000">a&gt;) (userRatings:Rating&lt;</span><span style="color: #800000">'</span><span style="color: #000000">a</span><span style="color: #000000">&gt;</span><span style="color: #000000">) </span><span style="color: #000000">=</span><span style="color: #000000">
    </span><span style="color: #0000FF">let</span><span style="color: #000000"> insert oldM (item1, foundRating, userRating) </span><span style="color: #000000">=</span><span style="color: #000000">
      </span><span style="color: #0000FF">let</span><span style="color: #000000"> (count, normRating) </span><span style="color: #000000">=</span><span style="color: #000000"> foundRating
      </span><span style="color: #0000FF">let</span><span style="color: #000000"> totalRating </span><span style="color: #000000">=</span><span style="color: #000000"> (float count) </span><span style="color: #000000">*</span><span style="color: #000000"> (normRating </span><span style="color: #000000">+</span><span style="color: #000000"> userRating)
      Map.insertWith addT item1 (count, totalRating) oldM
    
    </span><span style="color: #0000FF">let</span><span style="color: #000000"> freqM </span><span style="color: #000000">=</span><span style="color: #000000"> 
      Seq.fold insert Map.empty (      
        seq { </span><span style="color: #0000FF">for</span><span style="color: #000000"> (item1, innerMap) </span><span style="color: #0000FF">in</span><span style="color: #000000"> Map.to_seq matrixIn </span><span style="color: #0000FF">do</span><span style="color: #000000">
              </span><span style="color: #0000FF">if</span><span style="color: #000000"> not (Map.containsKey item1 userRatings) </span><span style="color: #0000FF">then</span><span style="color: #000000">
                </span><span style="color: #0000FF">for</span><span style="color: #000000"> (userItem, userRating) </span><span style="color: #0000FF">in</span><span style="color: #000000"> Map.to_seq userRatings </span><span style="color: #0000FF">do</span><span style="color: #000000">
                  </span><span style="color: #0000FF">if</span><span style="color: #000000"> item1 </span><span style="color: #000000">&lt;&gt;</span><span style="color: #000000"> userItem </span><span style="color: #0000FF">then</span><span style="color: #000000">
                    </span><span style="color: #0000FF">if</span><span style="color: #000000"> Map.containsKey userItem innerMap </span><span style="color: #0000FF">then</span><span style="color: #000000">
                      </span><span style="color: #0000FF">let</span><span style="color: #000000"> foundRating </span><span style="color: #000000">=</span><span style="color: #000000"> Map.find userItem innerMap 
                      </span><span style="color: #0000FF">yield</span><span style="color: #000000"> (item1, foundRating, userRating)
           })
    
    </span><span style="color: #0000FF">let</span><span style="color: #000000"> normM </span><span style="color: #000000">=</span><span style="color: #000000"> Map.map</span><span style="color: #800000">'</span><span style="color: #800000"> (fun (count, totalRating) -&gt; totalRating / (float count)) freqM</span><span style="color: #800000">
</span><span style="color: #000000">    
    Map.filter (</span><span style="color: #0000FF">fun</span><span style="color: #000000"> _ normRating </span><span style="color: #0000FF">-&gt;</span><span style="color: #000000"> normRating </span><span style="color: #000000">&gt;</span><span style="color: #000000"> </span><span style="color: #800080">0</span><span style="color: #000000">.) normM</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>We can now define the data to feed to our function.&#160; In this case, let’s take the same matrix as defined in Bryan’s post.&#160; With this, we can make a prediction by calling the SlopeOne.update with an empty map and our user data and the ratings of the squid with a 0.4 rating.</p>
</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #0000FF">let</span><span style="color: #000000"> userData </span><span style="color: #000000">=</span><span style="color: #000000"> 
  List.map Map.of_list [
    [(</span><span style="color: #800000">"</span><span style="color: #800000">squid</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">1.0</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">cuttlefish</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.5</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">octopus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.2</span><span style="color: #000000">)];
    [(</span><span style="color: #800000">"</span><span style="color: #800000">squid</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">1.0</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">octopus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.5</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">nautilus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.2</span><span style="color: #000000">)];
    [(</span><span style="color: #800000">"</span><span style="color: #800000">squid</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.2</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">octopus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">1.0</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">cuttlefish</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.4</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">nautilus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.4</span><span style="color: #000000">)];
    [(</span><span style="color: #800000">"</span><span style="color: #800000">cuttlefish</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.9</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">octopus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.4</span><span style="color: #000000">); (</span><span style="color: #800000">"</span><span style="color: #800000">nautilus</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.5</span><span style="color: #000000">)]]
    
</span><span style="color: #0000FF">let</span><span style="color: #000000"> prediction </span><span style="color: #000000">=</span><span style="color: #000000"> 
  SlopeOne.predict (SlopeOne.update Map.empty userData) (Map.of_list [(</span><span style="color: #800000">"</span><span style="color: #800000">squid</span><span style="color: #800000">"</span><span style="color: #000000">, </span><span style="color: #800080">0.4</span><span style="color: #000000">)])    </span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
</p>
<p>We can then run this code through F# interactive to display our results:</p>
</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
<pre style="background-color:#FFFFFF;overflow: auto"><span style="color: #000000">&gt;</span><span style="color: #000000"> prediction;;
val it : Map</span><span style="color: #000000">&lt;</span><span style="color: #000000">string,float</span><span style="color: #000000">&gt;</span><span style="color: #000000">
</span><span style="color: #000000">=</span><span style="color: #000000"> seq
    [[cuttlefish, </span><span style="color: #800080">0.25</span><span style="color: #000000">] {Key </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800000">"</span><span style="color: #800000">cuttlefish</span><span style="color: #800000">"</span><span style="color: #000000">;
                         Value </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800080">0.25</span><span style="color: #000000">;}; [nautilus, </span><span style="color: #800080">0.1</span><span style="color: #000000">] {Key </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800000">"</span><span style="color: #800000">nautilus</span><span style="color: #800000">"</span><span style="color: #000000">;
                                                          Value </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800080">0.1</span><span style="color: #000000">;};
     [octopus, </span><span style="color: #800080">0.233333333333333</span><span style="color: #000000">] {Key </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800000">"</span><span style="color: #800000">octopus</span><span style="color: #800000">"</span><span style="color: #000000">;
                                   Value </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #800080">0.2333333333</span><span style="color: #000000">;}]</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
</p>
<p>How accurate is the Slope One family of algorithms?&#160; According to the paper, they are on par with the Pearson Coefficient, but less memory intensive after analyzing the <a href="http://www.grouplens.org/node/76">EachMovie</a> and <a href="http://movielens.umn.edu/">MovieLens</a> datasets.</p>
<h2>Conclusion</h2>
</p>
</p>
</p>
<p>Where can can we go from here?&#160; Because we’re using immutable data structures, we could look for ways of working this code in parallel without much effort.&#160; The beauty of functional programming is that without these mutable data structures and shared state, opportunities can arise for parallelization optimizations.&#160; </p>
<p>Overall, the Slope One family of algorithms are easy to understand, and once you’ve read the paper thoroughly, you may find it easier than the other ones we’ve discussed such as the Pearson Coefficient, the Jaccard Coefficient and so on.&#160; There is still some items left in this series such as calculating how similar items are to one another among other topics.</p>
<div class="shr-publisher-126"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/matthewpodwysocki/category/collective-intelligence/" title="View all posts in Collective Intelligence" rel="category tag">Collective Intelligence</a>, <a href="http://codebetter.com/matthewpodwysocki/category/f/" title="View all posts in F#" rel="category tag">F#</a>, <a href="http://codebetter.com/matthewpodwysocki/category/functional-programming/" title="View all posts in Functional Programming" rel="category tag">Functional Programming</a>, <a href="http://codebetter.com/matthewpodwysocki/category/haskell/" title="View all posts in Haskell" rel="category tag">Haskell</a>, <a href="http://codebetter.com/matthewpodwysocki/category/python/" title="View all posts in Python" rel="category tag">Python</a>. Bookmark the <a href="http://codebetter.com/matthewpodwysocki/2009/04/11/functional-programming-and-collective-intelligence-iv/" title="Permalink to Functional Programming and Collective Intelligence &#8211; IV" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/matthewpodwysocki/2009/04/11/functional-programming-and-collective-intelligence-iv/feed/" title="Comments RSS to Functional Programming and Collective Intelligence &#8211; IV" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-126 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/matthewpodwysocki/2009/04/08/functional-programming-and-collective-intelligence-iii/" rel="prev"><span class="meta-nav">&larr;</span> Functional Programming and Collective Intelligence &#8211; III</a></div>
					<div class="nav-next"><a href="http://codebetter.com/matthewpodwysocki/2009/04/14/from-imperative-to-functional-transposing-maps/" rel="next">From Imperative to Functional – Transposing Maps <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-317">
                    <div id="dsq-comment-header-317" class="dsq-comment-header">
                        <cite id="dsq-cite-317">
    http://mechanistician.blogspot.com/                            <span id="dsq-author-user-317">Mechanistician</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-317" class="dsq-comment-body">
                        <div id="dsq-comment-message-317" class="dsq-comment-message"><p>Interesting posts&#8230; I still prefer python though <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  for the same reasons you listed on a previous post:</p>
<p>&#8220;Why functional languages are a good fit here is around the conciseness of the language and the ability to explore data quickly.&#8221;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-318">
                    <div id="dsq-comment-header-318" class="dsq-comment-header">
                        <cite id="dsq-cite-318">
    http://codebetter.com/members/Matthew.Podwysocki/default.aspx                            <span id="dsq-author-user-318">Matthew.Podwysocki</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-318" class="dsq-comment-body">
                        <div id="dsq-comment-message-318" class="dsq-comment-message"><p>@Mechanistician  </p>
<p>Understood and it comes down to personal preference sometimes.  I do like Python as well for quick data exploration.  But, what I get from F# is the ability to better compose my small functions together as to eliminate the need to mutable data structures and loops.  This gets me thinking about the problem in tiny more solvable parts.</p>
<p>Matt</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/matthewpodwysocki/2009/04/11/functional-programming-and-collective-intelligence-iv/';
    var disqus_identifier = '126 /blogs/matthew.podwysocki/archive/2009/04/11/functional-programming-and-collective-intelligence-iv.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'matthewpodwysocki';
    var disqus_title = "Functional Programming and Collective Intelligence &#8211; IV";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=126');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/matthewpodwysocki\/2009\/04\/11\/functional-programming-and-collective-intelligence-iv\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 2.516 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 20:02:19 -->
<!-- super cache -->