<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>The consequence of a.NET Framework API design flaw | Patrick Smacchia</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/patricksmacchia/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/patricksmacchia/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Include IL Offset into production exception StackTrace' href='http://codebetter.com/patricksmacchia/2012/06/27/include-il-offset-into-production-exception-stacktrace/' />
<link rel='next' title='Beware mixing List.Sort() and Thread.Abort()' href='http://codebetter.com/patricksmacchia/2012/10/02/beware-mixing-list-sort-and-thread-abort/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/patricksmacchia/?p=689' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,159] -->
<link rel="canonical" href="http://codebetter.com/patricksmacchia/2012/08/06/the-consequence-of-a-net-framework-api-design-flaw/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='http://codebetter.com/patricksmacchia/files/2012/08/Query1.png' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-689" class="post-689 post type-post status-publish format-standard hentry category-net-framework category-api-usage category-breaking-changes category-code-rule">
					<h1 class="entry-title">The consequence of a.NET Framework API design flaw</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/patricksmacchia/author/patricksmacchia/" title="View all posts by Patrick Smacchia">Patrick Smacchia</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/patricksmacchia/2012/08/06/the-consequence-of-a-net-framework-api-design-flaw/" title="12:41 pm" rel="bookmark"><span class="entry-date">August 6, 2012</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/patricksmacchia/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/patricksmacchia/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>Last week, a user reported a bug on NDepend (hopefully it happens in a very rare situation!). After mulling over a bit on the bug stack trace, it appears that the bug is the consequence of a call to <a href="http://msdn.microsoft.com/en-us/library/63ywd54z.aspx" target="_blank">ICollection&lt;T&gt;.Add()</a> while the underlying collection is an array!</p>
<p>Here I felt bad, because really the bug is a consequence of a .NET Framework API design flaw. Or better said, to take our responsibility, the bug is the consequence of us, not providing a work around seriously enough on this  .NET Framework API design flaw. <strong>Why the hell some read-only collection implements the Add() method?</strong> It is even getting worse if considering the documentation of <em><a href="http://msdn.microsoft.com/en-US/library/system.array.system.collections.ilist.add(v=vs.80)" target="_blank">Array.Add()</a></em> (as a <em>IList&lt;T&gt;</em> explicit implementation method) and <a href="http://msdn.microsoft.com/en-en/library/cc672239.aspx" target="_blank">ReadOnlyCollection.ICollection&lt;T&gt;.Add()</a>.</p>
<p style="text-align: center"><em> <strong>This implementation always throws <a href="http://msdn.microsoft.com/en-us/library/system.notsupportedexception">NotSupportedException</a></strong>. </em>OUCH!</p>
<p>It appears that finally, a decade after .NET 1.0 has been release, 3 interfaces <a href="http://msdn.microsoft.com/en-us/library/ee537802.aspx" target="_blank">IReadOnlyCollection&lt;T&gt;</a>, <a href="http://msdn.microsoft.com/en-us/library/hh192385(v=vs.110).aspx" target="_blank">IReadOnlyList&lt;T&gt;</a>, <a href="http://msdn.microsoft.com/en-us/library/hh136548(v=vs.110).aspx" target="_blank">IReadOnlyDictionary&lt;T&gt;</a> will be presented by the .NET v4.5. As commonly said, <em>it is never too late to do things right</em>, but in the case of an API with ascendant compatibility used by millions of developers world-wide, this proverb doesn&#8217;t fit that well.</p>
<p>The fact is that the brand new <a href="http://www.ndepend.com/API/webframe.html" target="_blank">NDepend.API</a> actually uses the interface <em>ICollection&lt;T&gt;</em> to return read-only lists. I wouldn&#8217;t like us or some users stumble on this API design flaw again! Hence a decision was taken to change the API policy, even though this will introduce breaking-change (the API is still young enough for that). First, I wrote the following CQLinq query to evaluate the problem:</p>
<script src="http://gist.github.com/3247870.js"></script><noscript><link rel="stylesheet" href="https://gist.github.com/stylesheets/gist/embed.css"><div id="gist-3247870" class="gist">
    
        <div class="gist-file">
          <div class="gist-data gist-syntax">
              <div class="highlight"><pre><div class='line' id='LC1'><span class="n">let</span> <span class="n">seqTypes</span> <span class="p">=</span> <span class="n">Types</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span></div><div class='line' id='LC2'>&nbsp;&nbsp;<span class="n">t</span> <span class="p">=&gt;</span> <span class="n">t</span><span class="p">.</span><span class="n">Implement</span><span class="p">(</span><span class="s">&quot;System.Collections.Generic.IEnumerable&lt;T&gt;&quot;</span><span class="p">)</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">t</span><span class="p">.</span><span class="n">Name</span> <span class="p">!=</span> <span class="s">&quot;String&quot;</span> <span class="c1">// We don&#39;t string as collection!</span></div><div class='line' id='LC4'><span class="p">).</span><span class="n">ToHashSet</span><span class="p">()</span></div><div class='line' id='LC5'><br/></div><div class='line' id='LC6'><span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">Assemblies</span><span class="p">.</span><span class="n">WithNameIn</span><span class="p">(</span> <span class="s">&quot;NDepend.API&quot;</span><span class="p">).</span><span class="n">ChildMethods</span><span class="p">()</span></div><div class='line' id='LC7'><span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">IsPubliclyVisible</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC8'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC9'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">seqTypes</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span><span class="p">)</span></div><div class='line' id='LC10'><span class="k">select</span> <span class="k">new</span> <span class="p">{</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">}</span></div></pre></div>
          </div>

          <div class="gist-meta">
            <a href="https://gist.github.com/raw/3247870/8bdf5bc0d8bd07100fd4272777cb586eace7417b/gistfile1.cs" style="float:right;">view raw</a>
            <a href="https://gist.github.com/3247870#file_gistfile1.cs" style="float:right;margin-right:10px;color:#666">gistfile1.cs</a>
            <a href="https://gist.github.com/3247870">This Gist</a> brought to you by <a href="http://github.com">GitHub</a>.
          </div>
        </div>
</div>
</noscript>
<p>Here is the result, 40 methods (or property getters) returns something that implement <em>IEnumerable&lt;T&gt;</em> and many of them returns a <em>ICollection&lt;T&gt;</em>.</p>
<p><a href="http://codebetter.com/patricksmacchia/files/2012/08/Query1.png"><img src="http://codebetter.com/patricksmacchia/files/2012/08/Query1.png" alt="" width="557" height="991" /></a></p>
<p>So what the API should return instead of <em>ICollection&lt;T&gt;?</em> Knowing that NDepend is still compatible with VS2008 and hence is compiled with .NET 3.5, it cannot use the brand new .NET v4.5 <em>IReadOnlyList&lt;T&gt; </em>(but it will certainly use these in several years, when we will compile against .NET v4.5 and above).</p>
<ul>
<li>Returning arrays instead of <em>ICollection&lt;T&gt;</em> could be an idea. The problem is that array is an implementation, and it is not read-only since the user can update each slot of the array.</li>
<li>I never really liked the class <em>ReadOnlyCollection&lt;T&gt;</em> that wraps a <em>IList&lt;T&gt;</em>. First it is a class and not an interface. Second it has the property getter <em>Items</em> that can returns the wrapped <em>IList&lt;T&gt;</em>, so it is not that read-only and not a good wrapper at all! Third it implements <em>IList&lt;T&gt;</em>, and all mutable members are not supported, so it can lead to the same kind of confusion we are now faced with.</li>
<li>Returning some <em>IEnumerable&lt;T&gt;</em> would be a better choice than the two above. It is not ideal through. While <em>IEnumerable&lt;T&gt;</em> conveys well the read-only idea, it has no <em>Count</em> nor an item access by index property. Hence it is not really suited to return a well-sized list. LINQ provides the adequate extension methods <em>Count()</em> and <em>ElementAt()</em>, but  <em>IEnumerable&lt;T&gt; </em>has a strong taste of <strong>sequence</strong>, while we&#8217;d really like to provide users with proper <strong>lists</strong>!</li>
</ul>
<div>
<p>So we choose to provide our own interfaces <em>IReadOnlyCollection&lt;T&gt;</em> and <em>IReadOnlyList&lt;T&gt;</em>! Same as the ones released soon in .NET v4.5, but defined in another namespace <em>NDepend.Helpers</em>, this will discard most naming collisions for clients. Thanks to this choice, the API is as clean as possible for now, and the transition will be simplified once NDepend will be compiled for .NET v4.5 and above, sooner or later.</p>
<p>As more and more often, I found inspiration in a <em>stackoverflow.com</em> response <a href="http://stackoverflow.com/a/343506/27194" target="_blank">here</a>. Find below the whole interfaces declarations and implementations. This is not an ideal solution, since <em>List&lt;T&gt;</em> and <em>Array</em> of course doesn&#8217;t implement our interfaces, but I found it to be a good design compromise.</p>
<p>Notice the four factory extension methods, that make a clear distinction at creation time, between <strong>Wrapped</strong> and <strong>Cloned </strong>read-only collection. Notice as well that the <em>Cloned</em> factories, take any sequence as argument, while the <em>Wrapped</em> factories, need collections and lists as argument:</p>
<ul>
<li><em>ToReadOnlyWrappedCollection(this ICollection&lt;T&gt;), </em></li>
<li><em>ToReadOnlyClonedCollection(this IEnumerable&lt;T&gt;),</em></li>
<li><em>ToReadOnlyWrappedList(this IList&lt;T&gt;), </em></li>
<li><em>ToReadOnlyClonedList(this IEnumerable&lt;T&gt;),</em></li>
</ul>
</div>
<p>Also, we&#8217;ve added the <em>IndexOf()</em> extension method over our two interfaces, because we needed it, and because the .NET Framework doesn&#8217;t provide <em>IndexOf(this IEnumerable&lt;T&gt;) </em>because a sequence is not necessarily ordered (like <em>hashset</em> or <em>dictionary</em>).</p>
<script src="http://gist.github.com/3247559.js"></script><noscript><link rel="stylesheet" href="https://gist.github.com/stylesheets/gist/embed.css"><div id="gist-3247559" class="gist">
    

        <div class="gist-file">
          <div class="gist-data gist-syntax">
              <div class="highlight"><pre><div class='line' id='LC1'>&nbsp;&nbsp;<span class="c1">///&lt;summary&gt;</span></div><div class='line' id='LC2'>&nbsp;&nbsp;&nbsp;<span class="c1">///Defines the property getter Count that defines a read-only collections.</span></div><div class='line' id='LC3'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;/summary&gt;</span></div><div class='line' id='LC4'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;remarks&gt;A &lt;see cref=&quot;IReadOnlyCollection{T}&quot;/&gt; object can be obtain through the extension methods &lt;see cref=&quot;ExtensionMethodsEnumerable.ToReadOnlyWrappedCollection{T}&quot;/&gt; or  &lt;see cref=&quot;ExtensionMethodsEnumerable.ToReadOnlyClonedCollection{T}&quot;/&gt;.&lt;/remarks&gt;</span></div><div class='line' id='LC5'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the collection.&lt;/typeparam&gt;</span></div><div class='line' id='LC6'>&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">interface</span> <span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span></div><div class='line' id='LC7'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;summary&gt;</span></div><div class='line' id='LC8'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///Gets the number of elements contained in the collection.</span></div><div class='line' id='LC9'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;/summary&gt;</span></div><div class='line' id='LC10'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span> <span class="n">Count</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span></div><div class='line' id='LC11'>&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC12'><br/></div><div class='line' id='LC13'><br/></div><div class='line' id='LC14'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;summary&gt;</span></div><div class='line' id='LC15'>&nbsp;&nbsp;&nbsp;<span class="c1">///Represents a read-only collection of elements that can be accessed by index.</span></div><div class='line' id='LC16'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;/summary&gt;</span></div><div class='line' id='LC17'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;remarks&gt;A &lt;see cref=&quot;IReadOnlyList{T}&quot;/&gt; object can be obtain through the extension methods &lt;see cref=&quot;ExtensionMethodsEnumerable.ToReadOnlyWrappedList{T}&quot;/&gt; or  &lt;see cref=&quot;ExtensionMethodsEnumerable.ToReadOnlyClonedList{T}&quot;/&gt;.&lt;/remarks&gt;</span></div><div class='line' id='LC18'>&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the collection.&lt;/typeparam&gt;</span></div><div class='line' id='LC19'>&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">interface</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span></div><div class='line' id='LC20'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;summary&gt;</span></div><div class='line' id='LC21'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///Gets the element at the specified index in the read-only list.</span></div><div class='line' id='LC22'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;/summary&gt;</span></div><div class='line' id='LC23'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;param name=&quot;index&quot;&gt;The zero-based index of the element to get.&lt;/param&gt;</span></div><div class='line' id='LC24'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span></div><div class='line' id='LC25'>&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC26'><br/></div><div class='line' id='LC27'><br/></div><div class='line' id='LC28'><br/></div><div class='line' id='LC29'>&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ExtensionMethodsEnumerable</span> <span class="p">{</span></div><div class='line' id='LC30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;summary&gt;</span></div><div class='line' id='LC31'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// Creates a &lt;see cref=&quot;IReadOnlyCollection{T}&quot;/&gt; wrapper collection around &lt;paramref name=&quot;collection&quot;/&gt;. </span></div><div class='line' id='LC32'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;/summary&gt;</span></div><div class='line' id='LC33'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the collection.&lt;/typeparam&gt;</span></div><div class='line' id='LC34'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;param name=&quot;collection&quot;&gt;A collection object.&lt;/param&gt;</span></div><div class='line' id='LC35'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">ToReadOnlyWrappedCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">collection</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC36'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Requires</span><span class="p">(</span><span class="n">collection</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;collection must not be null&quot;</span><span class="p">);</span></div><div class='line' id='LC37'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;returned read-only collection is not null&quot;</span><span class="p">);</span></div><div class='line' id='LC38'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;().</span><span class="n">Count</span> <span class="p">==</span> <span class="n">collection</span><span class="p">.</span><span class="n">Count</span><span class="p">,</span> <span class="s">&quot;returned read-only collection has the same number of elements as collection&quot;</span><span class="p">);</span></div><div class='line' id='LC39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">new</span> <span class="n">CollectionReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">collection</span><span class="p">);</span></div><div class='line' id='LC40'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC41'><br/></div><div class='line' id='LC42'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;summary&gt;</span></div><div class='line' id='LC43'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// Creates a &lt;see cref=&quot;IReadOnlyCollection{T}&quot;/&gt; cloned collection around &lt;paramref name=&quot;collection&quot;/&gt;. </span></div><div class='line' id='LC44'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;/summary&gt;</span></div><div class='line' id='LC45'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the collection.&lt;/typeparam&gt;</span></div><div class='line' id='LC46'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;param name=&quot;collection&quot;&gt;A collection object.&lt;/param&gt;</span></div><div class='line' id='LC47'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">ToReadOnlyClonedCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">collection</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC48'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Requires</span><span class="p">(</span><span class="n">collection</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;collection must not be null&quot;</span><span class="p">);</span></div><div class='line' id='LC49'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;returned read-only collection is not null&quot;</span><span class="p">);</span></div><div class='line' id='LC50'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;().</span><span class="n">Count</span> <span class="p">==</span> <span class="n">collection</span><span class="p">.</span><span class="n">Count</span><span class="p">(),</span> <span class="s">&quot;returned read-only collection has the same number of elements as collection&quot;</span><span class="p">);</span></div><div class='line' id='LC51'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">new</span> <span class="n">CollectionReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">collection</span><span class="p">.</span><span class="n">ToArray</span><span class="p">());</span></div><div class='line' id='LC52'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC53'><br/></div><div class='line' id='LC54'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;summary&gt;</span></div><div class='line' id='LC55'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// Creates a &lt;see cref=&quot;IReadOnlyCollection{T}&quot;/&gt; wrapper collection around &lt;paramref name=&quot;list&quot;/&gt;. </span></div><div class='line' id='LC56'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;/summary&gt;</span></div><div class='line' id='LC57'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the list.&lt;/typeparam&gt;</span></div><div class='line' id='LC58'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;param name=&quot;list&quot;&gt;A list object.&lt;/param&gt;</span></div><div class='line' id='LC59'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">ToReadOnlyWrappedList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">list</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC60'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Requires</span><span class="p">(</span><span class="n">list</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;collection must not be null&quot;</span><span class="p">);</span></div><div class='line' id='LC61'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;returned read-only list is not null&quot;</span><span class="p">);</span></div><div class='line' id='LC62'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;().</span><span class="n">Count</span> <span class="p">==</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span><span class="p">,</span> <span class="s">&quot;returned read-only list has the same number of elements as list&quot;</span><span class="p">);</span></div><div class='line' id='LC63'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">new</span> <span class="n">ListReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">list</span><span class="p">);</span></div><div class='line' id='LC64'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC65'><br/></div><div class='line' id='LC66'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;summary&gt;</span></div><div class='line' id='LC67'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// Creates a &lt;see cref=&quot;IReadOnlyCollection{T}&quot;/&gt; cloned collection around &lt;paramref name=&quot;list&quot;/&gt;. </span></div><div class='line' id='LC68'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;/summary&gt;</span></div><div class='line' id='LC69'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the list.&lt;/typeparam&gt;</span></div><div class='line' id='LC70'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">/// &lt;param name=&quot;list&quot;&gt;A list object.&lt;/param&gt;</span></div><div class='line' id='LC71'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">ToReadOnlyClonedList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">list</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC72'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Requires</span><span class="p">(</span><span class="n">list</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;collection must not be null&quot;</span><span class="p">);</span></div><div class='line' id='LC73'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;returned read-only list is not null&quot;</span><span class="p">);</span></div><div class='line' id='LC74'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;&gt;().</span><span class="n">Count</span> <span class="p">==</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span><span class="p">(),</span> <span class="s">&quot;returned read-only list has the same number of elements as list&quot;</span><span class="p">);</span></div><div class='line' id='LC75'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">new</span> <span class="n">ListReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">list</span><span class="p">.</span><span class="n">ToArray</span><span class="p">());</span></div><div class='line' id='LC76'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC77'><br/></div><div class='line' id='LC78'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">private</span> <span class="k">class</span> <span class="nc">CollectionReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IReadOnlyCollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span></div><div class='line' id='LC79'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">internal</span> <span class="nf">CollectionReadOnlyWrapper</span><span class="p">(</span><span class="n">ICollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">collection</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC80'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Debug</span><span class="p">.</span><span class="n">Assert</span><span class="p">(</span><span class="n">collection</span> <span class="p">!=</span> <span class="k">null</span><span class="p">);</span></div><div class='line' id='LC81'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_Collection</span> <span class="p">=</span> <span class="n">collection</span><span class="p">;</span></div><div class='line' id='LC82'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC83'><br/></div><div class='line' id='LC84'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">readonly</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">m_Collection</span><span class="p">;</span></div><div class='line' id='LC85'><br/></div><div class='line' id='LC86'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="kt">int</span> <span class="n">Count</span> <span class="p">{</span></div><div class='line' id='LC87'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_Collection</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">}</span></div><div class='line' id='LC88'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC89'><br/></div><div class='line' id='LC90'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="n">IEnumerator</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">GetEnumerator</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC91'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">m_Collection</span><span class="p">.</span><span class="n">GetEnumerator</span><span class="p">();</span></div><div class='line' id='LC92'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC93'><br/></div><div class='line' id='LC94'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">IEnumerator</span> <span class="n">IEnumerable</span><span class="p">.</span><span class="n">GetEnumerator</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC95'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="p">((</span><span class="n">IEnumerable</span><span class="p">)</span><span class="n">m_Collection</span><span class="p">).</span><span class="n">GetEnumerator</span><span class="p">();</span></div><div class='line' id='LC96'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC97'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC98'><br/></div><div class='line' id='LC99'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">private</span> <span class="k">class</span> <span class="nc">ListReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">CollectionReadOnlyWrapper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;,</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span></div><div class='line' id='LC100'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">internal</span> <span class="nf">ListReadOnlyWrapper</span><span class="p">(</span><span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">list</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">list</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC101'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Debug</span><span class="p">.</span><span class="n">Assert</span><span class="p">(</span><span class="n">list</span> <span class="p">!=</span> <span class="k">null</span><span class="p">);</span></div><div class='line' id='LC102'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_List</span> <span class="p">=</span> <span class="n">list</span><span class="p">;</span></div><div class='line' id='LC103'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC104'><br/></div><div class='line' id='LC105'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">private</span> <span class="k">readonly</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">m_List</span><span class="p">;</span></div><div class='line' id='LC106'><br/></div><div class='line' id='LC107'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="n">T</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span> <span class="p">{</span></div><div class='line' id='LC108'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_List</span><span class="p">[</span><span class="n">index</span><span class="p">];</span> <span class="p">}</span></div><div class='line' id='LC109'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC110'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC111'><br/></div><div class='line' id='LC112'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;summary&gt;</span></div><div class='line' id='LC113'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///Determines the index of a specific item in &lt;paramref name=&quot;readOnlyList&quot;/&gt;.</span></div><div class='line' id='LC114'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;/summary&gt;</span></div><div class='line' id='LC115'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;typeparam name=&quot;T&quot;&gt;The type parameter of the items in the read-only list.&lt;/typeparam&gt;</span></div><div class='line' id='LC116'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;param name=&quot;readOnlyList&quot;&gt;&lt;/param&gt;</span></div><div class='line' id='LC117'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;param name=&quot;value&quot;&gt;The object to locate in &lt;paramref name=&quot;readOnlyList&quot;/&gt;.&lt;/param&gt;</span></div><div class='line' id='LC118'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;returns&gt;The index of value if found in the list; otherwise, -1.&lt;/returns&gt;</span></div><div class='line' id='LC119'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">///&lt;remarks&gt;This method uses the EqualityComparer$lt;T&amp;gt;.Default.Equals() method on &lt;paramref name=&quot;value&quot;/&gt; to determine whether item exists&lt;/remarks&gt;</span></div><div class='line' id='LC120'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">IndexOf</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IReadOnlyList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">readOnlyList</span><span class="p">,</span> <span class="n">T</span> <span class="k">value</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC121'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Contract</span><span class="p">.</span><span class="n">Requires</span><span class="p">(</span><span class="n">readOnlyList</span> <span class="p">!=</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;readOnlyList must not be null&quot;</span><span class="p">);</span></div><div class='line' id='LC122'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">count</span> <span class="p">=</span> <span class="n">readOnlyList</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span></div><div class='line' id='LC123'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">equalityComparer</span> <span class="p">=</span> <span class="n">EqualityComparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">Default</span><span class="p">;</span></div><div class='line' id='LC124'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span><span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span></div><div class='line' id='LC125'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">current</span> <span class="p">=</span> <span class="n">readOnlyList</span><span class="p">[</span><span class="n">i</span><span class="p">];</span></div><div class='line' id='LC126'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">equalityComparer</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="k">value</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="n">i</span><span class="p">;</span> <span class="p">}</span></div><div class='line' id='LC127'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC128'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span><span class="p">-</span> <span class="m">1</span><span class="p">;</span></div><div class='line' id='LC129'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC130'>&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC131'><br/></div><div class='line' id='LC132'><br/></div><div class='line' id='LC133'><br/></div><div class='line' id='LC134'><br/></div><div class='line' id='LC135'><br/></div><div class='line' id='LC136'><span class="na">   [TestFixture]</span></div><div class='line' id='LC137'>&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">class</span> <span class="nc">Test_ReadOnlyCollectionList</span> <span class="p">{</span></div><div class='line' id='LC138'><br/></div><div class='line' id='LC139'><span class="na">      [Test]</span></div><div class='line' id='LC140'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">void</span> <span class="nf">Test_ReadOnlyCollection</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC141'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">collection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">{</span> <span class="m">11</span><span class="p">,</span> <span class="m">21</span> <span class="p">};</span></div><div class='line' id='LC142'><br/></div><div class='line' id='LC143'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">wrappedCollection</span> <span class="p">=</span> <span class="n">collection</span><span class="p">.</span><span class="n">ToReadOnlyWrappedCollection</span><span class="p">();</span></div><div class='line' id='LC144'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedCollection</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC145'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedCollection</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">==</span> <span class="m">11</span><span class="p">);</span></div><div class='line' id='LC146'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedCollection</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="p">==</span> <span class="m">21</span><span class="p">);</span></div><div class='line' id='LC147'><br/></div><div class='line' id='LC148'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">clonedCollection</span> <span class="p">=</span> <span class="n">collection</span><span class="p">.</span><span class="n">ToReadOnlyClonedCollection</span><span class="p">();</span></div><div class='line' id='LC149'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedCollection</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC150'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedCollection</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">==</span> <span class="m">11</span><span class="p">);</span></div><div class='line' id='LC151'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedCollection</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="p">==</span> <span class="m">21</span><span class="p">);</span></div><div class='line' id='LC152'><br/></div><div class='line' id='LC153'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Test Cloned/Wrapped</span></div><div class='line' id='LC154'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">collection</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="m">31</span><span class="p">);</span></div><div class='line' id='LC155'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedCollection</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">3</span><span class="p">);</span></div><div class='line' id='LC156'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedCollection</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">2</span><span class="p">)</span> <span class="p">==</span> <span class="m">31</span><span class="p">);</span></div><div class='line' id='LC157'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedCollection</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC158'><br/></div><div class='line' id='LC159'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Force cover the IEnumerable.GetEnumerator()</span></div><div class='line' id='LC160'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">IEnumerator</span> <span class="n">enumerator</span> <span class="p">=</span> <span class="p">((</span><span class="n">IEnumerable</span><span class="p">)</span><span class="n">wrappedCollection</span><span class="p">).</span><span class="n">GetEnumerator</span><span class="p">();</span></div><div class='line' id='LC161'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">enumerator</span><span class="p">.</span><span class="n">MoveNext</span><span class="p">();</span></div><div class='line' id='LC162'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">enumerator</span><span class="p">.</span><span class="n">Current</span><span class="p">)</span> <span class="p">==</span> <span class="m">11</span><span class="p">);</span></div><div class='line' id='LC163'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC164'><br/></div><div class='line' id='LC165'><br/></div><div class='line' id='LC166'><span class="na">      [Test]</span></div><div class='line' id='LC167'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">void</span> <span class="nf">Test_ReadOnlyList</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC168'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">{</span> <span class="m">11</span><span class="p">,</span><span class="m">21</span> <span class="p">};</span></div><div class='line' id='LC169'><br/></div><div class='line' id='LC170'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">wrappedList</span> <span class="p">=</span> <span class="n">list</span><span class="p">.</span><span class="n">ToReadOnlyWrappedList</span><span class="p">();</span></div><div class='line' id='LC171'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedList</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC172'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedList</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">11</span><span class="p">);</span></div><div class='line' id='LC173'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedList</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">==</span> <span class="m">21</span><span class="p">);</span></div><div class='line' id='LC174'><br/></div><div class='line' id='LC175'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">clonedList</span> <span class="p">=</span> <span class="n">list</span><span class="p">.</span><span class="n">ToReadOnlyClonedList</span><span class="p">();</span></div><div class='line' id='LC176'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedList</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC177'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedList</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">11</span><span class="p">);</span></div><div class='line' id='LC178'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedList</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">==</span> <span class="m">21</span><span class="p">);</span></div><div class='line' id='LC179'><br/></div><div class='line' id='LC180'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Test Cloned/Wrapped</span></div><div class='line' id='LC181'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">list</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="m">31</span><span class="p">);</span></div><div class='line' id='LC182'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedList</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">3</span><span class="p">);</span></div><div class='line' id='LC183'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">wrappedList</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">==</span> <span class="m">31</span><span class="p">);</span></div><div class='line' id='LC184'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">clonedList</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">2</span><span class="p">);</span></div><div class='line' id='LC185'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC186'><br/></div><div class='line' id='LC187'><span class="na">      [Test]</span></div><div class='line' id='LC188'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">void</span> <span class="nf">Test_IndexOf</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC189'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">ints</span> <span class="p">=</span> <span class="p">(</span><span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">{</span><span class="m">11</span><span class="p">,</span> <span class="m">21</span><span class="p">,</span> <span class="m">31</span><span class="p">}).</span><span class="n">ToReadOnlyWrappedList</span><span class="p">();</span></div><div class='line' id='LC190'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">ints</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="m">21</span><span class="p">)</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span></div><div class='line' id='LC191'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">ints</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="m">41</span><span class="p">)</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span></div><div class='line' id='LC192'><br/></div><div class='line' id='LC193'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">strings</span> <span class="p">=</span> <span class="p">(</span><span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span><span class="s">&quot;11&quot;</span><span class="p">,</span> <span class="s">&quot;21&quot;</span><span class="p">,</span> <span class="s">&quot;31&quot;</span><span class="p">}).</span><span class="n">ToReadOnlyWrappedList</span><span class="p">();</span></div><div class='line' id='LC194'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="s">&quot;21&quot;</span><span class="p">)</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span></div><div class='line' id='LC195'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">strings</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="s">&quot;41&quot;</span><span class="p">)</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span></div><div class='line' id='LC196'><br/></div><div class='line' id='LC197'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">obj</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">();</span></div><div class='line' id='LC198'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">var</span> <span class="n">objects</span> <span class="p">=</span> <span class="p">(</span><span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="p">{</span><span class="k">new</span> <span class="kt">object</span><span class="p">(),</span> <span class="n">obj</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">()}).</span><span class="n">ToReadOnlyWrappedList</span><span class="p">();</span></div><div class='line' id='LC199'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">objects</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span></div><div class='line' id='LC200'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">objects</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="k">new</span> <span class="kt">object</span><span class="p">())</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span></div><div class='line' id='LC201'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC202'>&nbsp;&nbsp;&nbsp;<span class="p">}</span></div></pre></div>
          </div>

          <div class="gist-meta">
            <a href="https://gist.github.com/raw/3247559/1ac54e60a786ab1b082f51dc7fb16c8c559383a0/gistfile1.cs" style="float:right;">view raw</a>
            <a href="https://gist.github.com/3247559#file_gistfile1.cs" style="float:right;margin-right:10px;color:#666">gistfile1.cs</a>
            <a href="https://gist.github.com/3247559">This Gist</a> brought to you by <a href="http://github.com">GitHub</a>.
          </div>
        </div>
</div>
</noscript>
<p>And finally, I did a CQLinq rule to check that NDepend.API will never return anymore a <em>ICollection&lt;T&gt;</em>!</p>
<script src="http://gist.github.com/3249750.js"></script><noscript><link rel="stylesheet" href="https://gist.github.com/stylesheets/gist/embed.css"><div id="gist-3249750" class="gist">
    
        <div class="gist-file">
          <div class="gist-data gist-syntax">
              <div class="highlight"><pre><div class='line' id='LC1'><span class="c1">// &lt;Name&gt;Check enumerable types returned by NDepend.API&lt;/Name&gt;</span></div><div class='line' id='LC2'><span class="n">warnif</span> <span class="n">count</span> <span class="p">&gt;</span> <span class="m">0</span></div><div class='line' id='LC3'><span class="n">let</span> <span class="n">seqTypes</span> <span class="p">=</span> <span class="n">Types</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span></div><div class='line' id='LC4'>&nbsp;&nbsp;&nbsp;<span class="n">t</span> <span class="p">=&gt;</span> <span class="n">t</span><span class="p">.</span><span class="n">Implement</span><span class="p">(</span><span class="s">&quot;System.Collections.Generic.IEnumerable&lt;T&gt;&quot;</span><span class="p">)</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// List of enumerable types that can be returned by a NDepend.API function.</span></div><div class='line' id='LC6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">!</span><span class="n">t</span><span class="p">.</span><span class="n">FullName</span><span class="p">.</span><span class="n">EqualsAny</span><span class="p">(</span><span class="s">&quot;System.String&quot;</span><span class="p">,</span></div><div class='line' id='LC7'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;System.Linq.ILookup&lt;TKey,TElement&gt;&quot;</span><span class="p">,</span></div><div class='line' id='LC8'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;NDepend.Helpers.IReadOnlyList&lt;T&gt;&quot;</span><span class="p">,</span></div><div class='line' id='LC9'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;NDepend.Helpers.IReadOnlyCollection&lt;T&gt;&quot;</span><span class="p">,</span></div><div class='line' id='LC10'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;System.Collections.Generic.HashSet&lt;T&gt;&quot;</span><span class="p">,</span></div><div class='line' id='LC11'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">&quot;NDepend.CodeModel.ICodeMetric&lt;TCodeElement,TNumeric&gt;&quot;</span><span class="p">)).</span><span class="n">ToHashSet</span><span class="p">()</span></div><div class='line' id='LC12'><br/></div><div class='line' id='LC13'><span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">Assemblies</span><span class="p">.</span><span class="n">WithNameIn</span><span class="p">(</span> <span class="s">&quot;NDepend.API&quot;</span><span class="p">).</span><span class="n">ChildMethods</span><span class="p">()</span> <span class="k">orderby</span> <span class="n">m</span><span class="p">.</span><span class="n">NbLinesOfCode</span> <span class="k">descending</span></div><div class='line' id='LC14'><br/></div><div class='line' id='LC15'><span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">IsPubliclyVisible</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC16'>&nbsp;<span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span></div><div class='line' id='LC17'>&nbsp;<span class="n">seqTypes</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span><span class="p">)</span></div><div class='line' id='LC18'><span class="k">select</span> <span class="k">new</span> <span class="p">{</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">}</span></div></pre></div>
          </div>

          <div class="gist-meta">
            <a href="https://gist.github.com/raw/3249750/83eefa5c696cb374799356f48e1811400d122431/gistfile1.cs" style="float:right;">view raw</a>
            <a href="https://gist.github.com/3249750#file_gistfile1.cs" style="float:right;margin-right:10px;color:#666">gistfile1.cs</a>
            <a href="https://gist.github.com/3249750">This Gist</a> brought to you by <a href="http://github.com">GitHub</a>.
          </div>
        </div>
</div>
</noscript>
<div class="shr-publisher-689"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/patricksmacchia/category/net-framework/" title="View all posts in .NET Framework" rel="category tag">.NET Framework</a>, <a href="http://codebetter.com/patricksmacchia/category/api-usage/" title="View all posts in API usage" rel="category tag">API usage</a>, <a href="http://codebetter.com/patricksmacchia/category/breaking-changes/" title="View all posts in breaking changes" rel="category tag">breaking changes</a>, <a href="http://codebetter.com/patricksmacchia/category/code-rule/" title="View all posts in Code Rule" rel="category tag">Code Rule</a>. Bookmark the <a href="http://codebetter.com/patricksmacchia/2012/08/06/the-consequence-of-a-net-framework-api-design-flaw/" title="Permalink to The consequence of a.NET Framework API design flaw" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/patricksmacchia/2012/08/06/the-consequence-of-a-net-framework-api-design-flaw/feed/" title="Comments RSS to The consequence of a.NET Framework API design flaw" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-689 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/patricksmacchia/2012/06/27/include-il-offset-into-production-exception-stacktrace/" rel="prev"><span class="meta-nav">&larr;</span> Include IL Offset into production exception StackTrace</a></div>
					<div class="nav-next"><a href="http://codebetter.com/patricksmacchia/2012/10/02/beware-mixing-list-sort-and-thread-abort/" rel="next">Beware mixing List.Sort() and Thread.Abort() <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-1691">
                    <div id="dsq-comment-header-1691" class="dsq-comment-header">
                        <cite id="dsq-cite-1691">
    http://barrkel.blogspot.com/                            <span id="dsq-author-user-1691">barrkel</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1691" class="dsq-comment-body">
                        <div id="dsq-comment-message-1691" class="dsq-comment-message"><p>You&#8217;re overstating how poor ReadOnlyCollection is. The Items property is protected; it is only accessible to descendants, and they can already access the wrapped IList through the constructor they need to provide. Returning an IEnumerable instead of a ReadOnlyCollection for something that supports O(1) random access is a *terrible* idea; it is not better at all.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1692">
                    <div id="dsq-comment-header-1692" class="dsq-comment-header">
                        <cite id="dsq-cite-1692">
                                <span id="dsq-author-user-1692">Anonymous</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1692" class="dsq-comment-body">
                        <div id="dsq-comment-message-1692" class="dsq-comment-message"><p>+1 for the  Items property protected on  ReadOnlyCollection, but still I would never use this class, in place where I really need an interface.</p>
<p>-1 for the IEnumerable, actually if the IEnumerable object is also a IList, the implementation of the extension method Enumerable.ElementAt() is smart enough to retrieve the element by index in O(1). But this is an implementation detail, and this finally advocates that having our own IReadOnlyList with a clearly O(1) indexer property is a good idea.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1693">
                    <div id="dsq-comment-header-1693" class="dsq-comment-header">
                        <cite id="dsq-cite-1693">
    http://barrkel.blogspot.com/                            <span id="dsq-author-user-1693">barrkel</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1693" class="dsq-comment-body">
                        <div id="dsq-comment-message-1693" class="dsq-comment-message"><p>You seriously think forcing clients to use Enumerable.ElementAt() for random access would be a good idea? OK, so ElementAt() has a special case optimization; but depending on it is really brittle, the implementation (the value returned) may change at any time. If the IEnumerable property is guaranteed to support IList (so you can depend on O(1)), then it should return IList, not IEnumerable.</p>
<p>Creating your own interface is even worse though. Interfaces are generally worse than abstract base classes &#8211; this is another of your objections I don&#8217;t really agree with &#8211; for everything except very narrow slices of functionality that are never going to have their API set change. Usability alone generally demands a broader set of methods and properties that can themselves be implemented in terms of a simpler underlying interface. This by itself justifies ReadOnlyCollection.</p>
<p>Inventing your own interface for this? That&#8217;s a really dumb idea! <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  You&#8217;ve just guaranteed that your code won&#8217;t interface well with all the other third-party code that expects to work with the common stuff in the BCL. Defective by design&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1694">
                    <div id="dsq-comment-header-1694" class="dsq-comment-header">
                        <cite id="dsq-cite-1694">
    http://blog.andrei.rinea.ro/                            <span id="dsq-author-user-1694">Andrei Rinea</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1694" class="dsq-comment-body">
                        <div id="dsq-comment-message-1694" class="dsq-comment-message"><p>Java does the same thing too.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1695">
                    <div id="dsq-comment-header-1695" class="dsq-comment-header">
                        <cite id="dsq-cite-1695">
                                <span id="dsq-author-user-1695">Anonymous</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1695" class="dsq-comment-body">
                        <div id="dsq-comment-message-1695" class="dsq-comment-message"><p>&gt;You seriously think forcing clients to use Enumerable.ElementAt() for random access would be a good idea? <br />
No, and as a matter of fact I don&#8217;t choose this solution.</p>
<p>&gt;<br />
Inventing your own interface for this? That&#8217;s a really dumb idea! <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />   </p>
<p>I don&#8217;t invent it, we just define the ones existing in .NET Fx v4.5, put them in our namespace system, and  will switch back to these standard ones once we&#8217;ll compile against .NET v4.5 sooner or later.</p>
<p>&gt;Interfaces are generally worse than abstract base classes</p>
<p>I disagree, interfaces represent a well defined simple responsability.  Base class represents a backbone responsability that can be specialized, and still shows a lot more than an interface to the user.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1696">
                    <div id="dsq-comment-header-1696" class="dsq-comment-header">
                        <cite id="dsq-cite-1696">
    http://www.facebook.com/leontivero                            <span id="dsq-author-user-1696">Lucas Ontivero</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1696" class="dsq-comment-body">
                        <div id="dsq-comment-message-1696" class="dsq-comment-message"><p>I´ve had the same problem and what I do is return arrays instead of ICollection, if developers want to modify its slots, what´s the problem? I think that even when it is a mutable object, the important point is that modifying its slots doesn´t change the internal API state (and that´s the reason we always return readonly collections). </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1697">
                    <div id="dsq-comment-header-1697" class="dsq-comment-header">
                        <cite id="dsq-cite-1697">
                                <span id="dsq-author-user-1697">Anonymous</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1697" class="dsq-comment-body">
                        <div id="dsq-comment-message-1697" class="dsq-comment-message"><p>&gt;if developers want to modify its slots, what´s the problem?<br />
The problem is that for that, you constantly need to return cloned collections to ensure that modifying slots doesn&#8217;t have any underlying impact. Cloned collections can be something costly in term of performance and memory consumption, and often returning a &#8220;really&#8221; read-only wrapped (as opposition to cloned) collection is a better choice.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1699">
                    <div id="dsq-comment-header-1699" class="dsq-comment-header">
                        <cite id="dsq-cite-1699">
    http://blog.tcx.be/                            <span id="dsq-author-user-1699">Tommy Carlier</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1699" class="dsq-comment-body">
                        <div id="dsq-comment-message-1699" class="dsq-comment-message"><p>I wrote a proposition for read-only collections back in 2008. My IReadableCollection also had the method Contains. I just basically took the existing collection interfaces and removed all members that modified the collection. I named my interfaces IReadableCollection and IReadableList, because they can be implemented by classes that are read/write (so they&#8217;re not &#8220;read-only&#8221;).</p>
<p>See: http://blog.tcx.be/2008/12/net-bcl-proposition-read-only.html</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1700">
                    <div id="dsq-comment-header-1700" class="dsq-comment-header">
                        <cite id="dsq-cite-1700">
    http://www.facebook.com/leontivero                            <span id="dsq-author-user-1700">Lucas Ontivero</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1700" class="dsq-comment-body">
                        <div id="dsq-comment-message-1700" class="dsq-comment-message"><p>Of course I agree with what you say, it depends on the usage requirements. And that is a good reason to avoid them, it is just that I found your point against the arrays approach not very solid.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1701">
                    <div id="dsq-comment-header-1701" class="dsq-comment-header">
                        <cite id="dsq-cite-1701">
                                <span id="dsq-author-user-1701">Dave Van den Eynde</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1701" class="dsq-comment-body">
                        <div id="dsq-comment-message-1701" class="dsq-comment-message"><p>It&#8217;s easy to blame the .NET Framework when you miss the fact that ICollection has a IsReadOnly property that you can check before you call Add().</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1702">
                    <div id="dsq-comment-header-1702" class="dsq-comment-header">
                        <cite id="dsq-cite-1702">
                                <span id="dsq-author-user-1702">Anonymous</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1702" class="dsq-comment-body">
                        <div id="dsq-comment-message-1702" class="dsq-comment-message"><p>Dave, do you really think that having a IsReadOnly property make this ICollection API clean? <br />
No it is not, this API is highly error prone, so much that I stumbled on it . If a method Add() is present, I can use it, I don&#8217;t want to check if I can or cannot use it. IReadOnlyCollection just discards the Add() method and remove any ambiguity.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/patricksmacchia/2012/08/06/the-consequence-of-a-net-framework-api-design-flaw/';
    var disqus_identifier = '689 http://codebetter.com/patricksmacchia/?p=689';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'codebetter';
    var disqus_title = "The consequence of a.NET Framework API design flaw";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=689');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/patricksmacchia\/2012\/08\/06\/the-consequence-of-a-net-framework-api-design-flaw\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 5.662 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 21:15:43 -->
<!-- super cache -->