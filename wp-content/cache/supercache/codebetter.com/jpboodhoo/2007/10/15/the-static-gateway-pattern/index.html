<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>The Static Gateway Pattern | Jean-Paul S. Boodhoo</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jpboodhoo/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jpboodhoo/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Start Flying With ReSharper (and windows in general) &#8211; Use the Alt-Key' href='http://codebetter.com/jpboodhoo/2007/10/12/start-flying-with-resharper-and-windows-in-general-use-the-alt-key/' />
<link rel='next' title='TDD is like snowboarding (or learning any new skill)' href='http://codebetter.com/jpboodhoo/2007/11/02/tdd-is-like-snowboarding-or-learning-any-new-skill/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jpboodhoo/?p=70' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,139] -->
<link rel="canonical" href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-70" class="post-70 post type-post status-publish format-standard hentry category-featured category-patterns category-programming">
					<h1 class="entry-title">The Static Gateway Pattern</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jpboodhoo/author/jpboodhoo/" title="View all posts by jpboodhoo">jpboodhoo</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/" title="12:50 pm" rel="bookmark"><span class="entry-date">October 15, 2007</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jpboodhoo/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jpboodhoo/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>Now I am by no means claiming to be any sort of patterns naming authority, but after you see the same occurent pattern in your applications you often will try to formulate some sort of vocabulary among the team to express the concept that you see occurring over and over again. This is the very nature of how patterns popped up in the first place. This is a pet name that I have come up with for the &ldquo;recurring&rdquo; theme you will see demonstrated here. If you are not familiar with the Gateway pattern check out the definition <a href="http://martinfowler.com/eaaCatalog/gateway.html">here</a>.</p>
<p>I am going to demonstrate this pattern with an example that most people should have in place at the beginning of a project. Logging.</p>
<p>One of the things about Logging, is that it should be simple. Let&rsquo;s assume that to get things rolling I really only care about logging informational messages. Assume I have a Calculator class that wants to do some logging, here are some possible code fragments that demonstrate the calculator class taking advantage of logging capabilities:</p>
<pre><span>    </span><span>public</span><span> </span><span>class</span><span> Calculator
    {
        </span><span>private</span><span> ILog log;

        </span><span>public</span><span> Calculator(ILog log)
        {
            </span><span>this</span><span>.log </span><span>=</span><span> log;
        }

        </span><span>public</span><span> </span><span>int</span><span> Add(</span><span>int</span><span> number1,</span><span>int</span><span> number2)
        {
            log.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">About to add two numbers</SPAN><SPAN style="color: #000000">"</span><span>);</span></pre>
<pre><span>            return number1 + number2;</span><span>
        }
    }
</span></pre>
</p>
<p>In this scenario the calculator is constructed with a log which will take care of logging behaviour on its behalf. I don&rsquo;t like this as Logging falls under that set of &ldquo;cross-cutting&rdquo; concerns, and I don&rsquo;t want to have to provide all of the objects in my application (domain layer or not) with this extra dependency. Here is another option:</p>
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> Calculator
    {
        </span><span>private</span><span> ILog log;

        </span><span>public</span><span> Calculator()
        {
            
        }

        </span><span>public</span><span> ILog Log
        {
            </span><span>set</span><span>
            {
                </span><span>this</span><span>.log </span><span>=</span><span> value;                
            }
        }

        </span><span>public</span><span> </span><span>int</span><span> Add(</span><span>int</span><span> number1,</span><span>int</span><span> number2)
        {
            log.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">About to add two numbers</SPAN><SPAN style="color: #000000">"</span><span>);</span></div><div><span>            return number1 + number2;
        }
    }</span></div></pre>
</p>
<p>Again, this is not optimal as it clutters up my object with unecessary noise. From a simplicity perspective, is it simpe for me to specify that &ldquo;all objects should have a field of type ILog if they want to consume logging functionality? I think that the simplest api would be something like this:</p>
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> Calculator
    {                
        </span><span>public</span><span> </span><span>int</span><span> Add(</span><span>int</span><span> number1,</span><span>int</span><span> number2)
        {
            Log.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">About to add two numbers</SPAN><SPAN style="color: #000000">"</span><span>);</span></div><div><span>            return number1 + number2;
        }
    }
</span></div></pre>
</p>
<p>Right now someone somewhere is screaming about the fact that I just introduced, what looks like, a Singleton. From an API perspective, the line above imposes the least design restrictions on my classes that want to consume logging functionality. The only caveat is that any class that wants to leverage logging is now coupled to the Log class. IMHO this is only an issue if it decreases the ability for me to test or if it decreases the option for me to swap out logging implementations (ex. Log4Net, MS Logging etc).</p>
<p>By the looks of the code above, it would seem that I have pinned myself into a fairly rigid design. I am not going to focus on how I test drive this out, but taking the API above, how could I go about testing the Log class? </p>
<p>With the Static Gateway pattern, the Gateway (in this case the Log class) does not actually do any of the work. It just serves as the entry point to the functionality. If that is the case here is a cut at what the Log class could look like:</p>
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> Log
    {
        </span><span>private</span><span> </span><span>static</span><span> ILogFactory logFactory;

        </span><span>public</span><span> </span><span>static</span><span> </span><span>void</span><span> InitializeLogFactory(ILogFactory logFactory)
        {
            Log.logFactory </span><span>=</span><span> logFactory;
        }

        </span><span>public</span><span> </span><span>void</span><span> InformationalMessage(</span><span>string</span><span> informationalMessage)
        {
            logFactory.Create().InformationalMessage(informationalMessage);
        }
    }

    </span><span>public</span><span> </span><span>interface</span><span> ILogFactory
    {
        ILog Create();
    }

    </span><span>public</span><span> </span><span>interface</span><span> ILog
    {
        </span><span>void</span><span> InformationalMessage(</span><span>string</span><span> message);
    }
</span></div></pre>
</p>
<p>How could you go about testing this class (I am&nbsp;demonstrating test-after, though the end solution was driven out test first). Here are two tests that prove out the functionality of the log class:</p>
<p>&nbsp;</p>
<pre><div><span>        [Test]
        </span><span>public</span><span> </span><span>void</span><span> Factory_should_be_leveraged_to_create_logger()
        {
            MockRepository mockery </span><span>=</span><span> </span><span>new</span><span> MockRepository();
            ILogFactory mockLogFactory </span><span>=</span><span> mockery.DynamicMock</span><span>&lt;</span><span>ILogFactory</span><span>&gt;</span><span>();
            ILog mockLog </span><span>=</span><span> mockery.DynamicMock</span><span>&lt;</span><span>ILog</span><span>&gt;</span><span>();

            </span><span>using</span><span> (mockery.Record())
            {
                Expect.Call(mockLogFactory.Create()).Return(mockLog);
            }
            
            Log.InitializeLogFactory(mockLogFactory);
            
            </span><span>using</span><span> (mockery.Playback())
            {       
                Log.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">blah</SPAN><SPAN style="color: #000000">"</span><span>);
            }
            Log.InitializeLogFactory(</span><span>null</span><span>);
        }

        [Test]
        </span><span>public</span><span> </span><span>void</span><span> Informational_message_call_should_be_delegated_to_created_logger()
        {
            MockRepository mockery </span><span>=</span><span> </span><span>new</span><span> MockRepository();
            ILogFactory mockLogFactory </span><span>=</span><span> mockery.DynamicMock</span><span>&lt;</span><span>ILogFactory</span><span>&gt;</span><span>();
            ILog mockLog </span><span>=</span><span> mockery.DynamicMock</span><span>&lt;</span><span>ILog</span><span>&gt;</span><span>();

            </span><span>using</span><span> (mockery.Record())
            {
                SetupResult.For(mockLogFactory.Create()).Return(mockLog);
                mockLog.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">blah</SPAN><SPAN style="color: #000000">"</span><span>);
            }
            
            Log.InitializeLogFactory(mockLogFactory);
            
            </span><span>using</span><span> (mockery.Playback())
            {            
                Log.InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">blah</SPAN><SPAN style="color: #000000">"</span><span>);
            }
            Log.InitializeLogFactory(</span><span>null</span><span>);
        }
</span></div></pre>
</p>
<p>As you can see, these are completely interaction based tests (hence the lack of assertions). I broke up the test for leveraging the factory to create the logger and the delegation to the actual logger into 2 separate tests. I am also using the SetupResult vs Expect in the second test to indicate that, it is not the behaviour I care about testing. It just needs to be there to focus on what I actually care about, the delegation of the Log class to the created ILog implementation (which is currently a mock itself). </p>
<p>The nice thing about this scenario is that neither the Log class, or the clients of the Log class are aware/tied to any one particular ILog implementation. As long as I can prove out the correct interaction between the Log class and it&rsquo;s dependency, I should be able to swap in any implementation of ILogFactory and the Log class is none the wiser. </p>
<p>The only downside to the current implementation of the Log class is the need for the static field and static method to initialize that field. Outside of introducing other concepts too early, the initialization of the Log class with an ILogFactory implementation is something that can be done at application startup. It is very likely that is should be one of the first things that should happen, as many other objects in the system may rely on the functionality of the Log class. </p>
<p>The only problem with the current solution is that the Log class is coupled to any changes that may occur in the ILog interface. To ensure that the ILog interface can vary independently of the Log class, I am going to make a small change to the API. Instead of calling methods on Log directly. I am going to change Log, and&nbsp;ILogFactory&nbsp;to the following:
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> Log
    {
        </span><span>private</span><span> </span><span>static</span><span> ILogFactory logFactory;

        </span><span>public</span><span> </span><span>static</span><span> </span><span>void</span><span> InitializeLogFactory(ILogFactory logFactory)
        {
            Log.logFactory </span><span>=</span><span> logFactory;
        }

        </span><span>public</span><span> </span><span>static</span><span> ILog For(Type type)
        {
            </span><span>return</span><span> logFactory.CreateFor(type);
        }

        </span><span>public</span><span> </span><span>static</span><span> ILog For(</span><span>object</span><span> itemThatRequiresLoggingServices)
        {
            </span><span>return</span><span> For(itemThatRequiresLoggingServices.GetType());
        }
    }
</span></div></pre>
</p>
<p>The nice thing about this change is that now the Log class does not need to have a mirroring method for every method that may exist on the ILog interface. The ILog interface is now free to change independently of the Log class. Which means I could easily add methods to log with a specific logging level, etc. The Log class is now strictly a &ldquo;Static Gateway&rdquo; to Logging functionality.</p>
<p>I&#8217;ll finish up by making a call into this API from the Calculator class:&nbsp;</p>
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> Calculator
    {
        </span><span>public</span><span> </span><span>int</span><span> Add(</span><span>int</span><span> number1,</span><span>int</span><span> number2)
        {
            Log.For(</span><span>this</span><span>).InformationalMessage(</span><span>"</SPAN><SPAN style="color: #000000">About to add 2 numbers</SPAN><SPAN style="color: #000000">"</span><span>);
            </span><span>return</span><span> number1 </span><span>+</span><span> number2;
        }
    }
</span></div></pre>
</p>
<p>At this point the Calculator class is completely oblivious to the fact that there is currently no concrete ILogFactory/ILog implementation. It just cares about leveraging the Logging gateways &ldquo;Static&rdquo; method to have it log on its behalf. When we actually swap in a real ILogFactory &amp; ILog, neither the Calculator or Log class will have to change at all. </p>
<p>In completion here is a quick implementation of an ILogFactory/ILog pair that will output log messages to the console (I&rsquo;ll leave it up to you to come up with a more testable implementation of the following 2 classes):</p>
<pre><div><span>    </span><span>public</span><span> </span><span>class</span><span> ConsoleLogFactory : ILogFactory
    {
        </span><span>public</span><span> ILog CreateFor(Type type)
        {
            </span><span>return</span><span> </span><span>new</span><span> ConsoleLogger();
        }

        </span><span>private</span><span> </span><span>class</span><span> ConsoleLogger : ILog
        {
            </span><span>public</span><span> </span><span>void</span><span> InformationalMessage(</span><span>string</span><span> message)
            {
                System.Console.Out.WriteLine(message);
            }
        }
    }
</span></div></pre>
</p>
<p>If you were to run the application now (after initializing the Log class with this ILogFactory implementation), you would see messages output to the Console, whenever the Add method on Calcuator was invoked.</p>
<p>In my next post, I&rsquo;ll demonstrate how to leverage the Static Gateway pattern with respect to an IOC gateway, that will allow me to remove the static field and initilization method on the Log class.</p>
<div class="shr-publisher-70"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jpboodhoo/category/featured/" title="View all posts in Featured" rel="category tag">Featured</a>, <a href="http://codebetter.com/jpboodhoo/category/patterns/" title="View all posts in Patterns" rel="category tag">Patterns</a>, <a href="http://codebetter.com/jpboodhoo/category/programming/" title="View all posts in Programming" rel="category tag">Programming</a>. Bookmark the <a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/" title="Permalink to The Static Gateway Pattern" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/feed/" title="Comments RSS to The Static Gateway Pattern" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-70 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jpboodhoo/2007/10/12/start-flying-with-resharper-and-windows-in-general-use-the-alt-key/" rel="prev"><span class="meta-nav">&larr;</span> Start Flying With ReSharper (and windows in general) &#8211; Use the Alt-Key</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jpboodhoo/2007/11/02/tdd-is-like-snowboarding-or-learning-any-new-skill/" rel="next">TDD is like snowboarding (or learning any new skill) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">7 Responses to <em>The Static Gateway Pattern</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-200">
		<div id="comment-200">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/david_laribee' rel='external nofollow' class='url'>Dave Laribee</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-200">October 17, 2007 at 4:03 pm</a></div>

		<div class="comment-body"><p>i got you. still the subtlety factor of patterns bothers me somewhat. gateway vs. adapter? i think this is a point brought up on poeaa, but then again there&#8217;s the gateway chapter. i don&#8217;t have an opinion though i do think subtlety is a good thing as long as it&#8217;s understood (high oo skill in a team).</p>
<p>here&#8217;s a question: how is this not just a factory method? </p>
<p>public static ILog For(Type type);</p>
<p>Factory Method Chain? maybe another pattern in there? i see you have one under ultimately resolving the log but it seems static gateway is really just two factories for the purpose of syntactic sugar (w/ testability).</p>
<p>at any rate i see where Log is both a gateway and static. this is a very composite pattern with similar patterns delegating to similar patterns (looks like a service locator delegating to a service locator, or a factory method delegating to an abstract factory in places.) of course saying &#8216;static gateway&#8217; tightens the langauge.</p>
<p>ok. i buy it! <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-199">
		<div id="comment-199">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">SteveG</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-199">October 16, 2007 at 2:29 pm</a></div>

		<div class="comment-body"><p>Good article!</p>
<p>I&#8217;d like to see this look something like this;</p>
<p>[Logger]  //inject the logger instead of a singleton- you need logging, you add the attribute<br />
public class Calculator<br />
&#8230;<br />
      Log.InformationalMessage(&#8230;)</p>
<p>Different subject, but it made me wonder if Castle Windsor can do this type of injection ?<br />
It&#8217;s cleaner than your first example, but still uses injection without the use of a singleton.</p>
<p>Thoughts on this?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-198">
		<div id="comment-198">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jpboodhoo.com' rel='external nofollow' class='url'>Jean-Paul S. Boodhoo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-198">October 15, 2007 at 8:10 pm</a></div>

		<div class="comment-body"><p>@Dave,</p>
<p>You are one step ahead. The example that you just gave is a &#8220;Static Gateway&#8221; to container functionality. IOC becomes the Static Gateway, the actual IContainer implementation is the actual service locator, the IOC is just the entry point to access this functionality. </p>
<p>Once you introduce a static gateway for the container (which I was going to do in my next post), the static initialization method on the Log class disappears, and each of its For methods gets changed to the following:</p>
<p>public ILog For(Type type)<br />
{<br />
    return IoC.Resolve<ilogfactory>().Create();<br />
}</p>
<p>The point being, that once people have started leveraging the Log (static gateway), they are oblivious to the introduction of the IoC gateway and can carry on logging as normal.</p>
<p>It is a subtle enough difference to make me not think that this is a Service Locator (Log, not the IoC).</ilogfactory></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-197">
		<div id="comment-197">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/david_laribee/' rel='external nofollow' class='url'>Dave Laribee</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-197">October 15, 2007 at 7:52 pm</a></div>

		<div class="comment-body"><p>How is this not a Service Locator?</p>
<p><a href="http://java.sun.com/blueprints/corej2eepatterns/Patterns/ServiceLocator.html" rel="nofollow">http://java.sun.com/blueprints/corej2eepatterns/Patterns/ServiceLocator.html</a></p>
<p>We&#8217;ve surfaced this pattern with something like this:</p>
<p>IoC.Resolve<imydependency>();<br />
IoC.IntializeWithContainer(mockContainer);</p>
<p>This lets us use the IoC static members inside things like controllers, etc. But we&#8217;re also using it for services in pretty much the same way you describe. What&#8217;s interesting is to look at Ruby and things like mixins. They really change the dependency inversion principle, or recast it in a different technique.</imydependency></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-196">
		<div id="comment-196">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.lostechies.com/blogs/joe_ocampo' rel='external nofollow' class='url'>Joe Ocampo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-196">October 15, 2007 at 5:53 pm</a></div>

		<div class="comment-body"><p>Thanks for the clarification.</p>
<p>I find it astonishing on the number of composite patterns that can be formulated to solve business issues.  The funny thing is that I find that developers in general don&#8217;t understand the basic GOF patterns to even recognize a composite pattern.</p>
<p>Is this a bad thing? hmmm&#8230;Have to think about that.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-195">
		<div id="comment-195">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jpboodhoo.com' rel='external nofollow' class='url'>Jean-Paul S. Boodhoo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-195">October 15, 2007 at 3:22 pm</a></div>

		<div class="comment-body"><p>@Joe,</p>
<p>Good eye!! I guess I should have taken the time to point out the players outside of the Gateway itself!! Like a lot of composite patterns, this just becomes a simpler term to use among team members.</p>
<p>With regards to it being a singleton, the actual logging factory strategy may not be a singleton. In the current implementation of the Log class, the factory is definitely a singleton by nature of the static field. With the introduction of delegating to a container (coming up soon), this limitation goes away, while maintaining the testability aspect. In it&#8217;s current implementation, it circumvents typical issues associated with Singletons, as it does nothing other than delegate to something that can be mocked/swapped etc.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-194">
		<div id="comment-194">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.lostechies.com/blogs/joe_ocampo' rel='external nofollow' class='url'>Joe Ocampo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jpboodhoo/2007/10/15/the-static-gateway-pattern/#comment-194">October 15, 2007 at 3:08 pm</a></div>

		<div class="comment-body"><p>This is awesome JP but isn&#8217;t this just combining a Bridge, Singleton and Strategy pattern into one?  Just asking for clarification purposes on my end.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/jpboodhoo/2007/10/15/the-static-gateway-pattern/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/jpboodhoo/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fjpboodhoo%2F2007%2F10%2F15%2Fthe-static-gateway-pattern%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.349 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 18:54:08 -->
<!-- super cache -->