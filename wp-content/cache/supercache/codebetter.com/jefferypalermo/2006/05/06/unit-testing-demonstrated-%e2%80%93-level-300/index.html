<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Unit testing demonstrated – level 300 | Jeffery Palermo</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jefferypalermo/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jefferypalermo/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Automated testing with .Net &#8211; an overview &#8211; level 200' href='http://codebetter.com/jefferypalermo/2006/05/03/automated-testing-with-net-an-overview-level-200/' />
<link rel='next' title='StructureMap 1.0 released &#8211; Don&#8217;t create a loosely coupled system without it &#8211; level 200' href='http://codebetter.com/jefferypalermo/2006/05/09/structuremap-1-0-released-dont-create-a-loosely-coupled-system-without-it-level-200/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jefferypalermo/?p=421' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,147] -->
<link rel="canonical" href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='/photos/jeffrey.palermo/images/144194/original.aspx' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-421" class="post-421 post type-post status-publish format-standard hentry category-agile category-asp-net category-coding-principles">
					<h1 class="entry-title">Unit testing demonstrated – level 300</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jefferypalermo/author/jefferypalermo/" title="View all posts by jefferypalermo">jefferypalermo</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/" title="11:25 pm" rel="bookmark"><span class="entry-date">May 6, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jefferypalermo/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jefferypalermo/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p class="MsoNormal"><b>I use NUnit for my<br />
automated tests.<span>&nbsp; </span>Because of that, all my<br />
tests are unit tests, right?</b></p>
<p class="MsoNormal">WRONG!<span>&nbsp; </span>The name of<br />
the testing framework has no bearing on the type of test you have.<span>&nbsp; </span>NUnit is a framework for running automated<br />
tests.<span>&nbsp; </span>You _can_ write unit tests with<br />
it, but you can also write integration tests as well as full-system tests with<br />
it.<span>&nbsp; </span><b>A<br />
unit test is a special type of developer test and can be done with or without<br />
NUnit.</b><span>&nbsp; </span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>A unit test tests a<br />
single line of code.</b></p>
<p class="MsoNormal">How big is a unit?<span>&nbsp;<br />
</span>Well, that’s up to you, and there is not scientific answer.<span>&nbsp; </span>Typically, you only give a class a single<br />
responsibility.<span>&nbsp; </span>The class may have several<br />
methods since the class may need to do several things to accomplish the single<br />
responsibility.<span>&nbsp; </span>The class may have to<br />
collaborate with several other classes to accomplish its purpose.<span>&nbsp; </span>A unit of code is an identifiable chunk of<br />
code needed to accomplish part of a responsibility.<span>&nbsp; </span>Is that vague enough for you?<span>&nbsp; </span>In my example below, I’ll clear this up a<br />
bit.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>A unit test isolates<br />
the code being tested.</b></p>
<p class="MsoNormal">A class will need to talk to other classes.<span>&nbsp; </span>That’s a given.<span>&nbsp; </span>Sometimes this is ok for testing, and<br />
sometimes this just gets in the way.<span>&nbsp; </span>It<br />
might be ok to talk to a class that just builds a string (like StringBuilder),<br />
but it’s not ok to talk to a class that grabs information from a configuration<br />
file.<span>&nbsp; </span>In a unit test, you need to take<br />
environmental dependencies out of the equation so that a pass or failure is<br />
truly dependent on the code being tested.<span>&nbsp;<br />
</span>You don’t want the test failing because the configuration file wasn’t in<br />
the right spot.<span>&nbsp; </span>There are plenty of<br />
techniques available for this.<span>&nbsp; </span>To start,<br />
you need to code against interfaces and use fake objects like stubs and<br />
mocks.<span>&nbsp; </span>I like the Rhino mock framework<br />
for this.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>Here are some<br />
dependencies that will need to be frequently simulated for unit testing:</b></p>
<ul style="margin-top: 0in" type="disc">
<li class="MsoNormal">Config<br />
     files</li>
<li class="MsoNormal">Registry<br />
     values</li>
<li class="MsoNormal">Databases</li>
<li class="MsoNormal">Environment<br />
     variables</li>
<li class="MsoNormal">Machine<br />
     name</li>
<li class="MsoNormal">System<br />
     clock (Yup.<span>&nbsp; </span>Even that has the<br />
     potential to get in your way).</li>
</ul>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>Example:</b></p>
<p class="MsoNormal">This example will show a real web user control that I’ve<br />
unit-tested.<span>&nbsp; </span>This is not<br />
theoretical.<span>&nbsp; </span>This is inside my EZWeb<br />
software.<span>&nbsp; </span>The purpose of the following<br />
screen is to maintain a few pieces of information for the page being<br />
viewed.<span>&nbsp; </span>The user can set the title of<br />
the page and some other things.</p>
<p class="MsoNormal" style="text-align: center" align="center"><img src="/photos/jeffrey.palermo/images/144194/original.aspx"></p>
<p class="MsoNormal">I’ve used the Mode-View-Presenter pattern to make unit<br />
testing this easier.<span>&nbsp; </span>Obviously if all my<br />
code is in the code-behind of the ASCX, then I won’t be able to test any of it<br />
because I can’t run that code outside of the ASP.NET runtime.<span>&nbsp; </span>If you aren’t familiar with the MVP pattern<br />
now, take some time to read up on it.<span>&nbsp;<br />
</span>The presenter is the controlling class that will be tested.<span>&nbsp; </span>The code-behind becomes very dumb.<span>&nbsp; </span>The code-behind will implement my view<br />
interface and be responsible for taking information and setting the correct<br />
control.<span>&nbsp; </span>The view is very small, and all<br />
the intelligence is in the controlling class (the Presenter).<span>&nbsp; </span>The presenter is where the bugs will hide, so<br />
I’ll unit test that class.<span>&nbsp; </span>The model is<br />
represented by an interface IPageConfig that you’ll see being referenced.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>The following example<br />
shows a unit test of the code that gets data from the model and publishes it to<br />
the view.<span>&nbsp; </span>The textboxes and drop-downs<br />
need to be set properly.<span>&nbsp; </span>This is not the<br />
full code.<span>&nbsp; </span>The full code also reacts to<br />
the save button being clicked and taking modifying information and saving it.</b></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>Here is the view interface:</b></p>
<p class="MsoNormal"><span>namespace</span><span><br />
Palermo.EZWeb.UI</span></p>
<p class="MsoNormal"><span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">interface</span> <span style="color: teal">IPagePropertiesView</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
Title { <span style="color: blue">get</span>; <span style="color: blue">set</span>;<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">bool</span> HasParent<br />
{ <span style="color: blue">get</span>; <span style="color: blue">set</span>; }</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
Template { <span style="color: blue">get</span>; <span style="color: blue">set</span>;<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
Theme { <span style="color: blue">get</span>; <span style="color: blue">set</span>;<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
Plugin { <span style="color: blue">get</span>; <span style="color: blue">set</span>;<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
Parameter { <span style="color: blue">get</span>; <span style="color: blue">set</span>;<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">bool</span><br />
IsPostback { <span style="color: blue">get</span>; }</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
GetTemplateChoices();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span><span style="color: blue">void</span> SetTemplatesDropDown(<span style="color: teal">DictionaryList</span><br />
list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
GetThemeChoices();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
SetThemesDropDown(<span style="color: teal">DictionaryList</span> list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
GetPluginChoices();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
SetPluginDropDown(<span style="color: teal">DictionaryList</span> list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
EnableTitle(<span style="color: blue">bool</span> enabled);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
EnableTemplate(<span style="color: blue">bool</span> enabled);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
EnableTheme(<span style="color: blue">bool</span> enabled);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
EnablePlugin(<span style="color: blue">bool</span> enabled);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
EnableParameter(<span style="color: blue">bool</span> enabled);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">void</span><br />
ReloadParent();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span>}</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><b>Here is the<br />
code-behind that implements the view interface (truncated):</b></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">partial</span> <span style="color: blue">class</span> <span style="color: teal">PageAdministration</span> : <span style="color: teal">UserControl</span>,<br />
<span style="color: teal">IPlugin</span>, <span style="color: teal">IPagePropertiesView</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span><br />
<span style="color: teal">PagePropertiesPresenter</span> _presenter;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span> Title</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span><br />
{ <span style="color: blue">return</span> txtTitle.Text; }</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span><br />
{ txtTitle.Text = <span style="color: blue">value</span>; }</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">bool</span> HasParent</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span><br />
{ <span style="color: blue">return</span> <span style="color: teal">Convert</span>.ToBoolean(ddlHasParent.SelectedValue);<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span><br />
{ ddlHasParent.SelectedValue = <span style="color: blue">value</span>.ToString();<br />
}</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">string</span> Template</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">get</span><br />
{ <span style="color: blue">return</span> ddlTemplate.SelectedValue; }</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">set</span><br />
{ ddlTemplate.SelectedValue = <span style="color: blue">value</span>; }</span></p>
<p class="MsoNormal" style="margin-left: 0.75in"><span>}</span></p>
<p class="MsoNormal"><span>. . .</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><b>Here is the part of<br />
the Presenter that we’ll be focusing on:</b></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: teal">PagePropertiesPresenter</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span><br />
<span style="color: blue">readonly</span> <span style="color: teal">IPagePropertiesView</span><br />
_view;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">private</span><br />
<span style="color: teal">ICurrentContext</span> _context;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span><br />
PagePropertiesPresenter(<span style="color: teal">IPagePropertiesView</span><br />
view)</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view = view;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_context = (<span style="color: teal">ICurrentContext</span>) <span style="color: teal">ObjectFactory</span>.GetInstance(<span style="color: blue">typeof</span> (<span style="color: teal">ICurrentContext</span>));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green">//testing<br />
constructor</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span><span style="color: blue">public</span> PagePropertiesPresenter(<span style="color: teal">IPagePropertiesView</span> view, <span style="color: teal">ICurrentContext</span><br />
context)</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view = view;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_context = context;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">virtual</span> <span style="color: blue">void</span><br />
LoadConfiguration()</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">if</span><br />
(!_view.IsPostback)</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">IPageConfig</span><br />
config = _context.GetPageConfig();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.Title = config.Title;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.HasParent =<br />
config.HasParent;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
templates = removeBadItems(_view.GetTemplateChoices());</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>_view.SetTemplatesDropDown(templates);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.Template =<br />
config.Template;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
themes = removeBadItems(_view.GetThemeChoices());</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>_view.SetThemesDropDown(themes);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span>_view.Theme = config.Theme;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
plugins = removeBadItems(_view.GetPluginChoices());</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span>_view.SetPluginDropDown(plugins);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.Plugin = config.Plugin;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_view.Parameter = config.Parameter;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin-left: 0.75in"><span>}</span></p>
<p class="MsoNormal">.<span>&nbsp; </span>.<span>&nbsp; </span>.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Notice that the LoadConfiguration() method checks for<br />
postback (through the view) and then uses the MODEL to set pieces of<br />
information on the VIEW.<span>&nbsp; </span>You may think<br />
that this code is boring, but it’s essential for the behavior of the screen.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>Now for the<br />
test.<span>&nbsp; </span>Note that we’re simulating the<br />
view and the ICurrentContext interface since these are collaborators.<span>&nbsp; </span>The ICurrentContext provides the MODEL to the<br />
Presenter:</b></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span>[<span style="color: teal">TestFixture</span>]</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: teal">PagePropertiesPresenterTester</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[<span style="color: teal">Test</span>]</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">public</span> <span style="color: blue">void</span> ShouldSetAllInformationOnPage()</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">MockRepository</span><br />
mocks = <span style="color: blue">new</span> <span style="color: teal">MockRepository</span>();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">IPageConfig</span><br />
mockConfig = (<span style="color: teal">IPageConfig</span>)mocks.CreateMock(<span style="color: blue">typeof</span>(<span style="color: teal">IPageConfig</span>));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">IPagePropertiesView</span><br />
view = (<span style="color: teal">IPagePropertiesView</span>)mocks.CreateMock(<span style="color: blue">typeof</span>(<span style="color: teal">IPagePropertiesView</span>));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">ICurrentContext</span><br />
context = (<span style="color: teal">ICurrentContext</span>)mocks.CreateMock(<span style="color: blue">typeof</span>(<span style="color: teal">ICurrentContext</span>));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(view.IsPostback).Return(<span style="color: blue">false</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(context.GetPageConfig()).Return(mockConfig);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
title = <span style="color: maroon">&#8220;fake title&#8221;</span>;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.Title).Return(title);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.Title = title;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">bool</span><br />
hasParent = <span style="color: blue">false</span>;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.HasParent).Return(hasParent);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.HasParent = hasParent;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
selectedItem = <span style="color: maroon">&#8220;foo&#8221;</span>;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.Template).Return(selectedItem);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">DictionaryList</span><br />
list = <span style="color: blue">new</span> <span style="color: teal">DictionaryList</span>();</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list.Add(<span style="color: maroon">&#8220;first&#8221;</span>,<br />
<span style="color: maroon">&#8220;first&#8221;</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list.Add(<span style="color: maroon">&#8220;Foo&#8221;</span>,<br />
selectedItem);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list.Add(<span style="color: maroon">&#8220;.svn&#8221;</span>,<br />
<span style="color: maroon">&#8220;.svn&#8221;</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list.Add(<span style="color: maroon">&#8220;_something&#8221;</span>,<br />
<span style="color: maroon">&#8220;_something&#8221;</span>);</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(view.GetTemplateChoices()).Return(list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.SetTemplatesDropDown(<span style="color: blue">null</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">LastCall</span>.On(view).Constraints(<span style="color: blue">new</span> <span style="color: teal">PropertyIs</span>(<span style="color: maroon">&#8220;Count&#8221;</span>, 2));<span style="color: green">//.<br />
and _ should be stripped out.</span></span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.Template = selectedItem;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.Theme).Return(selectedItem);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(view.GetThemeChoices()).Return(list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.SetThemesDropDown(<span style="color: blue">null</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">LastCall</span>.On(view).Constraints(<span style="color: blue">new</span> <span style="color: teal">PropertyIs</span>(<span style="color: maroon">&#8220;Count&#8221;</span>, 2));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>view.Theme = selectedItem;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.Plugin).Return(selectedItem);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(view.GetPluginChoices()).Return(list);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.SetPluginDropDown(<span style="color: blue">null</span>);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">LastCall</span>.On(view).Constraints(<span style="color: blue">new</span> <span style="color: teal">PropertyIs</span>(<span style="color: maroon">&#8220;Count&#8221;</span>, 2));</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.Plugin = selectedItem;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue">string</span><br />
fakeParameter = <span style="color: maroon">&#8220;faky&#8221;</span>;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal">Expect</span>.Call(mockConfig.Parameter).Return(fakeParameter);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>view.Parameter = fakeParameter;</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mocks.ReplayAll();</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: teal">PagePropertiesPresenter</span><br />
presenter = <span style="color: blue">new</span> <span style="color: teal">PagePropertiesPresenter</span>(view,<br />
context);</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>presenter.LoadConfiguration();</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mocks.VerifyAll();</span></p>
<p class="MsoNormal" style="margin-left: 0.75in"><span>}</span></p>
<p class="MsoNormal"><span>. . .</span></p>
<p class="MsoNormal"><span>&nbsp;</span></p>
<p class="MsoNormal">Your first thought might be that this unit test method is<br />
too long.<span>&nbsp; </span>It certainly pushes my comfort<br />
level as well.<span>&nbsp; </span>I could have chosen a<br />
small one for this example, but I chose my largest one instead.<span>&nbsp; </span>I’ve seen other unit testing examples that<br />
are so trivial that they don’t demonstrate much.<span>&nbsp; </span>In this sample, I chose one of the most<br />
difficult things to unit test:<span>&nbsp; </span>A UI<br />
screen.<span>&nbsp; </span>Notice that I’m using Rhino<br />
mocks to set up my fake objects.<span>&nbsp; </span>The call<br />
to “mocks.VerifyAll()” does a check to ensure that the collaborators were<br />
called with the correct input.<span>&nbsp; </span>After all,<br />
my presenter method is in charge of getting information from the MODEL and<br />
publishing them to the VIEW.<span>&nbsp; </span>If you<br />
spend some time going over this test, you can see some of the rules the code<br />
has to live by.<span>&nbsp; </span>One of the side-effects<br />
of the unit test is documentation of the code (developer documentation).<span>&nbsp; </span>At this point, I can refactor my method<br />
knowing that I have this test as a safety net.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b>How do I unit test my<br />
legacy code?</b></p>
<p class="MsoNormal">Change it.<span>&nbsp; </span>This<br />
screen started out several years ago with all the code in the code-behind<br />
class.<span>&nbsp; </span>It was impossible to test this<br />
way.<span>&nbsp; </span>I had to refactor to the MVP<br />
pattern to enable testing.<span>&nbsp; </span>I had to<br />
break some things away by inserting an interface so that I’d have a seam to<br />
break dependencies.<span>&nbsp; </span>In short, you must<br />
refactor your existing code to get it to a point where it is testable.<span>&nbsp; </span>The reason it’s not testable is that it’s<br />
tightly-coupled with its dependencies.<span>&nbsp; </span>I<br />
hope by now that the words “loosely-coupled” are recognized as “good” and “tightly-coupled”<br />
are recognized as “bad”.<span>&nbsp; </span>Testable code<br />
is loosely-coupled.<span>&nbsp; </span>Loosely-coupled code<br />
is testable.<span>&nbsp; </span>And now the big leap:<span>&nbsp; </span>Testable code == good.</p>
<div class="shr-publisher-421"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jefferypalermo/category/agile/" title="View all posts in Agile" rel="category tag">Agile</a>, <a href="http://codebetter.com/jefferypalermo/category/asp-net/" title="View all posts in ASP.NET" rel="category tag">ASP.NET</a>, <a href="http://codebetter.com/jefferypalermo/category/coding-principles/" title="View all posts in Coding Principles" rel="category tag">Coding Principles</a>. Bookmark the <a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/" title="Permalink to Unit testing demonstrated – level 300" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/feed/" title="Comments RSS to Unit testing demonstrated – level 300" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-421 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jefferypalermo/2006/05/03/automated-testing-with-net-an-overview-level-200/" rel="prev"><span class="meta-nav">&larr;</span> Automated testing with .Net &#8211; an overview &#8211; level 200</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jefferypalermo/2006/05/09/structuremap-1-0-released-dont-create-a-loosely-coupled-system-without-it-level-200/" rel="next">StructureMap 1.0 released &#8211; Don&#8217;t create a loosely coupled system without it &#8211; level 200 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">18 Responses to <em>Unit testing demonstrated – level 300</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-866">
		<div id="comment-866">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-866">May 28, 2006 at 6:59 pm</a></div>

		<div class="comment-body"><p>Bob,<br />
Thanks for the feedback.  I have a long bloggin todo list, and I&#8217;ll post a full sample when I&#8217;m satisfied that it clearly illustrates the pattern.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-865">
		<div id="comment-865">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">bobwantstdd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-865">May 22, 2006 at 8:57 pm</a></div>

		<div class="comment-body"><p>Hi Jeffrey,</p>
<p>Didn&#8217;t want you to think I wrote one long comment here and promptly forgot about you.</p>
<p>I spent about a week playing with nunitasp, along with other tasks,  and then of course got the demand &#8220;Show some results&#8221;</p>
<p>Now that they have a lousy piece of code that &#8220;shows something&#8221;, is not really too testable and stinks, I can get back to trying to figure out how to do this the right way, or at least some approximation thereof <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Q#1, &#8220;read up on MVP&#8221;<br />
I found Fowlers article at <a href="http://www.martinfowler.com/eaaDev/ModelViewPresenter.html" rel="nofollow">http://www.martinfowler.com/eaaDev/ModelViewPresenter.html</a></p>
<p>Got a recommendation of anything a bit more straightforward?  I could use a URL, if you know one, where someone actually takes hello world, maybe adds a button or two, and then changes it into a mvp version.</p>
<p>Barring that, perhaps a recommended reading list from you?  I like your style of writing more than most others, so I&#8217;m hoping your suggestions will save me some time.</p>
<p>Q#2  I understand the point of mocks ( well, i think i do ) and stubs ( pretty sure I do )</p>
<p>The thing is, the group I am working in now didn&#8217;t even implement source control, in any form whatsoever, until I got here.  The one app I work on usually gets out of synch if anyone but me works on it.  ( At least they WANT to use VSS, so there is hope&#8230;. )</p>
<p>Much less implement testing or TDD.  They are mostly a bright bunch, just severely time limited due to management requests.</p>
<p>One of the things I like about NOT mocking or stubbing in this work environment is knowing that a failure is environmental.</p>
<p>Other folks may ( unfortunately ) be in similar situations.</p>
<p>OK, the actual Q#2 , could you perhaps post the codebehind of the above sample.  *thinking* I know what it looks like and seeing could be different.  I want to *know* I know what it looks like.  Even a link to a zip or rar containing these 3 or four code files wouold give me a better picture.  I think I can safely infer the contents of the .aspx itself, but include that if it might be useful to determine the names of the controls.  doh, just noticed its a control, well, whatever source files you feel might be useful.</p>
<p>well, that&#8217;s enough for now.  I need to figure out how to convert some inherited code into something digestible, while adding functionality, to a third party DB app ( written in vb.net I think.  They don&#8217;t actually have the source or anything silly like that ) that has no documentation, apparently in three days ( or get fired / yelled at / whatever ) while adding in some automated testing to avoid self-foot-shooting.<br />
Oh, and write it all clean enough that the nightmares stop too.<br />
Read ya later&#8230;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-864">
		<div id="comment-864">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://flimflan.com/blog' rel='external nofollow' class='url'>Joshua Flanagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-864">May 10, 2006 at 2:07 am</a></div>

		<div class="comment-body"><p>What if you used DynamicMocks so that you didn&#8217;t have to setup all the expections (repeating your implementation code)? Your test would just focus on whether the code does SOMETHING when IsPostBack is true, and NOTHING when it is false.</p>
<p>In your example, you would get rid of everything after:<br />
           Expect.Call(context.GetPageConfig()).Return(mockConfig);<br />
and before:<br />
           mocks.ReplayAll();</p>
<p>Any other logic that may be relevant (like stripping out . and _ folders) could be covered by another simple test.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-863">
		<div id="comment-863">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-863">May 9, 2006 at 9:01 pm</a></div>

		<div class="comment-body"><p>I don&#8217;t unit test getters and setters because my take on it is that I&#8217;m not going to unit test generated code.  All my getters and setters are generated by Resharper.  </p>
<p>Resharper can&#8217;t generate my method here.  It does something important.  This method has to coordinate 6 pieces of information from a data source to the right places on the view. . . but only if IsPostBack is false.</p>
<p>That doesn&#8217;t sound like a method that is immune to bugs.  In my experience, the places where bugs lie are the places that I neglect to test.</p>
<p>The cyclomatic complexity of this method is 2 (not even 1 like getters and setters).  This method is sufficiently complicated that I would not think of ignoring it, and if I don&#8217;t test it with a unit test, then I have to test it in another way, like running the application manually (and that takes much more time).</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-862">
		<div id="comment-862">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://flimflan.com/blog' rel='external nofollow' class='url'>Joshua Flanagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-862">May 9, 2006 at 8:40 pm</a></div>

		<div class="comment-body"><p>After thinking about it a little more&#8230; I wonder if maybe this method doesn&#8217;t need to be unit tested? Like a simple get/set accessor &#8211; the method is not doing any logic (there is only a single conditional (IsPostBack), which is negligible from a testing perspective). If you think of it from the angle of &#8220;unit tests as documentation&#8221;, what additional documentation does this test add? To me, it doesnt add anything. It just regurgitates the code under test. Its like the old guideline about code comments: explain what the code does, not how the code does it. This sort of heavily mocked unit test does not document what the code does, it only documents how it does it.<br />
So now I&#8217;m having a crisis of faith and starting to question the value of the MVP pattern for unit testing, since the only part we are (presumably) testing is the Presenter, and it is mainly performing straigtforward &#8220;getter/setter&#8221; type glue methods with negligible logic.<br />
I&#8217;m not criticizing your approach or saying I know a better way &#8211; I&#8217;m just trying to open the conversation. Are we getting the value that we expect from this type of unit test and design? Maybe we&#8217;ll have to re-open the topic at the next lunch.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-861">
		<div id="comment-861">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-861">May 9, 2006 at 2:47 pm</a></div>

		<div class="comment-body"><p>Josh,<br />
Yes, there is a lot of setup, but this method seems to be working well.  Of course, I&#8217;m always open to better ways to do things.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-860">
		<div id="comment-860">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://flimflan.com/blog' rel='external nofollow' class='url'>Joshua Flanagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-860">May 9, 2006 at 1:46 pm</a></div>

		<div class="comment-body"><p>I was making Ayende&#8217;s point at a recent AgileATX lunch as I was writing the same kidns of tests, but feeling uncomfortable about it. Unit tests that use a lot of mocking to re-iterate each step in the class being tested do feel fragile. Your unit test is now very tightly coupled to the implementation details. You usually try to hide implementation details from your unit tests (which is why you don&#8217;t test private methods), so that you can easily refactor the implementation without breaking your tests. Otherwise every time you change your code, you need to change your test.<br />
Jeremy helped me feel a little better about it by saying that (paraphrasing) in this case, you are not testing the interface of the method (inputs &#038; outputs) &#8211; you are testing and verifying the interaction of the class with its collaborators. A valid approach, you just have to live with the fragile feeling.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-859">
		<div id="comment-859">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Liang</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-859">May 8, 2006 at 11:35 pm</a></div>

		<div class="comment-body"><p>Jeffrey,</p>
<p>Thank you so much for your reply! I am using Rhino Mock as well. Thanks Ayende! That is the best I can find so far. But I still have some confusion regarding the process of TDD. When I read the TDD articles, it seem to ask me to write method by method first. Then through continuous refactoring, we can reach a better design. So that is my question coming from. Obviously we can not expect everything from start, but as you said, we DO have a basic architecture in mind, for example, I have to decide to follow a real Domian/Repository pattern or other type of mapping patterns. Put another way, TDD itself won&#8217;t lead us to that.</p>
<p>Thanks again!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-858">
		<div id="comment-858">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-858">May 8, 2006 at 8:06 pm</a></div>

		<div class="comment-body"><p>Liang,<br />
I do apply TDD to modifying code normally, but when refactoring legacy code to be more testable, I find it&#8217;s hard to write a test first.  I tend to break the hard dependencies first and then write a unit test.  At the point that I&#8217;ve made the old code loosely-coupled, I can then write more tests first.  I value unit testing whether the test is written first or second.</p>
<p>I use Rhino mocks exclusively as my mock framework.  From time to time, I&#8217;ll use concrete mock and stub classes, though.</p>
<p>I always have an application architecture in mind when writing code.  The application just won&#8217;t fall into place.  Without a design, what can you make?  Now, certain conditions pop out midstream as well, so I find that I might have to shift directions a bit while I&#8217;m going.  You can never design and predict everything from the start.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-857">
		<div id="comment-857">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-857">May 8, 2006 at 8:02 pm</a></div>

		<div class="comment-body"><p>Vikas,<br />
I may write a post on unit testing data access controllers in the future.  I can say right now that I&#8217;ll use NHibernate, but the data access controllers will be tested in isolation first before being tested along with the database.</p>
<p>Interfaces are the key. . . and a service locator tool like StructureMap or Spring.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-856">
		<div id="comment-856">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-856">May 8, 2006 at 8:00 pm</a></div>

		<div class="comment-body"><p>Ayende,<br />
I&#8217;m still open for suggestions, but I&#8217;ve found that all my unit tests are very specific to the code.  After all, they exist to validate that unit of code.  I can reorder and extract methods all day long, but as long as I&#8217;m talking to the dependencies in the same way, this test will pass.  UI code is very different from other code.  UI code is boring (ask something for this data &#8211; push this data to UI controls).  Other parts of the system get more interesting.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-855">
		<div id="comment-855">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-855">May 8, 2006 at 7:58 pm</a></div>

		<div class="comment-body"><p>JBarbatos,<br />
Yes, I also do FIT tests.  FitNesse is a GUI for running FIT tests.  I start with unit testing to test the smallest units of code first.  I then combine integration tests in the small, and then for the full system.  FIT tests then  run the same way as full-system integration tests, but they are readable by non-technical folks.  </p>
<p>I do break my tests into another assembly.  My application assembly is EZWeb.dll, and I have EZWeb.UnitTests.dll and EZWeb.IntegrationTests.dll.  I have a Fit namespace inside integration tests for my FIT fixtures.  It&#8217;s up to you how to split them out, though.  I wouldn&#8217;t say that there is any rule on how to do it.  You don&#8217;t, however, want to deploy these tests with the application normally.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-854">
		<div id="comment-854">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Liang</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-854">May 8, 2006 at 1:17 pm</a></div>

		<div class="comment-body"><p>Hi Jeffrey,</p>
<p>It is a very nice post. I am just curious if you apply TDD, which means you use Mock or any other unit testing framework in your design process? or using as pure testing? If you follow TDD, you still have a basic application architecture in your mind when writing the code?</p>
<p>Thanks!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-853">
		<div id="comment-853">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://vikasnetdev.blogspot.com/' rel='external nofollow' class='url'>Vikas Kerni</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-853">May 7, 2006 at 9:46 pm</a></div>

		<div class="comment-body"><p>Very nice post.<br />
You forced me to read Mock Objects.<br />
After reading your post , I have to read article Introducing Rhino Mocks by Ayende.<br />
Nice Article, Ayende. Then again I read your post and it made sense to me. I am very sure that this framework will be very helpful for  writing  automated unit tests.<br />
I really liked your pragmatic remarks at Ar-agilist post discussion.<br />
I am looking forward to your Article demonstrating how you write automated test cases for entity classes which perform CRUD operations.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-852">
		<div id="comment-852">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.ayende.com/Blog/' rel='external nofollow' class='url'>Ayende Rahien</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-852">May 7, 2006 at 8:38 pm</a></div>

		<div class="comment-body"><p>The problem is that the test basically create a set of expectations for every line of code.</p>
<p>Any change to LoadConfiguration will break the test. Even something as simple as adding logging information, which I usually don&#8217;t have tests for.</p>
<p>I don&#8217;t see another way to test it, to tell you the truth, but I have problems with the test being so very tightly coupled with the code.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-851">
		<div id="comment-851">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">JBarbatos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-851">May 7, 2006 at 4:23 pm</a></div>

		<div class="comment-body"><p>I see you have also been using Fitnesse, how would something like this fit into these tests? Or does it at all? </p>
<p>Based of the above sample, you would have 2 projects, EZWeb apps and something like EZWeb.Tests right? Assuming you were to use Fitnesse as well, would you then create a thrid assembly like EZWeb.Fitnesse or just keep all tests together in EZWeb.Tests? </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-850">
		<div id="comment-850">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffreypalermo.com' rel='external nofollow' class='url'>jpalermo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-850">May 7, 2006 at 1:39 pm</a></div>

		<div class="comment-body"><p>Ayende,<br />
I&#8217;d certainly be open to other ideas about unit testing this Presenter method.  In this craft, I learned quickly that there can be several correct ways to do things.</p>
<p>I&#8217;ll be honest and say that I don&#8217;t understand how the test is fragile.  The code needs to get information from model and set it to controls on the veiw.  There isn&#8217;t any domain logic in this code, just coordinating logic.  There are 6 controls, so there are six pieces of information that need to be set.  The code can be reordered and refactored at will, and this tests will still pass, so I&#8217;m not sure I understand what you are telling me.  </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-849">
		<div id="comment-849">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.ayende.com/Blog/' rel='external nofollow' class='url'>Ayende Rahien</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/jefferypalermo/2006/05/06/unit-testing-demonstrated-%e2%80%93-level-300/#comment-849">May 7, 2006 at 8:50 am</a></div>

		<div class="comment-body"><p>The problem with this style of test is that it looks fragile to me.<br />
You are basically repeating the code you are testing in the test using mocks. Nearly any change that you&#8217;ll make there will break the test.</p>
<p>How do you handle this?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/jefferypalermo/2006/05/06/unit-testing-demonstrated-%E2%80%93-level-300/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/jefferypalermo/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fjefferypalermo%2F2006%2F05%2F06%2Funit-testing-demonstrated-%25e2%2580%2593-level-300%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 4.912 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 18:27:27 -->
<!-- super cache -->