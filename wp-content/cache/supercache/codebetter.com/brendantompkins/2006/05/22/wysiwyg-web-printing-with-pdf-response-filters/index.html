<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>WYSIWYG Web Printing with PDF &amp; Response Filters | Brendan Tompkins</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/brendantompkins/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/brendantompkins/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/brendantompkins/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/brendantompkins/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Brendan Tompkins' href='http://codebetter.com/brendantompkins/' />
<link rel='start' title='Tap. Tap.  Is this thing on?' href='http://codebetter.com/brendantompkins/2003/10/08/tap-tap-is-this-thing-on/' />
<link rel='prev' title='An ObjectDataSource/GridView Adapter for Business Entity Collections' href='http://codebetter.com/brendantompkins/2006/05/11/an-objectdatasourcegridview-adapter-for-business-entity-collections/' />
<link rel='next' title='Help Spread the Word &#8211; Devlicio.us' href='http://codebetter.com/brendantompkins/2006/06/21/help-spread-the-word-devlicio-us/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/brendantompkins/2006/05/22/wysiwyg-web-printing-with-pdf-response-filters/' />
<link rel='shortlink' href='http://codebetter.com/brendantompkins/?p=378' />
<link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/brendantompkins/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-378" class="post-378 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">WYSIWYG Web Printing with PDF &amp; Response Filters</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">Brendan Tompkins</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/brendantompkins/2006/05/22/wysiwyg-web-printing-with-pdf-response-filters/" title="8:16 pm" rel="bookmark"><span class="entry-date">May 22, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/brendantompkins/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/brendantompkins/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/brendantompkins/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>By far the #1 complaint I&nbsp;hear from users of various web applications is that printing a page is not WYSIWYG.&nbsp; It’s really a simple problem that the industry has sort of swept under the rug for most of the&nbsp;history of the Internet.&nbsp; Browser printing in the current versions of&nbsp;IE and Firefox is simply horrible, and while server technologies like ASP.NET and PHP&nbsp;have gotten&nbsp;better and better at screen presentation with every release, printing simply not kept up pace.&nbsp;&nbsp;As&nbsp;web developers we spend our time figuring out all the intricacies of browser&nbsp;page rendering, and&nbsp;often are asked to do the same thing&nbsp;for printing.&nbsp;&nbsp;It’s frankly a frustrating, difficult problem to solve. &nbsp;<a href="http://www.winsupersite.com/reviews/ie7_beta1.asp">IE7 should finally fix many of these problems when it’s released</a><a href="">, but what are we supposed to do&nbsp;until then?&nbsp; And even when it’s released,&nbsp;how many years will we be&nbsp;designing to support the current crop of&nbsp;web browsers</a>?</p>
<p><strong>Adobe PDF Printing Rocks</strong></p>
<p>Adobe’s PDF format <em>does</em> have it’s issues, but it also has&nbsp;<strong>huge</strong> advantages that make it a great solution for creating printable website documents. 1) Nearly all your users already have the free reader software and 2) Printing is nearly&nbsp;100% WYSIWYG.&nbsp; So what’s the solution to your website printing problems at least until you can guarantee that the majority of your users will be using a print-friendly browser?&nbsp; Simple, when a user makes a print request on your site, <strong>dynamically&nbsp;create PDF documents on the fly making sure to include all of your users page state,&nbsp;and output that&nbsp;PDF&nbsp;document to the&nbsp;browser</strong>.&nbsp; Simple right? Well, it’s actually easier said than done.&nbsp; You have two big issues when attempting to solve this problem: Finding a decent PDF writing component to deploy on your webservers, and being able to accurately render a html page to this component while at the same time preserving your user’s page state.</p>
<p><strong>Finding a Decent PDF Component</strong></p>
<p>In order to create a PDF document on the fly, I wanted a PDF component that would take a URL and create a document from the resulting page.&nbsp; There are plenty of resources out there for you to use that will help you find the right PDF component, so I won’t list them here.&nbsp; I settled on <a href="http://www.websupergoo.com/">webSuperGoo</a>’s ABCPdf component.&nbsp; I liked&nbsp;it’s simplicity – you can grab any page and turn it into a PDF, including JavaScript rendered elements using the following code:</p>
<div style="border: 1pt solid windowtext;padding: 0pt;background: white none repeat scroll 0%;font-size: 8pt;color: black;font-family: Courier New"><span style="color: teal">Doc</span> theDoc = <span style="color: blue">new</span> <span style="color: teal">Doc</span>(); </p>
<p style="margin: 0px">theDoc.HtmlOptions.PageCacheEnabled = <span style="color: blue">false</span>;</p>
<p style="margin: 0px">theDoc.HtmlOptions.PageCacheClear();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">theDoc.Page = theDoc.AddPage();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="color: blue">int</span> theID;</p>
<p style="margin: 0px">theDoc.HtmlOptions.UseScript = <span style="color: blue">true</span>;</p>
<p style="margin: 0px">theID = theDoc.AddImageUrl(<span style="color: maroon">&#8220;http://codebetter.com</span><span style="color: maroon">&#8220;</span>);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="color: blue">while</span> (<span style="color: blue">true</span>)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; theDoc.FrameRect(); <span style="color: green">// add a black border</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (!theDoc.Chainable(theID))</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">break</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; theDoc.Page = theDoc.AddPage();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; theID = theDoc.AddImageToChain(theID);</p>
<p style="margin: 0px">}</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="color: blue">for</span> (<span style="color: blue">int</span> i = 1; i &lt;= theDoc.PageCount; i++)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; theDoc.PageNumber = i;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; theDoc.Flatten();</p>
<p style="margin: 0px">}</p>
</div>
<p>You can&nbsp;then take the resulting document and&nbsp;stream it back to the&nbsp;browser.&nbsp; Here’s&nbsp;what the PDF&nbsp;output&nbsp;looks like rendered via the Acrobat reader in IE</p>
<p>&nbsp;<img alt="" src="/photos/brendan.tompkins/images/145263/original.aspx" border="0"></p>
<p><strong>Preserving Page State</strong></p>
<p>A problem you’ll find with this method of generating PDF documents is that while it works well for static HTML pages and other content, it quickly breaks down for anything but the simplest web applications.&nbsp; The reason?&nbsp; This PDF component won’t carry the user’s state information such as login status, session and viewstate cache, through the request, therefore, the&nbsp;resulting PDF output may not show things like secure content, grid sorting, or other page content that is dependent on Page State.&nbsp; You’ll often bump up against this limitation when you’re trying to&nbsp;stream the content of a web response to some other output location, such as a file, database, cache, email or something else entirely.&nbsp; The solution to this problem is to create a custom&nbsp;ASP.NET Response.Filter.&nbsp; This will allow you to&nbsp;intercept the response that would normally be sent to the user’s browser, and do all kinds of neat things with it, like turn it into a PDF document.&nbsp; <a href="http://aspnetresources.com/articles/HttpFilters.aspx">Here’s a great article</a>&nbsp;from a <a href="http://aspnetresources.com/">great site</a> that talks all about these Response.Filter thingeys.</p>
<p><strong>Putting it all Together</strong></p>
<p>In order to get this all to work properly, you’ve got to wire it all up.&nbsp; I’ve found that the following method works best:</p>
<p>First, create a linkbutton on your master page to allow the user to create a&nbsp;“Printable PDF View” Handle the button click event, and hand off the response to your custom PDF response filter.&nbsp; Here’s the code Snippet which switches the filter:</p>
<div style="border: 1pt solid windowtext;padding: 0pt;background: white none repeat scroll 0%;font-size: 8pt;color: black;font-family: Courier New">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">protected</span> <span style="color: blue">void</span> LinkButton1_Click(<span style="color: blue">object</span> sender, <span style="color: teal">EventArgs</span> e)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// HOW THIS WORKS:</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">//&nbsp;&nbsp;&nbsp; Add a new response filter.&nbsp; This saves the page output in the database, and redirects to </span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">//&nbsp;&nbsp;&nbsp; Pdf/PageToPdf.ashx.&nbsp; This page creates a PDF object and adds the saved output page via</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">//&nbsp;&nbsp;&nbsp; Pdf/PreRenderedPdfPage.ashx.&nbsp; This allows the current page state and view to be requestsed</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">//&nbsp;&nbsp;&nbsp; via the PDF object, which normally wouldn&#8217;t be able to share session, etc.</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Response.Filter = <span style="color: blue">new</span> <span style="color: teal">PdfResponseFilter</span>(Response.Filter); </p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>In your custom filter, write the output stream temporarially to the cache (or wherever you&nbsp;want to&nbsp;temporarially store it).&nbsp; It has to be&nbsp;stored&nbsp;somewhere&nbsp;that any&nbsp;web request can access it.&nbsp; Good candidates are the file system,&nbsp;cache, or the database.&nbsp; NOTE: This is what is called “Security by Obscurity” and is generally considered not secure enough for any highly sensitive data, such as credit card information.&nbsp; The issue is that while it may be extremely difficult to guess the GUID and you’d have to make the page request during the milliseconds or so that passes while this rendered&nbsp;HTML&nbsp;waits to be picked up, it is possible that it could be intercepted.&nbsp; So, don’t do this if you work for a bank or the government <img src="/blogs/brendan.tompkins/default.aspx/smile3.gif">. I don’t and find it secure enough for most applications I work with.</p>
<div style="border: 1pt solid windowtext;padding: 0pt;background: white none repeat scroll 0%;font-size: 8pt;color: black;font-family: Courier New">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">void</span> Write(<span style="color: blue">byte</span>[] buffer, <span style="color: blue">int</span> offset, <span style="color: blue">int</span> count)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">string</span> strBuffer = <span style="color: teal">UTF8Encoding</span>.UTF8.GetString(buffer, offset, count);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// Wait for the closing &lt;/html&gt; tag</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Regex</span> eof = <span style="color: blue">new</span> <span style="color: teal">Regex</span>(<span style="color: maroon">&#8220;&lt;/html&gt;&#8221;</span>, <span style="color: teal">RegexOptions</span>.IgnoreCase);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (!eof.IsMatch(strBuffer))</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; responseHtml.Append(strBuffer);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">else</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; responseHtml.Append(strBuffer);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">string</span> finalHtml = responseHtml.ToString();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Guid</span> g = <span style="color: teal">Guid</span>.NewGuid();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">HttpContext</span>.Current.Cache[g.ToString()] = finalHtml;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">HttpContext</span>.Current.Response.Redirect(<span style="color: maroon">&#8220;PageToPdf.ashx?DocId=&#8221;</span> + g.ToString(), <span style="color: blue">false</span>);&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>The PDF component has be issued&nbsp;a one-time ticket (GUID)&nbsp;to pickup the resulting HTML (which may contain secure information) and the Http response is re-directed to an ASHX handler that will create the PDF document.&nbsp; This handler creates a SuperGoo pdf document, and requests the stored html, passing in the ticket (GUID).&nbsp;</p>
<div style="border: 1pt solid windowtext;padding: 0pt;background: white none repeat scroll 0%;font-size: 8pt;color: black;font-family: Courier New">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">void</span> ProcessRequest(<span style="color: teal">HttpContext</span> context)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Doc</span> theDoc = <span style="color: blue">new</span> <span style="color: teal">Doc</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.HtmlOptions.PageCacheEnabled = <span style="color: blue">false</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.HtmlOptions.PageCacheClear();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.Page = theDoc.AddPage();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">int</span> theID;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.HtmlOptions.UseScript = <span style="color: blue">true</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theID = theDoc.AddImageUrl(<span style="color: maroon">&#8220;http://localhost/&#8221;</span> + context.Request.ApplicationPath + <span style="color: maroon">&#8220;/PreRenderedPdfPage.ashx?DocId=&#8221;</span> + context.Request[<span style="color: maroon">"DocId"</span>]);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">while</span> (<span style="color: blue">true</span>)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.FrameRect(); <span style="color: green">// add a black border</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (!theDoc.Chainable(theID))</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">break</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.Page = theDoc.AddPage();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theID = theDoc.AddImageToChain(theID);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">for</span> (<span style="color: blue">int</span> i = 1; i &lt;= theDoc.PageCount; i++)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.PageNumber = i;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.Flatten();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.ClearHeaders();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Expires = 0;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetCacheability(<span style="color: teal">HttpCacheability</span>.NoCache);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetNoServerCaching();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetNoStore();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetMaxAge(<span style="color: teal">TimeSpan</span>.Zero);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.AddHeader(<span style="color: maroon">&#8220;content-disposition&#8221;</span>, <span style="color: maroon">&#8220;attachement; filename=Doc&#8221;</span> + context.Request[<span style="color: maroon">"DocId"</span>] + <span style="color: maroon">&#8220;.pdf&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.ContentType = <span style="color: maroon">&#8220;application/pdf&#8221;</span>;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.Save(context.Response.OutputStream);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; theDoc.Clear();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.End();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>A final ASHX handler writes out the stored HTML and removes it from cache.</p>
<div style="border: 1pt solid windowtext;padding: 0pt;background: white none repeat scroll 0%;font-size: 8pt;color: black;font-family: Courier New">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> ProcessRequest (<span style="color: teal">HttpContext</span> context) </p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Expires = 0;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetCacheability(<span style="color: teal">HttpCacheability</span>.NoCache);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetNoServerCaching();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetNoStore();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Cache.SetMaxAge(<span style="color: teal">TimeSpan</span>.Zero);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (context.Request[<span style="color: maroon">"DocId"</span>] != <span style="color: blue">null</span> &amp;&amp; context.Cache[context.Request[<span style="color: maroon">"DocId"</span>]] != <span style="color: blue">null</span>)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">String</span> preRenderedHtml = context.Cache[context.Request[<span style="color: maroon">"DocId"</span>]].ToString();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// Write out this document.&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.Write(preRenderedHtml);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// Delete this so no one can pick up this page by guessing an ID later on.</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Cache.Remove(context.Request[<span style="color: maroon">"DocId"</span>]);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">else</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; </p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; context.Response.Write(<span style="color: maroon">&#8220;&lt;HTML&gt;&lt;BODY&gt;&lt;H1&gt;THIS PAGE HAS EXPIRED.&lt;/H1&gt;&lt;/BODY&gt;&lt;/HTML&gt;&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.Response.End();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>This all allows the exact HTML that would normally be sent back to the browser, to be routed through the PDF component and sent back to the user in&nbsp;PDF resulting in a true WYSIWYG printable page.</p>
<p>I’ve thrown together <a HREF="/files/44/downloads/entry145264.aspx">a quick sample app that you can download here</a>&nbsp;that demonstrates this entire process.&nbsp; You’ll have to visit <a href="http://www.websupergoo.com/">webSuperGoo</a>&nbsp;and <a href="http://www.websupergoo.com/downloadftp.htm">download the trial PDF component</a>&nbsp;to get this to work.&nbsp;&nbsp; It shows you the following page, allows you to set some session and view state information, then allows you to generate a WYSIWYG PDF document.</p>
<p><img alt="" src="/photos/brendan.tompkins/images/145266/original.aspx" border="0"></p>
<p>Clicking the Printable PDF View link will generate a pdf, with the calendar and other page state and login information saved.</p>
<p><img alt="" src="/photos/brendan.tompkins/images/145262/original.aspx" border="0"></p>
<p>Good luck, and I hope this can help solve your web printing headaches, it certainly did for me!</p>
<p>[tags: ASP.NET, PDF, WYSIWYG Printing]</p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Brendan Tompkins</h2>
							By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.							<div id="author-link">
								<a href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">View all posts by Brendan Tompkins &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/brendantompkins/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/brendantompkins/2006/05/22/wysiwyg-web-printing-with-pdf-response-filters/" title="Permalink to WYSIWYG Web Printing with PDF &amp; Response Filters" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/brendantompkins/2006/05/22/wysiwyg-web-printing-with-pdf-response-filters/feed/" title="Comments RSS to WYSIWYG Web Printing with PDF &amp; Response Filters" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-378 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/brendantompkins/2006/05/11/an-objectdatasourcegridview-adapter-for-business-entity-collections/" rel="prev"><span class="meta-nav">&larr;</span> An ObjectDataSource/GridView Adapter for Business Entity Collections</a></div>
					<div class="nav-next"><a href="http://codebetter.com/brendantompkins/2006/06/21/help-spread-the-word-devlicio-us/" rel="next">Help Spread the Word &#8211; Devlicio.us <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-2738">
					<div id="dsq-comment-header-2738" class="dsq-comment-header">
						<cite id="dsq-cite-2738">
								<span id="dsq-author-user-2738">Dave</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2738" class="dsq-comment-body">
						<div id="dsq-comment-message-2738" class="dsq-comment-message"><p>It looks like you are simply embedding a &#8220;screenshot&#8221; of the page into a pdf. Can you actually select the text in the PDF you generated or is it just one image? Seems to me like you could do the same think without any 3rd party components.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2739">
					<div id="dsq-comment-header-2739" class="dsq-comment-header">
						<cite id="dsq-cite-2739">
								<span id="dsq-author-user-2739">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2739" class="dsq-comment-body">
						<div id="dsq-comment-message-2739" class="dsq-comment-message"><p>&#8220;Can you actually select the text in the PDF you generated or is it just one image&#8221;</p>
<p>Dave, this component creates a true PDF with selectable text and everything, this is why it&#8217;s so cool!  You can scale in and print a perfect copy.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2740">
					<div id="dsq-comment-header-2740" class="dsq-comment-header">
						<cite id="dsq-cite-2740">
								<span id="dsq-author-user-2740">Dave</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2740" class="dsq-comment-body">
						<div id="dsq-comment-message-2740" class="dsq-comment-message"><p>Thanks for clearing that up for me. When I&#8217;ve looked into these types of controls before, they all used IE as the underlying renderer to get the webpage, is this one different?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2741">
					<div id="dsq-comment-header-2741" class="dsq-comment-header">
						<cite id="dsq-cite-2741">
								<span id="dsq-author-user-2741">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2741" class="dsq-comment-body">
						<div id="dsq-comment-message-2741" class="dsq-comment-message"><p>The underlying mechanism looks to be a com automation of IE, so yes, it&#8217;s rendering the webpage from IE.. This is a good thing tho, because you don&#8217;t have to design for yet another browser. </p>
<p>I don&#8217;t know how it scrapes the rendered page though..  Maybe via the printer output?  It does do a true pdf document&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2742">
					<div id="dsq-comment-header-2742" class="dsq-comment-header">
						<cite id="dsq-cite-2742">
	http://www.m2designgroup.com							<span id="dsq-author-user-2742">dmitchell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2742" class="dsq-comment-body">
						<div id="dsq-comment-message-2742" class="dsq-comment-message"><p>Great artice except when I run the app I get &#8220;This Page Has Expired.&#8221; for my pdf. Any idea what i am doing wrong? I would greatly appreciate some help. i have been working on this for days.<br />
Thanks<br />
Dave Mitchell<br />
<a href="mailto:dmitchell@mhcc.state.md.us">dmitchell@mhcc.state.md.us</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2743">
					<div id="dsq-comment-header-2743" class="dsq-comment-header">
						<cite id="dsq-cite-2743">
								<span id="dsq-author-user-2743">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2743" class="dsq-comment-body">
						<div id="dsq-comment-message-2743" class="dsq-comment-message"><p>Yes, </p>
<p>I ran into this too. For some reason, under some browsers the page is being requested twice. To fix this, in the ProcessRequest (HttpContext context) method, comment out the line that clears the cache.  You&#8217;ll have to clear out the cache some other way, perhaps using a timed expiration.</p>
<p>//            context.Cache.Remove(context.Request["DocId"]);</p>
<p>Good luck!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2744">
					<div id="dsq-comment-header-2744" class="dsq-comment-header">
						<cite id="dsq-cite-2744">
								<span id="dsq-author-user-2744">dmitchell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2744" class="dsq-comment-body">
						<div id="dsq-comment-message-2744" class="dsq-comment-message"><p>I am so close. The fix above to PreRenderedPage.ashx didn&#8217;t help. I still get This Page Has Expired. I am using IE  6.0.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2745">
					<div id="dsq-comment-header-2745" class="dsq-comment-header">
						<cite id="dsq-cite-2745">
								<span id="dsq-author-user-2745">btompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2745" class="dsq-comment-body">
						<div id="dsq-comment-message-2745" class="dsq-comment-message"><p>Try changing the ProcessRequest method to the following:</p>
<p>   public void ProcessRequest (HttpContext context)</p>
<p>    {</p>
<p>        context.Response.Expires = 0;</p>
<p>          context.Response.Cache.SetCacheability(HttpCacheability.NoCache);</p>
<p>        context.Response.Cache.SetNoServerCaching();<br />
        context.Response.Cache.SetNoStore();<br />
        context.Response.Cache.SetMaxAge(TimeSpan.Zero);</p>
<p>        String preRenderedHtml = context.Cache[context.Request["DocId"]].ToString();</p>
<p>        // Write out this document.<br />
        context.Response.Write(preRenderedHtml);<br />
        context.Response.End();</p>
<p>    }</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2746">
					<div id="dsq-comment-header-2746" class="dsq-comment-header">
						<cite id="dsq-cite-2746">
								<span id="dsq-author-user-2746">dmitchell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2746" class="dsq-comment-body">
						<div id="dsq-comment-message-2746" class="dsq-comment-message"><p>Damn! Almost. I got the following error related to Line 21<br />
String preRenderedHtml = context.Cache[context.Request["DocId"]].ToString();</p>
<p>&#8220;Object reference not set to an instance of an object&#8221;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2747">
					<div id="dsq-comment-header-2747" class="dsq-comment-header">
						<cite id="dsq-cite-2747">
								<span id="dsq-author-user-2747">dMitchell</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2747" class="dsq-comment-body">
						<div id="dsq-comment-message-2747" class="dsq-comment-message"><p>I was hoping I could get a working example. Still having trouble with Line 21.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2748">
					<div id="dsq-comment-header-2748" class="dsq-comment-header">
						<cite id="dsq-cite-2748">
								<span id="dsq-author-user-2748">David Bilbow</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2748" class="dsq-comment-body">
						<div id="dsq-comment-message-2748" class="dsq-comment-message"><p>HI,</p>
<p>We are using a similar technique. One of the issues is long pages. The pdf put page breaks at the end of the page (makes sense). What we would like to do is control where the page breaks are inserted. We have trying to set a style  to force page breaks which works when you print.</p>
<div title="Print Page Break" style="FONT-SIZE: 1px; PAGE-BREAK-BEFORE: always; VERTICAL-ALIGN: middle; HEIGHT: 1px; BACKGROUND-COLOR: #c0c0c0">&nbsp;</div>
<p>This seems to be ignored which doesnt surprise me as not all HTML/CSS is supported.</p>
<p>Have you had a requirement for this or do you know of any solutions?</p>
<p>Thanks<br />
David</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2749">
					<div id="dsq-comment-header-2749" class="dsq-comment-header">
						<cite id="dsq-cite-2749">
								<span id="dsq-author-user-2749">mon</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2749" class="dsq-comment-body">
						<div id="dsq-comment-message-2749" class="dsq-comment-message"><p>in the splitting of the document into multiple pages, how can i put footer and header margins in each break so it wouldn&#8217;t look like its a continuous document.  this is for aesthetics purpose.  thanks</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2750">
					<div id="dsq-comment-header-2750" class="dsq-comment-header">
						<cite id="dsq-cite-2750">
	http://www.winnovative-software.com							<span id="dsq-author-user-2750">razva</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2750" class="dsq-comment-body">
						<div id="dsq-comment-message-2750" class="dsq-comment-message"><p>you can simply get the html code from a .aspx page with the Server.Execute() method and then convert it with the html to pdf converter from <a href="http://www.winnovative-software.com" rel="nofollow">http://www.winnovative-software.com</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2751">
					<div id="dsq-comment-header-2751" class="dsq-comment-header">
						<cite id="dsq-cite-2751">
								<span id="dsq-author-user-2751">scokim</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2751" class="dsq-comment-body">
						<div id="dsq-comment-message-2751" class="dsq-comment-message"><p>does anyone have the sample app written by brendan please ?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2752">
					<div id="dsq-comment-header-2752" class="dsq-comment-header">
						<cite id="dsq-cite-2752">
								<span id="dsq-author-user-2752">g</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2752" class="dsq-comment-body">
						<div id="dsq-comment-message-2752" class="dsq-comment-message"><p>g</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/brendantompkins/2006/05/22/wysiwyg-web-printing-with-pdf-response-filters/ ';
	var disqus_identifier = '378 /blogs/brendan.tompkins/archive/2006/05/22/145267.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'brendantompkins';
	var disqus_title = "WYSIWYG Web Printing with PDF &amp; Response Filters";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=378');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/brendantompkins/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/brendantompkins\/2006\/05\/22\/wysiwyg-web-printing-with-pdf-response-filters\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">About Me</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: left;"><img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=96&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.413 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-26 18:55:44 -->
<!-- super cache -->