<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Map a Network Drive From Code for Cross-Domain File Copy | Brendan Tompkins</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/brendantompkins/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/brendantompkins/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Fun with C# and HP Printers&#8230;' href='http://codebetter.com/brendantompkins/2004/07/23/fun-with-c-and-hp-printers/' />
<link rel='next' title='Easily Raise Events From ASP.NET ASCX User Controls' href='http://codebetter.com/brendantompkins/2004/10/06/easily-raise-events-from-asp-net-ascx-user-controls/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/brendantompkins/?p=180' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,165] -->
<link rel="canonical" href="http://codebetter.com/brendantompkins/2004/09/24/map-a-network-drive-from-code-for-cross-domain-file-copy/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-180" class="post-180 post type-post status-publish format-standard hentry category-asp-net-tutorials category-most-popular">
					<h1 class="entry-title">Map a Network Drive From Code for Cross-Domain File Copy</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">Brendan Tompkins</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/brendantompkins/2004/09/24/map-a-network-drive-from-code-for-cross-domain-file-copy/" title="12:57 pm" rel="bookmark"><span class="entry-date">September 24, 2004</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/brendantompkins/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/brendantompkins/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>The other day, I had to copy a file from a Windows Service running on our Web server <STRONG>which is outside of our firewall, and not a trusted member of our domain</STRONG>, to a folder on a share <STRONG>inside of the firewall</STRONG>.&nbsp; Should be easy, right?&nbsp; Well, it turns out it that it&#8217;s a bit more complicated than I first thought.</P><br />
<P>In this case I had a username/password in the domain that I could use to access the share from the server.&nbsp; I could&nbsp;successfully map the drive when logged into the console, but&nbsp;my service couldn&#8217;t see this mapped drive.&nbsp; My service couldn&#8217;t impersonate&nbsp;this trusted&nbsp;domain user either (using LoginUser), since the server itself wasn&#8217;t a trusted member of the domain.</P><br />
<P>There&#8217;s no IO managed framework classes for connecting to a network share as a user, and there&#8217;s no way to connect to a network share, passing a domain\username and password, AFAIK.</P><br />
<P>I found out through a lot of searching that I needed to make a call to the WNetAddConnection APIs (mpr.dll) that would allow me to map a drive as a&nbsp;domain user&nbsp;in code.&nbsp;&nbsp;I also have to run&nbsp;my service under the NETWORK_SERVICE account,&nbsp;so that it has access to&nbsp;network resources.</P><br />
<P>Luckily, I found&nbsp;an article on Code Project <A href="http://www.codeproject.com/csharp/mapnetdrive.asp">Map Network Drive (API)</A>&nbsp;that does exactly this. So, my final solution (simplified), using the NetworkDrive class from the article looks like this:</P><br />
<P><FONT color="#008000" size="2"><FONT color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </FONT>// Create a network mapped drive<BR></FONT><FONT size="2">&nbsp;&nbsp;&nbsp;&nbsp; NetworkDrive drive = </FONT><FONT color="#0000ff" size="2">new</FONT><FONT size="2"> NetworkDrive();<BR></FONT><FONT size="2"><BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">drive.ShareName = @&#8221;\\SOME_SERVER\SOME_SHARE&#8221;;<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">drive.LocalDrive = &#8220;I&#8221;;<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">drive.Force = <FONT color="#0000ff">true</FONT>;<BR></FONT><FONT size="2">&nbsp;&nbsp;&nbsp;&nbsp; drive.MapDrive(@&#8221;DOMAIN\USERNAME&#8221;, &#8220;password&#8221;);</FONT></P><br />
<P><FONT size="2"></FONT></P><br />
<P><FONT size="2">&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">TextWriter textWriter = File.CreateText(@&#8221;I:\file.txt&#8221;);<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">textWriter.Write(&#8220;Some Text&#8221;);<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size="2">textWriter.Close();<BR></FONT><FONT size="2">&nbsp;&nbsp;&nbsp;&nbsp; drive.UnMapDrive();</FONT></P><br />
<P>This works really well.&nbsp; The only problem may come up is that if the drive is mapped by some other application, forcing this mapping may cause problems. You could have some code that loops through drive letters until it finds one suitable.</P><br />
<P>-Brendan</P></p>
<div class="shr-publisher-180"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Brendan Tompkins</h2>
							By day, I'm a software engineer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.							<div id="author-link">
								<a href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">View all posts by Brendan Tompkins &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/brendantompkins/category/asp-net-tutorials/" title="View all posts in ASP.NET Tutorials" rel="category tag">ASP.NET Tutorials</a>, <a href="http://codebetter.com/brendantompkins/category/most-popular/" title="View all posts in Most Popular" rel="category tag">Most Popular</a>. Bookmark the <a href="http://codebetter.com/brendantompkins/2004/09/24/map-a-network-drive-from-code-for-cross-domain-file-copy/" title="Permalink to Map a Network Drive From Code for Cross-Domain File Copy" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/brendantompkins/2004/09/24/map-a-network-drive-from-code-for-cross-domain-file-copy/feed/" title="Comments RSS to Map a Network Drive From Code for Cross-Domain File Copy" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-180 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/brendantompkins/2004/07/23/fun-with-c-and-hp-printers/" rel="prev"><span class="meta-nav">&larr;</span> Fun with C# and HP Printers&#8230;</a></div>
					<div class="nav-next"><a href="http://codebetter.com/brendantompkins/2004/10/06/easily-raise-events-from-asp-net-ascx-user-controls/" rel="next">Easily Raise Events From ASP.NET ASCX User Controls <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-1557">
                    <div id="dsq-comment-header-1557" class="dsq-comment-header">
                        <cite id="dsq-cite-1557">
                                <span id="dsq-author-user-1557">ben</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1557" class="dsq-comment-body">
                        <div id="dsq-comment-message-1557" class="dsq-comment-message"><p>Hi Brendan, I&#8217;m trying to do the same thing, but I keep getting a &quot;The network name cannot be found&quot;, did you run into this issue at all?  The server is running windows 2003 and I&#8217;m trying to connect from a windows 2000 box.  thanks for your help!</p>
<p>ben</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1558">
                    <div id="dsq-comment-header-1558" class="dsq-comment-header">
                        <cite id="dsq-cite-1558">
                                <span id="dsq-author-user-1558">Brendan Tompkins</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1558" class="dsq-comment-body">
                        <div id="dsq-comment-message-1558" class="dsq-comment-message"><p>Hmm.  I didn&#8217;t try to connect to W2K, but you can see (ping) the server from the 2003 box by name, right?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1559">
                    <div id="dsq-comment-header-1559" class="dsq-comment-header">
                        <cite id="dsq-cite-1559">
                                <span id="dsq-author-user-1559">ben</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1559" class="dsq-comment-body">
                        <div id="dsq-comment-message-1559" class="dsq-comment-message"><p>I&#8217;m trying to map a share that is on a 2k3 server to a w2k server that is running my asp.net app, and I can ping the 2k3 server, and I can browse to the share in windows explorer as well. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1560">
                    <div id="dsq-comment-header-1560" class="dsq-comment-header">
                        <cite id="dsq-cite-1560">
                                <span id="dsq-author-user-1560">Adam</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1560" class="dsq-comment-body">
                        <div id="dsq-comment-message-1560" class="dsq-comment-message"><p>Two questions: </p>
<p>1) &quot;I also have to run my service under the NETWORK_SERVICE account&quot; &#8212; How do you specify that? </p>
<p>2) What is the &quot;at&quot; symbol (page errors when I type it in) in your code for?</p>
<p>thanks,<br />
<br />Adam</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1561">
                    <div id="dsq-comment-header-1561" class="dsq-comment-header">
                        <cite id="dsq-cite-1561">
                                <span id="dsq-author-user-1561">Brendan Tompkins</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1561" class="dsq-comment-body">
                        <div id="dsq-comment-message-1561" class="dsq-comment-message"><p>@, in C# allows you to, among other things, turn off character escaping in strings.  YOu can do the same thing by escaping the backslashes. &quot;\\\\SOMESERVER\\&quot; instead of @&quot;\\SOMESERVER\&quot;</p>
<p>You can set the run as account in the Services snap in, or in your service installer class within VS.NET when you build your component.</p>
<p>Hope this helps.<br /></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1562">
                    <div id="dsq-comment-header-1562" class="dsq-comment-header">
                        <cite id="dsq-cite-1562">
                                <span id="dsq-author-user-1562">Ron Kegge</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1562" class="dsq-comment-body">
                        <div id="dsq-comment-message-1562" class="dsq-comment-message"><p>Brendan,</p>
<p>If you use the WNetUseConnection function, it will automagically pick an open drive letter to map.  So, if another app has already mapped the drive to a particular drive letter, you could use this function.  It returns the drive letter that was used (byref) so that you can subsequently write to the mapped drive.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1563">
                    <div id="dsq-comment-header-1563" class="dsq-comment-header">
                        <cite id="dsq-cite-1563">
    http://golger.freeownhost.com                            <span id="dsq-author-user-1563">Amir</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1563" class="dsq-comment-body">
                        <div id="dsq-comment-message-1563" class="dsq-comment-message"><p>Can you send the source code of the classed you used?, it is not available on Code Project. please sent it to amirsabdou[at]y-a-h-o-o(dot)c/o/m<br />
Thanks</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1564">
                    <div id="dsq-comment-header-1564" class="dsq-comment-header">
                        <cite id="dsq-cite-1564">
                                <span id="dsq-author-user-1564">kau</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1564" class="dsq-comment-body">
                        <div id="dsq-comment-message-1564" class="dsq-comment-message"><p>I am trying to do the same, Can you email me the code to this? My email address is <a href="mailto:kausmail@gmail.com">kausmail@gmail.com</a>. Thanks in advance&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1565">
                    <div id="dsq-comment-header-1565" class="dsq-comment-header">
                        <cite id="dsq-cite-1565">
                                <span id="dsq-author-user-1565">Himadrish</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1565" class="dsq-comment-body">
                        <div id="dsq-comment-message-1565" class="dsq-comment-message"><p>Is not there any simple way to do this? Using username, password&#8230;lots of thing&#8230;Just simple one way File.Copy() things&#8230;</p>
<p>Say already there are some files in other machine, and that directory / server already map in my pc. No I would like to  copy those one in my local drive&#8230;.I think there must be some simple way to do this&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1566">
                    <div id="dsq-comment-header-1566" class="dsq-comment-header">
                        <cite id="dsq-cite-1566">
                                <span id="dsq-author-user-1566">Jas</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1566" class="dsq-comment-body">
                        <div id="dsq-comment-message-1566" class="dsq-comment-message"><p>HI,<br />
Can you post complete working aspx page?</p>
<p>Greatly apprciated!!!</p>
<p><a href="mailto:jask2002@yahoo.com">jask2002@yahoo.com</a></p>
<p>Thanks<br />
Jas</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1567">
                    <div id="dsq-comment-header-1567" class="dsq-comment-header">
                        <cite id="dsq-cite-1567">
                                <span id="dsq-author-user-1567">nick</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1567" class="dsq-comment-body">
                        <div id="dsq-comment-message-1567" class="dsq-comment-message"><p>thank you, thank you, thank you!!!</p>
<p>this has been an annoyance for me for some time, so thanks for pointing me in the direction of such a helpful API <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' />  worked like a charm, first time, no messing around!! SUPERB!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1568">
                    <div id="dsq-comment-header-1568" class="dsq-comment-header">
                        <cite id="dsq-cite-1568">
    http://amit.ranjan.in@gmail.com                            <span id="dsq-author-user-1568">amit</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1568" class="dsq-comment-body">
                        <div id="dsq-comment-message-1568" class="dsq-comment-message"><p>Hey nick and Jas can i have the same aspx. I m also trying to do the same and facing some problem</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1569">
                    <div id="dsq-comment-header-1569" class="dsq-comment-header">
                        <cite id="dsq-cite-1569">
    http://chvwovcm.com/                            <span id="dsq-author-user-1569">Fmjyentq</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1569" class="dsq-comment-body">
                        <div id="dsq-comment-message-1569" class="dsq-comment-message"><p>D4cK3S </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-3169">
                    <div id="dsq-comment-header-3169" class="dsq-comment-header">
                        <cite id="dsq-cite-3169">
                                <span id="dsq-author-user-3169">Malik Muhammad Iqbal</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-3169" class="dsq-comment-body">
                        <div id="dsq-comment-message-3169" class="dsq-comment-message"><p>Excellent post!!!!!!!!!!!!!!!!<br />
I have the same issue and solve it through your post.</p>
<p>thanks alot</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/brendantompkins/2004/09/24/map-a-network-drive-from-code-for-cross-domain-file-copy/';
    var disqus_identifier = '180 /blogs/brendan.tompkins/archive/2004/09/24/26730.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'brendantompkins';
    var disqus_title = "Map a Network Drive From Code for Cross-Domain File Copy";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=180');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/brendantompkins\/2004\/09\/24\/map-a-network-drive-from-code-for-cross-domain-file-copy\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/brendantompkins/2011/02/' title='February 2011'>February 2011</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/12/' title='December 2004'>December 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/10/' title='October 2004'>October 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/09/' title='September 2004'>September 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/07/' title='July 2004'>July 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/06/' title='June 2004'>June 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/05/' title='May 2004'>May 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/04/' title='April 2004'>April 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2004/01/' title='January 2004'>January 2004</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2003/12/' title='December 2003'>December 2003</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2003/11/' title='November 2003'>November 2003</a></li>
	<li><a href='http://codebetter.com/brendantompkins/2003/10/' title='October 2003'>October 2003</a></li>
		</ul>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.891 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 19:54:23 -->
<!-- super cache -->