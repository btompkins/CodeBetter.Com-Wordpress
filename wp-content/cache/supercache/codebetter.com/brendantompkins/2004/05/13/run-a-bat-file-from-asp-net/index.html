<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Run a .BAT file from ASP.NET | Brendan Tompkins</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/brendantompkins/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/brendantompkins/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/brendantompkins/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/brendantompkins/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Brendan Tompkins' href='http://codebetter.com/brendantompkins/' />
<link rel='start' title='Tap. Tap.  Is this thing on?' href='http://codebetter.com/brendantompkins/2003/10/08/tap-tap-is-this-thing-on/' />
<link rel='prev' title='Getting the most out of System.DateTime' href='http://codebetter.com/brendantompkins/2004/04/20/getting-the-most-out-of-system-datetime/' />
<link rel='next' title='Windows Service Administration with .NET Part 3 &#8211; Controlling Your Service' href='http://codebetter.com/brendantompkins/2004/06/14/windows-service-administration-with-net-part-3-controlling-your-service/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/brendantompkins/2004/05/13/run-a-bat-file-from-asp-net/' />
<link rel='shortlink' href='http://codebetter.com/brendantompkins/?p=104' />
<link rel="stylesheet" href="http://codebetter.com/brendantompkins/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/brendantompkins/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/brendantompkins/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-104" class="post-104 post type-post status-publish format-standard hentry category-asp-net-tutorials category-most-popular">
					<h1 class="entry-title">Run a .BAT file from ASP.NET</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">Brendan Tompkins</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/brendantompkins/2004/05/13/run-a-bat-file-from-asp-net/" title="11:31 am" rel="bookmark"><span class="entry-date">May 13, 2004</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/brendantompkins/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/brendantompkins/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/brendantompkins/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><P>Okay, running .BAT files from ASP.NET using&nbsp; the System.Diagnostics.Process&nbsp;object and static methods&nbsp;this should be easy,&nbsp;right?&nbsp; Well, this <EM>might</EM> work for you, but it certainly won&#8217;t work on my machines.&nbsp;And after&nbsp;doing lots of reasearh on the issue, it seems that other people are also having problems with this&nbsp;too.&nbsp;&nbsp;</P><br />
<P>I wrestled with permissions&nbsp;and&nbsp;all sorts of other stuff, trying to get a simple batch file to run, with no luck.&nbsp; I tried&nbsp;lauching the bat file directly, launching cmd.exe and calling the bat file using stin. No dice.&nbsp; It seems that something on my machine was keeping an unattended process from running bat files.&nbsp; This makes sense, but I was never able to pinpoint what was preventing this, so I came up with a workaround.</P><br />
<P>I realized that since I could sucessfully run cmd.exe, and send commands to it via stin, I could just open the batch file, and send each line to cmd.exe, which is essentially the same as running a batch file itself.&nbsp; This technique works great, and I thought I&#8217;d pass along the code here.</P><br />
<P><FONT color="#008000" size="2">// Get the full file path<BR></FONT><FONT color="#0000ff" size="2">string</FONT><FONT size="2"> strFilePath = &#8220;c:\\temp\\test.bat&#8221;;</FONT></P><br />
<P><FONT color="#008000" size="2">// Create the ProcessInfo object<BR></FONT><FONT size="2">System.Diagnostics.ProcessStartInfo psi = </FONT><FONT color="#0000ff" size="2">new</FONT><FONT size="2"> System.Diagnostics.ProcessStartInfo(&#8220;cmd.exe&#8221;);<BR>psi.UseShellExecute = </FONT><FONT color="#0000ff" size="2">false</FONT><FONT size="2">; <BR>psi.RedirectStandardOutput = </FONT><FONT color="#0000ff" size="2">true</FONT><FONT size="2">;<BR>psi.RedirectStandardInput = </FONT><FONT color="#0000ff" size="2">true</FONT><FONT size="2">;<BR>psi.RedirectStandardError = </FONT><FONT color="#0000ff" size="2">true</FONT><FONT size="2">;<BR>psi.WorkingDirectory = &#8220;c:\\temp\\&#8220;;</P><br />
<P></FONT><FONT color="#008000" size="2">// Start the process<BR></FONT><FONT size="2">System.Diagnostics.Process proc = System.Diagnostics.Process.Start(psi);</P><br />
<P></P><br />
<P></FONT><FONT color="#008000" size="2">// Open the batch file for reading<BR></FONT><FONT size="2">System.IO.StreamReader strm = System.IO.File.OpenText(strFilePath); </P><br />
<P></FONT><FONT color="#008000" size="2">// Attach the output for reading<BR></FONT><FONT size="2">System.IO.StreamReader sOut = proc.StandardOutput;</P><br />
<P></FONT><FONT color="#008000" size="2">// Attach the in for writing<BR></FONT><FONT size="2">System.IO.StreamWriter sIn = proc.StandardInput;</P><br />
<P></P><br />
<P></FONT><FONT color="#008000" size="2">// Write each line of the batch file to standard input<BR></FONT><FONT color="#0000ff" size="2">while</FONT><FONT size="2">(strm.Peek() != -1)<BR>{<BR>&nbsp; sIn.WriteLine(strm.ReadLine());<BR>}</FONT></P><br />
<P><FONT size="2">strm.Close();</P><br />
<P></FONT><FONT color="#008000" size="2">// Exit CMD.EXE<BR></FONT><FONT color="#0000ff" size="2">string</FONT><FONT size="2"> stEchoFmt = &#8220;# {0} run successfully. Exiting&#8221;;</P><br />
<P>sIn.WriteLine(String.Format(stEchoFmt, strFilePath));<BR>sIn.WriteLine(&#8220;EXIT&#8221;);</P><br />
<P></FONT><FONT color="#008000" size="2">// Close the process<BR></FONT><FONT size="2">proc.Close();</P><br />
<P></FONT><FONT color="#008000" size="2">// Read the sOut to a string.<BR></FONT><FONT color="#0000ff" size="2">string</FONT><FONT size="2"> results = sOut.ReadToEnd().Trim();</P><br />
<P></P><br />
<P></FONT><FONT color="#008000" size="2">// Close the io Streams;<BR></FONT><FONT size="2">sIn.Close(); <BR>sOut.Close();</P><br />
<P></P><br />
<P></FONT><FONT color="#008000" size="2">// Write out the results.<BR></FONT><FONT color="#0000ff" size="2">string</FONT><FONT size="2"> fmtStdOut = &#8220;&lt;font face=courier size=0&gt;{0}&lt;/font&gt;&#8221;;<BR></FONT><FONT color="#0000ff" size="2">this</FONT><FONT size="2">.Response.Write(String.Format(fmtStdOut,results.Replace(System.Environment.NewLine, &#8220;&lt;br&gt;&#8221;)));</FONT></P><br />
<P>That&#8217;s it!&nbsp;&nbsp; Works like a charm!&nbsp;</P><br />
<P>-Brendan</P></p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Brendan Tompkins</h2>
							By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.							<div id="author-link">
								<a href="http://codebetter.com/brendantompkins/author/btompkins/" title="View all posts by Brendan Tompkins">View all posts by Brendan Tompkins &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/brendantompkins/category/asp-net-tutorials/" title="View all posts in ASP.NET Tutorials" rel="category tag">ASP.NET Tutorials</a>, <a href="http://codebetter.com/brendantompkins/category/most-popular/" title="View all posts in Most Popular" rel="category tag">Most Popular</a>. Bookmark the <a href="http://codebetter.com/brendantompkins/2004/05/13/run-a-bat-file-from-asp-net/" title="Permalink to Run a .BAT file from ASP.NET" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/brendantompkins/2004/05/13/run-a-bat-file-from-asp-net/feed/" title="Comments RSS to Run a .BAT file from ASP.NET" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-104 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/brendantompkins/2004/04/20/getting-the-most-out-of-system-datetime/" rel="prev"><span class="meta-nav">&larr;</span> Getting the most out of System.DateTime</a></div>
					<div class="nav-next"><a href="http://codebetter.com/brendantompkins/2004/06/14/windows-service-administration-with-net-part-3-controlling-your-service/" rel="next">Windows Service Administration with .NET Part 3 &#8211; Controlling Your Service <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-804">
					<div id="dsq-comment-header-804" class="dsq-comment-header">
						<cite id="dsq-cite-804">
								<span id="dsq-author-user-804">Lorenzo Barbieri</span>
							</cite>
					</div>
					<div id="dsq-comment-body-804" class="dsq-comment-body">
						<div id="dsq-comment-message-804" class="dsq-comment-message"><p>Perhaps it was a security setting enabled by the IISLockdown Tool?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-805">
					<div id="dsq-comment-header-805" class="dsq-comment-header">
						<cite id="dsq-cite-805">
								<span id="dsq-author-user-805">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-805" class="dsq-comment-body">
						<div id="dsq-comment-message-805" class="dsq-comment-message"><p>Lorenzo,</p>
<p>I don&#8217;t think so, since we&#8217;re running server 2003.  It could be a security setting, I agree, but I checked all the standard stuff, like permissions and that didn&#8217;t seem to be the problem.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-806">
					<div id="dsq-comment-header-806" class="dsq-comment-header">
						<cite id="dsq-cite-806">
								<span id="dsq-author-user-806">Chris Kinsman</span>
							</cite>
					</div>
					<div id="dsq-comment-body-806" class="dsq-comment-body">
						<div id="dsq-comment-message-806" class="dsq-comment-message"><p>Did you try cmd /c<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-807">
					<div id="dsq-comment-header-807" class="dsq-comment-header">
						<cite id="dsq-cite-807">
								<span id="dsq-author-user-807">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-807" class="dsq-comment-body">
						<div id="dsq-comment-message-807" class="dsq-comment-message"><p>Chris.  I tried this, to no effect.  It was like something low level was stopping the cmd.exe process from executing a bat file. Strange.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-808">
					<div id="dsq-comment-header-808" class="dsq-comment-header">
						<cite id="dsq-cite-808">
								<span id="dsq-author-user-808">Eric Engler</span>
							</cite>
					</div>
					<div id="dsq-comment-body-808" class="dsq-comment-body">
						<div id="dsq-comment-message-808" class="dsq-comment-message"><p>Can you run a VBScript from ASP.NET? You might try running a VBScript that, in turn, calls a batch. Something like this:</p>
<p>Save this as a name.vbs file and call it from your code-behine:<br />
<br />&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
<br />Const NOWAITFORFINISH = 0<br />
<br />Const WAITFORFINISH = 1<br />
<br />Const HIDEWINDOW = 0<br />
<br />Const SHOWWINDOW = 1</p>
<p>Dim oShell, sCommand<br />
<br />sCommand = &quot;c:\path\batch.bat&quot;<br />
<br />Set oShell = Wscript.CreateObject(&quot;Wscript.Shell&quot;)<br />
<br />oShell.Run Quote(sCommand), HIDEWINDOW, NOWAITFORFINISH</p>
<p>WScript.Quit(0)</p>
<p>Function Quote(sText)<br />
<br />  Quote = Chr(34) &amp; sText &amp; Chr(34)<br />
<br />End Function</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-809">
					<div id="dsq-comment-header-809" class="dsq-comment-header">
						<cite id="dsq-cite-809">
								<span id="dsq-author-user-809">Matt</span>
							</cite>
					</div>
					<div id="dsq-comment-body-809" class="dsq-comment-body">
						<div id="dsq-comment-message-809" class="dsq-comment-message"><p>Brendan your code works fine on my Windows 2000 server but on my Windows 2003 server I get the following error message&#8230;</p>
<p>Access is denied</p>
<p>at System.Diagnostics.Process.StartWithCreateProcess(ProcessStartInfo startInfo) at System.Diagnostics.Process.Start() at System.Diagnostics.Process.Start(ProcessStartInfo startInfo) at cis2004.resumertf.Page_Load(Object sender, EventArgs e)</p>
<p>Any ideas?</p>
<p>Thank in advance &#8211; Matt</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-810">
					<div id="dsq-comment-header-810" class="dsq-comment-header">
						<cite id="dsq-cite-810">
								<span id="dsq-author-user-810">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-810" class="dsq-comment-body">
						<div id="dsq-comment-message-810" class="dsq-comment-message"><p>Hi Matt,<br />
<br />Get yourself a copy of FileMon from Sysinternals.  </p>
<p><a target="_new" href="http://www.sysinternals.com/">http://www.sysinternals.com/</a></p>
<p>Run this on the server and look for ACCESS DENIED messages, or some other error.  This can get a bit tricky to get working&#8230;</p>
<p>I think that the local machine&#8217;s NETWORK SERVICE account has to have rights to open dirs, etc..</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-811">
					<div id="dsq-comment-header-811" class="dsq-comment-header">
						<cite id="dsq-cite-811">
								<span id="dsq-author-user-811">Dan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-811" class="dsq-comment-body">
						<div id="dsq-comment-message-811" class="dsq-comment-message"><p>This code works great but I can&#8217;t get anything to run in the batch file other than a simple net send.  What account does the batch file run as?  Seem like it doesn&#8217;t have permissions to delete or copy files.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-812">
					<div id="dsq-comment-header-812" class="dsq-comment-header">
						<cite id="dsq-cite-812">
								<span id="dsq-author-user-812">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-812" class="dsq-comment-body">
						<div id="dsq-comment-message-812" class="dsq-comment-message"><p>Hi Dan.. See the above comments I left for Matt.<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-813">
					<div id="dsq-comment-header-813" class="dsq-comment-header">
						<cite id="dsq-cite-813">
								<span id="dsq-author-user-813">Dan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-813" class="dsq-comment-body">
						<div id="dsq-comment-message-813" class="dsq-comment-message"><p>Thanks Brendan, </p>
<p>I already did install FileMon and all it seems to tell me is if the batch file failed or not.  Is there some option to see who the batch file ran as?  Can you somehow change the account the batch file runs as?  </p>
<p>I think I need mine to run as a domain account and not the local system because the files I am working with are not on the webserver.</p>
<p>BTY, great code!!!  I don&#8217;t even know C# and I was able to get it working (Just cut and paste)</p>
<p>Thanks,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-814">
					<div id="dsq-comment-header-814" class="dsq-comment-header">
						<cite id="dsq-cite-814">
								<span id="dsq-author-user-814">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-814" class="dsq-comment-body">
						<div id="dsq-comment-message-814" class="dsq-comment-message"><p>Dan,</p>
<p>Thanks!  Try TokenMon from Sysinternals. Under 2003, these batch files run as NETWORK SERVICE, AFAIK&#8230;.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-815">
					<div id="dsq-comment-header-815" class="dsq-comment-header">
						<cite id="dsq-cite-815">
								<span id="dsq-author-user-815">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-815" class="dsq-comment-body">
						<div id="dsq-comment-message-815" class="dsq-comment-message"><p>Brendan,<br />
<br />FYI, I am running this on windows 2000 but I will take a look at TokenMon.</p>
<p>Thanks,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-816">
					<div id="dsq-comment-header-816" class="dsq-comment-header">
						<cite id="dsq-cite-816">
								<span id="dsq-author-user-816">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-816" class="dsq-comment-body">
						<div id="dsq-comment-message-816" class="dsq-comment-message"><p>I don&#8217;t think TokenMon is going to tell me anyting since it reboots the server everytime I have TokenMon running and try to hit the webpage that calls the batch file.  Reboots everytime!  Any other ideas?</p>
<p>Thanks,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-817">
					<div id="dsq-comment-header-817" class="dsq-comment-header">
						<cite id="dsq-cite-817">
								<span id="dsq-author-user-817">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-817" class="dsq-comment-body">
						<div id="dsq-comment-message-817" class="dsq-comment-message"><p>Ha.  I&#8217;ve had that happen too. Well, are you sure filemon doesn&#8217;t tell you the process user? Have you tried granting permissions to the NETWORK SERVICE account on the local box?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-818">
					<div id="dsq-comment-header-818" class="dsq-comment-header">
						<cite id="dsq-cite-818">
								<span id="dsq-author-user-818">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-818" class="dsq-comment-body">
						<div id="dsq-comment-message-818" class="dsq-comment-message"><p>This is what I get from filemom&#8230;.Looks like it might be running as system but if I give system full access&#8230;&#8230;still no dice!!!</p>
<p>343	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS	SUCCESS	Options: Open  Access: All<br />
<br />344	7:21:19 AM	System:8	FASTIO_QUERY_BASIC_INFO	C:\RCS	SUCCESS	Attributes: D<br />
<br />345	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS	SUCCESS<br />
<br />346	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:\RCS	SUCCESS<br />
<br />347	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS	SUCCESS	Options: Open Directory  Access: Traverse<br />
<br />348	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS	BUFFER OVERFLOW	FileNameInformation<br />
<br />349	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS	SUCCESS	FileNameInformation<br />
<br />350	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS\V14\DATA66\DATA	SUCCESS	Options: Open  Access: All<br />
<br />351	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS\V14\DATA66\DATA	SUCCESS	FileBasicInformation<br />
<br />352	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS\V14\DATA66\DATA	SUCCESS<br />
<br />353	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:\RCS\V14\DATA66\DATA	SUCCESS<br />
<br />354	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS	SUCCESS<br />
<br />355	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:\RCS	SUCCESS<br />
<br />356	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS	SUCCESS	Options: Open  Access: All<br />
<br />357	7:21:19 AM	System:8	FASTIO_QUERY_BASIC_INFO	C:\RCS	SUCCESS	Attributes: D<br />
<br />358	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS	SUCCESS<br />
<br />359	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:\RCS	SUCCESS<br />
<br />360	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS	SUCCESS	Options: Open Directory  Access: Traverse<br />
<br />361	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS	BUFFER OVERFLOW	FileNameInformation<br />
<br />362	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS	SUCCESS	FileNameInformation<br />
<br />363	7:21:19 AM	System:8	IRP_MJ_CREATE 	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	Options: Open  Access: All<br />
<br />364	7:21:19 AM	System:8	FASTIO_QUERY_NETWORK_OPEN_INFO	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	Attributes: D<br />
<br />365	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	FileEaInformation<br />
<br />366	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	FileStreamInformation<br />
<br />367	7:21:19 AM	System:8	IRP_MJ_QUERY_INFORMATION	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	FileObjectIdInformation<br />
<br />368	7:21:19 AM	System:8	IRP_MJ_QUERY_SECURITY	C:\RCS\V14\DATA66\DATA\HotHits.bat	BUFFER OVERFLOW<br />
<br />369	7:21:19 AM	System:8	IRP_MJ_QUERY_SECURITY	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS<br />
<br />370	7:21:19 AM	System:8	FASTIO_READ	C:\RCS\V14\DATA66\DATA\HotHits.bat	FAILURE	Offset: 0 Length: 4096<br />
<br />371	7:21:19 AM	System:8	IRP_MJ_READ 	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS	Offset: 0 Length: 4096<br />
<br />372	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:&#8230;\\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS<br />
<br />373	7:21:19 AM	System:8	FASTIO_READ	C:\RCS\V14\DATA66\DATA\HotHits.bat	END OF FILE	Offset: 79 Length: 4017<br />
<br />374	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS\V14\DATA66\DATA\HotHits.bat	SUCCESS<br />
<br />375	7:21:19 AM	System:8	IRP_MJ_CLEANUP	C:\RCS	SUCCESS<br />
<br />376	7:21:19 AM	System:8	IRP_MJ_CLOSE 	C:\RCS	SUCCESS<br />
<br />377	7:21:20 AM	System:8	IRP_MJ_WRITE*	C:	SUCCESS	Offset: 11112448 Length: 4096<br />
<br />378	7:21:20 AM	System:8	IRP_MJ_WRITE*	C:	SUCCESS	Offset: 12288 Length: 4096<br />
<br />379	7:21:20 AM	System:8	IRP_MJ_WRITE*	C:	SUCCESS	Offset: 0 Length: 4096	</p>
<p>As far as permissions, the everyone domain group has full permissions so that should cover everything but I did try adding the NETWORK account and it didn&#8217;t work.  I couldn&#8217;t find a NETWORK SERVICE account?  Only network.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-819">
					<div id="dsq-comment-header-819" class="dsq-comment-header">
						<cite id="dsq-cite-819">
								<span id="dsq-author-user-819">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-819" class="dsq-comment-body">
						<div id="dsq-comment-message-819" class="dsq-comment-message"><p>It looks like the only way it will work is if the batch file is located and runs all commands on the webserver&#8230;..that seems to work fine.</p>
<p>Trying to copy, or in my case run a scanlog program on another server, just isn&#8217;t going to work.  Am I correct?</p>
<p>Thanks for all the help,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-820">
					<div id="dsq-comment-header-820" class="dsq-comment-header">
						<cite id="dsq-cite-820">
								<span id="dsq-author-user-820">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-820" class="dsq-comment-body">
						<div id="dsq-comment-message-820" class="dsq-comment-message"><p>Brendan,</p>
<p>Is there anyway I could get a VB version of this code?  It is working great but I don&#8217;t know CSharp and I am having an hell of a time trying to add a drop down box that a user can select a program, hit submit, and the path to the batch file will use the selected program (which is a different path).</p>
<p>So I am going to have 60 different paths to the batch file (which will scan the log files in those directories).</p>
<p>“c:\\Hot Hits\\test.bat”;<br />
<br />“c:\\Classical\\test.bat”;<br />
<br />“c:\\Jazz\\test.bat”;<br />
<br />and so on&#8230;.I just can get it to work in CSharp (I can&#8217;t even get a button to work).</p>
<p>Thanks,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-821">
					<div id="dsq-comment-header-821" class="dsq-comment-header">
						<cite id="dsq-cite-821">
								<span id="dsq-author-user-821">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-821" class="dsq-comment-body">
						<div id="dsq-comment-message-821" class="dsq-comment-message"><p>Brenden,</p>
<p>Please disregard, I got it working in CSharp with the help of some nice guy on aspmessageboard.  Working great!!!</p>
<p>Thanks,<br />
<br />Dan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-822">
					<div id="dsq-comment-header-822" class="dsq-comment-header">
						<cite id="dsq-cite-822">
								<span id="dsq-author-user-822">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-822" class="dsq-comment-body">
						<div id="dsq-comment-message-822" class="dsq-comment-message"><p>Dan &#8211; Good.  BTW, anyone know of any tools to port from C# to VB?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-823">
					<div id="dsq-comment-header-823" class="dsq-comment-header">
						<cite id="dsq-cite-823">
								<span id="dsq-author-user-823">Dan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-823" class="dsq-comment-body">
						<div id="dsq-comment-message-823" class="dsq-comment-message"><p>Brenden,</p>
<p>Is there anyway to get the batchfile to run from a certain directory?  I am using some old scanlog program that doesn&#8217;t always work if it isn&#8217;t run from the same directory as the log files it is scanning.  It seems like it keeps running the batch file from C:\WINNT even if I put a CD in the batch file&#8230;.see below?</p>
<p>C:\WINNT&gt;CD C:\RCSFiles\HHI</p>
<p>C:\WINNT&gt;scanlog.exe /p /2 /U1 *.HHI</p>
<p>C:\WINNT&gt;# c:\RCSFiles\HHI\ScanLog.bat run successfully. Exiting</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-824">
					<div id="dsq-comment-header-824" class="dsq-comment-header">
						<cite id="dsq-cite-824">
								<span id="dsq-author-user-824">Dan Marth</span>
							</cite>
					</div>
					<div id="dsq-comment-body-824" class="dsq-comment-body">
						<div id="dsq-comment-message-824" class="dsq-comment-message"><p>Sorry about the mis-spelling of your name.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-825">
					<div id="dsq-comment-header-825" class="dsq-comment-header">
						<cite id="dsq-cite-825">
								<span id="dsq-author-user-825">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-825" class="dsq-comment-body">
						<div id="dsq-comment-message-825" class="dsq-comment-message"><p>Dan,</p>
<p>You could try setting this line to your directory, but I&#8217;m not positive it works.. I seem to remember having trouble with this.</p>
<p>psi.WorkingDirectory = “c:\\temp\\“;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-826">
					<div id="dsq-comment-header-826" class="dsq-comment-header">
						<cite id="dsq-cite-826">
								<span id="dsq-author-user-826">TrungGap</span>
							</cite>
					</div>
					<div id="dsq-comment-body-826" class="dsq-comment-body">
						<div id="dsq-comment-message-826" class="dsq-comment-message"><p>Hi all,</p>
<p>I was having problem executing a batch file on Windows 2003 Server also. The code seems to execute fine on Windows 2000 Server. After playing around with it, I discovered the cause what was causing the problem, but still haven&#8217;t fully understand why. Anyway, hopefully this little tibbits would help somebody. </p>
<p>This piece of code works perfectly on Win2K Server:</p>
<p>  Process myProcess = new Process();<br />
<br />  myProcess.StartInfo.WorkingDirectory = Request.MapPath(&quot;resources/files&quot;);</p>
<p>  myProcess.StartInfo.FileName = Request.MapPath(&quot;resources/files/build.bat&quot;);<br />
<br />  myProcess.StartInfo.Arguments = Request[&quot;Language&quot;];<br />
<br />  myProcess.StartInfo.UseShellExecute = false;<br />
<br />  myProcess.StartInfo.RedirectStandardOutput = true;<br />
<br />  myProcess.Start();    </p>
<p>  myOutput = myProcess.StandardOutput.ReadToEnd();</p>
<p>  myProcess.WaitForExit();</p>
<p>However that didn&#8217;t work on Win2K3 Server. The problem was if any commands in the batch file result in an error, it would exit. Thus in the batch had some del&#8217;s to make sure the directory is clean, if it didn&#8217;t delete anything, then it would exit.</p>
<p>To get around this, I had to redirect the standard error:</p>
<p>  myProcess.StartInfo.RedirectStandardError = true;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-827">
					<div id="dsq-comment-header-827" class="dsq-comment-header">
						<cite id="dsq-cite-827">
								<span id="dsq-author-user-827">Brendan Tompkins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-827" class="dsq-comment-body">
						<div id="dsq-comment-message-827" class="dsq-comment-message"><p>Nice!  Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-828">
					<div id="dsq-comment-header-828" class="dsq-comment-header">
						<cite id="dsq-cite-828">
								<span id="dsq-author-user-828">Mike</span>
							</cite>
					</div>
					<div id="dsq-comment-body-828" class="dsq-comment-body">
						<div id="dsq-comment-message-828" class="dsq-comment-message"><p>I am having the same problem!  Has anyone found a solution to this?  I cannot seem to run a BAT file from ASP.NET, however, running it directly on the server works fine.  I am sure it is a permissions issue, but I am not sure how to work around it! </p>
<p>Thanks,<br />
<br />mike<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-829">
					<div id="dsq-comment-header-829" class="dsq-comment-header">
						<cite id="dsq-cite-829">
								<span id="dsq-author-user-829">Oliver</span>
							</cite>
					</div>
					<div id="dsq-comment-body-829" class="dsq-comment-body">
						<div id="dsq-comment-message-829" class="dsq-comment-message"><p>Having the same problem on Win2k3 server. All directories have full permissions for Everyone (development server <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> ). Still no success. The .bat file runs fine locally, but does nothing when called from an ASP.NET process.<br />
<br />Any help is greatly appreciated.<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-830">
					<div id="dsq-comment-header-830" class="dsq-comment-header">
						<cite id="dsq-cite-830">
								<span id="dsq-author-user-830">Yaheya Quazi</span>
							</cite>
					</div>
					<div id="dsq-comment-body-830" class="dsq-comment-body">
						<div id="dsq-comment-message-830" class="dsq-comment-message"><p>You need to give access to IUSR_machinename account Read and Execture permission to cmd.exe also you have to add the following to your web.config file</p>
<p> &lt;identity impersonate=&quot;true&quot; /&gt;</p>
<p>Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-831">
					<div id="dsq-comment-header-831" class="dsq-comment-header">
						<cite id="dsq-cite-831">
								<span id="dsq-author-user-831">Serge</span>
							</cite>
					</div>
					<div id="dsq-comment-body-831" class="dsq-comment-body">
						<div id="dsq-comment-message-831" class="dsq-comment-message"><p>Brendan,<br />
<br />Thanks for beatifull solution of the problem.</p>
<p>There are no need to read any batch file if you want to run the static command.<br />
<br />Instead of :<br />
<br />while(strm.Peek() != -1)<br />
<br />{<br />
<br />  sIn.WriteLine(strm.ReadLine());<br />
<br />}<br />
<br />you can write: </p>
<p>sIn.WriteLine(strCmd);<br />
<br />Where strCmd is any command valid in command prompt. For example:<br />
<br />string strCmd = @&quot;findstr /i /m &quot; + &quot;stringToFind&quot; + &quot; &quot; + strDirectory + &quot;\\*.*&quot;;<br />
<br />Return a file list contained &quot;stringToFind&quot;.<br />
<br />Serge</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-832">
					<div id="dsq-comment-header-832" class="dsq-comment-header">
						<cite id="dsq-cite-832">
								<span id="dsq-author-user-832">Michael</span>
							</cite>
					</div>
					<div id="dsq-comment-body-832" class="dsq-comment-body">
						<div id="dsq-comment-message-832" class="dsq-comment-message"><p>Brendan,</p>
<p> Thanks for this &#8230; MS should be shot for making it so difficult to run a simple batch file !</p>
<p>&#8211; Michael</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-833">
					<div id="dsq-comment-header-833" class="dsq-comment-header">
						<cite id="dsq-cite-833">
								<span id="dsq-author-user-833">Sunil</span>
							</cite>
					</div>
					<div id="dsq-comment-body-833" class="dsq-comment-body">
						<div id="dsq-comment-message-833" class="dsq-comment-message"><p>Try this!! Works fine on W2K</p>
<p>Process myCmd = null;<br />
<br />				ProcessStartInfo qOptions = new ProcessStartInfo(@&quot;cmd.exe&quot;,@&quot;/k C:/trigger.bat&quot;);<br />
<br />				qOptions.WindowStyle = ProcessWindowStyle.Hidden;<br />
<br />				qOptions.RedirectStandardOutput = false;  // set to &quot;true&quot; to enable logging<br />
<br />				qOptions.UseShellExecute = true;  // set to true to make silent/background</p>
<p>				myCmd = Process.Start(qOptions);<br />
<br />				myCmd.WaitForExit();</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-834">
					<div id="dsq-comment-header-834" class="dsq-comment-header">
						<cite id="dsq-cite-834">
								<span id="dsq-author-user-834">viki</span>
							</cite>
					</div>
					<div id="dsq-comment-body-834" class="dsq-comment-body">
						<div id="dsq-comment-message-834" class="dsq-comment-message"><p>Hi,<br />
<br />i was trying to run an application(for e.g., notepad) thru the batch file.But my application hangs, i could see the notepad process running in the task manager, but i could not see the command window or notepad.</p>
<p>If my batch file has del or copy command it works eventhough i could not see the command window.</p>
<p>i have set integrated windows authentication and identity impersonate=true.</p>
<p>could u please shed a light on this</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-835">
					<div id="dsq-comment-header-835" class="dsq-comment-header">
						<cite id="dsq-cite-835">
								<span id="dsq-author-user-835">Somayeh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-835" class="dsq-comment-body">
						<div id="dsq-comment-message-835" class="dsq-comment-message"><p>hello<br />
<br />i have few questions about this code.<br />
<br />from where this batch file will be executed?i mean does it execute the batch file on the server or on the clients???<br />
<br />i guess it runs on the server..but if i want to have a batch file on the server and i want it to be execute everytime a user send a request to that page..what should i do??<br />
<br />i want the batch file to be executed on the client and do something on the client machin.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-836">
					<div id="dsq-comment-header-836" class="dsq-comment-header">
						<cite id="dsq-cite-836">
								<span id="dsq-author-user-836">Ramesh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-836" class="dsq-comment-body">
						<div id="dsq-comment-message-836" class="dsq-comment-message"><p>Thanx I will try and then send another reply</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-837">
					<div id="dsq-comment-header-837" class="dsq-comment-header">
						<cite id="dsq-cite-837">
								<span id="dsq-author-user-837">HELP</span>
							</cite>
					</div>
					<div id="dsq-comment-body-837" class="dsq-comment-body">
						<div id="dsq-comment-message-837" class="dsq-comment-message"><p>i run process.start(&quot;send.bat&quot;,&quot;net-software test&quot; for net send message &quot;test&quot; for net-software computer . but this code runing in win 2000 server and cant run in win 2003 server<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-838">
					<div id="dsq-comment-header-838" class="dsq-comment-header">
						<cite id="dsq-cite-838">
								<span id="dsq-author-user-838">Dariwe</span>
							</cite>
					</div>
					<div id="dsq-comment-body-838" class="dsq-comment-body">
						<div id="dsq-comment-message-838" class="dsq-comment-message"><p>I am having issues on winxp sp2. Everything is golden on win2k3 and xpsp1, but on 2 sp2 machines the debugger goes through the function where it is processing the batch file as expected, but the batch file just is not run. Any ideas?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-839">
					<div id="dsq-comment-header-839" class="dsq-comment-header">
						<cite id="dsq-cite-839">
								<span id="dsq-author-user-839">Kien</span>
							</cite>
					</div>
					<div id="dsq-comment-body-839" class="dsq-comment-body">
						<div id="dsq-comment-message-839" class="dsq-comment-message"><p>For win2k3 users (like me) suffering with permissions and security, try <a target="_new" href="http://www.eggheadcafe.com/articles/20030703.asp">http://www.eggheadcafe.com/articles/20030703.asp</a>.  Just this morning this helped me solve my permissions issue problem with an intranet app.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-840">
					<div id="dsq-comment-header-840" class="dsq-comment-header">
						<cite id="dsq-cite-840">
								<span id="dsq-author-user-840">Jan Landen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-840" class="dsq-comment-body">
						<div id="dsq-comment-message-840" class="dsq-comment-message"><p>Thank you Brendan!</p>
<p>It was a bit difficult to handle process standard io redirection to me&#8230;</p>
<p>Your code was great help to me to learn the basics&#8230;.</p>
<p>-Jan</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-841">
					<div id="dsq-comment-header-841" class="dsq-comment-header">
						<cite id="dsq-cite-841">
								<span id="dsq-author-user-841">MadRiverLizard</span>
							</cite>
					</div>
					<div id="dsq-comment-body-841" class="dsq-comment-body">
						<div id="dsq-comment-message-841" class="dsq-comment-message"><p>How would I modify this so that the process uses command line arguments (c:\bat.bat 2004 1)?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-842">
					<div id="dsq-comment-header-842" class="dsq-comment-header">
						<cite id="dsq-cite-842">
								<span id="dsq-author-user-842">lastdragon</span>
							</cite>
					</div>
					<div id="dsq-comment-body-842" class="dsq-comment-body">
						<div id="dsq-comment-message-842" class="dsq-comment-message"><p>none of the above suggestions seem to work</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-843">
					<div id="dsq-comment-header-843" class="dsq-comment-header">
						<cite id="dsq-cite-843">
								<span id="dsq-author-user-843">Jason</span>
							</cite>
					</div>
					<div id="dsq-comment-body-843" class="dsq-comment-body">
						<div id="dsq-comment-message-843" class="dsq-comment-message"><p>Anyone know how i can make it into a dataset. ie. ability to make each line a record in a virtual datasource? for datagrid use, etc.</p>
<p>Jason<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-844">
					<div id="dsq-comment-header-844" class="dsq-comment-header">
						<cite id="dsq-cite-844">
								<span id="dsq-author-user-844">Alex</span>
							</cite>
					</div>
					<div id="dsq-comment-body-844" class="dsq-comment-body">
						<div id="dsq-comment-message-844" class="dsq-comment-message"><p>In my case (Win 2003) it was completely permissions problem. I added Everyone with read writ execute permissions and it worked. I am going to take out permissions for everyone and add needed once.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-845">
					<div id="dsq-comment-header-845" class="dsq-comment-header">
						<cite id="dsq-cite-845">
								<span id="dsq-author-user-845">Utkal Sharma</span>
							</cite>
					</div>
					<div id="dsq-comment-body-845" class="dsq-comment-body">
						<div id="dsq-comment-message-845" class="dsq-comment-message"><p>Oh boy&#8230;. Getting this thing working was like climbing Mount Everest. The code to run through cmd.exe was good but only if the processing which is done in .BAT file is small. In my case it may take 1-2 hour and so the cmd.exe was locking after the Script-timeout for aspx page is reached. In that case we have to make UseShellExecute = true so that it runs in background. Sunil&#8217;s code(Below) works fine in such case.    </p>
<p>Process myCmd = null;<br />
<br />ProcessStartInfo qOptions = new ProcessStartInfo(@&quot;cmd.exe&quot;,@&quot;/k C:/trigger.bat&quot;);<br />
<br />qOptions.WindowStyle = ProcessWindowStyle.Hidden;<br />
<br />qOptions.RedirectStandardOutput = false; // set to &quot;true&quot; to enable logging<br />
<br />qOptions.UseShellExecute = true; // set to true to make silent/background </p>
<p>myCmd = Process.Start(qOptions);<br /></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-846">
					<div id="dsq-comment-header-846" class="dsq-comment-header">
						<cite id="dsq-cite-846">
								<span id="dsq-author-user-846">Marck NOOB</span>
							</cite>
					</div>
					<div id="dsq-comment-body-846" class="dsq-comment-body">
						<div id="dsq-comment-message-846" class="dsq-comment-message"><p>Is that possible to someone please write a full aspx page, calling a bat file ??</p>
<p>Please help me, I am very boob! <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-847">
					<div id="dsq-comment-header-847" class="dsq-comment-header">
						<cite id="dsq-cite-847">
								<span id="dsq-author-user-847">Ivan Belov</span>
							</cite>
					</div>
					<div id="dsq-comment-body-847" class="dsq-comment-body">
						<div id="dsq-comment-message-847" class="dsq-comment-message"><p>Thanks for snippet, Brendan! Helped me to solve related problem. Great job! <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> )</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-848">
					<div id="dsq-comment-header-848" class="dsq-comment-header">
						<cite id="dsq-cite-848">
								<span id="dsq-author-user-848">Tim Riester</span>
							</cite>
					</div>
					<div id="dsq-comment-body-848" class="dsq-comment-body">
						<div id="dsq-comment-message-848" class="dsq-comment-message"><p>AAAAACCCCKKK!!!  I implemented this code in VB.NET on my web app and it runs great on my local web server which is Windows XP.  When I move it to the production server which is W2K3, the batch files don&#8217;t run.  I&#8217;ve tried giving the Network Service acct on the machine full control over the batch files and the c drive, but still getting the same results of the batch files not being able to run.  Any help would be appreciated.  Thanks.</p>
<p>-Tim</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-849">
					<div id="dsq-comment-header-849" class="dsq-comment-header">
						<cite id="dsq-cite-849">
								<span id="dsq-author-user-849">Abhi</span>
							</cite>
					</div>
					<div id="dsq-comment-body-849" class="dsq-comment-body">
						<div id="dsq-comment-message-849" class="dsq-comment-message"><p>Thanks so much Brendon, it works, and shld say &#8216;finally it works&#8217;.<br />
 I have spent hours to get this right. Ur logic and technique are very correct. Great work.<br />
 But please do mention above ur codes that, the user account under which the ASPNET runs should have full permissions.<br />
I created a new user login, with admin access, and added the identitity impersonate = true in webconfig file<br />
eg :   <identity impersonate = "true" userName="SingpostPrintUser" password="singpost"></identity></p>
<p>It should work now&#8230;</p>
<p>regards<br />
abhi</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-850">
					<div id="dsq-comment-header-850" class="dsq-comment-header">
						<cite id="dsq-cite-850">
	http://guestbooks.pathfinder.gr/read/online-seven-card-stud							<span id="dsq-author-user-850">online seven card stud</span>
							</cite>
					</div>
					<div id="dsq-comment-body-850" class="dsq-comment-body">
						<div id="dsq-comment-message-850" class="dsq-comment-message"><p>Welcome symbols <a href="http://guestbooks.pathfinder.gr/read/online-seven-card-stud">online seven card stud</a> <a href="http://guestbooks.pathfinder.gr/read/online-seven-card-stud">http://guestbooks.pathfinder.gr/read/online-seven-card-stud</a> blind fold complete <a href="http://guestbooks.pathfinder.gr/read/online-seven-card-stud" rel="nofollow">http://guestbooks.pathfinder.gr/read/online-seven-card-stud</a>  earn variance.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-851">
					<div id="dsq-comment-header-851" class="dsq-comment-header">
						<cite id="dsq-cite-851">
	http://guestbooks.pathfinder.gr/read/7-card-stud							<span id="dsq-author-user-851">7 card stud</span>
							</cite>
					</div>
					<div id="dsq-comment-body-851" class="dsq-comment-body">
						<div id="dsq-comment-message-851" class="dsq-comment-message"><p>Doesn&#8217;t <a href="http://guestbooks.pathfinder.gr/read/7-card-stud">7 card stud</a> <a href="http://guestbooks.pathfinder.gr/read/7-card-stud">http://guestbooks.pathfinder.gr/read/7-card-stud</a>!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-852">
					<div id="dsq-comment-header-852" class="dsq-comment-header">
						<cite id="dsq-cite-852">
	http://guestbooks.pathfinder.gr/read/play-seven-card-stud							<span id="dsq-author-user-852">play seven card stud</span>
							</cite>
					</div>
					<div id="dsq-comment-body-852" class="dsq-comment-body">
						<div id="dsq-comment-message-852" class="dsq-comment-message"><p>Eventually <a href="http://guestbooks.pathfinder.gr/read/play-seven-card-stud">play seven card stud</a> fold <a href="http://guestbooks.pathfinder.gr/read/play-seven-card-stud">http://guestbooks.pathfinder.gr/read/play-seven-card-stud</a> scalper four represent percentage!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-853">
					<div id="dsq-comment-header-853" class="dsq-comment-header">
						<cite id="dsq-cite-853">
	http://guestbooks.pathfinder.gr/read/online-7-card-stud							<span id="dsq-author-user-853">online 7 card stud</span>
							</cite>
					</div>
					<div id="dsq-comment-body-853" class="dsq-comment-body">
						<div id="dsq-comment-message-853" class="dsq-comment-message"><p>As you see<br />
 tap <a href="http://guestbooks.pathfinder.gr/read/online-7-card-stud">online 7 card stud</a> <a href="http://guestbooks.pathfinder.gr/read/online-7-card-stud">http://guestbooks.pathfinder.gr/read/online-7-card-stud</a> <a href="http://guestbooks.pathfinder.gr/read/online-7-card-stud" rel="nofollow">http://guestbooks.pathfinder.gr/read/online-7-card-stud</a> .</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-854">
					<div id="dsq-comment-header-854" class="dsq-comment-header">
						<cite id="dsq-cite-854">
	http://sudeep_aitian@yahoo.com							<span id="dsq-author-user-854">Sudeep Ghosh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-854" class="dsq-comment-body">
						<div id="dsq-comment-message-854" class="dsq-comment-message"><p>Hi,<br />
I am facing the same problem &#8230; it says the following </p>
<p>10060 &#8211; Connection timeout<br />
Internet Security and Acceleration Server </p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211; </p>
<p>Technical Information (for support personnel) </p>
<p>Background:<br />
When the server, while acting as a gateway or proxy, contacted the upstream content server, it did not receive a timely response. </p>
<p>Do I have the work around for this&#8230;. I need the connection to stay longer for some back ground process to work. </p>
<p>Please let me know if you have found the solution to this problem. </p>
<p>Thanks in advance </p>
<p>Thanks and Regards<br />
Sudeep<br />
<a href="mailto:sudeep_aitian@yahoo.com">sudeep_aitian@yahoo.com</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-855">
					<div id="dsq-comment-header-855" class="dsq-comment-header">
						<cite id="dsq-cite-855">
								<span id="dsq-author-user-855">darktown</span>
							</cite>
					</div>
					<div id="dsq-comment-body-855" class="dsq-comment-body">
						<div id="dsq-comment-message-855" class="dsq-comment-message"><p>for those who want the vb -code so badly<br />
it took me 2 mins to convert it..</p>
<p>  Dim strFilePath As String = &#8220;c:\\temp\\test.bat&#8221;</p>
<p>        Dim psi As System.Diagnostics.ProcessStartInfo = New System.Diagnostics.ProcessStartInfo(&#8220;cmd.exe&#8221;)<br />
        psi.UseShellExecute = False<br />
        psi.RedirectStandardOutput = True<br />
        psi.RedirectStandardInput = True<br />
        psi.RedirectStandardError = True<br />
        psi.WorkingDirectory = &#8220;c:\\temp\\&#8221;</p>
<p>        Dim proc As System.Diagnostics.Process = System.Diagnostics.Process.Start(psi)<br />
        Dim strm As System.IO.StreamReader = System.IO.File.OpenText(strFilePath)<br />
        Dim sout As System.IO.StreamReader = proc.StandardOutput<br />
        Dim sin As System.IO.StreamWriter = proc.StandardInput</p>
<p>        While strm.Peek() <> -1<br />
            sin.WriteLine(strm.ReadLine())<br />
        End While</p>
<p>        strm.Close()</p>
<p>        Dim stEchoFmt As String = &#8220;# {0} run successfully. Exiting&#8221;<br />
        sin.WriteLine(String.Format(stEchoFmt, strFilePath))<br />
        sin.WriteLine(&#8220;EXIT&#8221;)<br />
        proc.Close()</p>
<p>        sin.Close()<br />
        sout.Close()</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-856">
					<div id="dsq-comment-header-856" class="dsq-comment-header">
						<cite id="dsq-cite-856">
								<span id="dsq-author-user-856">Tracy Spratt</span>
							</cite>
					</div>
					<div id="dsq-comment-body-856" class="dsq-comment-body">
						<div id="dsq-comment-message-856" class="dsq-comment-message"><p>Well, y&#8217;all are getting me closer than any other site I have found!</p>
<p>Since I have just a single command to run I am trying to use Serge&#8217;s suggestion () of writing the command directly to the sIn but am having a bit of trouble.</p>
<p>A hardcoded line works fine, but whenever I try to concatenate a variable, the command string, the command fails.</p>
<p>this works:<br />
sCommand = &#8220;psshutdown.exe \\172.31.255.57 -u Administrator&#8221;<br />
this works:<br />
sCommand =&#8221;psshutdown.exe \\&#8221; &#038; &#8220;172.31.255.57&#8243; &#038; &#8221; -u Administrator&#8221;<br />
but this fails:<br />
sCommand =&#8221;psshutdown.exe \\&#8221; &#038; sIP &#038; &#8221; -u Administrator&#8221;</p>
<p>The WriteLine() has an overload that is supposed to take string.</p>
<p>Any ideas what is happening?</p>
<p>Alternatively, how could I parameterize the bat/cmd file if I used the sIn approach?  I tried passing in a SET IP= to the cmd process,  but this did not seem to work.  Is that a valid approach?</p>
<p>It is silly that something so basic should be so hard!</p>
<p>TIA<br />
Tracy</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-857">
					<div id="dsq-comment-header-857" class="dsq-comment-header">
						<cite id="dsq-cite-857">
								<span id="dsq-author-user-857">Tracy Spratt</span>
							</cite>
					</div>
					<div id="dsq-comment-body-857" class="dsq-comment-body">
						<div id="dsq-comment-message-857" class="dsq-comment-message"><p>I spoke too soon.  Nothing is working on my win 2003 box.  I have opened up every security resrtiction I can think of.  Rats!<br />
Tracy</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-858">
					<div id="dsq-comment-header-858" class="dsq-comment-header">
						<cite id="dsq-cite-858">
								<span id="dsq-author-user-858">Anupam Srivastava</span>
							</cite>
					</div>
					<div id="dsq-comment-body-858" class="dsq-comment-body">
						<div id="dsq-comment-message-858" class="dsq-comment-message"><p>Hi Brendan,<br />
Your code is really good. However I&#8217;m stuck up at a point. Could you please tell me how do I pass parameters to my batch file?? I have tried giving<br />
psi.Arguments = &#8220;123&#8243; ( in VB)<br />
The code works fine but my batch file does not show any effect of the passed parameter. My batch file is :<br />
copy h1.txt+h2.txt result%1.txt /B</p>
<p>I want the output as result123.txt but it comes as result%1.txt.</p>
<p>What&#8217;s wrong with my code? Is it with batch file code or VB code??</p>
<p>Please help.<br />
Anupam</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-859">
					<div id="dsq-comment-header-859" class="dsq-comment-header">
						<cite id="dsq-cite-859">
								<span id="dsq-author-user-859">James</span>
							</cite>
					</div>
					<div id="dsq-comment-body-859" class="dsq-comment-body">
						<div id="dsq-comment-message-859" class="dsq-comment-message"><p>Wow, just hit this after some searching and hair removing(insert frustration image here).  This was by far the most helpful. </p>
<p>Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-860">
					<div id="dsq-comment-header-860" class="dsq-comment-header">
						<cite id="dsq-cite-860">
								<span id="dsq-author-user-860">vikas kumar</span>
							</cite>
					</div>
					<div id="dsq-comment-body-860" class="dsq-comment-body">
						<div id="dsq-comment-message-860" class="dsq-comment-message"><p>this is my question</p>
<p>i m making a project in which i have to run cmd.exe from client machine</p>
<p>i am making project in asp.net using vb.net</p>
<p>if any one help me out please mail me at</p>
<p><a href="mailto:viks_mumu@yahoo.co.in">viks_mumu@yahoo.co.in</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-861">
					<div id="dsq-comment-header-861" class="dsq-comment-header">
						<cite id="dsq-cite-861">
	http://tinuverma@gmail.com							<span id="dsq-author-user-861">Deepak</span>
							</cite>
					</div>
					<div id="dsq-comment-body-861" class="dsq-comment-body">
						<div id="dsq-comment-message-861" class="dsq-comment-message"><p>ok..tried all of the above. this does not work. W2K3 permissions is killing me. Always getting Access Denied error. I even impersonated as xxx who is admin on the server and has full permissions on network.<br />
Any suggestions?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-862">
					<div id="dsq-comment-header-862" class="dsq-comment-header">
						<cite id="dsq-cite-862">
	http://blog.joycode.com/percyboy/							<span id="dsq-author-user-862">percyboy</span>
							</cite>
					</div>
					<div id="dsq-comment-body-862" class="dsq-comment-body">
						<div id="dsq-comment-message-862" class="dsq-comment-message"><p>The codes really work!<br />
but it doesn&#8217;t support the &#8220;goto label&#8221; grammer.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-863">
					<div id="dsq-comment-header-863" class="dsq-comment-header">
						<cite id="dsq-cite-863">
								<span id="dsq-author-user-863">Kumar</span>
							</cite>
					</div>
					<div id="dsq-comment-body-863" class="dsq-comment-body">
						<div id="dsq-comment-message-863" class="dsq-comment-message"><p>Hi    Yaheya Quazi ,<br />
Thanks ya,we were facing a problem while running .Bat file from local machine throgh ASP.NET application on W2k3 server.But your inputs are great in this issue and we are now able to run the .Bat file on the W2k3 server.</p>
<p>Thanks<br />
Kumar</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-864">
					<div id="dsq-comment-header-864" class="dsq-comment-header">
						<cite id="dsq-cite-864">
								<span id="dsq-author-user-864">P. Ravichandran</span>
							</cite>
					</div>
					<div id="dsq-comment-body-864" class="dsq-comment-body">
						<div id="dsq-comment-message-864" class="dsq-comment-message"><p>On the above given code is not working properly in the ASPX page.  But is working on the Windows Application.  In ASPX page we need to close the input file before close the process.  Here i give the solution.</p>
<p>ProcessStartInfo ProObj = new ProcessStartInfo(&#8220;cmd.exe&#8221;);<br />
ProObj.UseShellExecute = false;<br />
ProObj.RedirectStandardOutput = true;<br />
ProObj.RedirectStandardInput = true;<br />
ProObj.RedirectStandardError = true;</p>
<p>Process proc = System.Diagnostics.Process.Start(ProObj);<br />
StreamReader Sr = File.OpenText(@&#8221;E:\test.bat&#8221;);<br />
StreamReader sOut = proc.StandardOutput;<br />
StreamWriter sIn = proc.StandardInput;</p>
<p>while(Sr.Peek() != -1)<br />
{<br />
          sIn.WriteLine(Sr.ReadLine());<br />
}<br />
Sr.Close(); //We must close it Here not after the process closing<br />
sIn.WriteLine(&#8220;EXIT&#8221;);<br />
sIn.Close();<br />
proc.Close();<br />
string result = sOut.ReadToEnd();<br />
sOut.Close();<br />
Response.Write(result);</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-865">
					<div id="dsq-comment-header-865" class="dsq-comment-header">
						<cite id="dsq-cite-865">
								<span id="dsq-author-user-865">Ipun</span>
							</cite>
					</div>
					<div id="dsq-comment-body-865" class="dsq-comment-body">
						<div id="dsq-comment-message-865" class="dsq-comment-message"><p>no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;<br />
no code works&#8230;&#8230;&#8230;&#8230;&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-866">
					<div id="dsq-comment-header-866" class="dsq-comment-header">
						<cite id="dsq-cite-866">
	http://www.morganpersson.net							<span id="dsq-author-user-866">Morgan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-866" class="dsq-comment-body">
						<div id="dsq-comment-message-866" class="dsq-comment-message"><p>In windows 2003 you need to give Execute permissions to cmd.exe for your application pool user.<br />
I also added a<br />
psi.WindowStyle = ProcessWindowStyle.Hidden<br />
but i dont know if its required.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-867">
					<div id="dsq-comment-header-867" class="dsq-comment-header">
						<cite id="dsq-cite-867">
								<span id="dsq-author-user-867">Sashanan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-867" class="dsq-comment-body">
						<div id="dsq-comment-message-867" class="dsq-comment-message"><p>This code solved my problem, at least. Thanks for sharing.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-868">
					<div id="dsq-comment-header-868" class="dsq-comment-header">
						<cite id="dsq-cite-868">
								<span id="dsq-author-user-868">JOse </span>
							</cite>
					</div>
					<div id="dsq-comment-body-868" class="dsq-comment-body">
						<div id="dsq-comment-message-868" class="dsq-comment-message"><p>dsa</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-869">
					<div id="dsq-comment-header-869" class="dsq-comment-header">
						<cite id="dsq-cite-869">
								<span id="dsq-author-user-869">Sara</span>
							</cite>
					</div>
					<div id="dsq-comment-body-869" class="dsq-comment-body">
						<div id="dsq-comment-message-869" class="dsq-comment-message"><p>Hi there, I am constantly running in problem for calling a batchfile through asp.net. I read your whole article which apparently helped a lot of ppl but unfortunately not me.<br />
I wrote this 3 lines code in VB.Net and it works perfectly fine.<br />
        Dim proc As New System.Diagnostics.Process<br />
        proc.StartInfo.FileName = &#8220;c:\\MyImport\\Convergys.bat&#8221;<br />
        proc.Start()<br />
I tried by all means to run through asp.net(working on server)&#8230;No luck at all.I load my batch file on server as well but didnt work.I have all permissions as per my Network guy.<br />
It just doesnt call batch file thru asp.net.<br />
I dont know how to give all permissions to ASPNET thing. May be that the problem i am having&#8230;.Dont know.<br />
My boss is really mad at me and I want some body&#8217;s help really soon.<br />
I appreciate for your time.<br />
Thanks</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-870">
					<div id="dsq-comment-header-870" class="dsq-comment-header">
						<cite id="dsq-cite-870">
								<span id="dsq-author-user-870">Tonny</span>
							</cite>
					</div>
					<div id="dsq-comment-body-870" class="dsq-comment-body">
						<div id="dsq-comment-message-870" class="dsq-comment-message"><p>Hi, I&#8217;m moving an old conventional .asp application from iis5/w2k to iis6/win2003 and think that i have similar troubles as the .net scenario.</p>
<p>Cmd.exe can start an .exe or .com but when it comes to scripts (.cmd .bat) nothing happens. Not even an error message. </p>
<p>A sample asp code:<br />
  Dim WSH<br />
  Set WSH = server.CreateObject(&#8220;Wscript.Shell&#8221;)<br />
  &#8216;RunString = &#8220;C:\WINDOWS\SYSTEM32\CMD.EXE /D /C C:\foo\calc.exe&#8221; &#8216; Works perfectly<br />
  RunString = &#8220;C:\WINDOWS\SYSTEM32\CMD.EXE /D /C C:\foo\calc.cmd&#8221; &#8216; Script does not start<br />
  &#8216;RunString = &#8220;C:\WINDOWS\SYSTEM32\CMD.EXE /D /C C:\WINDOWS\SYSTEM32\calc.exe&#8221; &#8216; Actually works<br />
  &#8216;RunString = &#8220;C:\WINDOWS\SYSTEM32\CMD.EXE /D /C whoami > C:\foo\hello.txt&#8221; &#8216; Writes &#8220;NT Authority/NETWORK SERVICE&#8221;<br />
  Run = WSH.Run(RunString, 0, false)</p>
<p>I&#8217;ll probably end up writing a .exe that does what the .cmd script does.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-871">
					<div id="dsq-comment-header-871" class="dsq-comment-header">
						<cite id="dsq-cite-871">
								<span id="dsq-author-user-871">Tonny</span>
							</cite>
					</div>
					<div id="dsq-comment-body-871" class="dsq-comment-body">
						<div id="dsq-comment-message-871" class="dsq-comment-message"><p>Hi again.</p>
<p>It turns out that my colleague had the exact same cmd.exe problem as me and i suspect the same goes for .net. Microsoft sended a trace/debug tool to him and asked him to create some logs. Appearantly this cmd.exe behavior isn&#8217;t intended.</p>
<p>Workaround 1:  Make the webuser member of local administrators<br />
Workaround 2:  Call a .vbs instead and let it call the cmd.exe</p>
<p>Of course don&#8217;t use solution 1 for anonymous access (IUSR, IWAM, Network service). Here&#8217;s a sample for my .vbs workaround:</p>
<p>Dim WSH, ErrorLevel<br />
Set WSH = CreateObject(&#8220;Wscript.Shell&#8221;)<br />
RunString = &#8220;C:\WINDOWS\SYSTEM32\CMD.EXE /D /C C:\foo\MyScript.cmd&#8221; &#038; _<br />
	&#8221; &#8220;&#8221;" &#038; wscript.arguments.item(0) &#038; &#8220;&#8221;"&#8221; &#038; _<br />
	&#8221; &#8220;&#8221;" &#038; wscript.arguments.item(1) &#038; &#8220;&#8221;"&#8221; &#038; _<br />
	&#8221; &#8220;&#8221;" &#038; wscript.arguments.item(2) &#038; &#8220;&#8221;"&#8221; &#038; _<br />
	&#8221; &#8220;&#8221;" &#038; wscript.arguments.item(3) &#038; &#8220;&#8221;"&#8221;<br />
ErrorLevel = WSH.Run(RunString, 0, false)<br />
Set WSH = Nothing<br />
Wscript.Quit ErrorLevel</p>
<p>Hope this can be of some inspiration to the asp.net problem.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-872">
					<div id="dsq-comment-header-872" class="dsq-comment-header">
						<cite id="dsq-cite-872">
	http://www.mobilnova.com							<span id="dsq-author-user-872">Dennis</span>
							</cite>
					</div>
					<div id="dsq-comment-body-872" class="dsq-comment-body">
						<div id="dsq-comment-message-872" class="dsq-comment-message"><p>Passing parameters to a batch file</p>
<p>This is the first thing that came to my mind after running the cool solution.<br />
the trick was devised from the code itself: if you can write to input stream  the command line from the batch file, why not write a command with a batch file  + parameters. I e </p>
<p>  System.IO.StreamWriter sIn = proc.StandardInput;<br />
        // Write a line with batch file and parameters to standard input</p>
<p>        sIn.WriteLine(&#8220;build.bat &#8221;  +  param);<br />
&#8230;</p>
<p>Thus a bat file with<br />
dir %1<br />
command can be controlled with parameters (/b /s /? etc)<br />
<a href="http://localhost:3206/VisualStudio/Default.aspx?param=/b" rel="nofollow">http://localhost:3206/VisualStudio/Default.aspx?param=/b</a></p>
<p>The result is </p>
<p>C:\_dennis\VisualStudio>dir /b<br />
App_Data<br />
build.bat<br />
Default.aspx<br />
Default.aspx.cs</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-873">
					<div id="dsq-comment-header-873" class="dsq-comment-header">
						<cite id="dsq-cite-873">
								<span id="dsq-author-user-873">Dino</span>
							</cite>
					</div>
					<div id="dsq-comment-body-873" class="dsq-comment-body">
						<div id="dsq-comment-message-873" class="dsq-comment-message"><p>Can someone tell me if the same issue exists with classic ASP under SBS2K3? And perhaps provide an example?</p>
<p>I am trying to run commands executables and batch files etc from classic asp and seem to be getting the same issues &#8220;Access denied&#8221; etc, I&#8217;ve tried the IUSR_ permissons thing but not had any luck yet, will have another go, and alter webconfig as well (first time i read that advice was here <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> .</p>
<p>Actually one problem is I don&#8217;t seem to be able to run a batch file from the command line at all? I can create it, click it in file explorer, and it runs fine, but if I open a command prompt, navigate to that directory, and type its name I get &#8221; &#8216;test.bat&#8217; is not recognized as an internal or external command, operable program or batch file.&#8221; So what going on here? Why cant I just run the batch file from the command line?</p>
<p>Many thanks for any help.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-874">
					<div id="dsq-comment-header-874" class="dsq-comment-header">
						<cite id="dsq-cite-874">
								<span id="dsq-author-user-874">Dino</span>
							</cite>
					</div>
					<div id="dsq-comment-body-874" class="dsq-comment-body">
						<div id="dsq-comment-message-874" class="dsq-comment-message"><p>Ok have the batch file running from command line now! but having made the relevant IUSR permission changes, I can access the batch file from asp but it does not actually execute. For example i have a simple batch file that just echos some text to a text file (IUSR has read execute permisssions to the batch file and cmd.exe and full permissions to the text file). If intentionally use the wrong batch filename i get the appropriate error, now with teh correct batch file name i get no error, but equally no execution, nothing appears in the text file?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-875">
					<div id="dsq-comment-header-875" class="dsq-comment-header">
						<cite id="dsq-cite-875">
								<span id="dsq-author-user-875">Samir</span>
							</cite>
					</div>
					<div id="dsq-comment-body-875" class="dsq-comment-body">
						<div id="dsq-comment-message-875" class="dsq-comment-message"><p>Dino, did you resolve it yet? I have the same problem&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-876">
					<div id="dsq-comment-header-876" class="dsq-comment-header">
						<cite id="dsq-cite-876">
								<span id="dsq-author-user-876">Gear</span>
							</cite>
					</div>
					<div id="dsq-comment-body-876" class="dsq-comment-body">
						<div id="dsq-comment-message-876" class="dsq-comment-message"><p>God, I&#8217;ve been struglying with it since 2 days now.</p>
<p>I did everything imaginable to make ASP.NET 2.0 execute a simple batchfile and I always get Access Denied</p>
<p>I tell you,  IIS, ASP.NET ACCOUNT, Impersonation, URLSCAN, Permissions etc&#8230;etc&#8230;etc, all you can imagine have been tested.  So what else now</p>
<p>Windows 2000 server running IIS5.0<br />
ASP.NET 2.0.50727<br />
C# app which uses Process.Start() to start the batch file<br />
Always get Access Denied.<br />
BUT&#8230;&#8230;&#8230;. I can copy files to the directory, Create file to the directory, can do a lot of things but not executing a simple batch file</p>
<p>Yeah right</p>
<p><a href="mailto:geardoom3@gmail.com">geardoom3@gmail.com</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-877">
					<div id="dsq-comment-header-877" class="dsq-comment-header">
						<cite id="dsq-cite-877">
	http://geekswithblogs.net/mahesh							<span id="dsq-author-user-877">Mahesh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-877" class="dsq-comment-body">
						<div id="dsq-comment-message-877" class="dsq-comment-message"><p>might this helps you<br />
<a href="http://geekswithblogs.net/mahesh/archive/2006/09/15/91269.aspx" rel="nofollow">http://geekswithblogs.net/mahesh/archive/2006/09/15/91269.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-878">
					<div id="dsq-comment-header-878" class="dsq-comment-header">
						<cite id="dsq-cite-878">
								<span id="dsq-author-user-878">Gennady</span>
							</cite>
					</div>
					<div id="dsq-comment-body-878" class="dsq-comment-body">
						<div id="dsq-comment-message-878" class="dsq-comment-message"><p>When ASP.NET is running under IIS 6 (Windows 2003) in native mode, the IIS 6 process model is used and settings in this section (<processModel from %windir%\Microsoft.NET\Framework\v1.1.4322\CONFIG\ machine.config) are ignored.  Please use the IIS administrative UI to configure things like process identity and cycling for the IIS worker process for the desired application.</p>
<p>If you change it to Local System for Application Pull in IIS and for &#8220;ASP.NET State Service&#8221; service account in services you will be able to run anything from ASP.NET</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-879">
					<div id="dsq-comment-header-879" class="dsq-comment-header">
						<cite id="dsq-cite-879">
								<span id="dsq-author-user-879">Maurilio Martini</span>
							</cite>
					</div>
					<div id="dsq-comment-body-879" class="dsq-comment-body">
						<div id="dsq-comment-message-879" class="dsq-comment-message"><p>Great Stuff!! [}}:-))</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-880">
					<div id="dsq-comment-header-880" class="dsq-comment-header">
						<cite id="dsq-cite-880">
								<span id="dsq-author-user-880">Mick T</span>
							</cite>
					</div>
					<div id="dsq-comment-body-880" class="dsq-comment-body">
						<div id="dsq-comment-message-880" class="dsq-comment-message"><p>I&#8217;ve been messing with this sort of thing so I can remotely do things like opening an MP3 or running an EXE. What I would like is to be able to have a window pop up on my screen (the servers screen) and be able to send keys to it through ASP.Net but the process belongs to the ASPNET user not the user logged in. I&#8217;m using XP SP2.</p>
<p> Is there any way for me to either log on as the ASPNET user or have the process belong to the logged in user (or some other way).</p>
<p>Thanks</p>
<p>Mick</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-881">
					<div id="dsq-comment-header-881" class="dsq-comment-header">
						<cite id="dsq-cite-881">
								<span id="dsq-author-user-881">Lynda</span>
							</cite>
					</div>
					<div id="dsq-comment-body-881" class="dsq-comment-body">
						<div id="dsq-comment-message-881" class="dsq-comment-message"><p>The information here is great.  I used it to successfully run a bat file from CMD.exe for both XP Pro and Server 2003.  I am having one issue and would appreciate anyone&#8217;s thoughts and suggestions on how to resolve.</p>
<p>My web application runs a package software which can be started from command line.  I saved this line as my bat file.  When I double click the bat file on Server 2003, the package runs indicated with the creation of an output file.  When I run it from my web app, the name of the software shows in Task Manager but the output file is not created. When I run my web app on my XP pro device native (http:\\localhost\&#8230;), the process works and the output file is created.  I have Visual Studio installed on my XP Pro device.</p>
<p>To confirm that the process is working on Server 2003, I wrote another bat file that copies one file to another.  I ran that bat file from web application on Server 2003 and the copied file is created.  It appears that this code is working on Server 2003.</p>
<p>What would cause this to not work on Server 2003 for that package software?  Any suggestions on where to look or how to resolve this issue would be appreciated.</p>
<p>Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-882">
					<div id="dsq-comment-header-882" class="dsq-comment-header">
						<cite id="dsq-cite-882">
								<span id="dsq-author-user-882">DINESH</span>
							</cite>
					</div>
					<div id="dsq-comment-body-882" class="dsq-comment-body">
						<div id="dsq-comment-message-882" class="dsq-comment-message"><p>DEAR ALL,<br />
I HAVE WRITTEN A CODE IN VB TO EXECUTE AN EXE FILE THE CODE IS AS FOLLOWS<br />
        &#8216;Create process to create a user in Linux machine<br />
        Dim myProcessStartInfo As New ProcessStartInfo()<br />
        myProcessStartInfo.WorkingDirectory = &#8220;C:\&#8221;<br />
        myProcessStartInfo.FileName = &#8220;c:\plink.exe&#8221;<br />
        myProcessStartInfo.RedirectStandardOutput = True<br />
        myProcessStartInfo.RedirectStandardInput = False<br />
        myProcessStartInfo.UseShellExecute = False</p>
<p>        myProcessStartInfo.Arguments = &#8220;-pw &#8221; &#038; Login1.Password &#038; &#8221; &#8221; &#038; Login1.UserName &#038; &#8220;@192.168.116.77 ls &#8221;<br />
        &#8216;Start the process<br />
        Dim myProcess As Process<br />
        Dim myStreamReader As IO.StreamReader<br />
        myProcess = Process.Start(myProcessStartInfo)<br />
        myProcess.WaitForExit(2000)<br />
        If myProcess.HasExited Then<br />
            e.Authenticated = True<br />
            myStreamReader = myProcess.StandardOutput<br />
            Dim myString As String = myStreamReader.ReadToEnd<br />
            Label1.Text = myString<br />
            Session(&#8220;UserName&#8221;) = Login1.UserName<br />
            Session(&#8220;Password&#8221;) = Login1.Password<br />
            myStreamReader.Close()<br />
        Else<br />
            e.Authenticated = False<br />
            Label1.Text = &#8220;Could Not Completed in Allocated Time Slot !!!&#8221;<br />
            myProcess.Kill()<br />
        End If<br />
        myProcess.Close()<br />
I am Executing a plink.exe file this works 100% perfectly in &#8220;View in Browser&#8221; mode but wen i execute it like &#8220;http://localhost/&#8230;..aspx&#8221; it says &#8220;Could Not Completed in Allocated Time Slot !!!&#8221; This is really really frustrating can someone please help.<br />
Further I have added <identity impersonate="true"/> in my web.config and in IIS document Security I have ticked allow anonymus access and given ASPNET Administrator level authority What Else I can do other Than hang my self !!!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-883">
					<div id="dsq-comment-header-883" class="dsq-comment-header">
						<cite id="dsq-cite-883">
								<span id="dsq-author-user-883">Naags</span>
							</cite>
					</div>
					<div id="dsq-comment-body-883" class="dsq-comment-body">
						<div id="dsq-comment-message-883" class="dsq-comment-message"><p>Hi,<br />
i was trying to run an application(for e.g., notepad) thru the batch file.But my application hangs, i could see the notepad process running in the task manager, but i could not see the command window or notepad. </p>
<p>If my batch file has del or copy command it works eventhough i could not see the command window. </p>
<p>i have set integrated windows authentication and identity impersonate=true. </p>
<p>could u please shed a light on this</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-884">
					<div id="dsq-comment-header-884" class="dsq-comment-header">
						<cite id="dsq-cite-884">
								<span id="dsq-author-user-884">Code Smith</span>
							</cite>
					</div>
					<div id="dsq-comment-body-884" class="dsq-comment-body">
						<div id="dsq-comment-message-884" class="dsq-comment-message"><p>Hi,<br />
i was trying to run an web application(for e.g., notepad) thru the batch file which developed using C#, asp.net.But my web application hangs, i could not see the command window or notepad when running from IIS Virtual Directory (<a href="http://localhost/app/filename.aspx" rel="nofollow">http://localhost/app/filename.aspx</a>). </p>
<p>i have set integrated windows authentication and identity impersonate=true. </p>
<p>could u please shed a light on this</p>
<p>Thanks</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-885">
					<div id="dsq-comment-header-885" class="dsq-comment-header">
						<cite id="dsq-cite-885">
								<span id="dsq-author-user-885">Dinesh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-885" class="dsq-comment-body">
						<div id="dsq-comment-message-885" class="dsq-comment-message"><p>Hi Guys,<br />
I found an answer that would help most of you I think, It works for me. You give the following command before starting the process.</p>
<p> Dim _password As New System.Security.SecureString<br />
 Dim password As String<br />
 password = <your Password As String><br />
&#8216;This Part is important cause you cannot directly assign string variable to security string<br />
        For Each c As Char In password<br />
            _password.AppendChar(c)<br />
        Next</p>
<p>        Dim myProcessStartInfo As New ProcessStartInfo()</p>
<p>        myProcessStartInfo.LoadUserProfile = True</p>
<p>        myProcessStartInfo.LoadUserProfile = True<br />
        myProcessStartInfo.UserName = &#8220;Administrator&#8221;(Any User Name in Server)<br />
        myProcessStartInfo.Password = _password</your></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-886">
					<div id="dsq-comment-header-886" class="dsq-comment-header">
						<cite id="dsq-cite-886">
								<span id="dsq-author-user-886">Topcat</span>
							</cite>
					</div>
					<div id="dsq-comment-body-886" class="dsq-comment-body">
						<div id="dsq-comment-message-886" class="dsq-comment-message"><p>Good job! this is exactly what I needed.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-887">
					<div id="dsq-comment-header-887" class="dsq-comment-header">
						<cite id="dsq-cite-887">
	http://don&#039;tforget,DRIVELETTERvs.UNCPATH(2000vs2003)							<span id="dsq-author-user-887">Jeff</span>
							</cite>
					</div>
					<div id="dsq-comment-body-887" class="dsq-comment-body">
						<div id="dsq-comment-message-887" class="dsq-comment-message"><p>OK, one native difference in 2000 vs. 2003 server is that in 2000 the o/s allowed<br />
you to recognize c:\ g:\ , etc. &#8211; whatever logical drive mapping, BUT<br />
in 2003 Server, the difference is that, unless you use very specific interactive<br />
login credentials, you must use UNC path instead of &#8220;logical drive mapping.&#8221;</p>
<p>So.. fo processes without discreet &#8216;interactive context&#8217; (like when jsmith logs<br />
in interactively), try using \\servername\path\file.bat<br />
and when piping out use \\servername\path\file.bat > \\servername\path\file.txt</p>
<p>&#8220;path&#8221; being a valid UNC path of course.</p>
<p>That is one big problem I have seen.</p>
<p>Cheers!<br />
Jeff</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-888">
					<div id="dsq-comment-header-888" class="dsq-comment-header">
						<cite id="dsq-cite-888">
								<span id="dsq-author-user-888">Zen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-888" class="dsq-comment-body">
						<div id="dsq-comment-message-888" class="dsq-comment-message"><p>I hope this helps, it worked for me. I can now execute batch and exe. All I did was create a new application pool and assign it Local System as user and waaalaaa&#8230;&#8230;</p>
<p>Check this article out.<br />
<a href="http://west-wind.com/weblog/posts/2153.aspx" rel="nofollow">http://west-wind.com/weblog/posts/2153.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-889">
					<div id="dsq-comment-header-889" class="dsq-comment-header">
						<cite id="dsq-cite-889">
								<span id="dsq-author-user-889">John</span>
							</cite>
					</div>
					<div id="dsq-comment-body-889" class="dsq-comment-body">
						<div id="dsq-comment-message-889" class="dsq-comment-message"><p>I used a same code to call a bat file remotely I don&#8217;t received any  error, but the bat file do not execute !!!<br />
 I used<br />
objProc.StartInfo.WorkingDirectory= &#8220;\\<someipadderss \\c$"</p>
<p>objProc.StartInfo.FileName ="\\<someIPAdderss>\\c$\Test.bat&#8221;</someipadderss></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-890">
					<div id="dsq-comment-header-890" class="dsq-comment-header">
						<cite id="dsq-cite-890">
								<span id="dsq-author-user-890">redsv</span>
							</cite>
					</div>
					<div id="dsq-comment-body-890" class="dsq-comment-body">
						<div id="dsq-comment-message-890" class="dsq-comment-message"><p>Hi All,<br />
In my .bat file i have a command line which returns some sysout.<br />
that sysout i want to capture from vb.net.<br />
is it possible?</p>
<p>if i use below code, it is returning only the commanline which is there in bat file.</p>
<p>Dim listfiles As System.Diagnostics.Process<br />
listfiles = System.Diagnostics.Process.Start(psi)<br />
Streamreader = listfiles.StandardOutput<br />
please help</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-891">
					<div id="dsq-comment-header-891" class="dsq-comment-header">
						<cite id="dsq-cite-891">
								<span id="dsq-author-user-891">Ray</span>
							</cite>
					</div>
					<div id="dsq-comment-body-891" class="dsq-comment-body">
						<div id="dsq-comment-message-891" class="dsq-comment-message"><p>I am trying to run the batch file which contains</p>
<p>(CScript LCSAddACEs.wsf /usersfile:userfile.txt /acesfile:acesFile.txt>PrintFile.txt).</p>
<p>This does adding the domain/domains to the specifed user.</p>
<p>1.with windows application ran successfully.added domain to specified user.<br />
2.With web application(ASP.NET) not ran sucessfully.not able add domain to specified user.</p>
<p>Anybody has idia on this? If need more information on this issue let me know i will provide</p>
<p>Thanks in advance.<br />
Ray</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-892">
					<div id="dsq-comment-header-892" class="dsq-comment-header">
						<cite id="dsq-cite-892">
								<span id="dsq-author-user-892">Yinon</span>
							</cite>
					</div>
					<div id="dsq-comment-body-892" class="dsq-comment-body">
						<div id="dsq-comment-message-892" class="dsq-comment-message"><p>10x a lot &#8230; finaly it works &#8230; <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> )</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-893">
					<div id="dsq-comment-header-893" class="dsq-comment-header">
						<cite id="dsq-cite-893">
								<span id="dsq-author-user-893">W@nderlust</span>
							</cite>
					</div>
					<div id="dsq-comment-body-893" class="dsq-comment-body">
						<div id="dsq-comment-message-893" class="dsq-comment-message"><p>OK, for the ones having troubles running an EXE OR BAT on an ASP.NET, in W2k3, here is what worked for me:</p>
<p>1) In the IIS, right click on the Application Pool where you have the website running, select Properties, and then under &#8220;Identity tab&#8221;, change the security account to &#8220;LOCAL SYSTEM&#8221; (where says Predefined).</p>
<p>2) In ASP.NET use this code:</p>
<p>        ProcessStartInfo psi = new ProcessStartInfo(@&#8221;C:\TheExe.exe&#8221;);<br />
        psi.UseShellExecute = false;</p>
<p>        psi.RedirectStandardOutput = true;<br />
        psi.RedirectStandardInput = true;<br />
        psi.RedirectStandardError = true;</p>
<p>        psi.WindowStyle = ProcessWindowStyle.Hidden;<br />
        psi.WorkingDirectory = @&#8221;C:\TheWorkingDirectory&#8221;;</p>
<p>        psi.Arguments = @&#8221;The Arguments For The Exe&#8221;;</p>
<p>        Process proc = Process.Start(psi);</p>
<p>(Of course changing the name of your exe, working directory, and arguments).</p>
<p>Hope this helps. If not, write something to a DB and make a windows service to check the DB, and if the DB changed, then fire your exe from the C# service. That was PLAN B!! <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' />  <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' />  <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' /> </p>
<p>Enjoy.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-894">
					<div id="dsq-comment-header-894" class="dsq-comment-header">
						<cite id="dsq-cite-894">
								<span id="dsq-author-user-894">CryyL</span>
							</cite>
					</div>
					<div id="dsq-comment-body-894" class="dsq-comment-body">
						<div id="dsq-comment-message-894" class="dsq-comment-message"><p>It worked for me! Thanks W@nderlust! Good post.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-895">
					<div id="dsq-comment-header-895" class="dsq-comment-header">
						<cite id="dsq-cite-895">
								<span id="dsq-author-user-895">snickss</span>
							</cite>
					</div>
					<div id="dsq-comment-body-895" class="dsq-comment-body">
						<div id="dsq-comment-message-895" class="dsq-comment-message"><p>I am having problems with running this code on W2K3. I was getting Access Denied errors, but after adding permissions for IUSR to the bat file the error now is &#8220;Could not read key from registry&#8221;. I tried to track down the registry key the bat is trying to access, but there were hundreds of them.</p>
<p>Any help would be appreciated.</p>
<p>Thanks.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-896">
					<div id="dsq-comment-header-896" class="dsq-comment-header">
						<cite id="dsq-cite-896">
								<span id="dsq-author-user-896">MarkyTheMark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-896" class="dsq-comment-body">
						<div id="dsq-comment-message-896" class="dsq-comment-message"><p>W@nderlust you&#8217;re a saviour! I have spent hours on this to no avail!</p>
<p>seems so easy when you thinkabout it,but I still can&#8217;t get my batch file to run funcions cross-servers? </p>
<p>any further thoughts anyone?</p>
<p>thanks all</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-897">
					<div id="dsq-comment-header-897" class="dsq-comment-header">
						<cite id="dsq-cite-897">
	http://dd							<span id="dsq-author-user-897">Shashanka</span>
							</cite>
					</div>
					<div id="dsq-comment-body-897" class="dsq-comment-body">
						<div id="dsq-comment-message-897" class="dsq-comment-message"><p>Hi,<br />
   I used this<br />
actually the batch file is not opening but it shows that it is running<br />
to open what should i do ??</p>
<p>i got this type of message</p>
<p>Microsoft Windows 2000 [Version 5.00.2195]<br />
(C) Copyright 1985-2000 Microsoft Corp.</p>
<p>C:\WINNT>\\gmindia\Goldmine\gmw6.exe</p>
<p>C:\WINNT># C:\Documents and Settings\idml\Desktop\a.bat run successfully. Exiting</p>
<p>C:\WINNT>EXIT<br />
   Emp Name :</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-898">
					<div id="dsq-comment-header-898" class="dsq-comment-header">
						<cite id="dsq-cite-898">
	http://aa							<span id="dsq-author-user-898">Shashanka</span>
							</cite>
					</div>
					<div id="dsq-comment-body-898" class="dsq-comment-body">
						<div id="dsq-comment-message-898" class="dsq-comment-message"><p>Hi ALL,</p>
<p>Thanks<br />
It is solved<br />
<b><a href="http:\\www.website.com\flower\shashanka.exe">Click here for the exe/bat file called A.</a></b></p>
<p>Regards<br />
Shashanka</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-899">
					<div id="dsq-comment-header-899" class="dsq-comment-header">
						<cite id="dsq-cite-899">
								<span id="dsq-author-user-899">Rob</span>
							</cite>
					</div>
					<div id="dsq-comment-body-899" class="dsq-comment-body">
						<div id="dsq-comment-message-899" class="dsq-comment-message"><p>I don&#8217;t know why all the other 15000 different ways to run a batch file I&#8217;ve seen out there don&#8217;t work, but this one did the trick.  Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-900">
					<div id="dsq-comment-header-900" class="dsq-comment-header">
						<cite id="dsq-cite-900">
								<span id="dsq-author-user-900">Vinayak.N</span>
							</cite>
					</div>
					<div id="dsq-comment-body-900" class="dsq-comment-body">
						<div id="dsq-comment-message-900" class="dsq-comment-message"><p>iam trying for past one week to run an exe from ASP.NET. it start an process as Network service but not as an administrator. if i double click on exe it run the process as administrator and exe works. i tried all the ways like runnig as exe, as bat file, using impersonation passing user name and password. do any one have solution.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-901">
					<div id="dsq-comment-header-901" class="dsq-comment-header">
						<cite id="dsq-cite-901">
								<span id="dsq-author-user-901">ananda</span>
							</cite>
					</div>
					<div id="dsq-comment-body-901" class="dsq-comment-body">
						<div id="dsq-comment-message-901" class="dsq-comment-message"><p>Hi,<br />
 I want to execute the command<br />
mysql -u root -p  databasename > filename.sql<br />
in order to take the backup of the mysql database<br />
how can i do this</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-902">
					<div id="dsq-comment-header-902" class="dsq-comment-header">
						<cite id="dsq-cite-902">
								<span id="dsq-author-user-902">Rak</span>
							</cite>
					</div>
					<div id="dsq-comment-body-902" class="dsq-comment-body">
						<div id="dsq-comment-message-902" class="dsq-comment-message"><p>Nice bit of code there Brendan &#8211; I now finally figured out why I can&#8217;t create my Oracle database on IIS through a web application, output provied a lot of information!</p>
<p>Using the following code I had before, I was able to execute the batch without any problems:</p>
<p>ProcessStartInfo pInfo = new ProcessStartInfo(@&#8221;C:\createdb.bat&#8221;);<br />
pInfo.WindowStyle = ProcessWindowStyle.Normal;<br />
pInfo.UseShellExecute = false;</p>
<p>int ExitCode = -1;<br />
try<br />
{<br />
    Process process = Process.Start(pInfo);<br />
    while (process.HasExited == false)<br />
    {<br />
        process.Refresh();<br />
        Thread.Sleep(1000);<br />
    }</p>
<p>    ExitCode = process.ExitCode;<br />
    process.Close();<br />
}<br />
catch (Exception exp)<br />
{<br />
    // Error<br />
}</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-903">
					<div id="dsq-comment-header-903" class="dsq-comment-header">
						<cite id="dsq-cite-903">
								<span id="dsq-author-user-903">Imran</span>
							</cite>
					</div>
					<div id="dsq-comment-body-903" class="dsq-comment-body">
						<div id="dsq-comment-message-903" class="dsq-comment-message"><p>Just i want to pass date as parameter to my batch file.<br />
Below is my code:<br />
psi.Arguments = &#8220;3/13/2007&#8243;;<br />
In my batch file<br />
XCOPY C:\Sample\EdFi c:\Imran\Build /D:%%1</p>
<p>The files are not copied to destination folder.</p>
<p>Can anyone help on this.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-904">
					<div id="dsq-comment-header-904" class="dsq-comment-header">
						<cite id="dsq-cite-904">
								<span id="dsq-author-user-904">larry miller</span>
							</cite>
					</div>
					<div id="dsq-comment-body-904" class="dsq-comment-body">
						<div id="dsq-comment-message-904" class="dsq-comment-message"><p>how can i get the output into a different window so as not to disturb the current page they are on.  (using asp.net, c#)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-905">
					<div id="dsq-comment-header-905" class="dsq-comment-header">
						<cite id="dsq-cite-905">
								<span id="dsq-author-user-905">sowmya</span>
							</cite>
					</div>
					<div id="dsq-comment-body-905" class="dsq-comment-body">
						<div id="dsq-comment-message-905" class="dsq-comment-message"><p>how can i give the remote machine&#8217;s path as working directory???</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-906">
					<div id="dsq-comment-header-906" class="dsq-comment-header">
						<cite id="dsq-cite-906">
								<span id="dsq-author-user-906">Anju</span>
							</cite>
					</div>
					<div id="dsq-comment-body-906" class="dsq-comment-body">
						<div id="dsq-comment-message-906" class="dsq-comment-message"><p>will somebody tell me how to pass arguments while executing vbs especially while using the following format Dim strFilePath As String = &#8220;c:\\temp\\test.bat&#8221; </p>
<p>Dim psi As System.Diagnostics.ProcessStartInfo = New System.Diagnostics.ProcessStartInfo(&#8220;cmd.exe&#8221;)<br />
psi.UseShellExecute = False<br />
psi.RedirectStandardOutput = True<br />
psi.RedirectStandardInput = True<br />
psi.RedirectStandardError = True<br />
psi.WorkingDirectory = &#8220;c:\\temp\\&#8221; </p>
<p>Dim proc As System.Diagnostics.Process = System.Diagnostics.Process.Start(psi)<br />
Dim strm As System.IO.StreamReader = System.IO.File.OpenText(strFilePath)<br />
Dim sout As System.IO.StreamReader = proc.StandardOutput<br />
Dim sin As System.IO.StreamWriter = proc.StandardInput </p>
<p>While strm.Peek() <> -1<br />
sin.WriteLine(strm.ReadLine())<br />
End While </p>
<p>strm.Close() </p>
<p>Dim stEchoFmt As String = &#8220;# {0} run successfully. Exiting&#8221;<br />
sin.WriteLine(String.Format(stEchoFmt, strFilePath))<br />
sin.WriteLine(&#8220;EXIT&#8221;)<br />
proc.Close() </p>
<p>sin.Close()<br />
sout.Close()</p>
<p>i have been trying to execute a vbs which creates subdomain thru asp.net but its not working i am using windows 2003 and iis 6 ..<br />
The vbs works when executed thru cmd prompt but not thru asp.net .<br />
Please suggest a solution<br />
thank u</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-907">
					<div id="dsq-comment-header-907" class="dsq-comment-header">
						<cite id="dsq-cite-907">
								<span id="dsq-author-user-907">jagadish d</span>
							</cite>
					</div>
					<div id="dsq-comment-body-907" class="dsq-comment-body">
						<div id="dsq-comment-message-907" class="dsq-comment-message"><p>am try to run a series of batch files through a web application. For each batch file to run there are seperate functions. Below posted is the function for to run one batch file. After one batch file is executed the thread exits with an exception without executing next code in the page. I think internally the page execution end occurs. How to avoid this?</p>
<p>i., the thread exit with this exception</p>
<p>A first chance exception of type &#8216;System.Threading.ThreadAbortException&#8217; occurred in mscorlib.dll</p>
<p>Any help would be appraciated.</p>
<p>try</p>
<p>{</p>
<p>string strFilePath =  + &#8220;c:\\test\\test.bat&#8221;;<br />
System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo(strFilePath);</p>
<p>psi.UseShellExecute = false;<br />
psi.RedirectStandardOutput = true;</p>
<p>psi.RedirectStandardInput = true;<br />
psi.RedirectStandardError = true;</p>
<p>psi.WorkingDirectory = &#8220;c:\\inetpub\\wwwroot\\test\\bin\\&#8221;;System.Diagnostics.Process proc = new System.Diagnostics.Process();<br />
proc.StartInfo = psi; </p>
<p>proc.Start();</p>
<p>while (!proc.HasExited)<br />
{</p>
<p>proc.Refresh();</p>
<p>Thread.Sleep(1000);<br />
} </p>
<p>proc.Close(); </p>
<p>}</p>
<p>catch (Exception ex)<br />
{</p>
<p>}</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-908">
					<div id="dsq-comment-header-908" class="dsq-comment-header">
						<cite id="dsq-cite-908">
								<span id="dsq-author-user-908">Sam</span>
							</cite>
					</div>
					<div id="dsq-comment-body-908" class="dsq-comment-body">
						<div id="dsq-comment-message-908" class="dsq-comment-message"><p>This looks great and this is exactly what i need but&#8230;</p>
<p>Could someone please tell me how to use this code?<br />
do i need to compile it? what software do i need for it.<br />
(i have IIS up and running and have knowledge of building webpages)</p>
<p>The last time i programmed something was way back in time.<br />
(borland C and pasqal :- )</p>
<p>Thanks in advance !!!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-909">
					<div id="dsq-comment-header-909" class="dsq-comment-header">
						<cite id="dsq-cite-909">
								<span id="dsq-author-user-909">Ian</span>
							</cite>
					</div>
					<div id="dsq-comment-body-909" class="dsq-comment-body">
						<div id="dsq-comment-message-909" class="dsq-comment-message"><p>before you waste time check this post out, it really a good starting point.</p>
<p><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;555134" rel="nofollow">http://support.microsoft.com/default.aspx?scid=kb;en-us;555134</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-910">
					<div id="dsq-comment-header-910" class="dsq-comment-header">
						<cite id="dsq-cite-910">
	http://www.bompee.com							<span id="dsq-author-user-910">Ian</span>
							</cite>
					</div>
					<div id="dsq-comment-body-910" class="dsq-comment-body">
						<div id="dsq-comment-message-910" class="dsq-comment-message"><p>try this for instance</p>
<p>protected void Page_Load(object sender, EventArgs e)<br />
    {<br />
        string filepath = Server.MapPath(&#8220;me.bat&#8221;);<br />
        Response.Write(&#8220;cmd.exe /c &#8221; + filepath);<br />
        System.Diagnostics.Process.Start(&#8220;cmd.exe&#8221;, &#8220;/c &#8221;  + filepath );</p>
<p>    }</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-911">
					<div id="dsq-comment-header-911" class="dsq-comment-header">
						<cite id="dsq-cite-911">
								<span id="dsq-author-user-911">santosh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-911" class="dsq-comment-body">
						<div id="dsq-comment-message-911" class="dsq-comment-message"><p>my bat file appears to run fine as the output lines shows each line of my bat file being executed. However, i don&#8217;t get the result that i get normally while executing the bat file manually. The bat file simply dumps a mysql database. I have provided full control to the application. Can anyone help?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-912">
					<div id="dsq-comment-header-912" class="dsq-comment-header">
						<cite id="dsq-cite-912">
								<span id="dsq-author-user-912">santosh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-912" class="dsq-comment-body">
						<div id="dsq-comment-message-912" class="dsq-comment-message"><p>it works fine now. the application did not have the permission to write the dump file on the specified location.</p>
<p>Anyway, does anybody know how I can pass arguments to the bat file.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-913">
					<div id="dsq-comment-header-913" class="dsq-comment-header">
						<cite id="dsq-cite-913">
								<span id="dsq-author-user-913">Raj</span>
							</cite>
					</div>
					<div id="dsq-comment-body-913" class="dsq-comment-body">
						<div id="dsq-comment-message-913" class="dsq-comment-message"><p>Hi I am trying to start bat file which is executed properly in .net development server and not in iis</p>
<p>can any one suggest the best way. </p>
<p>i tried all the above process, codes are fine but things are not working properly in iis. i am using windows xp professional</p>
<p>thanks<br />
Raj</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-914">
					<div id="dsq-comment-header-914" class="dsq-comment-header">
						<cite id="dsq-cite-914">
								<span id="dsq-author-user-914">Cheng Zhang</span>
							</cite>
					</div>
					<div id="dsq-comment-body-914" class="dsq-comment-body">
						<div id="dsq-comment-message-914" class="dsq-comment-message"><p>Thanks so much for your sharing! It really works. It rocks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-915">
					<div id="dsq-comment-header-915" class="dsq-comment-header">
						<cite id="dsq-cite-915">
								<span id="dsq-author-user-915">Rajani Karthik</span>
							</cite>
					</div>
					<div id="dsq-comment-body-915" class="dsq-comment-body">
						<div id="dsq-comment-message-915" class="dsq-comment-message"><p>Hey&#8230;&#8230;.I got it. thanks everyone</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-916">
					<div id="dsq-comment-header-916" class="dsq-comment-header">
						<cite id="dsq-cite-916">
								<span id="dsq-author-user-916">Ryan</span>
							</cite>
					</div>
					<div id="dsq-comment-body-916" class="dsq-comment-body">
						<div id="dsq-comment-message-916" class="dsq-comment-message"><p>Thanks W@nderlust!!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-917">
					<div id="dsq-comment-header-917" class="dsq-comment-header">
						<cite id="dsq-cite-917">
								<span id="dsq-author-user-917">Mark</span>
							</cite>
					</div>
					<div id="dsq-comment-body-917" class="dsq-comment-body">
						<div id="dsq-comment-message-917" class="dsq-comment-message"><p>The example from W@nderlust works for me. I did not try the other examples.</p>
<p>Thanks W@nderlust</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-918">
					<div id="dsq-comment-header-918" class="dsq-comment-header">
						<cite id="dsq-cite-918">
								<span id="dsq-author-user-918">RIck</span>
							</cite>
					</div>
					<div id="dsq-comment-body-918" class="dsq-comment-body">
						<div id="dsq-comment-message-918" class="dsq-comment-message"><p>I have tried all of the above examples and I am still having problems executing a batch file on Server 2003. Everything works fine on my local machine but when I move it to the server I don&#8217;t receive anything when I click on a link to call the batch file. Any other suggestions? This information has been very helpful</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-919">
					<div id="dsq-comment-header-919" class="dsq-comment-header">
						<cite id="dsq-cite-919">
								<span id="dsq-author-user-919">sharad</span>
							</cite>
					</div>
					<div id="dsq-comment-body-919" class="dsq-comment-body">
						<div id="dsq-comment-message-919" class="dsq-comment-message"><p>it seems like all the above solutions work when you the ASP.NET application running on the server and you access it locally.<br />
I want to to run a exe when the user navigates to a particular screen or clicks on a button. Is there anyone who can help me out ?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-920">
					<div id="dsq-comment-header-920" class="dsq-comment-header">
						<cite id="dsq-cite-920">
								<span id="dsq-author-user-920">jyu</span>
							</cite>
					</div>
					<div id="dsq-comment-body-920" class="dsq-comment-body">
						<div id="dsq-comment-message-920" class="dsq-comment-message"><p>I am running Window XP Pro SP 2</p>
<p>The code works fine if i use VS 2005 built in development web server, however, if I were to run it under IIS 5.1, the code will not work, as i see in the task manager that the cmd.exe is executed by ASPNET, but nothing happens.</p>
<p>I am trying to use the .bat to generate some XML for me.  using VS 2005 built in web development server, my XML are generated when my .aspx is executed.  </p>
<p>But under the IIS 5.1  it doesn&#8217;t generate the XML for me.  </p>
<p>I did impersonate to an admin account and gave full permission to to access cmd.exe and the folder that contains my aspx page.</p>
<p>Any help is apperciated.  Thank you.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-921">
					<div id="dsq-comment-header-921" class="dsq-comment-header">
						<cite id="dsq-cite-921">
								<span id="dsq-author-user-921">kk</span>
							</cite>
					</div>
					<div id="dsq-comment-body-921" class="dsq-comment-body">
						<div id="dsq-comment-message-921" class="dsq-comment-message"><p>Hi, I tried all the examples above. But i am not able to run the bat file. im using Win xp.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-922">
					<div id="dsq-comment-header-922" class="dsq-comment-header">
						<cite id="dsq-cite-922">
								<span id="dsq-author-user-922">Jacob</span>
							</cite>
					</div>
					<div id="dsq-comment-body-922" class="dsq-comment-body">
						<div id="dsq-comment-message-922" class="dsq-comment-message"><p>If I hadnt found this site i might have killed myself</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-923">
					<div id="dsq-comment-header-923" class="dsq-comment-header">
						<cite id="dsq-cite-923">
								<span id="dsq-author-user-923">Tharaka</span>
							</cite>
					</div>
					<div id="dsq-comment-body-923" class="dsq-comment-body">
						<div id="dsq-comment-message-923" class="dsq-comment-message"><p>i have one problem,i have create batch file its working sucessfully but another machine access by my machine it doesn&#8217;t work ,probelm is workingdirectory, i wont to know about how to give path in working directory using IP ADDRESS</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-924">
					<div id="dsq-comment-header-924" class="dsq-comment-header">
						<cite id="dsq-cite-924">
								<span id="dsq-author-user-924">Ronald_from_Colombia</span>
							</cite>
					</div>
					<div id="dsq-comment-body-924" class="dsq-comment-body">
						<div id="dsq-comment-message-924" class="dsq-comment-message"><p>Hi Brendan! Thanks a lot for giving me the information content in this article. This really helped me!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-925">
					<div id="dsq-comment-header-925" class="dsq-comment-header">
						<cite id="dsq-cite-925">
	http://peterkellner.net							<span id="dsq-author-user-925">Peter kellner</span>
							</cite>
					</div>
					<div id="dsq-comment-body-925" class="dsq-comment-body">
						<div id="dsq-comment-message-925" class="dsq-comment-message"><p>Hi and thanks,<br />
When I run this in debug mode, it works, but when I run it without debug, it leaves the command window open and hangs.  I&#8217;m running several commands in a row. it&#8217;s just the third one that hangs.</p>
<p>Thanks, -Peter at Peterkellner dot net.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-926">
					<div id="dsq-comment-header-926" class="dsq-comment-header">
						<cite id="dsq-cite-926">
								<span id="dsq-author-user-926">Kel</span>
							</cite>
					</div>
					<div id="dsq-comment-body-926" class="dsq-comment-body">
						<div id="dsq-comment-message-926" class="dsq-comment-message"><p><a href="http://support.microsoft.com/kb/221081" rel="nofollow">http://support.microsoft.com/kb/221081</a></p>
<p>It&#8217;s been a while since I addressed a similar issue, but as I recall I wanted to run the Windows Media Encoder VB Script (WMCmd.vbs) with customized parameters from a IIS sever via PHP, essentially creating a transcoding VOD media server.  </p>
<p>IIRC, the above article was key to resolving the ACCESS DENIED problem between IIS and VBS.  Ultimately I had to use PSEXE to launch &#8220;Cscript.exe wmvmd.vbs &#8216;filename&#8217;&#8221;  so that PHP would regain control immediately instead of waiting for the vbs script to finish, which could be hours for a movie.</p>
<p>I&#8217;m currently trying to figure out how to use a remote UNC filename (\\remote_machine\share\filename) with the script instead of local filename.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-927">
					<div id="dsq-comment-header-927" class="dsq-comment-header">
						<cite id="dsq-cite-927">
								<span id="dsq-author-user-927">Krishna</span>
							</cite>
					</div>
					<div id="dsq-comment-body-927" class="dsq-comment-body">
						<div id="dsq-comment-message-927" class="dsq-comment-message"><p>This code piece is really great, but what if our bat file itself requires paramters runtime?<br />
my requirement is that its a file copy over internet and hence i have to pass the folder selected, currently in the bat file i have it as %1, %2 like that when executed from command prompt it has no issues, but i am not able to pass the same from here</p>
<p>thanks</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-928">
					<div id="dsq-comment-header-928" class="dsq-comment-header">
						<cite id="dsq-cite-928">
								<span id="dsq-author-user-928">kite</span>
							</cite>
					</div>
					<div id="dsq-comment-body-928" class="dsq-comment-body">
						<div id="dsq-comment-message-928" class="dsq-comment-message"><p>thanks</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-929">
					<div id="dsq-comment-header-929" class="dsq-comment-header">
						<cite id="dsq-cite-929">
								<span id="dsq-author-user-929">Nick</span>
							</cite>
					</div>
					<div id="dsq-comment-body-929" class="dsq-comment-body">
						<div id="dsq-comment-message-929" class="dsq-comment-message"><p>Just want to say thank you all here!</p>
<p>My co-worker write a web app that have some call to bcp.exe, one server working fine but after move to another server it always get access denied error.</p>
<p>My instinct tell me that BCP.exe is not running, so I start to check the necessary permission for running BCP.exe, no finding…</p>
<p>Second thought is the process never start properly, so I google system.diagnostics with access denied, turns out lot&#8217;s of developer have the same pain as me…</p>
<p>Someone said that&#8217;s a windows 2003 thing and on windows 2000 it work just fine, but our server are both 2003&#8230;</p>
<p>After comparing machine.config file, .net configuration runtime policy, identity impersonate value,  etc.  still no clue.</p>
<p>Finally after go through this thousand lines blog, I got the tip to check cmd.exe.</p>
<p>It turns out the new server do not have properly permission setup on cmd.exe (the web app pool use a domain account identity, this account does not have any permission granted on cmd.exe)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-930">
					<div id="dsq-comment-header-930" class="dsq-comment-header">
						<cite id="dsq-cite-930">
								<span id="dsq-author-user-930">Andrei</span>
							</cite>
					</div>
					<div id="dsq-comment-body-930" class="dsq-comment-body">
						<div id="dsq-comment-message-930" class="dsq-comment-message"><p>Your problems will be solved without any complications if you set the application pool to run under LocalSystem. When running the batch it will try to impersonate another user and this is the only accound that has this right.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-931">
					<div id="dsq-comment-header-931" class="dsq-comment-header">
						<cite id="dsq-cite-931">
								<span id="dsq-author-user-931">Krishna</span>
							</cite>
					</div>
					<div id="dsq-comment-body-931" class="dsq-comment-body">
						<div id="dsq-comment-message-931" class="dsq-comment-message"><p>this does not seem to be working on win2k3 SP2. I checked this and it is failing, below is mentioned the entire gist:<br />
I have a requirement of doing some copy commands over the network servers (over a same domain)using a web based GUI, hence designed it using aspx form and simply calling cmd.exe by instantiating a new Process, all permissions have been given administrative rights both under the IIS level and also under the NTFS level. I can see from task manager (in server) that cmd.exe gets launched but then it shows a message &#8211; &#8220;The application failed to initialize properly (0xc0000142). Click on OK to terminate the application.&#8221; in server because of which copy commands are not getting executed. Pasted below is the code part of it. This is being developed on Windows 2003 SP2<br />
Assistance will be highly appreciated.<br />
Beleaguered programmer&#8230;.<br />
protected string StartProcess(string Arguments, string WorkingDir)<br />
    {<br />
      // Start the process<br />
      string strDomain = &#8220;
<put_ur_domain>&#8220;;<br />
      string strUserName = &#8220;PUT_UR_USERNAME&#8221;;<br />
      string strPassword = &#8220;PUT_UR_PWD&#8221;;<br />
      string strReturnMesages = &#8220;&#8221;;<br />
      try<br />
      {<br />
        Process procMapPath = new Process();<br />
        procMapPath.StartInfo.WorkingDirectory = WorkingDir;<br />
        procMapPath.StartInfo.UseShellExecute = false;<br />
        procMapPath.StartInfo.RedirectStandardOutput = true;<br />
        procMapPath.StartInfo.RedirectStandardInput = true;<br />
        procMapPath.StartInfo.RedirectStandardError = true;<br />
        procMapPath.StartInfo.FileName = &#8220;cmd.exe&#8221;;<br />
        procMapPath.StartInfo.LoadUserProfile = true;<br />
        procMapPath.StartInfo.CreateNoWindow = false;<br />
        procMapPath.StartInfo.Domain = strDomain;<br />
        procMapPath.StartInfo.UserName = strUserName;<br />
        procMapPath.StartInfo.Password = new System.Security.SecureString();<br />
        for (int x = 0; x < strPassword.Length; ++x)<br />
        {<br />
          procMapPath.StartInfo.Password.AppendChar(strPassword[x]);<br />
        }<br />
        procMapPath.StartInfo.Arguments = "/C " + Arguments;<br />
        procMapPath.Start();<br />
        while (!procMapPath.HasExited)<br />
        {<br />
          strReturnMesages = "Still Copying...";<br />
          System.Threading.Thread.Sleep(2000);<br />
        }</p>
<p>        procMapPath.Close();<br />
        strReturnMesages = "Files Copied..." + Environment.NewLine;<br />
      }<br />
      catch (Exception ex)<br />
      {<br />
        strReturnMesages = ex.Source + " --- " + ex.Message + Environment.NewLine;<br />
      }<br />
      return strReturnMesages;<br />
    }</p>
<p>one more thing i have also tried giving cmd.exe by giving full permissions to "Everyone" in the server, still of no use.<br />
Not sure how come examples mentioned are working for them:<br />
<a href="http://www.velocityreviews.com/forums/t117223-run-cmdexe-from-aspx-page.html" rel="nofollow">http://www.velocityreviews.com/forums/t117223-run-cmdexe-from-aspx-page.html<br />
<a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3310025&#038;SiteID=1" rel="nofollow">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3310025&#038;SiteID=1</a></p>
<p>Also tried System.IO and with associated File.Copy commands, there is no provision for supplying user name and password with these calls, hence this also fails across network folders, however I understand when provided as UNC conventions these should work, but then again same problem would arise when trying to map the required folder.<br />
please suggest alternatives&#8230;</put_ur_domain>
</div>
					</div>
				</li>
					<li id="dsq-comment-932">
					<div id="dsq-comment-header-932" class="dsq-comment-header">
						<cite id="dsq-cite-932">
	http://inquest.wordpress.com/							<span id="dsq-author-user-932">sandeep</span>
							</cite>
					</div>
					<div id="dsq-comment-body-932" class="dsq-comment-body">
						<div id="dsq-comment-message-932" class="dsq-comment-message"><p>Thanks Yaar!</p>
<p>You saved my lots of time.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-933">
					<div id="dsq-comment-header-933" class="dsq-comment-header">
						<cite id="dsq-cite-933">
	http://www.harinath.in							<span id="dsq-author-user-933">Harinath Mallepally</span>
							</cite>
					</div>
					<div id="dsq-comment-body-933" class="dsq-comment-body">
						<div id="dsq-comment-message-933" class="dsq-comment-message"><p>Hi, your approach is working fine. I used domain user credentials (who is an admin in the win 2k3 machine) to app pool and its working fine.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-934">
					<div id="dsq-comment-header-934" class="dsq-comment-header">
						<cite id="dsq-cite-934">
								<span id="dsq-author-user-934">Nimish Agarwal</span>
							</cite>
					</div>
					<div id="dsq-comment-body-934" class="dsq-comment-body">
						<div id="dsq-comment-message-934" class="dsq-comment-message"><p>Hi, I have tried implementing the code given above by Bredan Tompkins.</p>
<p>My task is that I have to transfer files from one webserver to another web server every 6 hours. </p>
<p>When I am executing the copy command through command prompt the files are getting transferred from one webserver to another.</p>
<p>But when I try to execute the same command through the above code sample. It is not copying any files to the other web server. The results says: 0 file(s) copied.<br />
Both the servers are on the same domain.</p>
<p>It is really important for me to transfer files to other web server for syncronization. Any help would be greatly appreciated.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-935">
					<div id="dsq-comment-header-935" class="dsq-comment-header">
						<cite id="dsq-cite-935">
								<span id="dsq-author-user-935">Thomas</span>
							</cite>
					</div>
					<div id="dsq-comment-body-935" class="dsq-comment-body">
						<div id="dsq-comment-message-935" class="dsq-comment-message"><p>Hi Brendan,<br />
Nice piece of code..<br />
I tried to implement this in one of my applications. I inserted one more line to hide the command window &#8211;<br />
proc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;<br />
But here I want to display the error messages(if any) thrown by windows\system32\cmd.exe. The common try&#8230;catch block is not catching it. Any suggestion?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-936">
					<div id="dsq-comment-header-936" class="dsq-comment-header">
						<cite id="dsq-cite-936">
								<span id="dsq-author-user-936">Mubarak</span>
							</cite>
					</div>
					<div id="dsq-comment-body-936" class="dsq-comment-body">
						<div id="dsq-comment-message-936" class="dsq-comment-message"><p>You are the Man <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
I was having the same problem using Console application. I tried all possible ideas that I can think of but no luck. This workes for me.</p>
<p>Thank you <img src='http://codebetter.com/brendantompkins/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-937">
					<div id="dsq-comment-header-937" class="dsq-comment-header">
						<cite id="dsq-cite-937">
								<span id="dsq-author-user-937">Miesie</span>
							</cite>
					</div>
					<div id="dsq-comment-body-937" class="dsq-comment-body">
						<div id="dsq-comment-message-937" class="dsq-comment-message"><p>You must give the rights to whole path.<br />
i.e. c:\p1\p2\p3<br />
you must give rights to every fucking folder p1,p2 and p3 (also c:\ root (?)).</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-938">
					<div id="dsq-comment-header-938" class="dsq-comment-header">
						<cite id="dsq-cite-938">
	http://mxdev.biz							<span id="dsq-author-user-938">mxdev</span>
							</cite>
					</div>
					<div id="dsq-comment-body-938" class="dsq-comment-body">
						<div id="dsq-comment-message-938" class="dsq-comment-message"><p>1. change local policies for APSNET user:<br />
in WinXP: run secpol.msc</p>
<p>go to Local Policies->User Rights Assignment<br />
find &#8220;Deny log on locally&#8221; and remove ASPNET user from it.</p>
<p>then find &#8220;Deny logon locally&#8221; and remove ASPNET user from it.</p>
<p>read here:</p>
<p><a href="http://mxdev.blogspot.com/2008/09/asp-net-run-application-exe-from-aspnet.html" rel="nofollow">http://mxdev.blogspot.com/2008/09/asp-net-run-application-exe-from-aspnet.html</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-939">
					<div id="dsq-comment-header-939" class="dsq-comment-header">
						<cite id="dsq-cite-939">
								<span id="dsq-author-user-939">H</span>
							</cite>
					</div>
					<div id="dsq-comment-body-939" class="dsq-comment-body">
						<div id="dsq-comment-message-939" class="dsq-comment-message"><p>Many thanks Brendan,<br />
Such a treat when something just works!!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-940">
					<div id="dsq-comment-header-940" class="dsq-comment-header">
						<cite id="dsq-cite-940">
								<span id="dsq-author-user-940">Preeti</span>
							</cite>
					</div>
					<div id="dsq-comment-body-940" class="dsq-comment-body">
						<div id="dsq-comment-message-940" class="dsq-comment-message"><p>Hi ,<br />
Please help me in solving the problem. I am tring to execute a batch file through ASP.NET on W2K3 IIS6.0 it doesnt work. The code works perfectly fine on W2K IIS5.1 server though.<br />
Thanks  LOT IN ADVANCE.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-941">
					<div id="dsq-comment-header-941" class="dsq-comment-header">
						<cite id="dsq-cite-941">
								<span id="dsq-author-user-941">Ozz</span>
							</cite>
					</div>
					<div id="dsq-comment-body-941" class="dsq-comment-body">
						<div id="dsq-comment-message-941" class="dsq-comment-message"><p>Hi,<br />
I am trying to execute batch file which is creating another file. I am using C# asp.net 2.0 and windows 2000 server.<br />
I can start notepad or calc  with batch file but it doesn&#8217;t process to create a new file. I used impersonation and all permissions seems ok.<br />
Does anyone tell me what else I can do. It is very urgent.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-942">
					<div id="dsq-comment-header-942" class="dsq-comment-header">
						<cite id="dsq-cite-942">
								<span id="dsq-author-user-942">JJ</span>
							</cite>
					</div>
					<div id="dsq-comment-body-942" class="dsq-comment-body">
						<div id="dsq-comment-message-942" class="dsq-comment-message"><p>Does anyone try to execute a batch file in windows 2003. Tried all the above options.. Nothing works. Please help me</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-943">
					<div id="dsq-comment-header-943" class="dsq-comment-header">
						<cite id="dsq-cite-943">
								<span id="dsq-author-user-943">Rakshith</span>
							</cite>
					</div>
					<div id="dsq-comment-body-943" class="dsq-comment-body">
						<div id="dsq-comment-message-943" class="dsq-comment-message"><p>I have created a Web page in C# ASP.net that can be accessed with in campus, and through that i want to select a batch file from the PC who have accessed the page, is it possible . is there any changes to be done in web.config file. please sugget.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-944">
					<div id="dsq-comment-header-944" class="dsq-comment-header">
						<cite id="dsq-cite-944">
								<span id="dsq-author-user-944">Raghu</span>
							</cite>
					</div>
					<div id="dsq-comment-body-944" class="dsq-comment-body">
						<div id="dsq-comment-message-944" class="dsq-comment-message"><p>hi,<br />
i am running perl script using the bat file. the program runs perfect in sql server authentication but when i try to run the same program using windows authentication the process is not started and it works perfect in the debug mode in visual C#. but i have hosted the application in the server machine. from the inetmanger it is not running properly. is there any permission issue is there, so that i can enable it to run,</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-945">
					<div id="dsq-comment-header-945" class="dsq-comment-header">
						<cite id="dsq-cite-945">
	http://www.none.com							<span id="dsq-author-user-945">Ron</span>
							</cite>
					</div>
					<div id="dsq-comment-body-945" class="dsq-comment-body">
						<div id="dsq-comment-message-945" class="dsq-comment-message"><p>ur sample not working!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-946">
					<div id="dsq-comment-header-946" class="dsq-comment-header">
						<cite id="dsq-cite-946">
								<span id="dsq-author-user-946">lazi</span>
							</cite>
					</div>
					<div id="dsq-comment-body-946" class="dsq-comment-body">
						<div id="dsq-comment-message-946" class="dsq-comment-message"><p>Great job! Thanks!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-947">
					<div id="dsq-comment-header-947" class="dsq-comment-header">
						<cite id="dsq-cite-947">
								<span id="dsq-author-user-947">M</span>
							</cite>
					</div>
					<div id="dsq-comment-body-947" class="dsq-comment-body">
						<div id="dsq-comment-message-947" class="dsq-comment-message"><p>Hi,</p>
<p>I am having the same problem as Krishna running this in Windows 2003 Server SP2.</p>
<p>The call to cmd.exe fails with &#8220;The application failed to initialize properly (0xc0000142). Click on OK to terminate the application.&#8221;</p>
<p>Any ideas?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-948">
					<div id="dsq-comment-header-948" class="dsq-comment-header">
						<cite id="dsq-cite-948">
								<span id="dsq-author-user-948">P</span>
							</cite>
					</div>
					<div id="dsq-comment-body-948" class="dsq-comment-body">
						<div id="dsq-comment-message-948" class="dsq-comment-message"><p>I have similar problem on Vista. IIS6 on a Vista!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-949">
					<div id="dsq-comment-header-949" class="dsq-comment-header">
						<cite id="dsq-cite-949">
								<span id="dsq-author-user-949">Vinit</span>
							</cite>
					</div>
					<div id="dsq-comment-body-949" class="dsq-comment-body">
						<div id="dsq-comment-message-949" class="dsq-comment-message"><p>Thanks, I have been wondering for this for last 2 hours and your solution worked like a charm(as you said). Thanks once again.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-950">
					<div id="dsq-comment-header-950" class="dsq-comment-header">
						<cite id="dsq-cite-950">
								<span id="dsq-author-user-950">Abhishek</span>
							</cite>
					</div>
					<div id="dsq-comment-body-950" class="dsq-comment-body">
						<div id="dsq-comment-message-950" class="dsq-comment-message"><p>Hi Brendan,</p>
<p>I  am using your code to run a batch file. When i run my applicaiton in debug mode, its successfully run the batch file but when i deploye it on IIS, its able to read the fiel but not able to run the bat file, and also not giving any error message.<br />
Please help me out .</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-951">
					<div id="dsq-comment-header-951" class="dsq-comment-header">
						<cite id="dsq-cite-951">
								<span id="dsq-author-user-951">abhishek</span>
							</cite>
					</div>
					<div id="dsq-comment-body-951" class="dsq-comment-body">
						<div id="dsq-comment-message-951" class="dsq-comment-message"><p>Hi Brendan,</p>
<p>I  am using your code to run a batch file. When i run my applicaiton in debug mode, its successfully run the batch file but when i deploye it on IIS, its able to read the fiel but not able to run the bat file, and also not giving any error message.<br />
Please help me out .</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-952">
					<div id="dsq-comment-header-952" class="dsq-comment-header">
						<cite id="dsq-cite-952">
	http://www.blue-rhino.co.uk							<span id="dsq-author-user-952">Zak Willis</span>
							</cite>
					</div>
					<div id="dsq-comment-body-952" class="dsq-comment-body">
						<div id="dsq-comment-message-952" class="dsq-comment-message"><p>Hi, the answer is simple, well, not that simple. I had a similar problem trying to run a command line tool, offered to us by Bloomberg. I got a variety of errors, including permission denied, cannot read output. The end result was very simple. You need to redirect the standard input &#8211; which is the same as manually typing commands into command prompt. You could do following:- in Windows Environment variables, set an environment variable with the path of your batch file. You could also run an indiviual &#8220;Path&#8221; command. </p>
<p>Here is a simple example.</p>
<p>Process pr = new Process();<br />
            pr.StartInfo.UseShellExecute = false;</p>
<p>            pr.StartInfo.FileName = fileExecutable;</p>
<p>            pr.StartInfo.RedirectStandardInput = true;<br />
            pr.StartInfo.RedirectStandardOutput = true;<br />
            pr.StartInfo.RedirectStandardError = true;</p>
<p>            pr.Start();</p>
<p>            StreamWriter swrtrIn = pr.StandardInput;<br />
            StreamReader swrtrErr = pr.StandardError;<br />
            swrtrErr.AutoFlush = true;</p>
<p>            swrtrIn.WriteLine();<br />
            swrtrIn.WriteLine(&#8220;PATH &#8221; + pathCommandExecutable);</p>
<p>swrtrIn.WriteLine(&#8220;executable &#8221; + Options);</p>
<p>            swrtrIn.WriteLine(sbuild.ToString());</p>
<p>            swrtrIn.Close();</p>
<p>            StreamReader swrtrOut = pr.StandardOutput;</p>
<p>            string results = swrtrOut.ReadToEnd();</p>
<p>            pr.Close();<br />
            swrtrOut.Close();</p>
<p>            string errorstring = swrtrErr.ReadToEnd();<br />
            swrtrErr.Close();</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-953">
					<div id="dsq-comment-header-953" class="dsq-comment-header">
						<cite id="dsq-cite-953">
								<span id="dsq-author-user-953">Chris</span>
							</cite>
					</div>
					<div id="dsq-comment-body-953" class="dsq-comment-body">
						<div id="dsq-comment-message-953" class="dsq-comment-message"><p>This is a good chunk of code. I modified so I could see any errors thrown on the command line. So you can use the below to invoke a batch file and read from stderr to see if any error messages were thrown:</p>
<p>public static bool StartDataSync(string BatchSyncFileName, int AgencyID, int SyncFileID, DateTime StartDate, DateTime EndDate)<br />
		{<br />
			bool RetVal = true;</p>
<p>			System.IO.StreamReader strm = null;<br />
			System.IO.StreamReader sOut = null;<br />
			System.IO.StreamReader sError = null;<br />
			System.IO.StreamWriter sIn = null;<br />
			System.Diagnostics.Process proc = null;</p>
<p>			try<br />
			{<br />
				// Get the full file path<br />
				string Path = System.Configuration.ConfigurationSettings.AppSettings["SyncFilesPath"];<br />
				string FullFilePath = Path + BatchSyncFileName;</p>
<p>				// Create the ProcessInfo object<br />
				System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo(&#8220;cmd.exe&#8221;);<br />
				psi.UseShellExecute = false;<br />
				psi.RedirectStandardOutput = true;<br />
				psi.RedirectStandardInput = true;<br />
				psi.RedirectStandardError = true;<br />
				psi.CreateNoWindow = true;<br />
				psi.WorkingDirectory = System.AppDomain.CurrentDomain.BaseDirectory.ToString();</p>
<p>				// Start the process<br />
				proc = System.Diagnostics.Process.Start(psi);</p>
<p>				// Open the batch file for reading<br />
				strm = System.IO.File.OpenText(FullFilePath); </p>
<p>				// Attach the output for reading<br />
				sOut = proc.StandardOutput;</p>
<p>				// attach the standard error stream for reading<br />
				sError = proc.StandardError;</p>
<p>				// Attach the in for writing<br />
				sIn = proc.StandardInput;<br />
				sIn.AutoFlush = true; // automatically write to the stream after every Write(), WriteLine() call.</p>
<p>				// Write each line of the batch file to standard input<br />
				while(strm.Peek() != -1)<br />
				{<br />
					string Text = strm.ReadLine();<br />
					Text = Text.Replace(&#8220;<agencydatauserid>&#8220;, Convert.ToString(AgencyDataUserID));<br />
					Text = Text.Replace(&#8220;<datastartdate>&#8220;, StartDate.ToShortDateString());<br />
					Text = Text.Replace(&#8220;<dataenddate>&#8220;, EndDate.ToShortDateString());<br />
					sIn.WriteLine(Text);<br />
				}</p>
<p>				// close batch file reader.<br />
				strm.Close();</p>
<p>				// exit cmd.exe<br />
				sIn.WriteLine(&#8220;exit&#8221;);</p>
<p>				// Close the stdin stream.<br />
				sIn.Close();<br />
				// we leave stdout open so we can check it for errors. stderr and stdout seem to be linked.</p>
<p>				// check if we had any errors in our commands we passed to cmd.exe<br />
				int index = sError.Peek();<br />
				if(index != -1)<br />
				{<br />
					string Error = sError.ReadToEnd();<br />
					throw new System.Exception(Error);<br />
				}<br />
				sOut.Close();</p>
<p>//				int index = sOut.Peek();<br />
//				if(index != -1)<br />
//					throw new System.Exception(sOut.ReadToEnd());</p>
<p>				// wait for the cmd.exe process to close<br />
				bool Closed = proc.WaitForExit(60 * 1000);</p>
<p>				// process failed to close in a timely manner, throw error<br />
				if(!Closed)<br />
				{<br />
					try<br />
					{<br />
						proc.Kill();<br />
					}<br />
					catch(System.Exception)<br />
					{<br />
						// ignore kill exceptions.<br />
					}<br />
					throw(new System.Exception(&#8220;sync process hung or did not queue fast enough.&#8221;));<br />
				}</p>
<p>			}<br />
			catch(System.Exception ex)<br />
			{<br />
				// close streams<br />
				if(strm != null)<br />
					strm.Close();<br />
				if(sOut != null)<br />
					sOut.Close();<br />
				if(sIn != null)<br />
					sIn.Close();<br />
				if(proc != null) // close process<br />
					proc.Close();</p>
<p>				// log error<br />
				Common.ErrorHelper.WriteErrorToEventLog(&#8220;Error executing sync:\n&#8221; + ex.Message + &#8220;\n\n&#8221; + ex.StackTrace);<br />
				RetVal = false;<br />
			}</p>
<p>			return RetVal;<br />
		}</dataenddate></datastartdate></agencydatauserid></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-954">
					<div id="dsq-comment-header-954" class="dsq-comment-header">
						<cite id="dsq-cite-954">
	http://leowidodo.wordpress.com							<span id="dsq-author-user-954">leo_rw</span>
							</cite>
					</div>
					<div id="dsq-comment-body-954" class="dsq-comment-body">
						<div id="dsq-comment-message-954" class="dsq-comment-message"><p>I&#8217;ve problem to like abhishek. I can execute psshutdown in debug mode, but when i deploy to IIS in Windows XP, psshutdown timed out, and application hang. I&#8217;ve been searching the problem and i&#8217;ve found that the eula of Sysinternal is the problem. Because it first time load, then user must accept the eula first. To accept the eula, we must edit in registry.<br />
********************<br />
Windows Registry Editor Version 5.00</p>
<p>&#8216; Usage of psshutdown.exe authorized for all profils<br />
[HKEY_USERS\.DEFAULT\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for local SYSTEM<br />
[HKEY_USERS\S-1-5-18\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for local service (nt authority)<br />
[HKEY_USERS\S-1-5-19\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for network service (nt authority)<br />
[HKEY_USERS\S-1-5-20\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>[HKEY_USERS\S-1-5-21-839522115-492894223-2147179587-1007\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001<br />
*********************<br />
You can save the text above to .reg file then execute it. The last text is S-1-5-21-839522115-492894223-2147179587-1007 depend on your aspnet user. You have to search in your registry where the aspnet user.</p>
<p>After you add the registry, you can execute bat file from asp.net.</p>
<p>Have a nice try&#8230;&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-955">
					<div id="dsq-comment-header-955" class="dsq-comment-header">
						<cite id="dsq-cite-955">
	http://leowidodo.wordpress.com							<span id="dsq-author-user-955">leo_rw</span>
							</cite>
					</div>
					<div id="dsq-comment-body-955" class="dsq-comment-body">
						<div id="dsq-comment-message-955" class="dsq-comment-message"><p>I&#8217;ve problem to like abhishek. I can execute psshutdown in debug mode, but when i deploy to IIS in Windows XP, psshutdown timed out, and application hang. I&#8217;ve been searching the problem and i&#8217;ve found that the eula of Sysinternal is the problem. Because it first time load, then user must accept the eula first. To accept the eula, we must edit in registry.<br />
********************<br />
Windows Registry Editor Version 5.00</p>
<p>&#8216; Usage of psshutdown.exe authorized for all profils<br />
[HKEY_USERS\.DEFAULT\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for local SYSTEM<br />
[HKEY_USERS\S-1-5-18\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for local service (nt authority)<br />
[HKEY_USERS\S-1-5-19\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>&#8216; Usage of psshutdown.exe authorized for network service (nt authority)<br />
[HKEY_USERS\S-1-5-20\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001</p>
<p>[HKEY_USERS\S-1-5-21-839522115-492894223-2147179587-1007\Software\Sysinternals\PsShutdown]<br />
&#8220;EulaAccepted&#8221;=dword:00000001<br />
*********************<br />
You can save the text above to .reg file then execute it. The last text is S-1-5-21-839522115-492894223-2147179587-1007 depend on your aspnet user. You have to search in your registry where the aspnet user.</p>
<p>After you add the registry, you can execute bat file from asp.net.</p>
<p>Have a nice try&#8230;&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-956">
					<div id="dsq-comment-header-956" class="dsq-comment-header">
						<cite id="dsq-cite-956">
								<span id="dsq-author-user-956">cosmo</span>
							</cite>
					</div>
					<div id="dsq-comment-body-956" class="dsq-comment-body">
						<div id="dsq-comment-message-956" class="dsq-comment-message"><p>This code worked great, didn&#8217;t even have to switch to a different user before executing it from my aspx page! Think something I was doing wrong before was not setting the psi.WorkingDirectory with the directory path of the batch file I was executing. I&#8217;m using it to execute a batch file that has psexec commands in it to do some remote processing. thanx!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-957">
					<div id="dsq-comment-header-957" class="dsq-comment-header">
						<cite id="dsq-cite-957">
								<span id="dsq-author-user-957">ghh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-957" class="dsq-comment-body">
						<div id="dsq-comment-message-957" class="dsq-comment-message"><p>b nb</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-958">
					<div id="dsq-comment-header-958" class="dsq-comment-header">
						<cite id="dsq-cite-958">
								<span id="dsq-author-user-958">Ron</span>
							</cite>
					</div>
					<div id="dsq-comment-body-958" class="dsq-comment-body">
						<div id="dsq-comment-message-958" class="dsq-comment-message"><p>Tnx for this post!<br />
The code works perfectly.</p>
<p>Now my users can finally start there workstations remotely (WOL)!<br />
Tnx again!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-959">
					<div id="dsq-comment-header-959" class="dsq-comment-header">
						<cite id="dsq-cite-959">
								<span id="dsq-author-user-959">gm</span>
							</cite>
					</div>
					<div id="dsq-comment-body-959" class="dsq-comment-body">
						<div id="dsq-comment-message-959" class="dsq-comment-message"><p>vgf</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/brendantompkins/2004/05/13/run-a-bat-file-from-asp-net/ ';
	var disqus_identifier = '104 /blogs/brendan.tompkins/archive/2004/05/13/13484.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'brendantompkins';
	var disqus_title = "Run a .BAT file from ASP.NET";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=104');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/brendantompkins/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/brendantompkins\/2004\/05\/13\/run-a-bat-file-from-asp-net\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">About Me</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: left;"><img alt='' src='http://0.gravatar.com/avatar/c1de0fbc0dbc3fd24b285009c123d9b0?s=96&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>By day, I'm a .NET developer working in the transportation and logistics industry... By night I'm a fabulous disco dancer.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.420 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-26 18:55:59 -->
<!-- super cache -->