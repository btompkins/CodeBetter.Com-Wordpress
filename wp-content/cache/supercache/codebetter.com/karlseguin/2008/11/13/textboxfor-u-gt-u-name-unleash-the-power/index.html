<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>TextBoxFor(u =&gt; u.Name) &#8211; Unleash the power | Karl Seguin</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/karlseguin/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/karlseguin/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Karl Seguin' href='http://codebetter.com/karlseguin/' />
<link rel='start' title='Expecting More From Development Companies' href='http://codebetter.com/karlseguin/2006/03/24/expecting-more-from-development-companies/' />
<link rel='prev' title='A base fixture class can help reduce repetitive code' href='http://codebetter.com/karlseguin/2008/11/06/a-base-fixture-class-can-help-reduce-repetitive-code/' />
<link rel='next' title='Short Foundations Presentation &#8211; This Thursday in Ottawa' href='http://codebetter.com/karlseguin/2008/11/17/short-foundations-presentation-this-thursday-in-ottawa/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/' />
<link rel='shortlink' href='http://codebetter.com/karlseguin/?p=146' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-146" class="post-146 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">TextBoxFor(u =&gt; u.Name) &#8211; Unleash the power</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/karlseguin/author/karlseguin/" title="View all posts by karlseguin">karlseguin</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/" title="2:44 pm" rel="bookmark"><span class="entry-date">November 13, 2008</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/karlseguin/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/karlseguin/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p><H3>Introduction</H3><br />
<P>Three weeks ago, Jeremy Miller and Chad Myers laid down <A href="http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx">their MVC approach</A>. From the comments it&#8217;s clear that many of their goals resonated with fellow developers. Since I happened to be starting a large-scale application using MVC, I was very interested in learning more. The <A href="http://kaizenconf.pbwiki.com/Using+and+Abusing+ASPNET+MVC+for+Fun+and+Profit">videos</A>, from their presentation, detailed their customized MVC stack, but didn&#8217;t really provide us with anything to hit the ground running (i.e. working code).Chad has stated that he&#8217;s working on some code, but I figured I&#8217;d share my implementation of something he and Jeremy talked about: the TextBoxFor control. Now I don&#8217;t know exactly how they implemented their version, and mine just provides the necessary basis to get started, but hopefully it&#8217;ll help people bake some of this goodness within their own code.</P><br />
<H3>Base ViewPage</H3><br />
<P>The first thing to do is create our own base ViewPage which our views will inherit from. Since this code relies on passing strongly-typed objects to our view (remember, &#8220;no slinging around HashTable&#8217;s, IDictionary&#8217;s, or magic strings&#8221;), we inherit from ViewPage&lt;T&gt; instead of ViewPage:</P><PRE>namespace CodeBetter.Web.Components<br />
{<br />
   public class ApplicationView&lt;T&gt; : ViewPage&lt;T&gt; where T : class<br />
   {<br />
   }<br />
}</PRE><br />
<P>For those not familiar with generic constraints, the where T : class states that T must be a reference type (this is actually a constraint in the base ViewPage&lt;T&gt; which must be repeated when we inherit from it). This simple code actually has a nasty (and stupid) side effect. To use a generic within the ASP.NET @Page directive we need to use CLR notation (because the ASP.NET directives are language agnostic). In other words, if we want to use a User object in our thunderdome system, we need to declare our view as:</P><PRE>&lt;%@ Page Language=&#8221;C#&#8221; Inherits=&#8221;CodeBetter.Web.Components.ApplicationView`1[[CodeBetter.User,CodeBetter]]&#8221; &#8230; %&gt;</PRE><br />
<P>We can&#8217;t use &lt;XXX&gt;, but instead have to use the CLR `[[XXX,YYY]] notation. This quickly gets out of hand if you&#8217;re model is a generic type itself. The simplest solution is to use a codebehind (yuck!) file for your view:</P><PRE>login.aspx:<br />
&lt;%@ Page Language=&#8221;C#&#8221; Inherits=&#8221;CodeBetter.Web.Views.Login&#8221; &#8230; %&gt;</p>
<p>login.aspx.cs:<br />
public class Login : ApplicationView&lt;User&gt;<br />
{<br />
}</PRE><br />
<H3>Expressions</H3><br />
<P>Next we&#8217;re going to add the method definition for our TextBoxFor method:</P><PRE>protected internal MemberTextBox TextBoxFor(Expression&lt;Func&lt;T, string&gt;&gt; action)<br />
{</p>
<p>}</PRE><br />
<P>We&#8217;re going to implement MemberTextBox shortly (named because it&#8217;ll server as a TextBox for a class member). First though we need to get over that crazy parameter. Expression&lt;Func&lt;T, string&gt;&gt;, what the func? I&#8217;ve discussed <A href="http://codebetter.com/blogs/karlseguin/archive/2008/07/03/get-your-func-on.aspx">Func&lt;T, X&gt; and their usefulness before</A> (you should read that blog post, good stuff!) it&#8217;s simply a generic delegate that expects a type T as a parameter and returns type X. So in our example it&#8217;s expecting type T (which is the type being passed as our ViewData.Model) and returns a string. As for the expressions (and I&#8217;m by no means an expert on Expressions, hopefully someone will write a good follow up to explain it better), they are a new features in .NET 3.5 used to implement LINQ (as such you&#8217;ll find them in the System.Linq.Expressions namespace). When you supply a delegate as an Expression, the code doesn&#8217;t actually execute. Instead it gets turned into a tree of objects which we can use to dynamically build our textbox. Still confused, look at it this way. If we do this within our view without using an Expression:</P><PRE>&lt;% User user = ViewData.Model %&gt;<br />
&#8230;<br />
&lt;%= TextBoxFor(u =&gt; u.Name) %&gt;</PRE><br />
<P>Guess what&#8217;ll get passed into our TextBoxFor method? The user&#8217;s actual name (because the code will be executed as you&#8217;d normally expect). We need more than that â€“ we need the expression itself so we can build a consistent naming (name=&#8221;u.Name&#8221;) as well as type information. You might be wondering where u comes from? This is the variable that gets passed into our function of type T, which we said would be a user. You need to pass an actual instance, which is why you must render your view via:</P><PRE>return view(new User());</PRE><br />
<H3>Taking it further</H3><br />
<P>Now that we have that ground-work out of the way, we can focus on actually implementing this thing.</P><PRE>protected internal MemberTextBox TextBoxFor(Expression&lt;Func&lt;T, string&gt;&gt; action)<br />
{<br />
    var expression = (MemberExpression)action.Body;<br />
    var function = action.Compile();<br />
    string value = function(ViewData.Model);<br />
    return new MemberTextBox(expression.ToString(), value, expression.Member);<br />
}</PRE><br />
<P>This code looks more complicated than it is. First we get the body of our actual expression as a MemberExpression (if you call TextBoxFor and supply a method, like u =&gt; u.Save(), you&#8217;ll get a cast exception). Next we compile the expression (you can more or less think of this as compiling your code within visual studio) which gives us a function. Remember our function definition, Func&lt;T, string&gt;, so we know it expects a T (in this particular case that&#8217;s a User, whatever it is, ViewData.Model will always be of type T) and returns a string. We execute the actual function and get the result. We now have everything we need to build our textbox.</P><br />
<H3>MemberTextBox</H3><br />
<P>Now we can build an initial version of our MemberTextBox</P><PRE>public class MemberTextBox<br />
{<br />
  private readonly Dictionary&lt;string, string&gt; _attributes;</p>
<p>  public MemberTextBox(string name, string value, MemberInfo member)<br />
  {<br />
    _attributes = new Dictionary&lt;string, string&gt;(4);<br />
    _attributes["type"] = &#8220;text&#8221;;<br />
    var maxlengthAttribute = member.GetCustomAttributes(typeof(MaximumLengthAttribute), true);<br />
    if (maxlengthAttribute != null &amp;&amp; maxlengthAttribute.Length == 1)<br />
    {<br />
        _attributes["maxlength"] = ((MaximumLengthAttribute)maxlengthAttribute[0]).Length.ToString();<br />
    }<br />
    if (!string.IsNullOrEmpty(value))<br />
    {<br />
        _attributes["value"] = value;<br />
    }<br />
  }<br />
  public MemberTextBox AsPassword()<br />
  {<br />
    _attributes["type"] =  &#8220;password&#8221;;<br />
    return this;<br />
  }<br />
  public MemberTextBox WithClass(string cssClass)<br />
  {<br />
    _attributes["class"] = cssClass;<br />
    return this;<br />
  }<br />
  public override string ToString()<br />
  {<br />
    var sb = new StringBuilder(75);<br />
    sb.Append(&#8220;&lt;input &#8220;);<br />
    foreach(var attribute in _attributes)<br />
    {<br />
        sb.Append(attribute.Key);<br />
        sb.Append(&#8220;=\&#8221;");<br />
        sb.Append(HttpUtility.HtmlEncode(attribute.Value));<br />
        sb.Append(&#8220;\&#8221; &#8220;);<br />
    }<br />
    return sb.Append(&#8220;/&gt;&#8221;).ToString();<br />
  }<br />
}</PRE><br />
<P>This code is much more straight-forward and really provides everything we need as a basis to move on to a more advanced implementation. We&#8217;re basically building up a hashtable of names and values which then gets dumped as an HTML tag via the ToString override. Do notice that within the constructor we query our property to see if it has a MaximumLengthAttribute. This is a custom attribute that we use here at work (you should be able to easily find libraries that provide attribute-based validations online). I left this in so that you could see how the TextBoxFor can be used to really write powerful and domain-driven code with minimal effort (you&#8217;ll need to take it out to get this code to compile, plus fix all the other little mistakes I doubtlessly made!).</P><br />
<H3>Improvement 1</H3><br />
<P>If you&#8217;ve understood everything so far, you might be wondering why I limited my expression to returning a string. I think we can agree that it doesn&#8217;t make sense to allow any object (how do you display a &#8220;UserGroup&#8221; within a textbox?), but surely we should, at the very least, also allow numbers. In order to keep things nice and clean, and really show-off the power of this approach, we&#8217;ll actually create an overloaded TextBoxFor method:</P><PRE>protected internal MemberTextBox TextBoxFor(Expression&lt;Func&lt;T, int&gt;&gt; action)<br />
{<br />
    var expression = (MemberExpression)action.Body;<br />
    var function = action.Compile();<br />
    int value = function(ViewData.Model);<br />
    return new MemberTextBox(expression.ToString(), value, expression.Member);<br />
}</PRE><br />
<P>Which also requires an overloaded constructor within MemberTextBox (which accepts an int instead of a string):</P><PRE>public MemberTextBox(string name, int value, MemberInfo member) : this(name, value.ToString(), member)<br />
{<br />
    _attributes["rel"] = &#8220;numeric&#8221;;<br />
}</PRE><br />
<P>As you can see, whenever we create a textbox for an integer, we&#8217;ll be adding a rel=&#8221;numeric&#8221; attribute to our tag. Why? Now we can actually use a JavaScript library and automatically apply a numeric mask to any inputs with a rel=&#8221;numeric&#8221; (and it just so happens that I wrote an article for <A href="http://dotnetslackers.com/articles/ajax/JQuery-Primer-Part-2.aspx">DotNetSlackers just the other week</A> that accomplished this using jQuery). So, with very little effort, our code will automatically detect that our type is an int and apply a numeric mask to the appropriate textboxes.</P><br />
<H3>Improvement 2</H3><br />
<P>The last thing we&#8217;ll look at is cleaning up our code. Specifically, we&#8217;ll introduce a base MemberControl that&#8217;ll provide much of the core functionality, allowing us to easily create a CheckBoxFor and so on. First though, let&#8217;s clean up our ApplicationView a little (and while we&#8217;re at it, let&#8217;s add the CheckBoxFor method):</P><PRE>protected internal MemberTextBox TextBoxFor(Expression&lt;Func&lt;T, int&gt;&gt; action)<br />
{<br />
    var expression = (MemberExpression)action.Body;<br />
    return new MemberTextBox(expression.ToString(), GetValue(action), expression.Member);<br />
}<br />
protected internal MemberTextBox TextBoxFor(Expression&lt;Func&lt;T, string&gt;&gt; action)<br />
{<br />
    var expression = (MemberExpression)action.Body;<br />
    return new MemberTextBox(expression.ToString(), GetValue(action), expression.Member);<br />
}<br />
protected internal MemberCheckBox CheckBoxFor(Expression&lt;Func&lt;T, bool&gt;&gt; action)<br />
{<br />
    var expression = (MemberExpression)action.Body;<br />
    return new MemberCheckBox(expression.ToString(), GetValue(action), expression.Member);<br />
}<br />
private V GetValue&lt;V&gt;(Expression&lt;Func&lt;T, V&gt;&gt; action)<br />
{<br />
    var function = action.Compile();<br />
    return function(ViewData.Model);<br />
}</PRE><br />
<P>There are only two interesting things here. First we&#8217;ve introduced a GetValue method to remove some of the repetition found in each of our methods. Secondly, as you probably expect, our CheckBoxFor expects members that return Booleans.</P><br />
<P>Now we create our base MemberControl class:</P><PRE>public abstract class MemberControl&lt;T&gt;<br />
{<br />
  private readonly Dictionary&lt;string, string&gt; _attributes;<br />
  private readonly MemberInfo _member;<br />
  protected internal abstract string TagName { get; }<br />
  protected MemberInfo Member{ get { return _member; } }<br />
  protected internal Dictionary&lt;string, string&gt; Attributes<br />
  {<br />
    get { return _attributes; }<br />
  }        </p>
<p>  protected MemberControl(string name, MemberInfo member)<br />
  {<br />
    _attributes = new Dictionary&lt;string, string&gt;(4);<br />
    _member = member;<br />
    Add(&#8220;name&#8221;, name);<br />
  }</p>
<p>  public T WithClass(string className)<br />
  {<br />
    Add(&#8220;class&#8221;, className);<br />
    return This();<br />
  }<br />
  public T WithId(string id)<br />
  {<br />
    Add(&#8220;id&#8221;, id);<br />
    return This();<br />
  }</p>
<p>  protected internal abstract T This();<br />
  protected void Add(string key, string value)<br />
  {<br />
    _attributes[key] = value;<br />
  }<br />
  public override string ToString()<br />
  {<br />
    var sb = new StringBuilder(75);<br />
    sb.Append(&#8220;&lt;&#8221;);<br />
    sb.Append(TagName);<br />
    sb.Append(&#8221; &#8220;);<br />
    foreach(var attribute in _attributes)<br />
    {<br />
        sb.Append(attribute.Key);<br />
        sb.Append(&#8220;=\&#8221;");<br />
        sb.Append(HttpUtility.HtmlEncode(attribute.Value));<br />
        sb.Append(&#8220;\&#8221; &#8220;);<br />
    }<br />
    return sb.Append(&#8220;/&gt;&#8221;).ToString();<br />
 }<br />
}</PRE><br />
<P>This is largely what we saw in our previous MemberTextBox code so should be pretty familiar. Now we&#8217;ll look at our simplified MemberTextBox:</P><PRE>public class MemberTextBox : MemberControl&lt;MemberTextBox&gt;<br />
{<br />
  protected internal override string TagName<br />
  {<br />
    get { return &#8220;input&#8221;; }<br />
  }<br />
  public MemberTextBox(string name, int value, MemberInfo member) : this(name, value.ToString(), member)<br />
  {<br />
    Add(&#8220;rel&#8221;, &#8220;numeric&#8221;);<br />
  }<br />
  public MemberTextBox(string name, string value, MemberInfo member) : base(name, member)<br />
  {<br />
    Add(&#8220;type&#8221;, &#8220;text&#8221;);<br />
    var attribute = member.GetCustomAttributes(typeof(MaximumLengthAttribute), true);<br />
    if (attribute != null &amp;&amp; attribute.Length == 1)<br />
    {<br />
        Add(&#8220;maxlength&#8221;, ((MaximumLengthAttribute)attribute[0]).Length.ToString());<br />
    }<br />
    if (!string.IsNullOrEmpty(value))<br />
    {<br />
        Add(&#8220;value&#8221;, value);<br />
    }<br />
  }<br />
  protected internal override MemberTextBox This()<br />
  {<br />
    return this;<br />
  }<br />
  public MemberTextBox AsPassword()<br />
  {<br />
    Add(&#8220;type&#8221;, &#8220;password&#8221;);<br />
    return this;<br />
  }<br />
}</PRE><br />
<P>And, while we&#8217;re at it, take a look at the MemberCheckBox class:</P><PRE>public class MemberCheckBox : MemberControl&lt;MemberCheckBox&gt;<br />
{<br />
  protected internal override string TagName<br />
  {<br />
    get { return &#8220;input&#8221;; }<br />
  }<br />
  public MemberCheckBox(string name, bool value, MemberInfo member) : base(name, member)<br />
  {<br />
    Add(&#8220;type&#8221;, &#8220;checkbox&#8221;);<br />
    if (value)<br />
    {<br />
        Add(&#8220;checked&#8221;, &#8220;checked&#8221;);<br />
    }<br />
  }<br />
  protected internal override MemberCheckBox This()<br />
  {<br />
    return this;<br />
  }<br />
}</PRE><br />
<H3>Conclusion</H3><br />
<P>So that certainly is a lot of code. And it is relatively complicated. However, I think the numeric textbox example and integration with our validation attributes really showcases how simple it is to write powerful UIs.</P></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/karlseguin/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/" title="Permalink to TextBoxFor(u =&gt; u.Name) &#8211; Unleash the power" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/feed/" title="Comments RSS to TextBoxFor(u =&gt; u.Name) &#8211; Unleash the power" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-146 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/karlseguin/2008/11/06/a-base-fixture-class-can-help-reduce-repetitive-code/" rel="prev"><span class="meta-nav">&larr;</span> A base fixture class can help reduce repetitive code</a></div>
					<div class="nav-next"><a href="http://codebetter.com/karlseguin/2008/11/17/short-foundations-presentation-this-thursday-in-ottawa/" rel="next">Short Foundations Presentation &#8211; This Thursday in Ottawa <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">20 Responses to <em>TextBoxFor(u =&gt; u.Name) &#8211; Unleash the power</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-1357">
		<div id="comment-1357">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1357">November 21, 2008 at 2:31 pm</a></div>

		<div class="comment-body"><p>David:<br />
The actual code is heavily unit tested. The code here was heavily modified for the masses and to provoke discussions. Had I provided a download like to an assembly, I&#8217;d also have included unit tests. The code isn&#8217;t particularly difficult to test &#8211; it isn&#8217;t coupled to anything &#8211; input an expression output a string. As others have mentioned, there&#8217;s obviously some work being done by Chad and Jeremy and friends to get something more official out there (see above comments) &#8211; I suspect you&#8217;ll see unit tests out of that effort.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1356">
		<div id="comment-1356">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">David Kemp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1356">November 21, 2008 at 8:31 am</a></div>

		<div class="comment-body"><p>Where are the unit tests? I can see people copying this code, tweaking it, and having no tests around it.<br />
I&#8217;m sure you drove out this code from tests, so where are the tests you used to develop it?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1355">
		<div id="comment-1355">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1355">November 20, 2008 at 10:05 pm</a></div>

		<div class="comment-body"><p>Cool, but at some point, this becomes ASP.NET DynamicData.  For example, why not:</p>
<p>Html.ControlFor(u => u.Name)</p>
<p>Where ControlFor looks at the type and decides the best UI control for it.  But, if you do that, you may as well gen up the whole form that way:</p>
<p>Html.FormFor(u)</p>
<p>Where it reflects the properties and calls ControlFor for each.  But if you do that, you may as well gen up UI for your whole domain.  At which point, you&#8217;ve rewritten DynamicData&#8230;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1354">
		<div id="comment-1354">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1354">November 20, 2008 at 2:39 am</a></div>

		<div class="comment-body"><p>Thanks Phil. Pretty new to using expressions, didn&#8217;t run into any problems so stuck with that <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1353">
		<div id="comment-1353">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://haacked.com/' rel='external nofollow' class='url'>Haacked</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1353">November 20, 2008 at 12:37 am</a></div>

		<div class="comment-body"><p>Why use MemberExpression and not Expression? Try adding a property of type System.Nullable<decimal> to your model.</decimal></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1352">
		<div id="comment-1352">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://lunaverse.wordpress.com' rel='external nofollow' class='url'>Tim Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1352">November 15, 2008 at 12:18 am</a></div>

		<div class="comment-body"><p>I also attended the &#8220;Opinionated&#8221; presentation, and I have been working on something similar.  Basically, I&#8217;ve got this:</p>
<p>public class ConventionViewPage<t> : ViewPage</t><t>, IViewModelContainer</t><t> where T : class<br />
{<br />
    public T ViewModel<br />
    {<br />
        get { return ViewData.Model; }<br />
    }<br />
}</p>
<p>&#8230;along with some brothers, ConventionUserControl</t><t> and ConventionMasterPage</t><t>.  Then&#8230;</p>
<p>public static class ViewModelContainerExtensions<br />
{<br />
    public static TextBox TextBox</t><t>(this IViewModelContainer</t><t> view, Expression<func <T, object>> expression) where T : class<br />
    {<br />
        return new TextBox(GetMemberExpression(expression)).Value(GetValueFor(view.ViewModel, expression));<br />
    }<br />
   &#8230;</p>
<p>Used like this&#8230;</p>
<p>< %=this.TextBox(x => x.Name).Class(&#8220;required&#8221;).Label(&#8220;Name:&#8221;).Title(&#8220;Enter your name&#8221;)%></p>
<p>IViewModelContainer<t> implements IViewDataContainer.  It provides a common interface for all things that contain a strongly typed view model and so the extension methods apply to view, user control or master.  Most importantly, no reflection is needed.</p>
<p>For view pages without strongly typed model I have ViewDataContainerExtensions which returns the same chain-able objects as does ViewModelContainerExtensions, but instead of taking an expression they take the name as a string.  There is no need of a custom view page for these because they extend IViewDataContainer, which the basic page, user control and master all implement.</p>
<p>I have stopped short of the custom attribute magic.  It&#8217;s way cool, but my view objects are DTOs, not domain entities.  I might add this later.  My HTML objects have the member expression and so this could easily be added.</p>
<p>By the way, thanks to Chad for some feedback he gave me on an ealier version, although he may want to deny it. <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </t></func></t></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1351">
		<div id="comment-1351">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffhandley.com' rel='external nofollow' class='url'>Jeff Handley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1351">November 14, 2008 at 11:26 pm</a></div>

		<div class="comment-body"><p>Karl,</p>
<p>Yeah &#8212; what you have it definitely much beyond what I had done &#8212; but the idea is the same.  Instead of having extension methods that return strings, create objects and override ToString() to return the Html.  I don&#8217;t know that TagBuilder was there when I created my stuff, so I had rolled my own centralized way of rendering objects as HTML tags.</p>
<p>In MVC, I still want to have Custom Controls that are extensible and flexible.  The Html Helpers are tough to extend to slightly change the behavior of the existing functionality I thought.</p>
<p>-Jeff</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1350">
		<div id="comment-1350">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1350">November 14, 2008 at 5:33 pm</a></div>

		<div class="comment-body"><p>@LaptopHeaven:<br />
The DoveTail guys might have beat me to the code, but I predictably beat them to the documentation.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1349">
		<div id="comment-1349">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://colinjack.lostechies.com' rel='external nofollow' class='url'>Colin Jack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1349">November 14, 2008 at 2:02 pm</a></div>

		<div class="comment-body"><p>Really cool stuff, great work and we&#8217;ll definitely be giving this approach a go very soon.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1348">
		<div id="comment-1348">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1348">November 14, 2008 at 1:28 pm</a></div>

		<div class="comment-body"><p>The strongly-typed HTML helper is certainly a welcome addition. Will look into it. The fact that we&#8217;re even having this discussion really speaks well for the flexibility of the framework (which of course brings up the interesting conversation of flexibility vs opinionated).</p>
<p>Same with the TagBuilder &#8211; although for simple cases like this, object-base rendering is often more of a mess than simply building a string. I&#8217;ll look into it though, maybe its really lightweight.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1347">
		<div id="comment-1347">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://blog.robustsoftware.co.uk' rel='external nofollow' class='url'>Garry Shutler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1347">November 14, 2008 at 12:40 pm</a></div>

		<div class="comment-body"><p>You might want to look at the class: System.Web.Mvc.TagBuilder</p>
<p>It&#8217;s used by the built-in HtmlHelper extensions and makes it really easy to valid HTML tags rather than doing it all yourself.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1346">
		<div id="comment-1346">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codinginstinct.com' rel='external nofollow' class='url'>Torkel</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1346">November 14, 2008 at 8:25 am</a></div>

		<div class="comment-body"><p>Very nice stuff, I and I like Scott&#8217;s idea of generic types helpers for specific views.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1345">
		<div id="comment-1345">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://chadmyers.lostechies.com' rel='external nofollow' class='url'>Chad Myers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1345">November 14, 2008 at 7:07 am</a></div>

		<div class="comment-body"><p>So what we did is to prefer more Extension methods on the view pages:</p>
<p><a href="http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/HtmlExtensions.cs" rel="nofollow">http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/HtmlExtensions.cs</a></p>
<p>We use light-weight &#8220;Expression Builder&#8221; (Fluent API/Method Chaining, builder) objects and then add common functionality via extension methods to avoid having a &#8220;Huge Base Class&#8221; problem.</p>
<p>The base class:<br />
<a href="http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/HtmlExpressionBase.cs" rel="nofollow">http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/HtmlExpressionBase.cs</a></p>
<p>A simplistic data-bound textbox expression implementation:</p>
<p><a href="http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/TextBoxExpression.cs" rel="nofollow">http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/TextBoxExpression.cs</a></p>
<p>Then, we add extra juice to all Html Expressions for common stuff:</p>
<p><a href="http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/HtmlExpressionExtensions.cs" rel="nofollow">http://code.google.com/p/opinionatedmvc/source/browse/trunk/src/OpinionatedMVC.Core/Html/Expressions/HtmlExpressionExtensions.cs</a></p>
<p>Eventually, that enables us to do things like this:</p>
<p>< %= this.TextBoxFor(m=>m.GreetingText)<br />
   .AsMultiline()<br />
   .Required()<br />
   .Width(300) %></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1344">
		<div id="comment-1344">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://weblogs.asp.net/scottgu' rel='external nofollow' class='url'>ScottGu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1344">November 14, 2008 at 5:39 am</a></div>

		<div class="comment-body"><p>An alternative you might consider is creating a HtmlHelper<tmodel> class that derives from HtmlHelper:</p>
<p>    public class HtmlHelper</tmodel><tmodel> : HtmlHelper<br />
    {<br />
        public HtmlHelper(ViewContext viewContext, IViewDataContainer viewDataContainer)<br />
            : base(viewContext, viewDataContainer)<br />
        {</p>
<p>        }<br />
    }</p>
<p>You could then have your custom ViewPage class hide the built-in Html property and expose HtmlHelper</tmodel><tmodel> instead:</p>
<p>    public class MyCustomViewPage</tmodel><tmodel> : ViewPage</tmodel><tmodel> where TModel : class<br />
    {<br />
        public new HtmlHelper</tmodel><tmodel> Html {<br />
            get<br />
            {<br />
                return new HtmlHelper</tmodel><tmodel>(base.Html.ViewContext, base.Html.ViewDataContainer);<br />
            }<br />
        }<br />
    }</p>
<p>The advantage of this is that you can now implement strongly-typed viewhelper methods as extension methods to HtmlHelper</tmodel><tmodel> &#8211; where the TModel type comes from the ViewPage</tmodel><tmodel> declaration.</p>
<p>For example, you could implement a TextBoxFor() helper method that enabled:</p>
<p>   < %= Html.TextBoxFor(p=>p.Name) %></p>
<p>Using an extension method like so:</p>
<p>    public static class StronglyTypedHtmlHelper<br />
    {<br />
        public static string TextBoxFor</tmodel><tmodel>(this HtmlHelper</tmodel><tmodel> htmlHelper, Expression<func <TModel, string>> action)<br />
        {<br />
            var expression = (MemberExpression)action.Body;<br />
            var function = action.Compile();   </p>
<p>            TModel model = (TModel) htmlHelper.ViewData.Model;</p>
<p>            string value = function(model);</p>
<p>            return &#8220;<br />
<input value='" + value + "' type='text'/>&#8220;;<br />
        }<br />
    }</p>
<p>You will get full VS 2008 intellisense for extension methods like this within the .aspx editor.  Because they are extension methods, you can implement them in separate libraries (as opposed to having to bake them into your base class).  This will also naturally &#8220;group&#8221; your html helpers in one place under the Html. property (making them a little more discoverable).</p>
<p>Because HtmlHelper<t> derives from HtmlHelper, you will be able to see and use all existing html helper extensions built-into ASP.NET MVC, as well as all strongly typed ones you add.  If you want to hide the built-in late-bound extension methods you can do this by simply commenting out the System.Web.Mvc.Html namespace from web.config (since the built-in helpers are implemented as extension methods &#8211; if you nuke their namespace they will disappear).</p>
<p>The above solution today requires you to add HtmlHelper</t><t> and a custom ViewPage</t><t> to enable this scenario.  We are considering adding these types built-into ASP.NET MVC 1.0 &#8211; which would enable you to write strongly-typed Html.TextBoxFor(p=>p.Name) extension methods out of the box really easily.</p>
<p>Hope this helps,</p>
<p>Scott</t></func></tmodel></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1343">
		<div id="comment-1343">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://vladan.strigo.net' rel='external nofollow' class='url'>Vladan Strigo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1343">November 13, 2008 at 10:05 pm</a></div>

		<div class="comment-body"><p>Hi Karl,</p>
<p>Take a look at this:</p>
<p><a href="http://akuaproject.googlecode.com/svn/trunk/framework/trunk/src/Web.MVC/" rel="nofollow">http://akuaproject.googlecode.com/svn/trunk/framework/trunk/src/Web.MVC/</a></p>
<p>its part of my own &#8220;glue&#8221; framework which handles the MVC part, there you can find helpers for all html control types. It is implemented based on Chad&#8217;s and Jeremry&#8217;s ideas.</p>
<p>Its a first version implementation and needs more cleanup, but it works for now.</p>
<p>Cheers!</p>
<p>Vladan</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1342">
		<div id="comment-1342">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://chadmyers.lostechies.com' rel='external nofollow' class='url'>Chad Myers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1342">November 13, 2008 at 9:12 pm</a></div>

		<div class="comment-body"><p>@LaptopHeaven:</p>
<p>Drats! I&#8217;ve been outed&#8230;</p>
<p>*ahem* I mean, I have no idea what you&#8217;re talking about. Surely you are mistaken.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1341">
		<div id="comment-1341">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">LaptopHeaven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1341">November 13, 2008 at 8:50 pm</a></div>

		<div class="comment-body"><p>I found they have posted code to google:</p>
<p><a href="http://code.google.com/p/opinionatedmvc/" rel="nofollow">http://code.google.com/p/opinionatedmvc/</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1340">
		<div id="comment-1340">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://morten.lyhr.dk' rel='external nofollow' class='url'>Morten Lyhr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1340">November 13, 2008 at 8:15 pm</a></div>

		<div class="comment-body"><p>Great stuff.</p>
<p>I and think the level of abstraction is just right.</p>
<p>One of the main reasons i like monorail and ASP MCV is that the markup is clean. I can read the markup and i know how the final result will be,</p>
<p>If the markup builder (TextboxFor, Html etc) get to abstract, you will loose the transparency.</p>
<p>I wonder how long before someone introduces a markup builder like:</p>
<p>RenderMarkupFor(someModel)</p>
<p>with nothing else in the view.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-1339">
		<div id="comment-1339">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1339">November 13, 2008 at 7:28 pm</a></div>

		<div class="comment-body"><p>Jeff:<br />
Cool stuff. Though I do think what I have here is an evolution beyond what you did. This approach really makes the domain king. Without any extra code in your markup, TextBoxFor(u => u.Name) can be generate pretty complex html &#8211; validation rules, javascript, whatever. We actually have it generate labels, so that:</p>
<p>TextBoxFor(u => u.Name); automatically creates:</p>
<p><label for="u.Name">User Id</label><br />
<input type="textbox" name="u.Name" maxlength="50" />  (it looks up &#8220;User:Name&#8221; in a dictionary used for localization).</p>
<p>We also have it so you can present a list based on an enum:</p>
<p>RadioListFor(u => u.AccountType).Exclude(AccountType.Uknown).TemplatedWith(&#8220;
<div class=\"choice\">{0} {1}</div>
<p>&#8220;)  </p>
<p>will automagically generate:</p>
<p><label for="u.AccountType">Account Type</label></p>
<div class="choice">
<input type="radio" name="u.AcccountType" value="1" /> Guest</div>
<div class="choice">
<input type="radio" name="u.AcccountType" value="2" /> Normal</div>
<div class="choice">
<input type="radio" name="u.AcccountType" value="3" /> Admin</div>
<p>and check the right one if an existing User is supplied.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1338">
		<div id="comment-1338">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.jeffhandley.com' rel='external nofollow' class='url'>Jeff Handley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/karlseguin/2008/11/13/textboxfor-u-gt-u-name-unleash-the-power/#comment-1338">November 13, 2008 at 6:57 pm</a></div>

		<div class="comment-body"><p>Karl,</p>
<p>This is great stuff.  It looks a lot like some stuff I blogged about awhile back.</p>
<p><a href="http://blog.jeffhandley.com/archive/2008/03/08/custom-controls-everywhere-and-asp.net-mvc-part-2.aspx" rel="nofollow">http://blog.jeffhandley.com/archive/2008/03/08/custom-controls-everywhere-and-asp.net-mvc-part-2.aspx</a></p>
<p>While I got good feedback from some folks on my blog, Phil Haack and Rob Conery weren&#8217;t sold.  I&#8217;d be curious to see what kind of feedback you get.</p>
<p>Jeff Handley</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.315 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 13:27:02 -->
<!-- super cache -->