<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Silverlight Frankenstein | Rod Paddock</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/rodpaddock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/rodpaddock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='10,000 Hours to Graceland' href='http://codebetter.com/rodpaddock/2009/04/26/10-000-hours-to-graceland/' />
<link rel='next' title='Move The Chair' href='http://codebetter.com/rodpaddock/2009/07/03/move-the-chair/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/rodpaddock/?p=50' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,128] -->
<link rel="canonical" href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank2_thumb_63E4F0E4.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787626&amp;Signature=8HoBgLyaEuIOaRU7DqL9ZJY9AWk%3d' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-50" class="post-50 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">Silverlight Frankenstein</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/rodpaddock/author/rodpaddock/" title="View all posts by rodpaddock">rodpaddock</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/" title="3:40 pm" rel="bookmark"><span class="entry-date">May 19, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/rodpaddock/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/rodpaddock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank2_5F00_661EE8EF.jpg"><img border="0" align="left" width="114" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank2_thumb_63E4F0E4.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787626&amp;Signature=8HoBgLyaEuIOaRU7DqL9ZJY9AWk%3d" alt="Frank2" height="151" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin: 0px 15px 0px 0px;border-right-width: 0px" /></a> For the last 6 months I have been working on a massive call center application that uses JavaScript heavily to provide a rich client experience. While working on this application a feature request was made that threw me for a loop. The requirement was that should the users browser die or lock up their session state would need to be recoverable, meaning when the browser was restarted&nbsp; we would need to recover state. With a little head scratching and soul searching I came up with this idea:</p>
<p align="center"><em><strong>&ldquo;Why not user Silverlight, Jquery, JSON and .NET Isolated Storage to persist client information on the browser. It&rsquo;s Alive!!!!&rdquo; </strong></em></p>
<p align="left">I then went to work to create this monster. </p>
<h2>Constructing a Monster</h2>
<p align="left">1. Create a new Silverlight Application with the test site included.&nbsp; Initially this application will have a visual representation. You will be changing this application to a&nbsp; &ldquo;headless&rdquo; version later.</p>
<p align="left">2. Add a new class to your application. Lets&nbsp; call that class Frank.</p>
<p align="left">3. Add a reference (and appropriate using statement) to System.Windows.Browser to your Silverlight Application. System.Windows.Browser is the assembly used to integrate Silverlight with its host application.</p>
<p align="left">4. Now add a function called wakeUp to your Frank class. Decorate wakeUp with the [ScriptableMember] attribute.</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">[ScriptableMember]<br /><span style="color: #0000ff">public</span> <span style="color: #0000ff">string</span> wakeUp(<span style="color: #0000ff">string</span> input)<br />{<br />    <span style="color: #0000ff">return</span> input + System.Guid.NewGuid().ToString();<br />}</pre>
<p></div>
<div class="csharpcode">5. The next step is to expose your Frank class to your browser by registering it it with the Silverlight plugin. Registering classes is done in the Page.xaml.cs file. </div>
<p>6. Open the Page.xaml.cs file and add a reference (and appropriate using statement) to the System.Windows.Browser assembly.</p>
<p>7. Modify the constructor of the Page class adding the following code:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">public</span> Page()<br />{<br />    InitializeComponent();<br />    HtmlPage.RegisterScriptableObject(<span style="color: #006080">"frank"</span>,<span style="color: #0000ff">new</span> Frank());<br />}<br /></pre>
<p></div>
<p>&nbsp;8. Now your Silverlight Frankenstein is exposed to your browser&rsquo;s scripting code. Now lets go to the browser and wake up the monster.</p>
<h2></h2>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank1_5F00_7F1D49E5.jpg"><img border="0" align="left" width="116" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank1_thumb_6C68502E.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787626&amp;Signature=oe5tcY%2bqmn0SzpNrvInrYd9QQ9s%3d" alt="Frank1" height="149" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin: 0px 5px 0px 0px;border-right-width: 0px" /></a> </p>
<h2>Waking Up the Monster</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Our preferred method of working with the DOM and JavaScript is to use jQuery. jQuery found at <a href="http://www.jquery.com">www.jquery.com</a> is a very useful library that takes the pain away from working with client side applications.</p>
<p>Along with jQuery we use the JSON library to serialize and de-serialize JavaScript objects. the JSON library can be found at <a href="http://www.JSON.org/json2.js" title="http://www.JSON.org/json2.js">http://www.JSON.org/json2.js</a></p>
<p>Now lets go to work and call our monster from our JavaScript application.</p>
<p>Important Step:</p>
<p>Before you begin this exercise modify the &lt;object&gt; tag in the HTML page created when you started the silverlight application. You need to add an ID attribute to that tag. Your Silverlight tag should look like:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">&lt;<span style="color: #0000ff">object</span> id=<span style="color: #006080">"frank"</span> data=<span style="color: #006080">"data:application/x-silverlight-2,"</span> type=<span style="color: #006080">"application/x-silverlight-2"</span> width=<span style="color: #006080">"100%"</span> height=<span style="color: #006080">"100%"</span>&gt;<br /> &lt;param name=<span style="color: #006080">"source"</span> value=<span style="color: #006080">"ClientBin/SilverlightFrankenstein.xap"</span>/&gt;<br /> &lt;param name=<span style="color: #006080">"onerror"</span> value=<span style="color: #006080">"onSilverlightError"</span> /&gt;<br /> &lt;param name=<span style="color: #006080">"background"</span> value=<span style="color: #006080">"blue"</span> /&gt;<br /> &lt;param name=<span style="color: #006080">"minRuntimeVersion"</span> value=<span style="color: #006080">"2.0.31005.0"</span> /&gt;<br /> &lt;param name=<span style="color: #006080">"autoUpgrade"</span> value=<span style="color: #006080">"true"</span> /&gt;<br /> &lt;a href=<span style="color: #006080">"http://go.microsoft.com/fwlink/?LinkID=124807"</span> style=<span style="color: #006080">"text-decoration: none;"</span>&gt;<br />    &lt;img src=<span style="color: #006080">"http://go.microsoft.com/fwlink/?LinkId=108181"</span> alt=<span style="color: #006080">"Get Microsoft Silverlight"</span> style=<span style="color: #006080">"border-style: none"</span>/&gt;<br />  &lt;/a&gt;<br /> &lt;/<span style="color: #0000ff">object</span>&gt;</pre>
<p></div>
<p>&nbsp;Now you can proceed to add the code to talk to your Silverlight application.</p>
<p>1. Add the latest and greatest version of jQuery to your web application.</p>
<p>2. Add the latest and greatest version of JSON to your web application.</p>
<p>3. Add a new Jscript file to your application. call it Frank.main.js. This file will contain your custom JavaScript code.</p>
<p>4. In the .html page generated for your Silverlight application add script references to jQuery, JSON and your Frank.main.js files.</p>
<p>5. Add a script tag to your html page to launch your jQuery application. Your code should look like the following snippet:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">&lt;script src=<span style="color: #006080">"Scripts/jquery-1.2.6.js"</span> type=<span style="color: #006080">"text/javascript"</span>&gt;&lt;/script&gt;<br />&lt;script src=<span style="color: #006080">"Scripts/json2.js"</span> type=<span style="color: #006080">"text/javascript"</span>&gt;&lt;/script&gt;<br />&lt;script src=<span style="color: #006080">"Scripts/Frank.Main.js"</span> type=<span style="color: #006080">"text/javascript"</span>&gt;&lt;/script&gt;<br />&lt;script type=<span style="color: #006080">"text/javascript"</span>&gt;<br />   $(document).ready(main);<br />&lt;/script&gt;<br /></pre>
<p></div>
<p>5. Add a function called main to the Frank.main.js file.</p>
<p>6. Now you can add code to call your Frank class. The first step is to create a function that will return a reference to your referenced frank class. The following JavaScript function does just that:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">function</span> getFrank() {<br />  <span style="color: #0000ff">var</span> returnValue = document.getElementById(<span style="color: #006080">"frank"</span>).content.frank;<br />  <span style="color: #0000ff">return</span> returnValue;<br />}</pre>
<p></div>
<p>7. You need to carefully examine that function. It does the following:</p>
<p>&nbsp; a) Grabs a handle to the Silverlight control via <strong>document.getElementByID(&ldquo;frank&rdquo;)</strong></p>
<p>&nbsp; b) Bores into the Silverlight control&rsquo;s content property and grabs a reference to&nbsp;&nbsp; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; the frank variable you referenced in the first exercise.</p>
<p>8. Now you can call your wakeUp() method as follows:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">alert(getFrank().wakeUp(<span style="color: #006080">"hello"</span>));</pre>
<p></div>
<h2></h2>
<p>&nbsp;</p>
<h2>Now For Something Useful</h2>
<p>Now that you have a basic understanding of how to call C# code from your web pages you can open up your horizons and do something useful.</p>
<p>&nbsp;<a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/s_5F00_spider_5F00_399849BA.jpg"><img border="0" align="right" width="244" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/s_spider_thumb_6955F239.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787627&amp;Signature=truyBse%2bxyHCy%2b9Vf88HVVcrb64%3d" alt="s_spider" height="178" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin-left: 0px;margin-right: 0px;border-right-width: 0px" /></a> </p>
<h2>Using the Visual Studio Debugger</h2>
<p>One of the more interesting things I came up with was integrating the Visual Studio debugger into my JavaScript applications. Rather than debugging variables via the good old alert() function why not spit information to the debugger?</p>
<p>&nbsp;</p>
<p>The following code blocks show how you can spit data from your JavaScript application into the Visual Studio debugger.</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">[ScriptableMember]<br /><span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> writeline(<span style="color: #0000ff">string</span> output)<br />{<br /> System.Diagnostics.Debug.WriteLine(output);<br />}</pre>
<p></div>
<p>&nbsp;</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">function</span> debuggerTest() {<br />    <span style="color: #0000ff">for</span> (i=0; i&lt;100; i++) {<br />        writeline(i);<br />    }<br />}</pre>
<p></div>
<p>&nbsp;<a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank3_5F00_327B9DF3.jpg"><img border="0" align="left" width="244" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/Frank3_thumb_1B502375.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787627&amp;Signature=C1IKTEx7D4RqC9OnMK9BYcPTn5I%3d" alt="Frank3" height="184" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin: 0px 5px 0px 0px;border-right-width: 0px" /></a> </p>
<h2>Calculating Ages</h2>
<p>Lets face it JavaScript date support,especially when it comes to date calculations sucks.Date support in the .NET framework is much better. Especially when you use the &ldquo;wrapped up&rdquo; code found in the Microsoft.VisualBasic namespace.</p>
<p>The following code calculates a person&rsquo;s age (in years) using the DateDiff() function found in the Microsoft.VisualBasic assembly. To use this code add a reference to the Microsoft.VisualBasic assembly to your Silverlight Application. </p>
<p>The following code snippets show how to calculate an age from a given date:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">[ScriptableMember]<br />public long getAge(string inputDate)<br />{<br />    long returnValue = <span style="color: #006080">-1;</span><br />    try<br />    {<br />        <span style="color: #0000ff">var</span> dateValue = System<span style="color: #cc6633">.Convert</span><span style="color: #cc6633">.ToDateTime</span>(inputDate);<br />        returnValue = Microsoft<span style="color: #cc6633">.VisualBasic</span><span style="color: #cc6633">.DateAndTime</span><span style="color: #cc6633">.DateDiff</span>(Microsoft<span style="color: #cc6633">.VisualBasic</span><span style="color: #cc6633">.DateInterval</span><span style="color: #cc6633">.Year</span>,<br />                 dateValue,<br />                 System<span style="color: #cc6633">.DateTime</span><span style="color: #cc6633">.Now</span>,<br />                 Microsoft<span style="color: #cc6633">.VisualBasic</span><span style="color: #cc6633">.FirstDayOfWeek</span><span style="color: #cc6633">.System</span>,<br />                 Microsoft<span style="color: #cc6633">.VisualBasic</span><span style="color: #cc6633">.FirstWeekOfYear</span><span style="color: #cc6633">.System</span>);<br />    }<br />    catch (Exception)<br />    {<br />        returnValue = <span style="color: #006080">-2;</span><br />    <span style="color: #006080">}<br />    return returnValue;</span><br />}<br /></pre>
<p></div>
<p>&nbsp;</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">alert(getFrank().getAge(<span style="color: #006080">"01/01/1981"</span>));c</pre>
<p></div>
<p>&nbsp;</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/51XJ2eVrTaL_5F005F00_SL500_5F00_166D6FB9.jpg"><img border="0" align="left" width="172" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/51XJ2eVrTaL__SL500_thumb_13C744B9.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787627&amp;Signature=X27ldH5iyOApItAcXsVHEnqHAXA%3d" alt="51XJ2eVrTaL__SL500" height="244" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin: 0px 10px 0px 0px;border-right-width: 0px" /></a> </p>
<h2>Final Frankenstein</h2>
<p>The original purpose of this exercise is to be able to save and restore form state from a client browser session. This is where a good plan comes together. Saving state involves a number of moving parts. </p>
<p>0. Create a simple HTML form with some fields.</p>
<p>1. Create an array of the objects representing the data from a set of web input fields.</p>
<p>2. Serialize the array into a string using JSON (JavaScript Object Notation)</p>
<p>3. Pass that string to Silverlight and save it to disk using Silverlight&rsquo;s Isolated storage mechanism.</p>
<p>4. Retrieve the JSON data from Isolated Storage and de-serialize it back to an array.</p>
<p>5. Re-populate the controls on the form from the array.</p>
<p>&nbsp;</p>
<h3>Simple HTML</h3>
<p>This code is about the simplest HTML form you could create. Two text fields and two buttons. The two buttons will be used to save and restore state (we save and restore state via a timer).</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">&lt;</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>Last Name<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">input</span> <span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span> <span style="color: #ff0000">id</span><span style="color: #0000ff">="txtLastname"</span><span style="color: #0000ff">/&gt;&lt;</span><span style="color: #800000">br</span> <span style="color: #0000ff">/&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>First Name<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">input</span> <span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span> <span style="color: #ff0000">id</span><span style="color: #0000ff">="txtFirstName"</span><span style="color: #0000ff">/&gt;&lt;</span><span style="color: #800000">br</span> <span style="color: #0000ff">/&gt;</span><br />    <br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">input</span> <span style="color: #ff0000">id</span><span style="color: #0000ff">="cmdSaveState"</span> <span style="color: #ff0000">type</span><span style="color: #0000ff">="button"</span> <span style="color: #ff0000">value</span><span style="color: #0000ff">="Save State"</span> <span style="color: #0000ff">/&gt;</span> <br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">input</span> <span style="color: #ff0000">id</span><span style="color: #0000ff">="cmdRestoreState"</span> <span style="color: #ff0000">type</span><span style="color: #0000ff">="button"</span> <span style="color: #ff0000">value</span><span style="color: #0000ff">="Restore State"</span> <span style="color: #0000ff">/&gt;</span> </pre>
<p></div>
<p>The following code wires up the buttons to functions to save and restore state:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">$(<span style="color: #006080">"#cmdRestoreState"</span>).click(restoreState);<br />$(<span style="color: #006080">"#cmdSaveState"</span>).click(saveState);</pre>
<p></div>
<h3>Gathering and Restoring Data </h3>
<p>The next set of code creates an array of objects representing page content. It also serializes the content to a JSON string using the JSON library added to your project earlier. </p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">function</span> getContentAsJSON() {<br />    <span style="color: #0000ff">var</span> inputControls = $(<span style="color: #006080">":input"</span>).not(<span style="color: #006080">":button"</span>).not(<span style="color: #006080">".ignorestate"</span>);<br />    <span style="color: #0000ff">var</span> controlData = Array();<br />    <span style="color: #0000ff">for</span> (i = 0; i &lt; inputControls.length; i++) {<br />        controlData.push({ ID: inputControls[i].id, Value: inputControls[i].value, Type: inputControls[i].type });<br />    }<br />    <span style="color: #0000ff">var</span> jsondata = JSON.stringify(controlData);<br />    <span style="color: #0000ff">return</span> jsondata;<br />}</pre>
<p></div>
<p>&nbsp;<strong>Note: this code gathers up data for all controls except for buttons and ones that have the .ignorestate style attached to them.</strong></p>
<p>The next set of code is the converse of the prior. It takes a JSON string and de-serializes it back to an array and repopulates control values based on its content.</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">function</span> restoreControlState(controlDataString) {<br />    <span style="color: #0000ff">if</span> (controlDataString.length &gt; 0) {<br />        <span style="color: #0000ff">var</span> controlData = JSON.parse(controlDataString);<br />        <span style="color: #0000ff">for</span> (i = 0; i &lt; controlData.length; i++) {<br />            $(<span style="color: #006080">"#"</span> + controlData[i].ID).val(controlData[i].Value);<br />        }<br />    }<br />}</pre>
<p></div>
<p>&nbsp;</p>
<h3>Saving and Restoring State</h3>
<p>Now you need a mechanism for storing and retrieving the data to client workstation. To do this, you will use the Isolated Storage mechanisms contained in the Silverlight framework. Isolated storage is a data storage mechanism available in both standard .NET and Silverlight applications. Isolated storage is a set of APIs used to read and write files to a virtual file system managed by the .NET framework. Silverlight applications have a default 1MB (yes 1MB) of storage available to them for reading and writing files.&nbsp; To use the following code examples import System.IO and System.IO.IsolatedStorage to your applications:</p>
<p>&nbsp;The first is used to preserve state. It&nbsp; does the following:</p>
<p>1.&nbsp; Opens the &ldquo;virtual file system&rdquo; presented by IsolatedStorage</p>
<p>2. Checks to see if the &ldquo;sessioncontents.txt&rdquo;&nbsp; file exists&nbsp; . If so it deletes it.</p>
<p>3. Creates a file stream to write content to.</p>
<p>4. Uses a standard StreamWriter to push content to the file.</p>
<p>5. Flushes the buffer and closes the file handle</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">[ScriptableMember]<br /><span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> saveState(<span style="color: #0000ff">string</span> stateString)<br />{<br />    <span style="color: #008000">//yes this is a MAGIC string for a demo</span><br />    var contentFileName = <span style="color: #006080">"sessionContents.txt"</span>;<br />    var userStore = IsolatedStorageFile.GetUserStoreForApplication();<br /><br />    <span style="color: #008000">//whack the file if it exists</span><br />    <span style="color: #0000ff">if</span> (userStore.FileExists(contentFileName))<br />    {<br />        userStore.DeleteFile(contentFileName);<br />    }<br />    var file = userStore.CreateFile(contentFileName);<br />    var writer = <span style="color: #0000ff">new</span> StreamWriter(file);<br />    writer.WriteLine(stateString);<br />    writer.Flush();<br />    writer.Close();<br />    file.Close();<br />}<br /></pre>
<p></div>
<p>The next step is to return the data from IsolatedStorage. It does the converse:</p>
<p>1.&nbsp; Opens the &ldquo;virtual file system&rdquo; presented by IsolatedStorage</p>
<p>2. Checks to see if the &ldquo;sessioncontents.txt&rdquo;&nbsp; file exists&nbsp; . If so it opens it.</p>
<p>3. Creates a file stream to read content from.</p>
<p>4. Uses a standard StreamReader to read content from the file.</p>
<p>5. Closes the file handle</p>
<p>6 Returns the string to the caller.</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">[ScriptableMember]<br /><span style="color: #0000ff">public</span> <span style="color: #0000ff">string</span> getState()<br />{<br />    var returnValue = <span style="color: #006080">""</span>;<br />    <span style="color: #008000">//yes this is a MAGIC string for a demo</span><br />    var contentFileName = <span style="color: #006080">"sessionContents.txt"</span>;<br />    var userStore = IsolatedStorageFile.GetUserStoreForApplication();<br /><br />    <span style="color: #008000">//whack the file if it exists</span><br />    <span style="color: #0000ff">if</span> (userStore.FileExists(contentFileName))<br />    {<br />        var file = userStore.OpenFile(contentFileName,FileMode.Open,FileAccess.Read );<br />        var reader = <span style="color: #0000ff">new</span> StreamReader(file);<br />        returnValue = reader.ReadToEnd();<br />        reader.Close();<br />    }<br /><br />    <span style="color: #0000ff">return</span> returnValue;<br />}<br /></pre>
<p></div>
<p>&nbsp;</p>
<p>Now all you need is the small glue code to put it all together:</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 97.5%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 100%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px">function saveState() {<br />    getFrank().saveState(getContentAsJSON());<br />}<br /><br />function restoreState() {<br />    restoreControlState(getFrank().getState());<br />}</pre>
<p></div>
<p>&nbsp;</p>
<p>That&rsquo;s all you need to save and restore state from a HTML form</p>
<p>&nbsp;</p>
<h2>Removing the Head</h2>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/FRANKENSTEIN_5F00_JR_5F00_HEADSHOT_5F00_07C55485.jpg"><img border="0" align="right" width="239" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/rodpaddock/FRANKENSTEIN_JR_HEADSHOT_thumb_25A66937.jpg?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787627&amp;Signature=%2fVR%2bzlUakh3ehmHqinMsiokRPKc%3d" alt="FRANKENSTEIN_JR_HEADSHOT" height="244" style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;margin-left: 0px;margin-right: 0px;border-right-width: 0px" /></a> </p>
<p>&nbsp;Finally you can go &ldquo;remove the head&rdquo; from your Silverlight application. this is rather simple. To remove the head from your Silverlight application you simply go to the Page.xaml file and change the size attributes to zero. Now you have a &ldquo;headless&rdquo; frankenstein for your fun and enjoyment.</p>
<div style="font-size: 8pt;margin: 20px 0px 10px;overflow: auto;width: 64.82%;cursor: text;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;height: 133px;background-color: #f4f4f4;text-align: left;border: silver 1px solid;padding: 4px">
<pre style="font-size: 8pt;margin: 0em;overflow: visible;width: 68.83%;color: black;direction: ltr;line-height: 12pt;font-family: 'Courier New', courier, monospace;height: 93px;background-color: #f4f4f4;text-align: left;border-style: none;padding: 0px"><span style="color: #0000ff">&lt;</span><span style="color: #800000">UserControl</span> <span style="color: #ff0000">x:Class</span><span style="color: #0000ff">="SilverlightFrankenstein.Page"</span><br />    <span style="color: #ff0000">xmlns</span><span style="color: #0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span> <br />    <span style="color: #ff0000">xmlns:x</span><span style="color: #0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</span> <br />    <span style="color: #ff0000">Width</span><span style="color: #0000ff">="0"</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">="0"</span><span style="color: #0000ff">&gt;</span><br />    <span style="color: #0000ff">&lt;</span><span style="color: #800000">Grid</span> <span style="color: #ff0000">x:Name</span><span style="color: #0000ff">="LayoutRoot"</span> <span style="color: #ff0000">Background</span><span style="color: #0000ff">="White"</span><span style="color: #0000ff">&gt;</span><br /><br />    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">Grid</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">UserControl</span><span style="color: #0000ff">&gt;</span></pre>
<p></div>
<p>&nbsp;</p>
<p>&nbsp;I hope you have enjoyed this post. You can find this code at <a href="http://www.dashpoint.com/downloads/silverlightfrankenstein.zip">www.dashpoint.com/downloads/silverlightfrankenstein.zip</a></p>
<div class="shr-publisher-50"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/rodpaddock/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/" title="Permalink to Silverlight Frankenstein" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/feed/" title="Comments RSS to Silverlight Frankenstein" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-50 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/rodpaddock/2009/04/26/10-000-hours-to-graceland/" rel="prev"><span class="meta-nav">&larr;</span> 10,000 Hours to Graceland</a></div>
					<div class="nav-next"><a href="http://codebetter.com/rodpaddock/2009/07/03/move-the-chair/" rel="next">Move The Chair <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">9 Responses to <em>Silverlight Frankenstein</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-208">
		<div id="comment-208">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.callcenterphilippines.org' rel='external nofollow' class='url'>philippine call center</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-208">May 19, 2010 at 6:44 am</a></div>

		<div class="comment-body"><p>Thanks for sharing this post. This maybe used by the philippine call center in the future.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-207">
		<div id="comment-207">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Ronald</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-207">May 23, 2009 at 10:41 am</a></div>

		<div class="comment-body"><p>Dumas: I did not look at Google Gears. I don&#8217;t know if this is good option as users need to install Gears, but I will definitely have a look at it. Thanks for the suggestion. </p>
<p>Hope Silverlight will support client side database in the future! Would make everything a bit more robust. </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-206">
		<div id="comment-206">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Dave T.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-206">May 21, 2009 at 9:43 pm</a></div>

		<div class="comment-body"><p>I use flash to do something similar. Unlike silverlight everyone seems to have it an I rarely run across the case where they have shut local storage off.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-205">
		<div id="comment-205">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/members/rodpaddock/default.aspx' rel='external nofollow' class='url'>Rod Paddock [MVP]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-205">May 21, 2009 at 7:37 pm</a></div>

		<div class="comment-body"><p>Ronald: Cool app.</p>
<p>Dumas: I need to look at that library.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-204">
		<div id="comment-204">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Art</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-204">May 21, 2009 at 2:22 pm</a></div>

		<div class="comment-body"><p>Interesting concept. Just wondering if you looked at Google Gears (JavaScript) to save/restore browser application state.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-203">
		<div id="comment-203">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Ronald</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-203">May 21, 2009 at 11:26 am</a></div>

		<div class="comment-body"><p>For another possible use of isolated storage check this webapp <a href="http://www.ToolToMeet.com" rel="nofollow">http://www.ToolToMeet.com</a>. </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-202">
		<div id="comment-202">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Frank N. Stein</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-202">May 21, 2009 at 6:09 am</a></div>

		<div class="comment-body"><p>I&#8217;m getting really sick of you guys tarnishing my name.</p>
<p>Oh, nice article&#8230;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-201">
		<div id="comment-201">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.garysherman.com' rel='external nofollow' class='url'>Gary Sherman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-201">May 20, 2009 at 3:26 am</a></div>

		<div class="comment-body"><p>Cool stuff Rod!<br />
I definitely have many ideas on how this could be useful in our web apps.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-200">
		<div id="comment-200">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Nordes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/rodpaddock/2009/05/19/silverlight-frankenstein/#comment-200">May 19, 2009 at 5:06 pm</a></div>

		<div class="comment-body"><p>Brilliant article. I will maybe use that in the future. </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/rodpaddock/2009/05/19/silverlight-frankenstein/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/rodpaddock/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Frodpaddock%2F2009%2F05%2F19%2Fsilverlight-frankenstein%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.399 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 20:35:14 -->
<!-- super cache -->