<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>ASP.NET Page Inheritance &#8211; Base Page Classes in your Web Applications | David Hayden</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/davidhayden/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/davidhayden/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Versant Open Access .NET &#8211; O/R Mapper' href='http://codebetter.com/davidhayden/2005/03/13/versant-open-access-net-or-mapper/' />
<link rel='next' title='Enterprise Library &#8211; Logging and Instrumentation Application Block &#8211; Patterns and Practices' href='http://codebetter.com/davidhayden/2005/03/17/enterprise-library-logging-and-instrumentation-application-block-patterns-and-practices/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/davidhayden/?p=23' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,180] -->
<link rel="canonical" href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-23" class="post-23 post type-post status-publish format-standard hentry category-asp-net category-c">
					<h1 class="entry-title">ASP.NET Page Inheritance &#8211; Base Page Classes in your Web Applications</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/davidhayden/author/davidhayden/" title="View all posts by davidhayden">davidhayden</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/" title="4:02 pm" rel="bookmark"><span class="entry-date">March 14, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/davidhayden/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/davidhayden/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>A week ago I talked about using <A href="http://codebetter.com/blogs/david.hayden/archive/2005/03/01/56226.aspx">XML Serialization</A> as a means to persist and retrieve&nbsp;application settings.&nbsp; Using that example as a stepping stone, I want to extend this idea further by exposing these settings via a base ASP.NET page class for use in your web applications.</P><br />
<P>In general, base page classes in your web applications help you to remove code smells in your web applications by allowing you to &#8220;Move Up&#8221; or &#8220;Pull Up&#8221; code that is common to all your web pages.&nbsp; Often, accessing application settings is one such action you do in all your web pages and is better exposed via a base page class.</P><br />
<P>I am going to take the same <STRONG>SiteSettings</STRONG> Class we used before and just expand the static methods a bit more to include saving the configuration in <STRONG>cache</STRONG> with a <STRONG>dependency</STRONG> on our <STRONG>sitesettings.config</STRONG> file in the application directory.&nbsp; This will improve performance so we don&#8217;t have to access the application settings from the file each time, but also have the application settings refreshed when a change is detected in the underlying file.</P><br />
<P>&nbsp;</P><br />
<FIELDSET><LEGEND>SiteSettings Class</LEGEND><PRE><SPAN>[XmlType(Namespace</SPAN><SPAN>=</SPAN><SPAN>"</SPAN><SPAN>urn:davidhayden-com:config</SPAN><SPAN>"</SPAN><SPAN>)]<br />
[XmlRoot(Namespace</SPAN><SPAN>=</SPAN><SPAN>"</SPAN><SPAN>urn:davidhayden-com:config</SPAN><SPAN>"</SPAN><SPAN>)]<br />
</SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>class</SPAN><SPAN> SiteSettings<br />
{<br />
    </SPAN><SPAN>#region</SPAN><SPAN> Private Members</SPAN><SPAN></p>
<p>    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> _name;<br />
    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> _url;<br />
    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> _emailAddress;</p>
<p>    </SPAN><SPAN>#endregion</SPAN><SPAN></p>
<p>    </SPAN><SPAN>#region</SPAN><SPAN> Properties</SPAN><SPAN></p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> Name<br />
    {<br />
        </SPAN><SPAN>get</SPAN><SPAN> { </SPAN><SPAN>return</SPAN><SPAN> _name; }<br />
        </SPAN><SPAN>set</SPAN><SPAN> { _name </SPAN><SPAN>=</SPAN><SPAN> value; }<br />
    }</p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> Url<br />
    {<br />
        </SPAN><SPAN>get</SPAN><SPAN> { </SPAN><SPAN>return</SPAN><SPAN> _url; }<br />
        </SPAN><SPAN>set</SPAN><SPAN> { _url </SPAN><SPAN>=</SPAN><SPAN> value; }<br />
    }</p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>string</SPAN><SPAN> EmailAddress<br />
    {<br />
        </SPAN><SPAN>get</SPAN><SPAN> { </SPAN><SPAN>return</SPAN><SPAN> _emailAddress; }<br />
        </SPAN><SPAN>set</SPAN><SPAN> { _emailAddress </SPAN><SPAN>=</SPAN><SPAN> value; }<br />
    }</p>
<p>    </SPAN><SPAN>#endregion</SPAN><SPAN></p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> SiteSettings() {}</p>
<p>    </SPAN><SPAN>#region</SPAN><SPAN> Static Methods</SPAN><SPAN></p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>static</SPAN><SPAN> SiteSettings Fetch()<br />
    {<br />
        </SPAN><SPAN>if</SPAN><SPAN> (HttpContext.Current.Cache[</SPAN><SPAN>"</SPAN><SPAN>SiteSettings</SPAN><SPAN>"</SPAN><SPAN>] </SPAN><SPAN>!=</SPAN><SPAN> </SPAN><SPAN>null</SPAN><SPAN>)<br />
            </SPAN><SPAN>return</SPAN><SPAN> (SiteSettings)HttpContext.Current.Cache[</SPAN><SPAN>"</SPAN><SPAN>SiteSettings</SPAN><SPAN>"</SPAN><SPAN>];<br />
        </SPAN><SPAN>else</SPAN><SPAN><br />
        {<br />
            SiteSettings settings </SPAN><SPAN>=</SPAN><SPAN> SiteSettings.FetchFromFile();<br />
            HttpContext.Current.Cache.Insert(</SPAN><SPAN>&#8220;</SPAN><SPAN>SiteSettings</SPAN><SPAN>&#8220;</SPAN><SPAN>, settings,<br />
                </SPAN><SPAN>new</SPAN><SPAN> CacheDependency(HttpContext.Current.Server.MapPath(</SPAN><SPAN>&#8220;</SPAN><SPAN>sitesettings.config</SPAN><SPAN>&#8220;</SPAN><SPAN>)));<br />
            </SPAN><SPAN>return</SPAN><SPAN> settings;<br />
        }<br />
    }</p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> </SPAN><SPAN>static</SPAN><SPAN> SiteSettings FetchFromFile()<br />
    {<br />
        SiteSettings siteSettings;</p>
<p>        XmlSerializer serializer </SPAN><SPAN>=</SPAN><SPAN> </SPAN><SPAN>new</SPAN><SPAN> XmlSerializer(</SPAN><SPAN>typeof</SPAN><SPAN>(SiteSettings));</p>
<p>        </SPAN><SPAN>using</SPAN><SPAN> (StreamReader reader </SPAN><SPAN>=</SPAN><SPAN> </SPAN><SPAN>new</SPAN><SPAN><br />
            StreamReader(HttpContext.Current.Server.MapPath(</SPAN><SPAN>&#8220;</SPAN><SPAN>sitesettings.config</SPAN><SPAN>&#8220;</SPAN><SPAN>)))<br />
        {<br />
            siteSettings </SPAN><SPAN>=</SPAN><SPAN> (SiteSettings)serializer.Deserialize(reader);<br />
        }</p>
<p>        </SPAN><SPAN>return</SPAN><SPAN> siteSettings;<br />
    }</p>
<p>    </SPAN><SPAN>#endregion</SPAN><SPAN><br />
}</SPAN></PRE></FIELDSET><br />
<P>&nbsp;</P><br />
<P>Here is our base page class, called&nbsp;<STRONG>BasePage</STRONG>,&nbsp;that essentially fetches the application settings and exposes the entire class via the protected&nbsp;field <STRONG>settings</STRONG>.&nbsp; As all protected fields,&nbsp;<STRONG>settings</STRONG> is accessible to any class that derives from <STRONG>BasePage</STRONG>.</P><br />
<P>&nbsp;</P><br />
<FIELDSET><LEGEND>BasePage Class</LEGEND><PRE><SPAN>public</SPAN><SPAN> </SPAN><SPAN>class</SPAN><SPAN> BasePage : Page<br />
{<br />
    </SPAN><SPAN>protected</SPAN><SPAN> SiteSettings settings;</p>
<p>    </SPAN><SPAN>public</SPAN><SPAN> BasePage()<br />
    {<br />
        Init </SPAN><SPAN>+=</SPAN><SPAN>new</SPAN><SPAN> EventHandler(LoadSettings);<br />
    }</p>
<p>    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>void</SPAN><SPAN> LoadSettings(</SPAN><SPAN>object</SPAN><SPAN> sender, EventArgs e)<br />
    {<br />
        settings </SPAN><SPAN>=</SPAN><SPAN> SiteSettings.Fetch();<br />
    }<br />
}</SPAN></PRE></FIELDSET><br />
<P>&nbsp;</P><br />
<P>Last, we create a page that derives from <STRONG>BasePage</STRONG>, called <STRONG>WorkingPage</STRONG>, that essentially just displays the current application settings on a web page.&nbsp; The settings are grabbed from the protected field <STRONG>settings</STRONG> in <STRONG>BasePage</STRONG> and displayed accordingly.</P><br />
<P>&nbsp;</P><br />
<FIELDSET><LEGEND>WorkingPage Class</LEGEND><PRE><SPAN>public</SPAN><SPAN> </SPAN><SPAN>class</SPAN><SPAN> WorkingPage : BasePage<br />
{<br />
    </SPAN><SPAN>protected</SPAN><SPAN> Label SiteName;<br />
    </SPAN><SPAN>protected</SPAN><SPAN> Label SiteUrl;<br />
    </SPAN><SPAN>protected</SPAN><SPAN> Label SiteEmailAddress;</p>
<p>    </SPAN><SPAN>protected</SPAN><SPAN> </SPAN><SPAN>override</SPAN><SPAN> </SPAN><SPAN>void</SPAN><SPAN> OnInit(EventArgs e)<br />
    {<br />
        </SPAN><SPAN>base</SPAN><SPAN>.OnInit (e);<br />
        </SPAN><SPAN>this</SPAN><SPAN>.Load </SPAN><SPAN>+=</SPAN><SPAN>new</SPAN><SPAN> EventHandler(Page_Load);<br />
    }</p>
<p>    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>void</SPAN><SPAN> Page_Load(</SPAN><SPAN>object</SPAN><SPAN> sender, EventArgs e)<br />
    {<br />
        </SPAN><SPAN>if</SPAN><SPAN> (</SPAN><SPAN>!</SPAN><SPAN>IsPostBack)<br />
            DisplaySettings();<br />
    }</p>
<p>    </SPAN><SPAN>private</SPAN><SPAN> </SPAN><SPAN>void</SPAN><SPAN> DisplaySettings()<br />
    {<br />
        SiteName.Text </SPAN><SPAN>=</SPAN><SPAN> settings.Name;<br />
        SiteUrl.Text </SPAN><SPAN>=</SPAN><SPAN> settings.Url;<br />
        SiteEmailAddress.Text </SPAN><SPAN>=</SPAN><SPAN> settings.EmailAddress;<br />
    }<br />
}</SPAN></PRE></FIELDSET><br />
<P>&nbsp;</P><br />
<P>And just to be complete, here is <STRONG>sitesettings.config</STRONG> and&nbsp;the&nbsp;<STRONG>sitesettings.aspx</STRONG> page used in the example:</P><br />
<P>&nbsp;</P><br />
<FIELDSET><LEGEND>sitesettings.config</LEGEND><PRE><SPAN>&lt;?</SPAN><SPAN>xml version</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>1.0</SPAN><SPAN>&#8220;</SPAN><SPAN> encoding</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>utf-8</SPAN><SPAN>&#8220;</SPAN><SPAN>?&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>SiteSettings xmlns:xsd</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>http://www.w3.org/2001/XMLSchema</SPAN><SPAN>&#8220;</SPAN><SPAN><br />
    xmlns:xsi</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>http://www.w3.org/2001/XMLSchema-instance</SPAN><SPAN>&#8220;</SPAN><SPAN><br />
    xmlns</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>urn:davidhayden-com:config</SPAN><SPAN>&#8220;</SPAN><SPAN>&gt;</SPAN><SPAN><br />
  </SPAN><SPAN>&lt;</SPAN><SPAN>Name</SPAN><SPAN>&gt;</SPAN><SPAN>DavidHayden.com</SPAN><SPAN>&lt;/</SPAN><SPAN>Name</SPAN><SPAN>&gt;</SPAN><SPAN><br />
  </SPAN><SPAN>&lt;</SPAN><SPAN>Url</SPAN><SPAN>&gt;</SPAN><SPAN>http:</SPAN><SPAN>//</SPAN><SPAN>www.davidhayden.com/&lt;/Url&gt;</SPAN><SPAN><br />
</SPAN><SPAN>  </SPAN><SPAN>&lt;</SPAN><SPAN>EmailAddress</SPAN><SPAN>&gt;</SPAN><SPAN>nospam@nospam.com</SPAN><SPAN>&lt;/</SPAN><SPAN>EmailAddress</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;/</SPAN><SPAN>SiteSettings</SPAN><SPAN>&gt;</SPAN></PRE></FIELDSET><br />
<P>&nbsp;</P><br />
<FIELDSET><LEGEND>SiteSettings.aspx</LEGEND><PRE><SPAN>&lt;%</SPAN><SPAN>@ Page Inherits</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>PageInheritance.WorkingPage</SPAN><SPAN>&#8220;</SPAN><SPAN> AutoEventWireUp</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>false</SPAN><SPAN>&#8220;</SPAN><SPAN> </SPAN><SPAN>%&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;!</SPAN><SPAN>DOCTYPE HTML PUBLIC </SPAN><SPAN>&#8220;</SPAN><SPAN>-//W3C//DTD HTML 4.01 Transitional//EN</SPAN><SPAN>&#8220;</SPAN><SPAN><br />
    </SPAN><SPAN>&#8220;</SPAN><SPAN>http://www.w3.org/TR/html4/loose.dtd</SPAN><SPAN>&#8220;</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>html</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>head</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>meta http</SPAN><SPAN>-</SPAN><SPAN>equiv</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>Content-Type</SPAN><SPAN>&#8220;</SPAN><SPAN> content</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>text/html; charset=iso-8859-1</SPAN><SPAN>&#8220;</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>title</SPAN><SPAN>&gt;</SPAN><SPAN>SiteSettings Test</SPAN><SPAN>&lt;/</SPAN><SPAN>title</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;/</SPAN><SPAN>head</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>body</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>form runat</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>server</SPAN><SPAN>&#8220;</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN>Site Name: </SPAN><SPAN>&lt;</SPAN><SPAN>asp:Label id</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>SiteName</SPAN><SPAN>&#8220;</SPAN><SPAN> runat</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>server</SPAN><SPAN>&#8220;</SPAN><SPAN> </SPAN><SPAN>/&gt;&lt;/</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN>Site Url: </SPAN><SPAN>&lt;</SPAN><SPAN>asp:Label id</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>SiteUrl</SPAN><SPAN>&#8220;</SPAN><SPAN> runat</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>server</SPAN><SPAN>&#8220;</SPAN><SPAN> </SPAN><SPAN>/&gt;&lt;/</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN>Site Email Address: </SPAN><SPAN>&lt;</SPAN><SPAN>asp:Label id</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>SiteEmailAddress</SPAN><SPAN>&#8220;</SPAN><SPAN> runat</SPAN><SPAN>=</SPAN><SPAN>&#8220;</SPAN><SPAN>server</SPAN><SPAN>&#8220;</SPAN><SPAN> </SPAN><SPAN>/&gt;&lt;/</SPAN><SPAN>p</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;/</SPAN><SPAN>form</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;/</SPAN><SPAN>body</SPAN><SPAN>&gt;</SPAN><SPAN><br />
</SPAN><SPAN>&lt;/</SPAN><SPAN>html</SPAN><SPAN>&gt;</SPAN></PRE></FIELDSET><br />
<P>&nbsp;</P><br />
<P>Application settings aren&#8217;t the only things you can place in your base pages, but it&#8217;s a good place to start if base page classes&nbsp;are new to you.</P></p>
<div class="shr-publisher-23"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/davidhayden/category/asp-net/" title="View all posts in ASP.NET" rel="category tag">ASP.NET</a>, <a href="http://codebetter.com/davidhayden/category/c/" title="View all posts in C#" rel="category tag">C#</a>. Bookmark the <a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/" title="Permalink to ASP.NET Page Inheritance &#8211; Base Page Classes in your Web Applications" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/feed/" title="Comments RSS to ASP.NET Page Inheritance &#8211; Base Page Classes in your Web Applications" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-23 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/davidhayden/2005/03/13/versant-open-access-net-or-mapper/" rel="prev"><span class="meta-nav">&larr;</span> Versant Open Access .NET &#8211; O/R Mapper</a></div>
					<div class="nav-next"><a href="http://codebetter.com/davidhayden/2005/03/17/enterprise-library-logging-and-instrumentation-application-block-patterns-and-practices/" rel="next">Enterprise Library &#8211; Logging and Instrumentation Application Block &#8211; Patterns and Practices <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">5 Responses to <em>ASP.NET Page Inheritance &#8211; Base Page Classes in your Web Applications</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-52">
		<div id="comment-52">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.davidhayden.com/' rel='external nofollow' class='url'>David Hayden</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#comment-52">March 14, 2005 at 8:02 pm</a></div>

		<div class="comment-body"><p>Good point, Sahil.  It would be better to pull it over to a variable before doing the check and casting.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-51">
		<div id="comment-51">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.davidhayden.com/' rel='external nofollow' class='url'>David Hayden</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#comment-51">March 14, 2005 at 7:56 pm</a></div>

		<div class="comment-body"><p>Thanks for pointing out the other posts, Raymond.  Good stuff!</p>
<p>You should post your slides or code on the demo as I love to read through code and learn best practices done by others.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-50">
		<div id="comment-50">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/sahil.malik' rel='external nofollow' class='url'>Sahil Malik</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#comment-50">March 14, 2005 at 5:38 pm</a></div>

		<div class="comment-body"><p>There&#8217;s a problem in this logic.</p>
<p>Check this out  &#8211;       </p>
<p>if (HttpContext.Current.Cache[&quot;SiteSettings&quot;] != null)<br />
<br />            return (SiteSettings)HttpContext.Current.Cache[&quot;SiteSettings&quot;];</p>
<p>So you read from the Cache. If you find it, you read AGAIN and return. What if between these 2 statements another thread kicked it out of the cache? You&#8217;re screwed.</p>
<p>What u should do is, fetch out of cache, and assign to a variable. And then check for the variable&#8217;s being not null. If it is not null, return the variable.</p>
<p>Man I love having time to read blogs <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-49">
		<div id="comment-49">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>Raymond Lewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#comment-49">March 14, 2005 at 5:27 pm</a></div>

		<div class="comment-body"><p>Demo&#8217;d at my local .Net users group, for clarification <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-48">
		<div id="comment-48">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>Raymond Lewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#comment-48">March 14, 2005 at 5:26 pm</a></div>

		<div class="comment-body"><p>I just did this exact demo, based on session wrapper classes, last Monday.  Serializing session state information to disk for a session wrapper created as part of a base page class.  Very similar to what I demo&#8217;d.  Very good starting point for base page inheritance.  For some more information, for those of you reading this post, check these links on how some of us others here at codebetter do some implementation into base pages:</p>
<p><a target="_new" href="http://codebetter.com/blogs/eric.wise/archive/2005/02/02/50334.aspx">http://codebetter.com/blogs/eric.wise/archive/2005/02/02/50334.aspx</a></p>
<p><a target="_new" href="http://codebetter.com/blogs/raymond.lewallen/archive/2005/02/02/50358.aspx">http://codebetter.com/blogs/raymond.lewallen/archive/2005/02/02/50358.aspx</a></p>
<p><a target="_new" href="http://codebetter.com/blogs/brendan.tompkins/archive/2005/02/23/55903.aspx">http://codebetter.com/blogs/brendan.tompkins/archive/2005/02/23/55903.aspx</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/davidhayden/2005/03/14/asp-net-page-inheritance-base-page-classes-in-your-web-applications/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://codebetter.com/davidhayden/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='23' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f50628d902" /></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.433 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 20:10:00 -->
<!-- super cache -->