<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Generics and Factories in the Data Access Layer &#8211; Code Generation | David Hayden</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/davidhayden/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/davidhayden/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Another Inversion of Control Example With Infrastructure and DAO Components' href='http://codebetter.com/davidhayden/2006/10/18/another-inversion-of-control-example-with-infrastructure-and-dao-components/' />
<link rel='next' title='SubSonic &#8211; Extending The Zero Code DAL With A &quot;Schema Provider Service&quot; For Kicks' href='http://codebetter.com/davidhayden/2006/10/28/subsonic-extending-the-zero-code-dal-with-a-schema-provider-service-for-kicks/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/davidhayden/?p=134' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,176] -->
<link rel="canonical" href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-134" class="post-134 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">Generics and Factories in the Data Access Layer &#8211; Code Generation</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/davidhayden/author/davidhayden/" title="View all posts by davidhayden">davidhayden</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/" title="12:42 am" rel="bookmark"><span class="entry-date">October 25, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/davidhayden/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/davidhayden/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>The family has been battling the flu for the past week, but it appears the worse is now over. Today was a day of recuperation, drinking <a href="http://www.relaxsipenjoy.com/">green tea</a> and orange Gatorade to replenish the body&#039;s nutrients.</p>
<p>Although a bit delirious from lack of sleep, I was playing a bit with the elegance of generics and factories in the data access layer. A lot of this realization was due to my recent investigation of the <a href="http://davidhayden.com/blog/dave/archive/2006/09/23/DataAccessGuidancePackageCodeGeneration.aspx">Data Access Guidance Package</a> in the <a href="http://davidhayden.com/blog/dave/category/56.aspx">Web Services Software Factory</a>. Although there are shortcomings in their repository implementations, I give them extra points for their elegant use of generics and the use of factories to&nbsp;reinforce <a href="http://davidhayden.com/blog/dave/archive/2004/12/10/680.aspx">high cohesion</a> and&nbsp;the <a href="http://davidhayden.com/blog/dave/archive/2005/05/29/1066.aspx">single-responsibility principle</a>.</p>
<p>The nice bit of refactoring Microsoft has done with the repositories is similar to what Sean has done with <a href="http://www.adapdev.com/codus/">Codus</a>. I haven&#039;t played with Codus in awhile, but I remember being impressed with how well it was refactored. If you are looking for a gentle introduction to <a href="http://davidhayden.com/blog/dave/category/24.aspx?Show=All">O/R Mapping</a>, Codus is a great way to&nbsp;get started&nbsp;and offers a good productivity boost.</p>
<p>&nbsp;</p>
<p><strong>Data Access Objects</strong></p>
<p>Tossing the Data Access Guidance Package aside for a moment, I decided to mimic the use of generics and factories used in the Web Service Software Factory to make my own DAO&#039;s. Here is an example that shows a best case example of grabbing an <strong>Order Entity</strong> from an <strong>Orders Table</strong> based on the primary key, <strong>OrderId</strong>:</p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> </span><span style="color: #0000ff">class</span><span style="color: #000000"> OrderDAO : DAO</span><span style="color: #000000">&lt;</span><span style="color: #000000">Order</span><span style="color: #000000">&gt;</span><span style="color: #000000">
{
    </span><span style="color: #0000ff">public</span><span style="color: #000000"> OrderDAO(IDatabase database) : </span><span style="color: #0000ff">base</span><span style="color: #000000">(database) { }

    </span><span style="color: #0000ff">public</span><span style="color: #000000"> Order GetOrderByOrderId(</span><span style="color: #0000ff">int</span><span style="color: #000000"> orderId)
    {
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #0000ff">base</span><span style="color: #000000">.FindOne</span><span style="color: #000000">&lt;</span><span style="color: #0000ff">int</span><span style="color: #000000">&gt;</span><span style="color: #000000">(</span><span style="color: #0000ff">new</span><span style="color: #000000"> GetOrderByOrderIdSelectionFactory(), </span><span style="color: #0000ff">new</span><span style="color: #000000"> OrderFactory(), orderId);
    }
}</span></pre>
<p>&nbsp;</p>
<p>Obviously there is a lot of code hidden in the factories, <strong>GetOrderByOrderIdSelectionFactory</strong> and <strong>OrderFactory</strong>, as well as the <strong>FindOne</strong> Method, but you gotta love the simplicity and elegance here. Things are nicely packaged here based on responsibility, and the naming is fairly intuitive such that&nbsp;a developer&nbsp;looking at this code for the first time can get an idea of what is happening.</p>
<p>&nbsp;</p>
<p><strong>Command Factories &#8211; e.g. GetOrderByOrderIdSelectionFactory</strong></p>
<p>We can break down the parts and start to see some of the &quot;necessary&quot; components of an <a href="http://davidhayden.com/blog/dave/category/24.aspx?Show=All">O/R Mapper</a>. The <strong>GetOrderByOrderIdSelectionFactory</strong> is nothing more than a DbCommand factory. To get our entity from the database, we will eventually need to issue a select command. The GetOrderByOrderIdSelectionFactory creates the command:</p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> </span><span style="color: #0000ff">class</span><span style="color: #000000"> GetOrderByOrderIdSelectionFactory : ISelectionFactory</span><span style="color: #000000">&lt;</span><span style="color: #0000ff">int</span><span style="color: #000000">&gt;</span><span style="color: #000000">
{
    </span><span style="color: #0000ff">public</span><span style="color: #000000"> DbCommand CreateSelectCommand(IDatabase database, </span><span style="color: #0000ff">int</span><span style="color: #000000"> orderId)
    {
        DbCommand command </span><span style="color: #000000">=</span><span style="color: #000000"> database.CreateStoredProcCommand(</span><span style="color: #000000">&quot;</span><span style="color: #008080">GetOrderByOrderId</span><span style="color: #000000">&quot;</span><span style="color: #000000">);
        database.AddInParameter(command, </span><span style="color: #000000">&quot;</span><span style="color: #008080">OrderId</span><span style="color: #000000">&quot;</span><span style="color: #000000">, DbType.Int32, orderId);
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> command;
    }
}</span></pre>
<p>&nbsp;</p>
<p><strong>Object Factories&nbsp;and&nbsp;Data Mapping</strong></p>
<p>When the command executes, an <strong>IDataReader</strong> will be returned. We need a factory to create the entity based on the values in the DataReader. This is the responsibility of <strong>OrderFactory</strong>:</p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> </span><span style="color: #0000ff">class</span><span style="color: #000000"> OrderFactory : IEntityFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">Order</span><span style="color: #000000">&gt;</span><span style="color: #000000">
{
    </span><span style="color: #0000ff">public</span><span style="color: #000000"> Order Construct(IDataReader dr)
    {
        Order order </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> Order();
        order.OrderId </span><span style="color: #000000">=</span><span style="color: #000000"> (</span><span style="color: #0000ff">int</span><span style="color: #000000">)dr[(</span><span style="color: #0000ff">int</span><span style="color: #000000">)OrderFieldIndex.OrderId];
        order.Number </span><span style="color: #000000">=</span><span style="color: #000000"> (</span><span style="color: #0000ff">string</span><span style="color: #000000">)dr[(</span><span style="color: #0000ff">int</span><span style="color: #000000">)OrderFieldIndex.Number];
        ...
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> order;
    }
}</span></pre>
<pre><span style="color: #000000">&nbsp;</span></pre>
<pre><span style="color: #000000">Again, this is nice and clean with clear separation of responsibilities.</span></pre>
<pre><span style="color: #000000">&nbsp;</span></pre>
<pre><span style="color: #000000"><strong>The Refactored Base DAO Class</strong></span></pre>
<pre><span style="color: #000000">The base class has much of the &quot;complexity&quot;, but again it is pretty easy to follow:</span></pre>
<pre><span style="color: #000000">&nbsp;</span></pre>
<pre><span style="color: #000000">&nbsp;
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> </span><span style="color: #0000ff">class</span><span style="color: #000000"> DAO</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000"> where T : Entity
{
    IDatabase _database;

    </span><span style="color: #0000ff">public</span><span style="color: #000000"> DAO(IDatabase database)
    {
        </span><span style="color: #0000ff">if</span><span style="color: #000000"> (database </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #0000ff">null</span><span style="color: #000000">)
            </span><span style="color: #0000ff">throw</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> ArgumentNullException(</span><span style="color: #000000">&quot;</span><span style="color: #008080">database</span><span style="color: #000000">&quot;</span><span style="color: #000000">);

        _database </span><span style="color: #000000">=</span><span style="color: #000000"> database;
    }

    </span><span style="color: #0000ff">protected</span><span style="color: #000000"> T FindOne</span><span style="color: #000000">&lt;</span><span style="color: #000000">TIdentity</span><span style="color: #000000">&gt;</span><span style="color: #000000">(ISelectionFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">TIdentity</span><span style="color: #000000">&gt;</span><span style="color: #000000"> selectionFactory, IEntityFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000"> entityFactory, TIdentity identity)
    {
        DbCommand selectCommand </span><span style="color: #000000">=</span><span style="color: #000000"> selectionFactory.CreateSelectCommand(_database, identity);

        T entity </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">default</span><span style="color: #000000"> (T);

        </span><span style="color: #0000ff">using</span><span style="color: #000000"> (IDataReader dr </span><span style="color: #000000">=</span><span style="color: #000000"> _database.ExecuteReader(selectCommand))
        {
            </span><span style="color: #0000ff">if</span><span style="color: #000000"> (dr.Read())
                entity </span><span style="color: #000000">=</span><span style="color: #000000"> entityFactory.Construct(dr);
            entity.AcceptChanges();
        }

        </span><span style="color: #0000ff">return</span><span style="color: #000000"> entity;
    }
}</span></pre>
<p></span>
<p>&nbsp;</p>
<p>I made a few changes here and there, but&nbsp;I have stayed true to the concepts in the Data Access Guidance Package.</p>
<p>&nbsp;</p>
<p><strong>Ease of Maintenance With Generics and Small Specialized Factory Classes</strong></p>
<p>The introduction of generics saves a lot of code, but the introduction of the small specialized factory classes obviously creates more classes ( not necessarily more code ). The beauty of these small specilialized classes supporting the single-responsibility principle is that they allow for easier maintenance over the long run.</p>
<p>It is easy to replace and change factories as needed with little effort and little distraction.</p>
<p>&nbsp;</p>
<p><strong>Moving Forward &#8211; Searching Orders</strong></p>
<p>For searching orders we might introduce an OrderSearchCriteria Class ( <a href="http://www.martinfowler.com/eaaCatalog/queryObject.html">Query&nbsp;Object</a> )&nbsp;to hold search options. This fits nicely with the infrastructure, albeit one has to decide how to map the class to T-SQL <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> </span><span style="color: #0000ff">class</span><span style="color: #000000"> SearchForOrdersSelectionFactory : ISelectionFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">OrderSearchCriteria</span><span style="color: #000000">&gt;</span><span style="color: #000000">
{
    </span><span style="color: #0000ff">public</span><span style="color: #000000"> DbCommand CreateSelectCommand(IDatabase database, OrderSearchCriteria criteria)
    {
        </span><span style="color: #008000">//</span><span style="color: #008000"> Generate DbCommand Based on OrderSearchCritiera...</span><span style="color: #008000">
</span><span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> command;
    }
}</span></pre>
<p>&nbsp;</p>
<p>&nbsp;We may get multiple orders ( List&lt;Order&gt; ) when searching. The OrderDAO method would look nice and clean as follows:</p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">public</span><span style="color: #000000"> List</span><span style="color: #000000">&lt;</span><span style="color: #000000">Order</span><span style="color: #000000">&gt;</span><span style="color: #000000"> SearchOrders(OrderSearchCriteria criteria)
{
    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #0000ff">base</span><span style="color: #000000">.FindAll</span><span style="color: #000000">&lt;</span><span style="color: #000000">OrderSearchCriteria</span><span style="color: #000000">&gt;</span><span style="color: #000000">(</span><span style="color: #0000ff">new</span><span style="color: #000000"> SearchForOrdersSelectionFactory(), </span><span style="color: #0000ff">new</span><span style="color: #000000"> OrderFactory(), criteria);
}</span></pre>
<p>&nbsp;</p>
<p>&nbsp;The FindAll method handles the details, keeping a nice and refactored architecture.</p>
<p>&nbsp;</p>
<pre><span style="color: #0000ff">protected</span><span style="color: #000000"> List</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000"> FindAll</span><span style="color: #000000">&lt;</span><span style="color: #000000">TIdentity</span><span style="color: #000000">&gt;</span><span style="color: #000000">(ISelectionFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">TIdentity</span><span style="color: #000000">&gt;</span><span style="color: #000000"> selectionFactory, IEntityFactory</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000"> entityFactory, TIdentity identity)
{
    DbCommand selectCommand </span><span style="color: #000000">=</span><span style="color: #000000"> selectionFactory.CreateSelectCommand(_database, identity);

    List</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000"> list </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> List</span><span style="color: #000000">&lt;</span><span style="color: #000000">T</span><span style="color: #000000">&gt;</span><span style="color: #000000">();

    </span><span style="color: #0000ff">using</span><span style="color: #000000"> (IDataReader dr </span><span style="color: #000000">=</span><span style="color: #000000"> _database.ExecuteReader(selectCommand))
    {
        </span><span style="color: #0000ff">while</span><span style="color: #000000"> (dr.Read())
        {
            T entity </span><span style="color: #000000">=</span><span style="color: #000000"> entityFactory.Construct(dr);
            entity.AcceptChanges();
            list.Add(entity);
        }
    }

    </span><span style="color: #0000ff">return</span><span style="color: #000000"> list;
}</span></pre>
<p>&nbsp;</p>
<p><strong>Code Generation</strong></p>
<p>This all screams <a href="http://davidhayden.com/blog/dave/category/15.aspx?Show=All">code generation</a>, which is what you get from the Data Access Guidance Package. You also get this from <a href="http://www.adapdev.com/codus/">Codus</a>, <a href="http://www.nettiers.com/">.netTiers</a> using <a href="http://codesmithtools.com/">CodeSmith</a>, <a href="http://www.llblgen.com/">LLBLGen Pro</a>, etc. One shouldn&#039;t be writing the majority of this code by hand except where performance and maintainability / sustainability require it.</p>
<p>&nbsp;</p>
<p><strong>Conclusion</strong></p>
<p>The use of generics and factories in the data access layer can reduce the amount of code as well as improve the overall maintability of your code over the long run by keeping cohesion high and responsibilities clear. Although it is important to understand the concepts, I would reach out for any one of the O/R Mappers and Code Generation Tools to help you with much of the grunt work.</p>
<p>by <a href="http://www.davidhayden.com/">David Hayden</a></p>
<p>&nbsp;</p>
<div class="shr-publisher-134"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/davidhayden/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/" title="Permalink to Generics and Factories in the Data Access Layer &#8211; Code Generation" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/feed/" title="Comments RSS to Generics and Factories in the Data Access Layer &#8211; Code Generation" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-134 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/davidhayden/2006/10/18/another-inversion-of-control-example-with-infrastructure-and-dao-components/" rel="prev"><span class="meta-nav">&larr;</span> Another Inversion of Control Example With Infrastructure and DAO Components</a></div>
					<div class="nav-next"><a href="http://codebetter.com/davidhayden/2006/10/28/subsonic-extending-the-zero-code-dal-with-a-schema-provider-service-for-kicks/" rel="next">SubSonic &#8211; Extending The Zero Code DAL With A &quot;Schema Provider Service&quot; For Kicks <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">5 Responses to <em>Generics and Factories in the Data Access Layer &#8211; Code Generation</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-354">
		<div id="comment-354">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Eugene Ye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#comment-354">November 1, 2006 at 3:02 am</a></div>

		<div class="comment-body"><p>Hi David, what did you say? Your post seems truncated to me, only the first line can be seen. Thanks.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-353">
		<div id="comment-353">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Eugene Ye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#comment-353">October 29, 2006 at 6:00 am</a></div>

		<div class="comment-body"><p>Hi, nice article. I am currently looking at how to use the Generic feature for my DAO.<br />
If I am not mistaken, I see that the post uses IoC, similar to the previous posts, where the IDatabase is passed as a constructor parameter. As I am new to this IoC, I need some help here.</p>
<p>1. I don&#8217;t know how is it better for the IDatabase to be passed into the constructor, rather than having the DAO calls another class that would instantiate the actual IDatabase, before returning to the DAO; if the aim is just to allow for pluggable IDatabase?</p>
<p>2. If, in the future I need to extend the DAO to read/write from multiple IDatabase, how shall I do it? Should I change the constructor to include multiple IDatabase parameter or IDatabase collection? If the DAO retrieve the database connection by itself, wouldn&#8217;t it be easier to change the DAO to connect to multiple IDatabase, as variable/reference is private within it&#8217;s class, rather than part of the constructor&#8217;s contracts?</p>
<p>I am kinda new to IoC, sorry in advance if my questions is shallow or laughable <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_razz.gif' alt=':P' class='wp-smiley' />  but I truly would like to know more. Thanks a great lot.</p>
<p>Eugene<br />
In the meantime, I need to read out the DAO Generic thoroughly before further comments <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-352">
		<div id="comment-352">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.entityspaces.net' rel='external nofollow' class='url'>Mike Griffin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#comment-352">October 25, 2006 at 3:02 pm</a></div>

		<div class="comment-body"><p>Michael, OR mapping is an excellent time saver. I am one of the authors of EntitySpaces, an OR architecture for the .NET framework. Our architecture is generated by MyGeneration. With our system you can create your entire data objects and business objects in just a few minutes, they will compile clean, be strongly typed, perform very fast, can be regenerated when your object model changes without losing custom code, and can be told to use stored procs or dynamic sql (no recompile necessary) and can be told to run against Oracle, SQL, MySQL with just a config file change (again no recompile). We never use string names like &#8220;EmployeeID&#8221; so if you drop a column you get a compile error not a runtime error. You can write very cool dynamic queries and be spoon fed all the way via intellisense and so much more. So, if you can get all this in a few minutes why wouldn&#8217;t you use it?  To top it off you can generate a complete hierarchical object model as well.</p>
<p>A query:<br />
=========<br />
AggregateTestCollection aggTestColl = new AggregateTestCollection();<br />
aggTestColl.Query.es.CountAll = true;<br />
aggTestColl.Query<br />
.Select<br />
(<br />
	aggTestColl.Query.IsActive,<br />
	aggTestColl.Query.DepartmentID<br />
)<br />
.Where<br />
(<br />
	aggTestColl.Query.IsActive.Equal(true)<br />
)<br />
.GroupBy<br />
(<br />
	aggTestColl.Query.IsActive,<br />
	aggTestColl.Query.DepartmentID<br />
);<br />
aggTestColl.Query.Load();</p>
<p>Saving a record:<br />
=============<br />
Employees emp = new Employees();<br />
emp.AddNew();<br />
emp.FirstName = &#8220;David&#8221;;<br />
emp.LastName = &#8220;Hayden&#8221;;<br />
emp.Save();</p>
<p>Why spend time writing a brand new architecture, use a tested one, generate it, and you will be able spend all those would be hours delivering a killer application that your competition cannot match. That&#8217;s why folks use them, the ROI is tremendous.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-351">
		<div id="comment-351">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Michael Urquiola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#comment-351">October 25, 2006 at 1:51 pm</a></div>

		<div class="comment-body"><p>Could someone please explain why this O/R mapping stuff is better than just using a DataTable/DataReader/DataSet?  I keep seeing code like this, but can think of a compelling reason for it.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-350">
		<div id="comment-350">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Sergio Pereira</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#comment-350">October 25, 2006 at 11:57 am</a></div>

		<div class="comment-body"><p>Nice post. Clean and testable foundation for your DAL. Keep it up.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/davidhayden/2006/10/25/generics-and-factories-in-the-data-access-layer-code-generation/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://codebetter.com/davidhayden/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='134' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="53c8293625" /></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.512 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 22:47:44 -->
<!-- super cache -->