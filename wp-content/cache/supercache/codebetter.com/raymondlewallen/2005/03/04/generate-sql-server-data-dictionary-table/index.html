<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Generate Sql Server data dictionary table | Raymond Lewallen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/raymondlewallen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/raymondlewallen/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/raymondlewallen/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/raymondlewallen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/raymondlewallen/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Raymond Lewallen' href='http://codebetter.com/raymondlewallen/' />
<link rel='start' title='Moving some blog entries' href='http://codebetter.com/raymondlewallen/2004/12/01/moving-some-blog-entries/' />
<link rel='prev' title='Fields and Constants for VB Beginners &#8211; Answered' href='http://codebetter.com/raymondlewallen/2005/03/04/fields-and-constants-for-vb-beginners-answered/' />
<link rel='next' title='Faking out the browser back button' href='http://codebetter.com/raymondlewallen/2005/03/08/faking-out-the-browser-back-button/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/' />
<link rel='shortlink' href='http://codebetter.com/raymondlewallen/?p=72' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/raymondlewallen/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/raymondlewallen/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-72" class="post-72 post type-post status-publish format-standard hentry category-most-popular category-sql-development">
					<h1 class="entry-title">Generate Sql Server data dictionary table</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/raymondlewallen/author/raymondlewallen/" title="View all posts by raymondlewallen">raymondlewallen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/" title="5:08 pm" rel="bookmark"><span class="entry-date">March 4, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/raymondlewallen/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/raymondlewallen/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/raymondlewallen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>Hereâ€™s a quick example on how to generate a data dictionary for your sql server database.</p>
<fieldset>
<legend>T-SQL Data Dictionary</legend>
<p>create table #dd (<br />&nbsp;table_id int NULL,<br />&nbsp;table_name nvarchar(128) NULL,<br />&nbsp;column_order int NULL,<br />&nbsp;column_name varchar(60) NULL,<br />&nbsp;column_datatype varchar(20) NULL,<br />&nbsp;column_length int NULL,<br />&nbsp;column_description varchar(500) NULL<br />)</p>
<p>DECLARE @table_name nvarchar(128)</p>
<p>DECLARE tablenames_cursor CURSOR FOR <br />SELECT name FROM sysobjects where type = &#8216;U&#8217; and status &gt; 1 order by name</p>
<p>OPEN tablenames_cursor<br />FETCH NEXT FROM tablenames_cursor INTO @table_name<br />WHILE @@FETCH_STATUS = 0<br />BEGIN<br />&nbsp;insert #dd select <br />&nbsp;&nbsp;o.[id] as &#8216;table_id&#8217;, <br />&nbsp;&nbsp;o.[name] as &#8216;table_name&#8217;,<br />&nbsp;&nbsp;0 as &#8216;column_order&#8217;,<br />&nbsp;&nbsp;NULL as &#8216;column_name&#8217;,<br />&nbsp;&nbsp;NULL as &#8216;column_datatype&#8217;,<br />&nbsp;&nbsp;NULL as &#8216;column_length&#8217;,<br />&nbsp;&nbsp;Cast(e.value as varchar(500)) as &#8216;column_description&#8217; <br />&nbsp;from sysobjects o <br />&nbsp;left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;,<br />&nbsp;N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, null, default) e on o.name = e.objname<br />&nbsp;where o.name = @table_name</p>
<p>&nbsp;insert #dd select <br />&nbsp;&nbsp;o.[id] as &#8216;table_id&#8217;, <br />&nbsp;&nbsp;o.[name] as &#8216;table_name&#8217;,<br />&nbsp;&nbsp;c.colorder as &#8216;column_order&#8217;,<br />&nbsp;&nbsp;c.[name] as &#8216;column_name&#8217;,<br />&nbsp;&nbsp;t.[name] as &#8216;column_datatype&#8217;,<br />&nbsp;&nbsp;c.[length] as &#8216;column_length&#8217;,<br />&nbsp;&nbsp;Cast(e.value as varchar(500)) as &#8216;column_description&#8217; <br />&nbsp;from sysobjects o inner join syscolumns c on o.id = c.id inner join systypes t on c.xtype = t.xtype<br />&nbsp;left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;,<br />&nbsp;N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, N&#8217;column&#8217;, null) e on c.name = e.objname<br />&nbsp;where o.name = @table_name<br />&nbsp;order by c.colorder</p>
<p>&nbsp;&nbsp; FETCH NEXT FROM tablenames_cursor INTO @table_name<br />END</p>
<p>CLOSE tablenames_cursor<br />DEALLOCATE tablenames_cursor</p>
<p>select * from #dd<br />drop table #dd</p>
<p>Return<br />Go</p>
</fieldset>
<p>Currently listening to: <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?songTerm=Stellar&amp;artistTerm=Incubus">Stellar</a> &#8211; <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?artistTerm=Incubus">Incubus</a></p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/raymondlewallen/category/most-popular/" title="View all posts in Most Popular" rel="category tag">Most Popular</a>, <a href="http://codebetter.com/raymondlewallen/category/sql-development/" title="View all posts in Sql Development" rel="category tag">Sql Development</a>. Bookmark the <a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/" title="Permalink to Generate Sql Server data dictionary table" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/feed/" title="Comments RSS to Generate Sql Server data dictionary table" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-72 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/raymondlewallen/2005/03/04/fields-and-constants-for-vb-beginners-answered/" rel="prev"><span class="meta-nav">&larr;</span> Fields and Constants for VB Beginners &#8211; Answered</a></div>
					<div class="nav-next"><a href="http://codebetter.com/raymondlewallen/2005/03/08/faking-out-the-browser-back-button/" rel="next">Faking out the browser back button <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">28 Responses to <em>Generate Sql Server data dictionary table</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-228">
		<div id="comment-228">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Harry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-228">December 17, 2009 at 4:35 pm</a></div>

		<div class="comment-body"><p>I agree with JonGalloway.ToString().<br />
Data Dictionary Creator is the best handy tool to generate Data Dictionary with muliptle import/export functionality.<br />
Awesome. </p>
<p>This post has helped a lot.</p>
<p>Have a Happy Holidays.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-227">
		<div id="comment-227">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.sqldocumentor.com' rel='external nofollow' class='url'>Nilesh</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-227">December 31, 2008 at 2:14 am</a></div>

		<div class="comment-body"><p>How about a tool that generates beautiful meta-data documentation and all for free. Check this sample document<br />
<a href="http://www.sqldocumentor.com/sqlserverhtml/sql_server_index.html" rel="nofollow">http://www.sqldocumentor.com/sqlserverhtml/sql_server_index.html</a></p>
<p>Few more days for release. Please submit your feedback</p>
<p>Thanks<br />
Nilesh<br />
<a href="http://www.sqldocumentor.com" rel="nofollow">http://www.sqldocumentor.com</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-226">
		<div id="comment-226">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.centrabyte.com' rel='external nofollow' class='url'>Hrair Kerametlian</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-226">May 13, 2008 at 6:00 pm</a></div>

		<div class="comment-body"><p>COLLATE Latin1_General_CI_AS &#8211; Works Wonders! Thanks for the great solution.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-225">
		<div id="comment-225">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Pa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-225">January 30, 2008 at 4:00 pm</a></div>

		<div class="comment-body"><p>This function(s) only return information on the dbo. schema.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-224">
		<div id="comment-224">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.fitbits.com.au' rel='external nofollow' class='url'>Anatol Romanov</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-224">January 23, 2008 at 5:37 am</a></div>

		<div class="comment-body"><p>I just tried the fnDataDictionary function suggested above, and found that it returns 2 rows for each column with the user-defined data type. One row shows the UDDT, the other shows the base data type. </p>
<p>Cheers</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-223">
		<div id="comment-223">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Will</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-223">August 16, 2007 at 1:11 pm</a></div>

		<div class="comment-body"><p>If you&#8217;re getting error</p>
<p>Cannot resolve the collation conflict between &#8220;Latin1_General_CI_AI&#8221; and &#8220;SQL_Latin1_General_CP1_CI_AS&#8221; in the equal to operation.</p>
<p>then change the joins to </p>
<p>o.name COLLATE Latin1_General_CI_AS = e.objname </p>
<p><a href="https://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=177141&#038;SiteID=1" rel="nofollow">https://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=177141&#038;SiteID=1</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-222">
		<div id="comment-222">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>Raymond Lewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-222">May 2, 2007 at 3:39 pm</a></div>

		<div class="comment-body"><p>Ok, finally ran into the COLLATION issue.  In the joins for pulling descriptions, change them to read:</p>
<p>on o.name COLLATE Latin1_General_CI_AS = e.objname</p>
<p>and</p>
<p>on c.name COLLATE Latin1_General_CI_AS = e.objname</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-221">
		<div id="comment-221">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>rlewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-221">April 5, 2007 at 12:39 am</a></div>

		<div class="comment-body"><p>Sorry guys, but I haven&#8217;t had any issues with running this in Sql Server 2005.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-220">
		<div id="comment-220">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Shalin Shah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-220">February 22, 2007 at 8:16 pm</a></div>

		<div class="comment-body"><p>Hi I am not able to run this code from .sql file using MS SQL 2005. I got an error </p>
<p>Msg 468, Level 16, State 9, Line 20<br />
Cannot resolve the collation conflict between &#8220;Latin1_General_CI_AI&#8221; and &#8220;SQL_Latin1_General_CP1_CI_AS&#8221; in the equal to operation.<br />
Msg 468, Level 16, State 9, Line 33<br />
Cannot resolve the collation conflict between &#8220;Latin1_General_CI_AI&#8221; and &#8220;SQL_Latin1_General_CP1_CI_AS&#8221; in the equal to operation.</p>
<p>Please help to resove the problem</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-219">
		<div id="comment-219">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Abrar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-219">February 6, 2007 at 7:09 am</a></div>

		<div class="comment-body"><p>how can create Data dictionary in sql server 2005<br />
i have prblem in above script it gives error in<br />
insert DataD select<br />
and<br />
insert DataD select<br />
what is the syntex of this in sql server 2005<br />
plz give me answer very urgent</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-218">
		<div id="comment-218">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Abrar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-218">January 20, 2007 at 5:31 pm</a></div>

		<div class="comment-body"><p>how can i create data dictionary of required/selected tables from data base in sql server</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-217">
		<div id="comment-217">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.elsasoft.org' rel='external nofollow' class='url'>Jesse</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-217">October 27, 2006 at 10:16 am</a></div>

		<div class="comment-body"><p>I can recommend SqlSpec as a very comprehensive data dictionary generator.  It&#8217;s available at <a href="http://www.elsasoft.org" rel="nofollow">http://www.elsasoft.org</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-216">
		<div id="comment-216">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">AdamP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-216">October 12, 2006 at 9:02 pm</a></div>

		<div class="comment-body"><p>Can someone tell me if both the sysobject/syscolumns and the extended property data is stored within the corresponding dbase?  Or is it stored in Master or msdb?  I&#8217;m trying to determine if my DR stategy needs to change if I begin to use this in a prod environment.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-215">
		<div id="comment-215">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">twincities</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-215">September 22, 2006 at 3:31 pm</a></div>

		<div class="comment-body"><p>I modified Oskars script for sql 2005 </p>
<p>/*<br />
Oskar Austegard<br />
Here it is as a function returning a table (useful for queries like this:</p>
<p>select *<br />
from dbo.fnDataDictionary()<br />
where column_description is null</p>
<p>SQL 2005 changes<br />
1) Add collate twice<br />
   COLLATE Latin1_General_CI_AS<br />
2) used sys.objects not sysobjects<br />
3) Removed status = 1 since<br />
   status is 0 in 2005 system view sysobjects<br />
   status is not in sys.objects</p>
<p>*/</p>
<p>SET QUOTED_IDENTIFIER OFF<br />
GO<br />
SET ANSI_NULLS OFF<br />
GO</p>
<p>CREATE FUNCTION fnDataDictionary ()<br />
RETURNS @DataDictionary TABLE (<br />
table_id int NULL,<br />
table_name nvarchar(128) NULL,<br />
column_order int NULL,<br />
column_name varchar(60) NULL,<br />
column_datatype varchar(20) NULL,<br />
column_length int NULL,<br />
column_description varchar(500) NULL<br />
)<br />
AS<br />
BEGIN</p>
<p>DECLARE @table_name nvarchar(128)<br />
DECLARE tablenames_cursor CURSOR FOR<br />
SELECT name FROM sys.objects where type = &#8216;U&#8217; order by name</p>
<p>OPEN tablenames_cursor<br />
FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
WHILE @@FETCH_STATUS = 0<br />
BEGIN<br />
insert @DataDictionary<br />
select<br />
o.[id] as &#8216;table_id&#8217;,<br />
o.[name] as &#8216;table_name&#8217;,<br />
0 as &#8216;column_order&#8217;,<br />
NULL as &#8216;column_name&#8217;,<br />
NULL as &#8216;column_datatype&#8217;,<br />
NULL as &#8216;column_length&#8217;,<br />
Cast(e.value as varchar(500)) as &#8216;column_description&#8217;<br />
from sysobjects o<br />
left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;, N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, null, default) e<br />
on o.name = e.objname<br />
COLLATE Latin1_General_CI_AS<br />
where o.name = @table_name</p>
<p>insert @DataDictionary<br />
select<br />
o.[id] as &#8216;table_id&#8217;,<br />
o.[name] as &#8216;table_name&#8217;,<br />
c.colorder as &#8216;column_order&#8217;,<br />
c.[name] as &#8216;column_name&#8217;,<br />
t.[name] as &#8216;column_datatype&#8217;,<br />
c.[length] as &#8216;column_length&#8217;,<br />
Cast(e.value as varchar(500)) as &#8216;column_description&#8217;<br />
from sysobjects o inner join syscolumns c on o.id = c.id inner join systypes t on c.xtype = t.xtype<br />
left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;, N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, N&#8217;column&#8217;, null) e<br />
on c.name = e.objname<br />
COLLATE Latin1_General_CI_AS<br />
where o.name = @table_name<br />
order by c.colorder</p>
<p>FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
END</p>
<p>CLOSE tablenames_cursor<br />
DEALLOCATE tablenames_cursor</p>
<p>RETURN<br />
END</p>
<p>GO<br />
SET QUOTED_IDENTIFIER OFF<br />
GO<br />
SET ANSI_NULLS ON<br />
GO</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-214">
		<div id="comment-214">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Manish Jain</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-214">September 4, 2006 at 10:35 am</a></div>

		<div class="comment-body"><p>How we can generate the data dictionary (sql script) with column description??</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-213">
		<div id="comment-213">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.thirdstagesoftware.com' rel='external nofollow' class='url'>GeoSync</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-213">April 4, 2006 at 4:10 am</a></div>

		<div class="comment-body"><p>I discovered and fixed another problem. Also, I fixed my COLLATE error problem.  Please read on&#8230;</p>
<p>New problem; Fixed:<br />
If I use the first SELECT statement as it&#8217;s written, I get no rows back when the script completes.  However, it works if I remove the &#8220;status > 1&#8243; part of the WHERE clause.  So the new SELECT statement looks like this:</p>
<p>SELECT name FROM sysobjects where type = &#8216;U&#8217;<br />
order by name </p>
<p>I also noticed the STATUS column is undocumented.  Why are you guys using it?</p>
<p>Workaround for Original Problem:<br />
Just before the 2 WHERE clauses that read<br />
     where o.name = @table_name</p>
<p>I inserted<br />
    COLLATE Latin1_General_CI_AS</p>
<p>So, the script reads<br />
    [FROM clause with Join info]<br />
    COLLATE Latin1_General_CI_AS<br />
    where o.name = @table_name</p>
<p>Sadly, this tweak did not work for Oskar&#8217;s embellished Function near the top of this thread.</p>
<p>Cheers!<br />
Rick in Boston, MA</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-212">
		<div id="comment-212">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">GeoSync</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-212">April 3, 2006 at 9:06 pm</a></div>

		<div class="comment-body"><p>Ray,<br />
Perhaps Christian is talking about this:<br />
&#8211; Fresh install of SQL Server 2005<br />
&#8211; DBs from a previous installation of MSDE.</p>
<p>When I run the scripts from your blog, I get this error message:</p>
<p>Msg 468, Level 16, State 9, Line 68<br />
Cannot resolve the collation conflict between &#8220;Latin1_General_CI_AI&#8221; and &#8220;SQL_Latin1_General_CP1_CI_AS&#8221; in the equal to operation.</p>
<p>My admin expertise for SQL Server is low.  So far my research hasn&#8217;t revealed anything conclusive or useful.</p>
<p>Any ideas?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-211">
		<div id="comment-211">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>rlewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-211">March 20, 2006 at 10:17 pm</a></div>

		<div class="comment-body"><p>Christian,</p>
<p>What collation problems are you referring to?  Are you just wanting the database to list which collation schemes are being used?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-210">
		<div id="comment-210">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Christian Olivares</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-210">March 20, 2006 at 8:57 pm</a></div>

		<div class="comment-body"><p>Just a question.<br />
There is any easy workaround for collation problems?</p>
<p>Thanks!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-209">
		<div id="comment-209">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Joel Reinford</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-209">March 4, 2006 at 7:54 pm</a></div>

		<div class="comment-body"><p>OK, I&#8217;m a little late for this party. I had some T-SQL to generate schema documentation but this post added a few nice options to what I already had (mostly the extended properties concept). </p>
<p>Here is my contribution to this discusssion, one year later. Perhaps some people will stumble across it and find it useful. My data dictionary includes more details about the columns such as status flags for isnullable, isorimarykey, isforeignkey, isidentity, and table and column information for foreign key columns. It cannot be wrapped in a UDF like Oskar did above because it uses a temp table for the primary key information.</p>
<p>I&#8217;m not sure what will happen with line wraps on this post so watch for that.</p>
<p>/*</p>
<p>	Purpose: T-SQL to create Data Dictionary<br />
	Created by:   Joel Reinford<br />
	Date Created: Mar-4-2006<br />
	Modified by:<br />
	Date Modified:<br />
	Note: 	Some of this information can be obtained from the INFORMATION_SCHEMA views<br />
		Select c.* from INFORMATION_SCHEMA.COLUMNS c<br />
		Select t.* from INFORMATION_SCHEMA.TABLES t</p>
<p>*/</p>
<p>DECLARE @DataDictionary table(<br />
	RowID [int] identity(1,1) primary key<br />
	,TableName [varchar](200)<br />
	, ColumnName  [varchar](200)<br />
	, OrdinalPosition int<br />
	, ColumnDefault [varchar](200)<br />
	, IsNullable  [bit]<br />
	, DataType [varchar](20)<br />
	, CharacterMaximumLength int<br />
	, IsIdentity [varchar](5) &#8211;[bit]<br />
	, IsPrimaryKey [bit]<br />
	, IsForeignKey [bit]<br />
	, ReferencedTableName [varchar](200)<br />
	, ReferencedColumnName [varchar](200)<br />
	, ObjectDescription  [varchar](500)<br />
	)</p>
<p>DECLARE @TableList table(<br />
	RowID [int] identity(1,1) primary key<br />
	,TableCatalog [varchar](200)<br />
	,TableSchema [varchar](200)<br />
	,TableName [varchar](200)<br />
	,TableType [varchar](20)<br />
	,ObjectDescription  [varchar](500)<br />
	)</p>
<p>DECLARE<br />
	 @RowNumber int<br />
	, @RowCount int<br />
	, @TableName varchar(255)<br />
	, @ObjectDescription  varchar(500)</p>
<p>&#8211;create a temp table to hold the primary keys<br />
&#8211;can&#8217;t do INSERT EXEC with a table variable<br />
IF  object_id(&#8216;tempdb..#PkColumns&#8217;) is not null<br />
BEGIN<br />
	DROP TABLE #PkColumns<br />
END</p>
<p>CREATE TABLE #PkColumns (<br />
	RowID [int] identity(1,1) primary key<br />
	,table_Qualifier varchar(255) NOT NULL<br />
	, owner_name varchar(255) NOT NULL<br />
	, table_name varchar(255) NOT NULL<br />
	, column_name varchar(255) NOT NULL<br />
	, key_seq varchar(255) NOT NULL<br />
	, Pk_Name varchar(255) NOT NULL<br />
	 )</p>
<p>&#8211;load the table list<br />
INSERT @TableList<br />
	(<br />
	TableCatalog<br />
	,TableSchema<br />
	,TableName<br />
	,TableType<br />
	,ObjectDescription<br />
	)</p>
<p>SELECT<br />
	t.Table_Catalog<br />
	,t.Table_Schema<br />
	,t.Table_Name<br />
	,t.Table_Type<br />
	, CAST(IsNULL(e.value,&#8221;) as varchar(500))</p>
<p>FROM<br />
	INFORMATION_SCHEMA.TABLES t<br />
	LEFT JOIN ::FN_LISTEXTENDEDPROPERTY<br />
		(<br />
		&#8216;MS_Description&#8217; &#8211;standard description property<br />
		,&#8217;user&#8217;<br />
		,&#8217;dbo&#8217;<br />
		,&#8217;table&#8217; &#8211;parent object type<br />
		, @TableName &#8212; parent object name<br />
		, NULL &#8211;child object type<br />
		, NULL &#8211;child object name from above<br />
		) e<br />
	ON  t.Table_Name = e.objname</p>
<p>WHERE<br />
	t.Table_Type = &#8216;BASE TABLE&#8217;</p>
<p>SELECT @RowCount = Count(*) from @TableList</p>
<p>&#8211;loop through the tables<br />
SET @RowNumber = 1<br />
WHILE @RowNumber <= @RowCount<br />
BEGIN</p>
<p>	SELECT<br />
		@TableName = TableName<br />
		,@ObjectDescription = ObjectDescription<br />
	FROM<br />
		@TableList<br />
	WHERE<br />
		RowID = @RowNumber</p>
<p>	&#8211;clear primary keys table<br />
	DELETE #PkColumns</p>
<p>	&#8211;insert the primary key records retrieved by the system stored procedure<br />
	INSERT 	#PkColumns<br />
	EXEC	sp_pkeys @table_name= @TableName</p>
<p>	&#8211;insert the table name and description for header purposes<br />
	INSERT @DataDictionary<br />
		(<br />
		TableName<br />
		, ColumnName<br />
		, OrdinalPosition<br />
		, ColumnDefault<br />
		, IsNullable<br />
		, DataType<br />
		, CharacterMaximumLength<br />
		, IsIdentity<br />
		, IsPrimaryKey<br />
		, IsForeignKey<br />
		, ReferencedTableName<br />
		, ReferencedColumnName<br />
		, ObjectDescription<br />
		)</p>
<p>	VALUES<br />
		(<br />
		@TableName &#8211;TableName<br />
		, &#8221; &#8211;ColumnName<br />
		, 0 &#8211;OrdinalPosition<br />
		, &#8221; &#8211;ColumnDefault<br />
		, 0 &#8211;IsNullable<br />
		, &#8221; &#8211;DataType<br />
		, 0 &#8211;CharacterMaximumLength<br />
		, 0 &#8211;IsIdentity<br />
		, 0 &#8211;IsPrimaryKey<br />
		, 0 &#8211;IsForeignKey<br />
		, &#8221; &#8211;ReferencedTableName<br />
		, &#8221; &#8211;ReferencedColumnName<br />
		, @ObjectDescription &#8211;ObjectDescription<br />
		)</p>
<p>	&#8211;insert the column schema information<br />
	INSERT @DataDictionary<br />
		(<br />
		TableName<br />
		, ColumnName<br />
		, OrdinalPosition<br />
		, ColumnDefault<br />
		, IsNullable<br />
		, DataType<br />
		, CharacterMaximumLength<br />
		, IsIdentity<br />
		, IsPrimaryKey<br />
		, IsForeignKey<br />
		, ReferencedTableName<br />
		, ReferencedColumnName<br />
		, ObjectDescription<br />
		)</p>
<p>	SELECT<br />
		t.table_name<br />
		, c.column_name<br />
		, c.ordinal_position<br />
		, IsNULL(c.column_default, &#8221;)<br />
	    	, CASE WHEN c.is_nullable = &#8216;Yes&#8217; THEN 1 ELSE 0 END<br />
		, c.data_type<br />
		, IsNULL(c.character_maximum_length, &#8221;)<br />
		, (SELECT COLUMNPROPERTY<br />
			(<br />
			OBJECT_ID(t.table_name)<br />
			,c.Column_Name,&#8217;IsIdentity&#8217;<br />
			)<br />
		   ) AS IsIdentity<br />
	 	, CASE WHEN pk.column_name IS NULL THEN 0<br />
			ELSE 1<br />
			END AS IsPrimaryKey<br />
		, CASE WHEN Fkey.REFERENCED_TABLE_NAME IS NULL THEN 0<br />
			ELSE 1<br />
			END AS IsForeignKey<br />
		, IsNULL(Fkey.REFERENCED_TABLE_NAME, &#8221;)<br />
		, IsNULL(Fkey.Referenced_Column_Name, &#8221;)<br />
		, CAST(IsNULL(e.value,&#8221;) as varchar(500)) as &#8216;ColumnDescription&#8217; </p>
<p>	FROM<br />
		information_schema.tables t<br />
		INNER JOIN information_schema.columns C<br />
	  	ON t.table_name = c.table_name<br />
		LEFT OUTER JOIN [#PkColumns] Pk<br />
		ON PK.column_Name = c.column_Name<br />
		LEFT OUTER JOIN<br />
			(<br />
			SELECT<br />
				CASE WHEN OBJECTPROPERTY(CONSTID, &#8216;CNSTISDISABLED&#8217;) = 0<br />
						THEN &#8216;Enabled&#8217;<br />
				        ELSE &#8216;Disabled&#8217; END<br />
					AS Status<br />
				, OBJECT_NAME(CONSTID) AS Constraint_Name<br />
				, OBJECT_NAME(FKEYID) AS Table_Name<br />
				, COL_NAME(FKEYID, FKEY) AS Column_Name<br />
				, OBJECT_NAME(RKEYID) AS Referenced_Table_Name<br />
				, COL_NAME(RKEYID, RKEY) AS Referenced_Column_Name<br />
			FROM<br />
				SYSFOREIGNKEYS<br />
			) As Fkey<br />
		ON c.table_name = Fkey.table_name<br />
		AND c.column_Name = Fkey.Column_Name</p>
<p>		LEFT JOIN ::FN_LISTEXTENDEDPROPERTY<br />
			(<br />
			&#8216;MS_Description&#8217; &#8211;standard description property<br />
			,&#8217;user&#8217;<br />
			,&#8217;dbo&#8217;<br />
			,&#8217;table&#8217; &#8211;parent object type<br />
			, @TableName &#8212; parent object name from above<br />
			, &#8216;column&#8217; &#8212; child object type<br />
			, NULL &#8212; child object name from above<br />
			) e<br />
		ON c.Column_Name = e.objname</p>
<p>	WHERE<br />
		t.table_name = @TableName </p>
<p>	ORDER BY<br />
		c.ordinal_position</p>
<p>	SET @RowNumber = @RowNumber + 1</p>
<p>END &#8211;end table loop	</p>
<p>&#8211;drop the temp table<br />
DROP TABLE #PkColumns</p>
<p>SELECT * </p>
<p>FROM<br />
	@DataDictionary d</p>
<p>ORDER BY<br />
	d.TableName<br />
	, d.OrdinalPosition </p>
<p>Joel Reinford<br />
Data Management Solutions LLC</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-208">
		<div id="comment-208">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Seashell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-208">October 10, 2005 at 6:21 pm</a></div>

		<div class="comment-body"><p>I found the answer to my question, in case anyone else is interested.  Use:</p>
<p>exec sp_addextendedproperty &#8216;MS_Description&#8217;,<br />
&#8216;[put description here]&#8216;,<br />
&#8216;user&#8217;,<br />
&#8216;dbo&#8217;,<br />
&#8216;table&#8217;,<br />
&#8216;[put table name here]&#8216;,<br />
&#8216;column&#8217;,<br />
&#8216;[put field name here]&#8216;</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-207">
		<div id="comment-207">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Seashell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-207">October 8, 2005 at 12:46 am</a></div>

		<div class="comment-body"><p>This is precisely what I was looking for &#8211; thanks !  One question: I understand that the description column is pulled from the Description entry under Design View in Enterprise Manager.  How do you script that entry?  I&#8217;m thinking of migrating this to the production server, and all db changes have to go through the dba group in the form of scripts &#8211; so how would I do that?<br />
Thanks for any help -</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-206">
		<div id="comment-206">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Seashell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-206">October 8, 2005 at 12:45 am</a></div>

		<div class="comment-body"><p>This is precisely what I was looking for &#8211; thanks !  One question: I understand that the description column is pulled from the Description entry under Design View in Enterprise Manager.  How do you script that entry?  I&#8217;m thinking of migrating this to the production server, and all db changes have to go through the dba group in the form of scripts &#8211; so how would I do that?<br />
Thanks for any help -</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-205">
		<div id="comment-205">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Robert Texas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-205">August 29, 2005 at 7:48 pm</a></div>

		<div class="comment-body"><p>Thanks for the Data Dictionary SQL.<br />
I&#8217;m trying to make a way for other developers in our group to generate data dictionaries for their databases without having to know much about the procedure.  I&#8217;m even trying to encapsulate it in a SQL Reporting Services report where they enter a parameter of their database.  The columns are reported, but the description from the FN_LISTEXTENDEDPROPERTY is not reported.  The procedure only appears to work correctly when it resides in the database it&#8217;s reporting from.  Do I need to add a USE statement?  Any suggestions?</p>
<p>CREATE        Procedure dbo.prDataDictionary2<br />
		@Database varchar(50)<br />
AS</p>
<p>SET @Database = @Database + &#8216;.dbo.&#8217;</p>
<p>declare @strSql nvarchar(4000)<br />
Set @strSQL = &#8216;<br />
create table #dd (<br />
 table_id int NULL,<br />
 table_name nvarchar(128) NULL,<br />
 column_order int NULL,<br />
 column_name varchar(60) NULL,<br />
 column_datatype varchar(20) NULL,<br />
 column_length int NULL,<br />
 column_description varchar(500) NULL<br />
)</p>
<p>DECLARE @table_name nvarchar(128)</p>
<p>DECLARE tablenames_cursor CURSOR FOR<br />
SELECT name FROM &#8216;+@Database+&#8217;sysobjects where type = &#8221;U&#8221; and status > 1 and name <> &#8221;dtproperties&#8221; order by name</p>
<p>OPEN tablenames_cursor<br />
FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
WHILE @@FETCH_STATUS = 0<br />
BEGIN<br />
 insert #dd select<br />
  o.[id] as &#8221;table_id&#8221;,<br />
  o.[name] as &#8221;table_name&#8221;,<br />
  0 as &#8221;column_order&#8221;,<br />
  NULL as &#8221;column_name&#8221;,<br />
  NULL as &#8221;column_datatype&#8221;,<br />
  NULL as &#8221;column_length&#8221;,<br />
  Cast(e.value as varchar(500)) as &#8221;column_description&#8221;<br />
 from &#8216;+@Database+&#8217;sysobjects o<br />
 left join ::FN_LISTEXTENDEDPROPERTY(N&#8221;MS_Description&#8221;,<br />
 N&#8221;user&#8221;,N&#8221;dbo&#8221;,N&#8221;table&#8221;, @table_name, null, default) e on o.name = e.objname<br />
 where o.name = @table_name</p>
<p> insert #dd select<br />
  o.[id] as &#8221;table_id&#8221;,<br />
  o.[name] as &#8221;table_name&#8221;,<br />
  c.colorder as &#8221;column_order&#8221;,<br />
  c.[name] as &#8221;column_name&#8221;,<br />
  t.[name] as &#8221;column_datatype&#8221;,<br />
  c.[length] as &#8221;column_length&#8221;,<br />
  Cast(e.value as varchar(500)) as &#8221;column_description&#8221;<br />
 from &#8216;+@Database+&#8217;sysobjects o inner join &#8216;+@Database+&#8217;syscolumns c on o.id = c.id inner join &#8216;+@Database+&#8217;systypes t on c.xtype = t.xtype<br />
 left join ::FN_LISTEXTENDEDPROPERTY(N&#8221;MS_Description&#8221;,<br />
 N&#8221;user&#8221;,N&#8221;dbo&#8221;,N&#8221;table&#8221;, @table_name, N&#8221;column&#8221;, null) e on c.name = e.objname<br />
 where o.name = @table_name<br />
 order by c.colorder</p>
<p>   FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
END</p>
<p>CLOSE tablenames_cursor<br />
DEALLOCATE tablenames_cursor</p>
<p>select a.table_name, table_description, column_name, column_datatype, column_length, column_description from<br />
(select table_name, column_description table_description from #dd where column_order = 0) a,<br />
(select * from #dd where column_order <> 0) b<br />
where a.table_name = b.table_name</p>
<p>&#8211;select * from #dd<br />
drop table #dd</p>
<p>Return&#8217;</p>
<p>EXEC sp_executesql @strSQL</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-204">
		<div id="comment-204">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>rlewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-204">April 24, 2005 at 8:34 pm</a></div>

		<div class="comment-body"><p>Yes, the information_schema does return the same data, but that&#8217;s not nearly as fun to do <img src='http://codebetter.com/raymondlewallen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  Also, you can&#8217;t exclude Views when using information schema. I&#8217;ve never generated a data dictionary that included views.  Also, you can&#8217;t get extended property information from information_scheme.columns without going through the process above of using the function FN_LISTEXTENDEDPROPERTY.  The code above is much better for producing data dictionaries rather than the information_schema.columns.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-203">
		<div id="comment-203">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">MAURO</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-203">April 20, 2005 at 6:28 pm</a></div>

		<div class="comment-body"><p>I think you can get almost the same by using</p>
<p>select * from information_schema.columns</p>
<p>Regards&#8230;!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-202">
		<div id="comment-202">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://codebetter.com/blogs/raymond.lewallen' rel='external nofollow' class='url'>Raymond Lewallen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-202">March 7, 2005 at 12:26 pm</a></div>

		<div class="comment-body"><p>Awesome Oskar, thanks for the modifications to a UDF.  Since I only run it once in a blue moon, I just run it from query analyzer.  If you have a need to run it more often, like for developer look ups, a UDF is definately the way to go.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-201">
		<div id="comment-201">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://blahblahg.blogspot.com' rel='external nofollow' class='url'>Oskar Austegard</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#comment-201">March 7, 2005 at 12:17 pm</a></div>

		<div class="comment-body"><p>Here it is as a function returning a table (useful for queries like this: </p>
<p>select *<br />
<br />from dbo.fnDataDictionary()<br />
<br />where column_description is null</p>
<p>SET QUOTED_IDENTIFIER OFF<br />
<br />GO<br />
<br />SET ANSI_NULLS OFF<br />
<br />GO</p>
<p>CREATE FUNCTION fnDataDictionary ()<br />
<br />RETURNS @DataDictionary TABLE (<br />
<br /> table_id int NULL,<br />
<br /> table_name nvarchar(128) NULL,<br />
<br /> column_order int NULL,<br />
<br /> column_name varchar(60) NULL,<br />
<br /> column_datatype varchar(20) NULL,<br />
<br /> column_length int NULL,<br />
<br /> column_description varchar(500) NULL<br />
<br />)<br />
<br />AS<br />
<br />BEGIN</p>
<p>	DECLARE @table_name nvarchar(128)<br />
<br />	DECLARE tablenames_cursor CURSOR FOR<br />
<br />		SELECT name FROM sysobjects where type = &#8216;U&#8217; and status &gt; 1 order by name</p>
<p>	OPEN tablenames_cursor<br />
<br />	FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
<br />	WHILE @@FETCH_STATUS = 0<br />
<br />	BEGIN<br />
<br />		insert @DataDictionary<br />
<br />		select<br />
<br />			o.[id] as &#8216;table_id&#8217;,<br />
<br />		  o.[name] as &#8216;table_name&#8217;,<br />
<br />		  0 as &#8216;column_order&#8217;,<br />
<br />		  NULL as &#8216;column_name&#8217;,<br />
<br />		  NULL as &#8216;column_datatype&#8217;,<br />
<br />		  NULL as &#8216;column_length&#8217;,<br />
<br />		  Cast(e.value as varchar(500)) as &#8216;column_description&#8217;<br />
<br />		from sysobjects o<br />
<br />			left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;, N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, null, default) e<br />
<br />				on o.name = e.objname<br />
<br />		where o.name = @table_name</p>
<p> 		insert @DataDictionary<br />
<br />		select<br />
<br />		  o.[id] as &#8216;table_id&#8217;,<br />
<br />		  o.[name] as &#8216;table_name&#8217;,<br />
<br />		  c.colorder as &#8216;column_order&#8217;,<br />
<br />		  c.[name] as &#8216;column_name&#8217;,<br />
<br />		  t.[name] as &#8216;column_datatype&#8217;,<br />
<br />		  c.[length] as &#8216;column_length&#8217;,<br />
<br />		  Cast(e.value as varchar(500)) as &#8216;column_description&#8217;<br />
<br />		from sysobjects o inner join syscolumns c on o.id = c.id inner join systypes t on c.xtype = t.xtype<br />
<br />			left join ::FN_LISTEXTENDEDPROPERTY(N&#8217;MS_Description&#8217;, N&#8217;user&#8217;,N&#8217;dbo&#8217;,N&#8217;table&#8217;, @table_name, N&#8217;column&#8217;, null) e<br />
<br />				on c.name = e.objname<br />
<br />		where o.name = @table_name<br />
<br />		order by c.colorder</p>
<p>   	FETCH NEXT FROM tablenames_cursor INTO @table_name<br />
<br />	END</p>
<p>	CLOSE tablenames_cursor<br />
<br />	DEALLOCATE tablenames_cursor</p>
<p>	RETURN<br />
<br />END</p>
<p>GO<br />
<br />SET QUOTED_IDENTIFIER OFF<br />
<br />GO<br />
<br />SET ANSI_NULLS ON<br />
<br />GO</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/raymondlewallen/2005/03/04/generate-sql-server-data-dictionary-table/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/raymondlewallen/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fraymondlewallen%2F2005%2F03%2F04%2Fgenerate-sql-server-data-dictionary-table%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.528 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-18 16:11:41 -->
<!-- super cache -->