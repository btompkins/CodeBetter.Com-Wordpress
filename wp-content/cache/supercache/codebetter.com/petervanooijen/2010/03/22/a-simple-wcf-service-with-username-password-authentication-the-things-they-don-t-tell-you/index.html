<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>A simple WCF service with username password authentication: the things they don’t tell you | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/petervanooijen/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/petervanooijen/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/petervanooijen/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Peter van Ooijen' href='http://codebetter.com/petervanooijen/' />
<link rel='start' title='Hello weblog' href='http://codebetter.com/petervanooijen/2003/06/03/hello-weblog/' />
<link rel='prev' title='Ubiquitous and unambiguous ?' href='http://codebetter.com/petervanooijen/2010/03/07/ubiquitous-and-unambiguous/' />
<link rel='next' title='A simple WCF service with username password authentication: the things you told me' href='http://codebetter.com/petervanooijen/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/' />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=576' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/petervanooijen/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetterpetergekkosblog/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/petervanooijen/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-576" class="post-576 post type-post status-publish format-standard hentry category-uncategorized">
					<h1 class="entry-title">A simple WCF service with username password authentication: the things they don’t tell you</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/" title="11:35 am" rel="bookmark"><span class="entry-date">March 22, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/petervanooijen/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>The WCF framework is gigantic. It has such an enormous amount of possibilities that it’s pretty easy to get completely lost. For our scenario we needed just a small basic subset. Our application provides a set of services which are consumed by a diversity of clients which have to tell who they are by providing a custom&#160; username and password. There are loads and loads of documents and manuals to be found on the web but I didn’t find anything which gave me the complete story. Most of them follow all kinds of sidesteps in other parts of the rich WCF framework. Things we didn’t need at all, the things we needed to get our stuff to work were either omitted or only mentioned briefly in a comment.</p>
<p>This post tries to describe the full story. It will try to keep quiet on all noise on other cool, but unneeded, features. This information is assembled from a rich variety of stuff on the web and error messages provided by the WCF framework itself. The latter are often quite to the point and provide a lot of essential information. This post is just a kind of cookbook recipe, I don’t claim to understand every detail and would appreciate any comment to further clarify the details.</p>
<h2>The service</h2>
<p>The service is an ASP.NET service, hosted by IIS and configured in the system.ServiceModel part of the web.config.</p>
<div style="font-family: consolas;background: white;color: black;font-size: 10pt">
<p style="margin: 0px"><span style="color: blue">&#160; &lt;</span><span style="color: #a31515">system.serviceModel</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">services</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">service</span><span style="color: blue"> </span><span style="color: red">behaviorConfiguration</span><span style="color: blue">=</span>&quot;F<span style="color: blue">armService.CustomerDeskOperationsBehavior</span>&quot;<span style="color: blue"> </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;F<span style="color: blue">armService.CustomerDeskOperations</span>&quot;<span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">endpoint</span><span style="color: blue"> </span><span style="color: red">address</span><span style="color: blue">=</span>&quot;&quot;<span style="color: blue"> </span><span style="color: red">binding</span><span style="color: blue">=</span>&quot;<span style="color: blue">wsHttpBinding</span>&quot;<span style="color: blue"> </span><span style="color: red">bindingConfiguration</span><span style="color: blue">=</span>&quot;<span style="color: blue">RequestUserName</span>&quot;<span style="color: blue"> </span><span style="color: red">contract</span><span style="color: blue">=</span>&quot;F<span style="color: blue">armService.ICustomerDeskOperations</span>&quot;<span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">endpoint</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">endpoint</span><span style="color: blue"> </span><span style="color: red">address</span><span style="color: blue">=</span>&quot;<span style="color: blue">mex</span>&quot;<span style="color: blue"> </span><span style="color: red">binding</span><span style="color: blue">=</span>&quot;<span style="color: blue">mexHttpBinding</span>&quot;<span style="color: blue"> </span><span style="color: red">contract</span><span style="color: blue">=</span>&quot;<span style="color: blue">IMetadataExchange</span>&quot;<span style="color: blue">/&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">service</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">services</span><span style="color: blue">&gt;</span></p>
</p></div>
<p> <!--EndFragment-->
<p>The endpoint address is the root of the IIS site in which it his hosted. To use username authentication you need to use wsHttpBinding. The services functionality is described in the ICustomerDeskOperations contract.</p>
<p>In the binding you specify the credential type as username.</p>
<div style="font-family: consolas;background: white;color: black;font-size: 10pt">
<p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">bindings</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160; &lt;</span><span style="color: #a31515">wsHttpBinding</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">binding</span><span style="color: blue"> </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">RequestUserName</span>&quot;<span style="color: blue"> </span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">security</span><span style="color: blue"> </span><span style="color: red">mode</span><span style="color: blue">=</span>&quot;<span style="color: blue">Message</span>&quot;<span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">message</span><span style="color: blue"> </span><span style="color: red">clientCredentialType</span><span style="color: blue">=</span>&quot;<span style="color: blue">UserName</span>&quot;<span style="color: blue">/&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">security</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">binding</span><span style="color: blue">&gt;</span></p>
</p></div>
<p> <!--EndFragment-->
<p>In the servicebehaviour you set up how the username is going to be validated</p>
<div style="font-family: consolas;background: white;color: black;font-size: 10pt">
<p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">behaviors</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160; &lt;</span><span style="color: #a31515">serviceBehaviors</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">behavior</span><span style="color: blue"> </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">FarmService.CustomerDeskOperationsBehavior</span>&quot;<span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">serviceMetadata</span><span style="color: blue"> </span><span style="color: red">httpGetEnabled</span><span style="color: blue">=</span>&quot;<span style="color: blue">true</span>&quot;<span style="color: blue">/&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">serviceCredentials</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">userNameAuthentication</span><span style="color: blue"> </span><span style="color: red">userNamePasswordValidationMode</span><span style="color: blue">=</span>&quot;<span style="color: blue">Custom</span>&quot;<span style="color: blue"> </span><span style="color: red">customUserNamePasswordValidatorType</span><span style="color: blue">=</span>&quot;<span style="color: blue">FarmService.Authentication.DistributorValidator, FarmService</span>&quot;<span style="color: blue">/&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">serviceCertificate</span><span style="color: blue"> </span><span style="color: red">findValue</span><span style="color: blue">=</span>&quot;<span style="color: blue">Farm</span>&quot;<span style="color: blue"> </span><span style="color: red">storeLocation</span><span style="color: blue">=</span>&quot;<span style="color: blue">LocalMachine</span>&quot;<span style="color: blue"> </span><span style="color: red">storeName</span><span style="color: blue">=</span>&quot;<span style="color: blue">TrustedPeople</span>&quot;<span style="color: blue"> </span><span style="color: red">x509FindType</span><span style="color: blue">=</span>&quot;<span style="color: blue">FindBySubjectName</span>&quot;<span style="color: blue">/&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">serviceCredentials</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">behavior</span><span style="color: blue">&gt;</span></p>
</p></div>
<p> <!--EndFragment-->
<p>The username is custom validated. This is done by the <em>FarmService.Authentication.DistributorValidator</em> class in the <em>FarmService</em> assembly. This class inherits from WCF class <em>UserNamePasswordValidator</em> and overrides the <em>Validate</em> method.</p>
<div style="font-family: consolas;background: white;color: black;font-size: 10pt">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">DistributorValidator</span> : <span style="color: #2b91af">UserNamePasswordValidator</span></p>
<p style="margin: 0px">{ </p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">void</span> Validate(<span style="color: blue">string</span> userName, <span style="color: blue">string</span> password)</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (<span style="color: blue">string</span>.IsNullOrEmpty(userName) || <span style="color: blue">string</span>.IsNullOrEmpty(password))</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">SecurityTokenException</span>(<span style="color: #a31515">&quot;Username and password required&quot;</span>);</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> repository = <span style="color: blue">new</span> <span style="color: #2b91af">DistributorRepository</span>();</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (! repository.IsKnownDistributor(userName, password))</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">FaultException</span>(<span style="color: blue">string</span>.Format(<span style="color: #a31515">&quot;Wrong username ({0}) or password &quot;</span>, userName));</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>The method validates the incoming username and password in a repository and throws appropriate exceptions when needed. This is really custom code. As long as you don’t throw an exception the service invocation will be accepted.</p>
<p>So far this could have been a copy of many a story on the web. Except for one detail which is absolutely essential. For username password authentication to work your server hosting the service needs an X509 certificate. Else all service invocations will fail. This certificate is specified in the service behavior.</p>
<p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">serviceCertificate</span><span style="color: blue"> </span><span style="color: red">findValue</span><span style="color: blue">=</span>&quot;<span style="color: blue">Farm</span>&quot;<span style="color: blue"> </span><span style="color: red">storeLocation</span><span style="color: blue">=</span>&quot;<span style="color: blue">LocalMachine</span>&quot;<span style="color: blue"> </span><span style="color: red">storeName</span><span style="color: blue">=</span>&quot;<span style="color: blue">TrustedPeople</span>&quot;<span style="color: blue"></span><span style="color: red">&#160; x509FindType</span><span style="color: blue">=</span>&quot;<span style="color: blue">FindBySubjectName</span>&quot;<span style="color: blue">/&gt;</span></p>
<p>First you need a certificate. Instead of buying one (which is bound to a specific server address and thereby as good as useless for testing purposes) you can create your own. The .net framework comes with tools to generate these and there are several tutorials how to use these tools. Far more easier is <a href="http://www.pluralsight-training.net/community/blogs/keith/archive/2009/01/22/create-self-signed-x-509-certificates-in-a-flash-with-self-cert.aspx">selfcert</a> a <a href="http://www.pluralsight-training.net/microsoft/">pluralsight</a> tool which takes care of the whole process in a couple of clicks.</p>
<p>What they don’t tell you here is that you have to run the tool as administrator, else it will crash most ungracefully. What the tool is also unclear about is where to store the generated certificate. By default it is stored in <em>MyStore</em>. When validating the certificate it’s trustworthiness depends on the location it is stored. When the store is not trusted a chain of validation is started. Instead of setting up a chain of certificates you can also directly store your certificate in a trusted store.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/peter.van.ooijen/SelfCert_5F00_5810E1BA.png"><img style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" border="0" alt="SelfCert" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/peter/van/ooijen/SelfCert_thumb_133497B9.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787624&amp;Signature=qQJNmIRE%2fWbaTnRL0A7S5gID5F0%3d" width="576" height="431" /></a> </p>
<p>With these settings the certificate is stored in a trusted location. The name and location match the settings in the service behavior</p>
<p>Troubles don’t end here. After a while, like logging in the next time, the service host will start complaining it cannot find the private key of the certificate with a “Keyset does not exist” error message. What happens it that the service no longer has the access right to read the certificate. What helped me was explicitly setting rights on the certificate’s private key file.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/peter.van.ooijen/SelfCert2_5F00_56ABFD41.png"><img style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" border="0" alt="SelfCert2" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/peter/van/ooijen/SelfCert2_thumb_53A672C1.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1919787624&amp;Signature=0EFwP3xwnPmPTHGIPMUM%2bE30z1o%3d" width="556" height="522" /></a> </p>
<p>&#160;</p>
<p>Here I am using a blunt axe by just allowing everybody read rights on the certificate’s private key file. I’m no security expert but I am aware this is absolutely not the way to do things. But hey, I only want to build a service, never asked for this certificate stuff and the only thing I want to do here is get that out of the way in the development process.</p>
<p>Now the service is ready to be consumed by a client</p>
<h2>The client</h2>
<p>To consume this service add a service reference in the client. The mexHttpBinding in the service configuration enables to read all metadata form the service without any credentials.</p>
<p>Setting up a connection to the client requires some fiddling. Again not all of these settings are clear by default. </p>
<div style="font-family: consolas;background: white;color: black;font-size: 10pt">
<p style="margin: 0px"><span style="color: blue">var</span> endPoint = <span style="color: blue">new</span> <span style="color: #2b91af">EndpointAddress</span>(<span style="color: blue">new</span> <span style="color: #2b91af">Uri</span>(<span style="color: #2b91af">Farm</span>.FarmUrl), <span style="color: #2b91af">EndpointIdentity</span>.CreateDnsIdentity(<span style="color: #a31515">&quot;Farm&quot;</span>));</p>
<p style="margin: 0px"><span style="color: blue">var</span> binding = <span style="color: blue">new</span> <span style="color: #2b91af">WSHttpBinding</span>();</p>
<p style="margin: 0px">binding.Security.Mode = <span style="color: #2b91af">SecurityMode</span>.Message;</p>
<p style="margin: 0px">binding.Security.Message.ClientCredentialType = <span style="color: #2b91af">MessageCredentialType</span>.UserName;</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px"><span style="color: blue">var</span> result = <span style="color: blue">new</span> <span style="color: #2b91af">CustomerDeskOperationsClient</span>(binding, endPoint);</p>
<p style="margin: 0px">result.ClientCredentials.UserName.UserName = <span style="color: #2b91af">Farm</span>.FarmUserName;</p>
<p style="margin: 0px">result.ClientCredentials.UserName.Password = <span style="color: #2b91af">Farm</span>.FarmPassword;</p>
</p></div>
<p> <!--EndFragment-->
<p>First we need an endpoint. This is assembled from the url in the client’s configuration, here a constant <em>Farm.FarmUrl</em>. For the custom username authentication to work the endpoint also needs an <em>EndpointIndentity</em>. According to the sparse msdn documentation this is to prevent phishing. The fact that the identity was needed and the parameter had to be the certificate’s name was suggested by the WCF error messages.</p>
<p>The security is set according to the security settings we have seen in the service. Both the username and password are set in <em>UserName</em> property of the <em>ClientCredentails</em>.</p>
<h2>Wrapping up</h2>
<p>This is it. Now our service and clients are talking. But it took far to much effort to find the right settings. The number is not great, but they all were found to be essential. Finding the right was a process of endlessly weeding out all sidesteps. I hope this well help you to get it done a little faster. </p>
<p>&lt;Update&gt;</p>
<p>The many useful comments and their possibilities are summarized in <a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me.aspx">this sequel</a>. All misty things in this post are clarified there. Be sure to read it.</p>
<p>&lt;/Update&gt;</p>
											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Peter van Ooijen</h2>
							Bla di blore, later I'll tell more							<div id="author-link">
								<a href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">View all posts by Peter van Ooijen &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/" title="Permalink to A simple WCF service with username password authentication: the things they don’t tell you" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/feed/" title="Comments RSS to A simple WCF service with username password authentication: the things they don’t tell you" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-576 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2010/03/07/ubiquitous-and-unambiguous/" rel="prev"><span class="meta-nav">&larr;</span> Ubiquitous and unambiguous ?</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me/" rel="next">A simple WCF service with username password authentication: the things you told me <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-2833">
					<div id="dsq-comment-header-2833" class="dsq-comment-header">
						<cite id="dsq-cite-2833">
								<span id="dsq-author-user-2833">paper1337</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2833" class="dsq-comment-body">
						<div id="dsq-comment-message-2833" class="dsq-comment-message"><p>And we wonder why so many developers resort to using isAdmin=true in the query string&#8230;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2834">
					<div id="dsq-comment-header-2834" class="dsq-comment-header">
						<cite id="dsq-cite-2834">
	http://johannes.hansen.name/							<span id="dsq-author-user-2834">Johannes Hansen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2834" class="dsq-comment-body">
						<div id="dsq-comment-message-2834" class="dsq-comment-message"><p>@paper1337: Sure certificates are a hassle to work with. However you can ease the pain slightly by using a certificate server which is trusted on domain members machines automatically using group policy config. This way you don&#8217;t have to distribute test/dev certs between developer machines.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2835">
					<div id="dsq-comment-header-2835" class="dsq-comment-header">
						<cite id="dsq-cite-2835">
								<span id="dsq-author-user-2835">DaRage</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2835" class="dsq-comment-body">
						<div id="dsq-comment-message-2835" class="dsq-comment-message"><p>WCF is stupid</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2836">
					<div id="dsq-comment-header-2836" class="dsq-comment-header">
						<cite id="dsq-cite-2836">
	http://heathermclean.net/							<span id="dsq-author-user-2836">Heather McLean</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2836" class="dsq-comment-body">
						<div id="dsq-comment-message-2836" class="dsq-comment-message"><p>Easier than dealing with the certificate mess, I just use TransportWithMessageCredential as the security mode. Then all you need is an SSL connection. Our QA and production environments are already setup for SSL, so no hassles there &#8211; if I have to test locally, I can set it up once for my entire IIS installation using a self-signed certificate.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2837">
					<div id="dsq-comment-header-2837" class="dsq-comment-header">
						<cite id="dsq-cite-2837">
	http://mynerditorium.blogspot.com							<span id="dsq-author-user-2837">Daniel Auger</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2837" class="dsq-comment-body">
						<div id="dsq-comment-message-2837" class="dsq-comment-message"><p>As Heather said, using SSL instead of x509 certs makes things much more straight forward. Additionally &#8211; in .NET 4.0 and 3.5 (via a hotfix), you no longer need SSL all the way to the IIS server, meaning you can do SSL at an appliance level. This ability was added via the AllowInsecureTransport property &#8211; <a href="http://support.microsoft.com/kb/971831" rel="nofollow">http://support.microsoft.com/kb/971831</a> .</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2838">
					<div id="dsq-comment-header-2838" class="dsq-comment-header">
						<cite id="dsq-cite-2838">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2838">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2838" class="dsq-comment-body">
						<div id="dsq-comment-message-2838" class="dsq-comment-message"><p>Having a certificate server at hand is beyond my possibilities. I have to be able to do development work on a machine detached from it&#8217;s home domain. FI working at my customer&#8217;s location.<br />
I don&#8217;t always have a live IIS at hand too. This works on a Cassini server. Does the SSL alternative work there ?<br />
If so, it sounds like an alternative for development. But SSL is no option for deployment, so that would be switching (and testing..) to the configuration (with a real trusted certificate) described. Without the fiddling <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2839">
					<div id="dsq-comment-header-2839" class="dsq-comment-header">
						<cite id="dsq-cite-2839">
	http://wrtwt							<span id="dsq-author-user-2839">ertwre</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2839" class="dsq-comment-body">
						<div id="dsq-comment-message-2839" class="dsq-comment-message"><p>wrwt</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2840">
					<div id="dsq-comment-header-2840" class="dsq-comment-header">
						<cite id="dsq-cite-2840">
	http://webservices20.blogspot.com/							<span id="dsq-author-user-2840">Yaron Naveh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2840" class="dsq-comment-body">
						<div id="dsq-comment-message-2840" class="dsq-comment-message"><p>With WCF clearUsernamebinding you can send a username withtout an X.509 certificate:</p>
<p><a href="http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html" rel="nofollow">http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2841">
					<div id="dsq-comment-header-2841" class="dsq-comment-header">
						<cite id="dsq-cite-2841">
	http://simon-says-architecture.com/							<span id="dsq-author-user-2841">Szymon Pobiega</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2841" class="dsq-comment-body">
						<div id="dsq-comment-message-2841" class="dsq-comment-message"><p>Why are you using wsHttpBinding instead of basic one? Do you have some strong reliability-related requirements?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2842">
					<div id="dsq-comment-header-2842" class="dsq-comment-header">
						<cite id="dsq-cite-2842">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2842">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2842" class="dsq-comment-body">
						<div id="dsq-comment-message-2842" class="dsq-comment-message"><p>Clearusernamebinding <a href="http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html" rel="nofollow">http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html</a><br />
is not part of the WCF framework itself. I guess it&#8217;s born out of the samen kind of frustration <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_confused.gif' alt=':?' class='wp-smiley' /> </p>
<p>@Szymon: the WCF customusername authentication requires wsHttpBinding. No choice..</p>
<p>I think I will give clearusernamebinding a try. It sounds promissing.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2843">
					<div id="dsq-comment-header-2843" class="dsq-comment-header">
						<cite id="dsq-cite-2843">
	http://ornatsky.blogspot.com/							<span id="dsq-author-user-2843">Dmitry Ornatsky</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2843" class="dsq-comment-body">
						<div id="dsq-comment-message-2843" class="dsq-comment-message"><p>@pvanooijen, don&#8217;t use clearUsernameBinding in scenarios like this. It&#8217;s intended to help when confidentiality and integrity is ensured in a way that WCF stack is unaware of, like, when SSL is handled by network hardware. Otherwise, you&#8217;ll end up transmitting credentials in plain text.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2844">
					<div id="dsq-comment-header-2844" class="dsq-comment-header">
						<cite id="dsq-cite-2844">
	http://ornatsky.blogspot.com/							<span id="dsq-author-user-2844">Dmitry Ornatsky</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2844" class="dsq-comment-body">
						<div id="dsq-comment-message-2844" class="dsq-comment-message"><p>@pvanooijen  ,<br />
And as for BasicHttpBinding part, do you really need ws-security?<br />
You actually can authenticate against custom users storage with basicHttpBinding, just use Transport security mode.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2845">
					<div id="dsq-comment-header-2845" class="dsq-comment-header">
						<cite id="dsq-cite-2845">
								<span id="dsq-author-user-2845">Arnis L.</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2845" class="dsq-comment-body">
						<div id="dsq-comment-message-2845" class="dsq-comment-message"><p>Co-worker said that certificate is not necessary if  DnsIdentity is not used and this can be simplified or something. But I might misunderstood him and it doesn&#8217;t change whole point of blog post anyway &#8211; using WCF is constant &#8216;weeding of sidesteps&#8217;.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2846">
					<div id="dsq-comment-header-2846" class="dsq-comment-header">
						<cite id="dsq-cite-2846">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2846">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2846" class="dsq-comment-body">
						<div id="dsq-comment-message-2846" class="dsq-comment-message"><p>@Dmitry. I gave cUB a(nother) short spin. Again I bumped into a misunderstanding between Client and server about the protocol to be used.</p>
<p>Transport security is not an option. In the production environment buying a site specific certificate is not a big problem. For development we&#8217;ll keep using this &#8220;weeded&#8221; garden. </p>
<p>@Arnis: yes, it&#8217;s all about gardening <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2847">
					<div id="dsq-comment-header-2847" class="dsq-comment-header">
						<cite id="dsq-cite-2847">
	http://webservices20.blogspot.com/							<span id="dsq-author-user-2847">Yaron Naveh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2847" class="dsq-comment-body">
						<div id="dsq-comment-message-2847" class="dsq-comment-message"><p>@pvanooijen &#8211; what exact error did you got with CUB? It comes with a working sample. If you try to use it with a specific server you can customize the soap version or any other setting.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2848">
					<div id="dsq-comment-header-2848" class="dsq-comment-header">
						<cite id="dsq-cite-2848">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2848">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2848" class="dsq-comment-body">
						<div id="dsq-comment-message-2848" class="dsq-comment-message"><p>Yaron. The sample is OK.</p>
<p>As you can see in the post I&#8217;m building my own endpoint from code. So I have to do my own binding as well.<br />
What was unclear to me is what binding type I have to instantiate. All things I tried all resulted in &#8220;There was an error with the message security&#8221;</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2849">
					<div id="dsq-comment-header-2849" class="dsq-comment-header">
						<cite id="dsq-cite-2849">
	http://webservices20.blogspot.com/							<span id="dsq-author-user-2849">Yaron Naveh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2849" class="dsq-comment-body">
						<div id="dsq-comment-message-2849" class="dsq-comment-message"><p>You should instantiate the class ClearUsernameBinding. Anyway if this is important for you to be able to work w/o x.509 I can help you with it &#8211; I have a lot of experience with Wcf security.<br />
BTW the way to debug Wcf security issues is by turning on the Wcf trace on the service. In many cases it will give you extremely useful analysis.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2850">
					<div id="dsq-comment-header-2850" class="dsq-comment-header">
						<cite id="dsq-cite-2850">
	http://ornatsky.blogspot.com							<span id="dsq-author-user-2850">Dmitry Ornatsky</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2850" class="dsq-comment-body">
						<div id="dsq-comment-message-2850" class="dsq-comment-message"><p>@pvanooijen, you could use makecert to create SSL certificate for development env.</p>
<p><a href="http://www.codeproject.com/KB/WCF/WCFSSL.aspx" rel="nofollow">http://www.codeproject.com/KB/WCF/WCFSSL.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2851">
					<div id="dsq-comment-header-2851" class="dsq-comment-header">
						<cite id="dsq-cite-2851">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2851">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2851" class="dsq-comment-body">
						<div id="dsq-comment-message-2851" class="dsq-comment-message"><p>Thanks Yaron.<br />
I was naive in hoping I could keep the client unaware of the CUB class. Except from the name in the config. As we will also have 3d party customers, who will create their own clients, I don&#8217;t want to introduce them to more than &#8220;plain vanilla WCF&#8221;. </p>
<p>I don&#8217;t have a big problem with a (bought) certificate in the production environment. My only real problem with real certificates is that they are bound to a specific URL. And that makes it a problem in development.</p>
<p>The problem with SSL is that it (AFAIK) doesn&#8217;t work with Cassini. And it  introduces a configuration maintenance complexity in production. We will have internal and external clients.</p>
<p>For now I will stick to plain http with a fiddled certificate in development and a straightforward one in production.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2852">
					<div id="dsq-comment-header-2852" class="dsq-comment-header">
						<cite id="dsq-cite-2852">
	http://webservices20.blogspot.com/							<span id="dsq-author-user-2852">Yaron Naveh</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2852" class="dsq-comment-body">
						<div id="dsq-comment-message-2852" class="dsq-comment-message"><p>In development I think it is best to set certificateValidationMode to false.</p>
<p>As for CUB, the main motive was actually interoperability with non Wcf clients / servers, as some natively allow clear user / pass. If you expect unknown Wcf clients I agree you should stick to plain vanilla.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2853">
					<div id="dsq-comment-header-2853" class="dsq-comment-header">
						<cite id="dsq-cite-2853">
								<span id="dsq-author-user-2853">Henning</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2853" class="dsq-comment-body">
						<div id="dsq-comment-message-2853" class="dsq-comment-message"><p>Is it possible to inject a validation service in the constructor of the DistributorValidator?</p>
<p>We use dependency injection almost everywhere, Jimmy Bogard style, and would preferably not use Service location in the Validator.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2854">
					<div id="dsq-comment-header-2854" class="dsq-comment-header">
						<cite id="dsq-cite-2854">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2854">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2854" class="dsq-comment-body">
						<div id="dsq-comment-message-2854" class="dsq-comment-message"><p>@Yaron<br />
AFAIK you set that property on the client. For the service to be hosted in a webserver, &#8220;Show in browser&#8221; on the svc,  the webserver still needs to be able to read the certificate. Which does not free me from the uggly fiddle.</p>
<p>@Hennig.<br />
Why not ? It&#8217;s just a piece of code like any other other.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2855">
					<div id="dsq-comment-header-2855" class="dsq-comment-header">
						<cite id="dsq-cite-2855">
								<span id="dsq-author-user-2855">Adrian</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2855" class="dsq-comment-body">
						<div id="dsq-comment-message-2855" class="dsq-comment-message"><p>You can get rid of the certificate if not needed using this:<br />
ServicePointManager.ServerCertificateValidationCallback += HandleCertificationCheck;<br />
 public static bool HandleCertificationCheck(object sender, X509Certificate certificate, X509Chain chain,  SslPolicyErrors sslPolicyErrors)<br />
        {<br />
            return true;<br />
        }</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2856">
					<div id="dsq-comment-header-2856" class="dsq-comment-header">
						<cite id="dsq-cite-2856">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2856">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2856" class="dsq-comment-body">
						<div id="dsq-comment-message-2856" class="dsq-comment-message"><p>Same problem, it&#8217;s client side</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2857">
					<div id="dsq-comment-header-2857" class="dsq-comment-header">
						<cite id="dsq-cite-2857">
								<span id="dsq-author-user-2857">Henning</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2857" class="dsq-comment-body">
						<div id="dsq-comment-message-2857" class="dsq-comment-message"><p>Thanks for your answer. I got it to work, but hit a rather boring snag.</p>
<p>As far as I can tell, the Validate method is called before pretty much everything. That poses a problem with my Unit of work. We use nhibernate and in our webclient it automatically saves failed attemps and locks the account after X number of failed attempts.<br />
When I try to do something similar with your solution my unit of work hasn&#8217;t been initialized yet, and therefore does not save the User.</p>
<p>My current Unit of work solution creates a class that inherits from IInstanceProvider and Commits the session on ReleaseInstance. However, when the validation failes, i.e an exception is thrown, the method is never called. In fact, GetInstances is not called as well.</p>
<p>Do you have a solution for this?<br />
If I can&#8217;t find a solution to this I have to find another way, like using an Attribute.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2858">
					<div id="dsq-comment-header-2858" class="dsq-comment-header">
						<cite id="dsq-cite-2858">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2858">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2858" class="dsq-comment-body">
						<div id="dsq-comment-message-2858" class="dsq-comment-message"><p>Validate is called just before anything else. So the configuration will not be right yet. I bumped into the same issue myself. What I did was fire off the configuration in my Validate method. Which will not work in your case, as your intention is to inject an implementattion. Chicken and egg..</p>
<p>I can imagine this being pretty hard. From a hacker&#8217;s perspective it might be interesting to do just that. WCF is pretty hard to hack. So hard it is pretty hard to use as well <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2859">
					<div id="dsq-comment-header-2859" class="dsq-comment-header">
						<cite id="dsq-cite-2859">
								<span id="dsq-author-user-2859">Henning</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2859" class="dsq-comment-body">
						<div id="dsq-comment-message-2859" class="dsq-comment-message"><p>That doesn&#8217;t sound to good for me.</p>
<p>What I initially planned to do was to use a custom Authenticate attribute that I put on the webservice methods and validate the credentials there. The bad thing about this is that I have to make my own custom header message, such as Username and password.<br />
Is this something you would do in my case?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2860">
					<div id="dsq-comment-header-2860" class="dsq-comment-header">
						<cite id="dsq-cite-2860">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2860">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2860" class="dsq-comment-body">
						<div id="dsq-comment-message-2860" class="dsq-comment-message"><p>I don&#8217;t think setting an attribute on the methods will work. You have to get past the Valoidate method first.</p>
<p>Custom headers with username password ? Why would you want to do that ? Sounds like reinventing the WCF wheel. And it makes switching to another mode of authentication/authorization very hard. </p>
<p>What we do is catch the user credentials in the validate method and use them where needed in the implementation of th service.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2861">
					<div id="dsq-comment-header-2861" class="dsq-comment-header">
						<cite id="dsq-cite-2861">
								<span id="dsq-author-user-2861">cav</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2861" class="dsq-comment-body">
						<div id="dsq-comment-message-2861" class="dsq-comment-message"><p>Anyone else getting the good ol&#8217;&#8221;object reference not set to an instance of an object&#8221; while running self-cert? I&#8217;m running in Windows 7 (as admin).</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2862">
					<div id="dsq-comment-header-2862" class="dsq-comment-header">
						<cite id="dsq-cite-2862">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2862">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2862" class="dsq-comment-body">
						<div id="dsq-comment-message-2862" class="dsq-comment-message"><p>That should have been part of this<br />
<a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me.aspx" rel="nofollow">http://codebetter.com/blogs/peter.van.ooijen/archive/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me.aspx</a></p>
<p>as well.</p>
<p>SelfCert shines but the exception handlings just sucks <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_sad.gif' alt=':(' class='wp-smiley' />  It does come with sourcecode. Be their guest <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2863">
					<div id="dsq-comment-header-2863" class="dsq-comment-header">
						<cite id="dsq-cite-2863">
								<span id="dsq-author-user-2863">cav</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2863" class="dsq-comment-body">
						<div id="dsq-comment-message-2863" class="dsq-comment-message"><p>Found it. If you type into the combos of SelfCert it gives the error. you have to pick from the list instead.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2864">
					<div id="dsq-comment-header-2864" class="dsq-comment-header">
						<cite id="dsq-cite-2864">
								<span id="dsq-author-user-2864">cav</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2864" class="dsq-comment-body">
						<div id="dsq-comment-message-2864" class="dsq-comment-message"><p>OK, I had a nice little WCF serfvice app running and tried to lock it down with this article.<br />
After following all the steps, my Service is no longer being found when I try to add a Service Reference. Where do I even start debuggin this?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2865">
					<div id="dsq-comment-header-2865" class="dsq-comment-header">
						<cite id="dsq-cite-2865">
								<span id="dsq-author-user-2865">cav</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2865" class="dsq-comment-body">
						<div id="dsq-comment-message-2865" class="dsq-comment-message"><p>Got it working (typo in the config). However I&#8217;ve noticed that if you use the override for the service that doesn&#8217;t proved the binding and endpoint, it still works. ie instead of</p>
<p>var result = new CustomerDeskOperationsClient(binding, endPoint);<br />
result.ClientCredentials.UserName.UserName = Farm.FarmUserName;<br />
result.ClientCredentials.UserName.Password = Farm.FarmPassword;</p>
<p>you can just use</p>
<p>var result = new CustomerDeskOperationsClient();</p>
<p>doesn&#8217;t this negate the whole point? Or have I done something wrong?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2866">
					<div id="dsq-comment-header-2866" class="dsq-comment-header">
						<cite id="dsq-cite-2866">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2866">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2866" class="dsq-comment-body">
						<div id="dsq-comment-message-2866" class="dsq-comment-message"><p>Looks like the default endpoint, as imported when adding the service reference, binds to a version of the service which can be consumed without credentials. Perhaps your old version of the service is still floating around ?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2867">
					<div id="dsq-comment-header-2867" class="dsq-comment-header">
						<cite id="dsq-cite-2867">
	http://www.ssllogic.com/							<span id="dsq-author-user-2867">SSL Certificates</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2867" class="dsq-comment-body">
						<div id="dsq-comment-message-2867" class="dsq-comment-message"><p>a long discussion in going on,, I am enjoying coz i am getting all the answers of my questions without asking here.  Cheers.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2868">
					<div id="dsq-comment-header-2868" class="dsq-comment-header">
						<cite id="dsq-cite-2868">
	http://w3mentor.com							<span id="dsq-author-user-2868">ram</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2868" class="dsq-comment-body">
						<div id="dsq-comment-message-2868" class="dsq-comment-message"><p>thank for this wcf article. will use it on <a href="http://w3mentor.com" rel="nofollow">http://w3mentor.com</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2869">
					<div id="dsq-comment-header-2869" class="dsq-comment-header">
						<cite id="dsq-cite-2869">
	http://www.clickssl.com							<span id="dsq-author-user-2869">Cheap SSL</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2869" class="dsq-comment-body">
						<div id="dsq-comment-message-2869" class="dsq-comment-message"><p>I am adequate coz i am accepting all the answers of my questions after allurement here.</p>
<p>Thanks for this excellent sharing.<br />
Keep it up!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2870">
					<div id="dsq-comment-header-2870" class="dsq-comment-header">
						<cite id="dsq-cite-2870">
								<span id="dsq-author-user-2870">aaav</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2870" class="dsq-comment-body">
						<div id="dsq-comment-message-2870" class="dsq-comment-message"><p>Hello,<br />
I am testing the WCF service and client locally.<br />
1) how do i find the address the web service is hosted locally. I tried address=&#8221;http://localhost/MyService.svc&#8221; and i get error that there is no endpoint listening here.<br />
2) Once I get this working, and ready to move to server&#8230; How do I  make the certificate on the server(test certificate) ?I used makecert locally.<br />
3) when the certificate is there on the server&#8230; how does the client gets that? do i have to export the certificate from the server to the client ? please explain.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2871">
					<div id="dsq-comment-header-2871" class="dsq-comment-header">
						<cite id="dsq-cite-2871">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2871">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2871" class="dsq-comment-body">
						<div id="dsq-comment-message-2871" class="dsq-comment-message"><p>hi,</p>
<p>1. The service has to be running. Can be done by selecting &#8220;View in Browser&#8221; on .svc</p>
<p>2. Easiest way is to run makecert again on the server. Else check for the administration of certificates on the server. Is on IT mangement issues.</p>
<p>3. Don&#8217;t worry, no work needed here <img src='http://codebetter.com/petervanooijen/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2872">
					<div id="dsq-comment-header-2872" class="dsq-comment-header">
						<cite id="dsq-cite-2872">
								<span id="dsq-author-user-2872">Wil</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2872" class="dsq-comment-body">
						<div id="dsq-comment-message-2872" class="dsq-comment-message"><p>Here is a good article on using certificates without a certificate store.  Although it has config classes for loading the client and server certificates from the file system, I actually use the certificate store for the service host machine and I load the client certificate from the file system using the code from this article. <a href="http://www.codeproject.com/KB/WCF/wcfcertificates.aspx" rel="nofollow">http://www.codeproject.com/KB/WCF/wcfcertificates.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2873">
					<div id="dsq-comment-header-2873" class="dsq-comment-header">
						<cite id="dsq-cite-2873">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2873">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2873" class="dsq-comment-body">
						<div id="dsq-comment-message-2873" class="dsq-comment-message"><p>The link in your comment is broken: this should be the right one:</p>
<p><a href="http://www.codeproject.com/KB/WCF/wcfcertificates.aspx">http://www.codeproject.com/KB/WCF/wcfcertificates.aspx</a></p>
<p>The problem with certificate store I describe here can quite easely be fixed with the windows http cert tools </p>
<p>as described in the sequel on this post:</p>
<p><a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me.aspx">http://codebetter.com/blogs/peter.van.ooijen/archive/2010/04/09/a-simple-wcf-service-with-username-password-authentication-the-things-you-told-me.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2982">
					<div id="dsq-comment-header-2982" class="dsq-comment-header">
						<cite id="dsq-cite-2982">
	http://retrievepassword.us/a-simple-wcf-service-with-username-password-authentication-the/							<span id="dsq-author-user-2982">A simple WCF service with username password authentication: the &#8230; | Retrieve Password</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2982" class="dsq-comment-body">
						<div id="dsq-comment-message-2982" class="dsq-comment-message"><p>[...]  [...]</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2995">
					<div id="dsq-comment-header-2995" class="dsq-comment-header">
						<cite id="dsq-cite-2995">
								<span id="dsq-author-user-2995">Nupur</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2995" class="dsq-comment-body">
						<div id="dsq-comment-message-2995" class="dsq-comment-message"><p>Hello Sir,<br />
I have done till here and everything is working fine but my need is to prevent re-authentication of client for subsequent service calls as the client is already authenticated for the initial service call,he should provide access rights for subsequent service calls without re-authentication&#8230;..</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2997">
					<div id="dsq-comment-header-2997" class="dsq-comment-header">
						<cite id="dsq-cite-2997">
								<span id="dsq-author-user-2997">Anonymous</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2997" class="dsq-comment-body">
						<div id="dsq-comment-message-2997" class="dsq-comment-message"><p>Good day to you,</p>
<p>A service is usually stateless, that is it does not associate one invocation with a previous one and requires supplying the credentials every time.<br />
Which does not prevent you from caching the credentials in your client software after the user has entered them once.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2998">
					<div id="dsq-comment-header-2998" class="dsq-comment-header">
						<cite id="dsq-cite-2998">
								<span id="dsq-author-user-2998">Nupur</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2998" class="dsq-comment-body">
						<div id="dsq-comment-message-2998" class="dsq-comment-message"><p>First of all Thanks for the reply sir.But I want to correct my self as in my previous post I mistakenly mentioned there to call another service instead my need is to call another method of same service without re-authenticaton could you help me in this and please provide me the step by step guidance on how to do it</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-3000">
					<div id="dsq-comment-header-3000" class="dsq-comment-header">
						<cite id="dsq-cite-3000">
								<span id="dsq-author-user-3000">Anonymous</span>
							</cite>
					</div>
					<div id="dsq-comment-body-3000" class="dsq-comment-body">
						<div id="dsq-comment-message-3000" class="dsq-comment-message"><p>You can only do that provided both methods are a member of the same service and that service supports sessions.<br />
It&#8217;s far easier to store the username &#8211; password combination in the client code and add it to the service request. As explained in the post. And that will only work as long as each service accepts the same username password combination.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-3001">
					<div id="dsq-comment-header-3001" class="dsq-comment-header">
						<cite id="dsq-cite-3001">
								<span id="dsq-author-user-3001">Nupur</span>
							</cite>
					</div>
					<div id="dsq-comment-body-3001" class="dsq-comment-body">
						<div id="dsq-comment-message-3001" class="dsq-comment-message"><p>Thanks once again.I know I am becoming a bit more greedy but could you please provide me the sample or any example for implementing the same.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-3002">
					<div id="dsq-comment-header-3002" class="dsq-comment-header">
						<cite id="dsq-cite-3002">
								<span id="dsq-author-user-3002">Anonymous</span>
							</cite>
					</div>
					<div id="dsq-comment-body-3002" class="dsq-comment-body">
						<div id="dsq-comment-message-3002" class="dsq-comment-message"><p>What are you missing ?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-3024">
					<div id="dsq-comment-header-3024" class="dsq-comment-header">
						<cite id="dsq-cite-3024">
	http://twitter.com/tevest							<span id="dsq-author-user-3024">tevest</span>
							</cite>
					</div>
					<div id="dsq-comment-body-3024" class="dsq-comment-body">
						<div id="dsq-comment-message-3024" class="dsq-comment-message"><p>I suggest changing adding the word &#8220;message  security, certificates&#8221; to the title, I had to do this the hard way too, I was looking for a free ssl tool when stumbled upon this post. It would&#8217;ve been much less painful if I found it when started!</p>
<p>Great post</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/ ';
	var disqus_identifier = '576 /blogs/peter.van.ooijen/archive/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetterpetergekkosblog';
	var disqus_title = "A simple WCF service with username password authentication: the things they don’t tell you";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=576');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/petervanooijen/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
			{
				'author_name':	"A simple WCF service with username password authentication: the &#8230; | Retrieve Password",
				'author_url':	"http:\/\/retrievepassword.us\/a-simple-wcf-service-with-username-password-authentication-the\/",
				'date':			"12\/18\/2010 10:36 AM",
				'excerpt':		"[...]  [...] ",
				'type':			"pingback"			}
		],
		'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2010\/03\/22\/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='67 topics' style='font-size: 16.3151515152pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.4848484848pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.2121212121pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='45 topics' style='font-size: 14.8727272727pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.5454545455pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='13 topics' style='font-size: 10.5454545455pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.5454545455pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.8727272727pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='317 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.7515151515pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2010/12/28/seasons-gifts-from-the-monotouch-iphone-treasure-chest-background-gps-tasks-and-uicontrol/" title="Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl">Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/11/05/kalifescope-and-monotouch-from-idea-to-the-appstore/" title="Kalifescope and Monotouch, from idea to the AppStore">Kalifescope and Monotouch, from idea to the AppStore</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/10/28/monotouch-your-c-app-on-a-real-iphone/" title="Monotouch: your C# app on a real iPhone">Monotouch: your C# app on a real iPhone</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/09/28/monotouch-drawing-an-image-pixel-by-pixel/" title="Monotouch: drawing an image pixel by pixel">Monotouch: drawing an image pixel by pixel</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/08/30/catching-the-iphone-in-the-net/" title="Catching the iPhone in the .net">Catching the iPhone in the .net</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.392 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-18 15:16:10 -->
<!-- super cache -->