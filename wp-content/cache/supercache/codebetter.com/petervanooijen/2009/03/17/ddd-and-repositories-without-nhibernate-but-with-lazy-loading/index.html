<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>DDD and repositories. Without nHibernate but with lazy loading | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='The return of CopySourceAsHtml' href='http://codebetter.com/petervanooijen/2009/02/26/the-return-of-copysourceashtml/' />
<link rel='next' title='Every picture tells a story' href='http://codebetter.com/petervanooijen/2009/04/07/every-picture-tells-a-story/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=557' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,171] -->
<link rel="canonical" href="http://codebetter.com/petervanooijen/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='http://codebetter.com/photos/peter.van.ooijen/images/189384/original.aspx' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-557" class="post-557 post type-post status-publish format-standard hentry category-coding category-data">
					<h1 class="entry-title">DDD and repositories. Without nHibernate but with lazy loading</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading/" title="12:00 pm" rel="bookmark"><span class="entry-date">March 17, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>Domain driven design has become a very prominent way to develop software. A central domain model is used by all participants. To the end user it is a representation of the real&#160; world. To the coder the model is a class model, working with the real domain world boils down to instantiating objects from these classes. In meetings we find ourselves often discussing a Visual Studio class diagram. Nothing fancy, but it works quite well. The domain user recognizes her entities, their data and behavior, the developer recognizes his classes, properties and methods.</p>
<p><img src="http://codebetter.com/photos/peter.van.ooijen/images/189384/original.aspx" /></p>
<p>In DDD these domain objects interact with the database through repositories. The methods of a repository return (sets of) domain objects as read from the database or accept domain objects which will be persisted to the database. nHibernate is a wonderful tool to build these repositories. All you have to do is define a mapping between domain classes and databases tables and nHibernate will take care of the tedious sql stuff. As a bonus you get a nice API for querying.</p>
<p>But there are reasons not to use nHibernate. </p>
<ol>
<li>Learning curve. In some teams the jump from sql scattered between the tags of a web page, stored procedures and wherever else to an O/R mapper is to big. Getting all database access together in one assembly is a big step forward on itself. </li>
<li>Database server specific functionality. In a current project we are using SQL 2008 because we need the specific geographical functionality. At the time we started the project SQL 2008 was not feature stable yet, the nHibernate support was not quite there&#160; either and the specific geographical queries would require a lot of sql passthrough. Combined with point 1 it was obvious we were going to do the sql ourselves. </li>
<li>Restricted permissions on the application hoster. To do its magic nHibernate uses a lot of reflection. Reflection requires more priviliges than the partial trust many a shared hoster does offer. I <a href="http://petersgekko.codebetter.com/blogs/peter.van.ooijen/archive/2008/05/09/nhibernate-and-medium-trust.aspx">tried to get nHibernate to work under partial trust</a> but did not succeed. Perhaps it is possible with nHibernate 2.0 </li>
</ol>
<p>But not using nHibernate does not mean you cannot work in DDD style. Using the repository pattern is still the way to go. In the remainder of this post I will briefly demonstrate that and will focus on lazy loading. This is a programming aspect of domain objects which makes life for you as a coder so much easier and your code such a lot clearer and easier to maintain. Given the domain model of last figure, it is clear to code like this</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">foreach</span> (<span style="color: blue">var</span> orderLine <span style="color: blue">in</span> myOrder.Lines)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; myTotal += orderLine.Article.Price;</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p> When you need to think about the database stuff behind this things get complicated. The order has to be read from an orders table. The orderdetails are read from another table and for every orderline a row has to be read from the articles table. The only way to get this working is by implementing lazy loading. That is read the data from the database when it is requested, not any earlier than that. With nHibernate you get lazy loading for free. We had to do it ourselves. The solution presented here works well for us. But don’t take it for granted, we have to jump through some hoops. Feel free to comment. Anything to simplify the matter will improve our code.</p>
<p>The domain layer itself should suffer from persitance ignorance. That is it should be completely unknown to the domain object itself how and where it it persisted. The concession I have to make is that the domain object cannot ignore the fact that it is persited in some way and that it does have a certain price to retrieve data. To express this I define delegates with the domain classes , that is the signature of methods which will actually retrieve a domain object.</p>
<p>Take the article class</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">Article</span></p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">int</span> Id { <span style="color: blue">get</span>; <span style="color: blue">private</span> <span style="color: blue">set</span>; }</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">string</span> Name { <span style="color: blue">get</span>; <span style="color: blue">private</span> <span style="color: blue">set</span>; }</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">decimal</span> Price { <span style="color: blue">get</span>; <span style="color: blue">private</span> <span style="color: blue">set</span>; }</p>
<p style="margin: 0px">}</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">delegate</span> <span style="color: #2b91af">Article</span> <span style="color: #2b91af">OnRequestArticle</span>(<span style="color: blue">int</span> id);</p>
</p></div>
<p> <!--EndFragment-->
<p>This delegate is used by the order line class to lazyload an article</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">OrderLine</span></p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> OrderLine(<span style="color: blue">int</span> articleId, <span style="color: blue">int</span> numberOrdered)</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">this</span>.articleId = articleId;</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; NumberOrdered = numberOrdered;</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">int</span> NumberOrdered { <span style="color: blue">get</span>; <span style="color: blue">set</span>; }</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: #2b91af">OnRequestArticle</span> RequestArticle { <span style="color: blue">get</span>; <span style="color: blue">set</span>; }</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">int</span> articleId;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: #2b91af">Article</span> article;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">Article</span> Article</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">get</span></p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (article == <span style="color: blue">null</span>)</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (RequestArticle != <span style="color: blue">null</span>)</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; article = RequestArticle(articleId);</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> article;</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>The article of the orderline is instantiated as a null object. The first time the article is requested the static delegate property is fired to actually retrieve the article. To do that I need the article id. Which is passed in the constructor but not exposed by the domain object. In case you need it it is requested as orderLine.Article.ID</p>
<p>Likewise the orderlines define a delegate, this one expresses that orderlines come in a set, all belonging to the same order.</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">delegate</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; <span style="color: #2b91af">OnRequestOrderLines</span>(<span style="color: #2b91af">Order</span> forOrder);</p>
</p></div>
<p><!--EndFragment-->This delegate is used in the Order domain class</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: #2b91af">OnRequestOrderLines</span> RequestOrderLines { <span style="color: blue">get</span>; <span style="color: blue">set</span>; }</p>
<p style="margin: 0px"><span style="color: blue">private</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; lines;</p>
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; Lines</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">get</span></p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (lines == <span style="color: blue">null</span>)</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (RequestOrderLines != <span style="color: blue">null</span>)</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; lines = RequestOrderLines(<span style="color: blue">this</span>);</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> lines;</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">}</p>
</p></div>
<p>Using these static delegates we can have lazy loading. For the delegates to work they have to be wired up. Before doing that we have to take a look at implementing the repositories.</p>
<p>This demo project has three repositories: Orders, Articles and Customers. I will not dive into the details of the implementation, you can find those <a href="http://petersgekko.codebetter.com/blogs/peter.van.ooijen/archive/2007/12/03/back-to-basics-from-the-db-to-a-simple-domain-object.aspx">in a previous post</a>. What is important for now are the signatures of the repository methods. This is the OrderRepository.</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">OrderRepository</span></p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">Order</span> GetOrder(<span style="color: blue">int</span> orderId)</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Order</span>&gt; ListOrders()</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; GetOrderLines(<span style="color: #2b91af">Order</span> forOrder)</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>The last method is quite interesting as it’s signature matches the OnRequestOrderLines delegate. It is the one which has to be wired to the Order’s&#160; RequestOrderLines property.</p>
<p>The repository has a helper class Lazyloaders which exposes all lazy loading methods as static methods. </p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">LazyLoaders</span></p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; RequestOderLines(<span style="color: #2b91af">Order</span> order)</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> orderRepository = <span style="color: blue">new</span> <span style="color: #2b91af">OrderRepository</span>();</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> orderRepository.GetOrderLines(order);</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: #2b91af">Article</span> RequestArticle(<span style="color: blue">int</span> articleId)</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> articleRepository = <span style="color: blue">new</span> <span style="color: #2b91af">ArticleRepository</span>();</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> articleRepository.GetArticle(articleId);</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>A repository object has very real instance members such as the connection to the database. It is not desired to have such a connection as a static member of the repository class. So it’s not possible to declare these static lazyloader members as members of the repository. That’s the main reason for the helper class.</p>
<p>The lazyloaders have to be static as they are wired to a static property of the domain objects. This wiring up is done in the static constructor of the repository. A static constructor is fired only once, at the moment in your code the class is actually used the first time.</p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">OrderRepository</span></p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">static</span> OrderRepository()</p>
<p style="margin: 0px">&#160;&#160;&#160; {</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Order</span>.RequestOrderLines = <span style="color: #2b91af">LazyLoaders</span>.RequestOrderLines;</p>
<p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OrderLine</span>.RequestArticle = <span style="color: #2b91af">LazyLoaders</span>.RequestArticle;</p>
<p style="margin: 0px">&#160;&#160;&#160; }</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">Order</span> GetOrder(<span style="color: blue">int</span> orderId)</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Order</span>&gt; ListOrders()</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">&#160;</p>
<p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">OrderLine</span>&gt; GetOrderLines(<span style="color: #2b91af">Order</span> forOrder)</p>
<p style="margin: 0px">&#160;&#160;&#160; {}</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>In the static constructor of the repository the domain class is given an implementation of the lazyloaders. And now I am there and do have lazy loading for my orders and orderlines. </p>
<p>It works. There are some things I don’t quite like</p>
<ul>
<li>The domain objects have to expose public delegate properties. These are needed by the repositories but for anything else they can be confusing.</li>
<li>The orderrepository has to expose the GetOrderLines method. This method makes no sense to any code outside the repositories. There are no orderlines without an order. The only way to access orderlines should be through their order. The lazy loading will return the orderlines. Lazy loading does need this method. Nobody else does. Any suggestion to hide this method is appreciated.</li>
<li>I have to keep the article ID in the orderline. It is hidden and only required for the lazy loading. But I don’t like having an article Id and an Article in my orderline object.</li>
</ul>
<p>But as a whole this solution is quite satisfying for us. You might wonder whether it performs well. When the&#160; simple loop we started with executes a lot is happening behind the scenes. </p>
<div style="border-right: 1px solid;border-top: 1px solid;font-size: 10pt;background: white;border-left: 1px solid;color: black;border-bottom: 1px solid;font-family: courier new">
<p style="margin: 0px"><span style="color: blue">foreach</span> (<span style="color: blue">var</span> orderLine <span style="color: blue">in</span> myOrder.Lines)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&#160;&#160;&#160; myTotal += orderLine.Article.Price;</p>
<p style="margin: 0px">}</p>
</p></div>
<p> <!--EndFragment-->
<p>For every iteration in the loop an article repository is created and a database query is performed.&#160; When it comes to the actual performance the only thing which really counts is database access. Don’t worry about instantiating POCO’s, do worry about complex sql. That’ s where the real bottleneck is. In this case I’m firing a series of short and simple sql statements. The ado.net connection pooling will ensure the multiple subsequent connections to the DB will be fast. And in real life the code presented here works fast and smooth.</p>
<p>The real plus lies in the real part of the application, where the code does things all kind of things with the domain objects. And never, ever has to worry when or how the data is read into the domain object. </p>
<p>I still do miss nHibernate. Writing all the sql, and especially maintaining it, is tedious and can be pretty boring. Except for the geographical stuff. But to all other parts of the application it is transparent whether the repositories are hand work or implemented by an O-R mapper. </p>
<p>I do hope to have made clear that you main goal should be coding against a domain model, and not using an O-R mapper. And I do hope you have suggestions to make my life even easier.</p>
<div class="shr-publisher-557"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/coding/" title="View all posts in Coding" rel="category tag">Coding</a>, <a href="http://codebetter.com/petervanooijen/category/data/" title="View all posts in Data" rel="category tag">Data</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading/" title="Permalink to DDD and repositories. Without nHibernate but with lazy loading" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading/feed/" title="Comments RSS to DDD and repositories. Without nHibernate but with lazy loading" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-557 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2009/02/26/the-return-of-copysourceashtml/" rel="prev"><span class="meta-nav">&larr;</span> The return of CopySourceAsHtml</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2009/04/07/every-picture-tells-a-story/" rel="next">Every picture tells a story <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-2720">
                    <div id="dsq-comment-header-2720" class="dsq-comment-header">
                        <cite id="dsq-cite-2720">
    http://anothercodingcatastrophe.co.uk                            <span id="dsq-author-user-2720">Nik Radford</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2720" class="dsq-comment-body">
                        <div id="dsq-comment-message-2720" class="dsq-comment-message"><p>Typically when I&#8217;m doing data access I only do lazy loading on collections. Which I&#8217;ve created a class for, which takes an IEnumerable<t> and populates itself from the IEnumerable</t><t> when an action that requires the list to be enumerated is performed.</p>
<p>Using the the love that is yield return you can keep it truly lazy, though I usually have to pull datasets so my my IEnumerable yield function (which I&#8217;m unaware what the actual name for them are) just builds the objects from the dataset(s) but you could do it with SqlDataReader if you don&#8217;t mind keeping a connection open to the database. </p>
<p>Though for none collections I usually forego lazy loading. </t></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2721">
                    <div id="dsq-comment-header-2721" class="dsq-comment-header">
                        <cite id="dsq-cite-2721">
                                <span id="dsq-author-user-2721">obiwanjacobi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2721" class="dsq-comment-body">
                        <div id="dsq-comment-message-2721" class="dsq-comment-message"><p>I feel that the dependencies between LazyLoaders and the OrderRepository is &#8220;sub-optimal&#8221;. I would not depend the static ctor of the repository on LazyLoaders (maybe a factory to hook up the static callbacks?) and I would IoC the repository dependency in LazyLoaders, so other repository implementations can be injected (also for testing). But I understand its a sample, so you&#8217;re forgiven, but I had to say it <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_wink.gif' alt=';-)' class='wp-smiley' /> </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2722">
                    <div id="dsq-comment-header-2722" class="dsq-comment-header">
                        <cite id="dsq-cite-2722">
    http://blog.andreloker.de                            <span id="dsq-author-user-2722">Andre Loker</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2722" class="dsq-comment-body">
                        <div id="dsq-comment-message-2722" class="dsq-comment-message"><p>The example you gave (calculating the grand total) is maybe not the best example where you want lazy loading. Depending on the number of order lines this will cause a lot of distinct queries (aka. the SELECT 1 + N problem). Fetching the data eagerly will most often be the more efficient solution.</p>
<p>Regarding your implementation: honestly, that&#8217;s too much &#8220;static&#8221; for my taste. Static code is &#8211; well &#8211; static. You can&#8217;t use polymorphism or easily abstract from it with an interface. Especially, I find static code to be more difficult to test. You could instead use something like DynamicProxy to create proxy instances of your domain objects that implement lazy loading- just as NHibernate does. </p>
<p>But then again &#8211; this still needs a lot of reflection and runtime code generaton, so it might not be an option for everyone. Maybe you could use PostSharp as a post compilation step to inject lazy loading. That should work in lower trust scanrios as well.</p>
<p>Regards,<br />
Andre</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2723">
                    <div id="dsq-comment-header-2723" class="dsq-comment-header">
                        <cite id="dsq-cite-2723">
                                <span id="dsq-author-user-2723">Ryan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2723" class="dsq-comment-body">
                        <div id="dsq-comment-message-2723" class="dsq-comment-message"><p>Nice article.  Have you looked into NHibernate.Spatial?  I haven&#8217;t worked with it myself but will hopefully have the opportunity to look into it soon.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2724">
                    <div id="dsq-comment-header-2724" class="dsq-comment-header">
                        <cite id="dsq-cite-2724">
                                <span id="dsq-author-user-2724">Bob</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2724" class="dsq-comment-body">
                        <div id="dsq-comment-message-2724" class="dsq-comment-message"><p>If you are hesitant to jump into NHibernate (I am going through the same thing with my team), why not start with something like IBatis.NET? The learning curve is very minimal and you can use all of the hand-crafted SQL you desire. Things like lazy loading are supported out of the box.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2725">
                    <div id="dsq-comment-header-2725" class="dsq-comment-header">
                        <cite id="dsq-cite-2725">
    http://magnusforsberg.wordpress.com                            <span id="dsq-author-user-2725">Magnus Forsberg</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2725" class="dsq-comment-body">
                        <div id="dsq-comment-message-2725" class="dsq-comment-message"><p>One thing that bothers me with your example is the iteration to calculate the grand total. To me, the Order feels like the aggregate root of the order lines and as such you would get the total cost from the order, not by iterating through it&#8217;s inner details. And by getting the total cost from the order, you can do an eager fetch for the order details as needed.</p>
<p>Or did I miss something?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2726">
                    <div id="dsq-comment-header-2726" class="dsq-comment-header">
                        <cite id="dsq-cite-2726">
    http://blog.elliottohara.com                            <span id="dsq-author-user-2726">Elliott</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2726" class="dsq-comment-body">
                        <div id="dsq-comment-message-2726" class="dsq-comment-message"><p>I totally agree with what Andre said.</p>
<p>Just because you don&#8217;t have NHibernate doesn&#8217;t mean you can&#8217;t use AOP to handle lazy loading, and it&#8217;s actually not much more work than what you&#8217;ve done here.</p>
<p>In your example, you&#8217;ve made your model &#8220;aware&#8221; of lazy loading. Yeah, you&#8217;ve freed it of the implementation details of doing it, but you still have muddied the model with some delegate that has nothing to do with the actual entity. </p>
<p>Would an &#8220;Order&#8221; ever &#8220;Request Order Lines&#8221;? </p>
<p>So, the way I would handle this is move all the understanding of lazy loading out of you Order object into some other class (exactly like FluentNhibernate ClassMaps do), then you have your repos return proxies that consume those classes. </p>
<p>Not much more work, and a clean domain. </p>
<p>Just my $0.02<br />
Thanks for starting a great discussion!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2727">
                    <div id="dsq-comment-header-2727" class="dsq-comment-header">
                        <cite id="dsq-cite-2727">
    http://www.tobinharris.com                            <span id="dsq-author-user-2727">Tobin Harris</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2727" class="dsq-comment-body">
                        <div id="dsq-comment-message-2727" class="dsq-comment-message"><p>Nice article. It&#8217;s fun to see how you tackled problems. I like the fact that the solutions are a fairly consistent and clean without too much &#8216;plumbing code&#8217; everywhere. It&#8217;s also cool to remember that an ORM doesn&#8217;t *have* to be very complex.</p>
<p>Have you considered selectively eager loading associated entities up-front rather than lazy loading? I find eager loading almost always performs better, and it makes the repository fully responsible for demarcating data access, which keeps things simple. </p>
<p>Something like this was what I had in mind:</p>
<p>    // Using fetch strategy hints tells repository to eager-fetch required data<br />
    var order = orders.GetOrder(10, OrderFetch.WithOrderLines)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2728">
                    <div id="dsq-comment-header-2728" class="dsq-comment-header">
                        <cite id="dsq-cite-2728">
    http://www.joshjordan.com                            <span id="dsq-author-user-2728">Josh Jordan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2728" class="dsq-comment-body">
                        <div id="dsq-comment-message-2728" class="dsq-comment-message"><p>True, it might not be the best example, but it definitely gets the point across. Thanks for the read!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2729">
                    <div id="dsq-comment-header-2729" class="dsq-comment-header">
                        <cite id="dsq-cite-2729">
    http://thinkbeforecoding.com                            <span id="dsq-author-user-2729">Think Before Coding</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2729" class="dsq-comment-body">
                        <div id="dsq-comment-message-2729" class="dsq-comment-message"><p>I described a way to enable both lazy/eager loading with a light syntax in the following post :<br />
<a href="http://thinkbeforecoding.com/post/2009/02/07/Lazy-load-and-persistence-ignorance" rel="nofollow">http://thinkbeforecoding.com/post/2009/02/07/Lazy-load-and-persistence-ignorance</a><br />
This way, you can still use the object the same way when no lazy loading is needed, and you don&#8217;t need extra plumbing in your class (except declaring a Lazy<t> instead of T for you lazy loaded field&#8230;)</t></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2730">
                    <div id="dsq-comment-header-2730" class="dsq-comment-header">
                        <cite id="dsq-cite-2730">
    http://petersgekko.codebetter.com/                            <span id="dsq-author-user-2730">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2730" class="dsq-comment-body">
                        <div id="dsq-comment-message-2730" class="dsq-comment-message"><p>Wow, thanks everybody for the richness of the comments.</p>
<p>Some points:<br />
- Lazy loading is not just about collections. Note the Article property in the orderlines. </p>
<p>- Eager loading may be better for some properties. The bas thing about my way of working that way is that it has to be decided by the domain class. Which is still smelly.</p>
<p>- When you eager load the problem is what to load. Given the example it might be an idea to eager load all orderlines. But what about the articles ? Eager load them in the same query ? That will be a point where the mud starts. It requires a multitable join (not really the problem) but how to load the article object in the orderline ? And how to handle any lazy/eager properties in the article ? Suppose in the domain mode the article has a customers collection, describing all customers who eve bought this article. Etc, where will it end ?</p>
<p>- For this project we have decided not to eager load anything but collections. Most collections are loaded in one shot (see the orderlines) but all entity properties are lazy loaded. In (sometimes many ) simple queries. And, as described, performance is quite OK It would be better to do some timing tests to investiigate it deeper.</p>
<p>- In the example it looks somewhat silly to calculate the order total in the way described. But who says it is _the_ total <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  Don&#8217;t take that to literally</p>
<p>- If we are going to use an O-R mapper it will be nHibernate. I havn&#8217;t looked at nHibernate spatial yet. Sounds promissing. For now it is just a matter of presenting the team members simple straightforward sql and very little plumbing. </p>
<p>- Doing anything with reflection is a non issue as it would introduce the same problem nHibernate itself has. Building anything towards a more serious framework doing O-R mapping &#8220;my-style&#8221; with &#8220;mystyle&#8221; proxies is imho the first step to hell. No way, as simple as possible, even simpler than this. Or else nHibernate.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2731">
                    <div id="dsq-comment-header-2731" class="dsq-comment-header">
                        <cite id="dsq-cite-2731">
    http://www.dotnettricks.com                            <span id="dsq-author-user-2731">Fregas</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2731" class="dsq-comment-body">
                        <div id="dsq-comment-message-2731" class="dsq-comment-message"><p>Well done. I &#8216;m at a place that seems to require stored procs for all data access, so I was wondering how to do DDD and PI w/o NHibernate.  You&#8217;re solutions is along the same lines about what was floating around in my head.</p>
<p>craig</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2732">
                    <div id="dsq-comment-header-2732" class="dsq-comment-header">
                        <cite id="dsq-cite-2732">
                                <span id="dsq-author-user-2732">Philipp C</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2732" class="dsq-comment-body">
                        <div id="dsq-comment-message-2732" class="dsq-comment-message"><p>I agree that there is a lot of &#8220;static&#8221; in your code. Maybe you can use &#8220;constructor injection&#8221; to pass your delegates when you create the orders in the repo?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2733">
                    <div id="dsq-comment-header-2733" class="dsq-comment-header">
                        <cite id="dsq-cite-2733">
                                <span id="dsq-author-user-2733">Paco</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2733" class="dsq-comment-body">
                        <div id="dsq-comment-message-2733" class="dsq-comment-message"><p>Why don&#8217;t you use a proxy?<br />
Isn&#8217;t this violating the SRP?<br />
When you couple your entities with the lazy loading code, the entities are responsible of how they are loaded, shouldn&#8217;t that be somewhere else? You also have a problem when you want to load some things eager in one case and lazy in another.</p>
<p>I don&#8217;t agree with your reasons not to use NHibernate.<br />
1. The learning time pays of.<br />
2. Not true, as mentioned earlier<br />
3. It&#8217;s probably cheaper to buy a server then to pay a developer to write the code.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2734">
                    <div id="dsq-comment-header-2734" class="dsq-comment-header">
                        <cite id="dsq-cite-2734">
    http://petersgekko.codebetter.com                            <span id="dsq-author-user-2734">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2734" class="dsq-comment-body">
                        <div id="dsq-comment-message-2734" class="dsq-comment-message"><p>I see no objections to using static code for this kind of things. My static code lays the plumbing when the repositories are loaded. The plumbing will not change after load. So I even like the name &#8220;static&#8221;. DI would work but what extra will it give me here ?</p>
<p>Yes I do violate SRP. But at least the DO only carries the interface to loading and is completely unaware of its implementation. It is a trade-off.</p>
<p>I can load eager, no problem. But have to make that decission in the DO. </p>
<p>I don&#8217;t use a proxy because it requires reflection. In some projects I just cannot choose my server and the permissions there. I just need a reflectionless solution.</p>
<p>Learning nh pays off, yes. But in some environments the problem NH is going to solve has to be clear first. FIrst step is to scrape all DB access code together and make clear how it should fit in the overall architecture of the project. Next is moving all that code to NH. But NH shoul offer full covergae. Half a year a ago this was not the case for 2008 and spatial data.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2735">
                    <div id="dsq-comment-header-2735" class="dsq-comment-header">
                        <cite id="dsq-cite-2735">
                                <span id="dsq-author-user-2735">Gary Hall</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2735" class="dsq-comment-body">
                        <div id="dsq-comment-message-2735" class="dsq-comment-message"><p>foreach (var orderLine in myOrder.Lines)<br />
{<br />
    myTotal += orderLine.Article.Price;<br />
}</p>
<p>That code would require far too many database hits to justify the cleanliness of the DO. When crossing process boundaries &#8211; especially distributed ones &#8211; your interface needs to be chunky and not chatty. The fine-grained control of DOs is totally anathema to this. Fowler&#8217;s PoEAA covers this nicely. In this instance, you&#8217;d want to have the SQL return your the total price of an order. Never let a desire for DDD purity override pragmatism.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2736">
                    <div id="dsq-comment-header-2736" class="dsq-comment-header">
                        <cite id="dsq-cite-2736">
    http://codebetter.com/members/pvanooijen/default.aspx                            <span id="dsq-author-user-2736">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2736" class="dsq-comment-body">
                        <div id="dsq-comment-message-2736" class="dsq-comment-message"><p>In case I only wanted to know the total it would be indeed not very effficient.<br />
In case I ocassionally want to list all articles descriptions and the like, FI in an invoice, I still needed to load the articles.<br />
It all depends. To reverse your statement: Never let pragmatism override a good domain model.<br />
The real bad thing is that I have to decide in the domain model&#8217;s implementation about lazy / eager loading.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/petervanooijen/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading/';
    var disqus_identifier = '557 /blogs/peter.van.ooijen/archive/2009/03/17/ddd-and-repositories-without-nhibernate-but-with-lazy-loading.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'codebetterpetergekkosblog';
    var disqus_title = "DDD and repositories. Without nHibernate but with lazy loading";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=557');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2009\/03\/17\/ddd-and-repositories-without-nhibernate-but-with-lazy-loading\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='68 topics' style='font-size: 16.299401197605pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.383233532934pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.125748502994pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='46 topics' style='font-size: 14.874251497006pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.51497005988pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='14 topics' style='font-size: 10.766467065868pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.51497005988pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.790419161677pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='331 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.694610778443pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2012/10/25/a-crash-course-into-mac-recovery-for-windows-users-and-other-dummies/" title="A crash course into Mac recovery for Windows users and other dummies">A crash course into Mac recovery for Windows users and other dummies</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/23/facebooks-experience-sucks-comments-of-an-app-builder-on-projectxharen/" title="Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)">Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/14/domain-model-over-database-schema-using-fluent-nhibernate-to-generate-the-database/" title="Domain Model over Database Schema. Using fluent nHibernate to generate the database">Domain Model over Database Schema. Using fluent nHibernate to generate the database</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/07/20/small-digital-disappointments/" title="(Small) digital disappointments">(Small) digital disappointments</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2011/12/28/what-we-did-on-our-holidays-a-classic-guitar-an-ipad-fender-and-irig-2/" title="What we did on our holidays: a classic guitar, an iPad, Fender and iRig">What we did on our holidays: a classic guitar, an iPad, Fender and iRig</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2012/10/' title='October 2012'>October 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/09/' title='September 2012'>September 2012</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/07/' title='July 2012'>July 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/12/' title='December 2011'>December 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/11/' title='November 2011'>November 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/10/' title='October 2011'>October 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/09/' title='September 2011'>September 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/08/' title='August 2011'>August 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/07/' title='July 2011'>July 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/03/' title='March 2011'>March 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/02/' title='February 2011'>February 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/01/' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 1.609 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 21:39:35 -->
<!-- super cache -->