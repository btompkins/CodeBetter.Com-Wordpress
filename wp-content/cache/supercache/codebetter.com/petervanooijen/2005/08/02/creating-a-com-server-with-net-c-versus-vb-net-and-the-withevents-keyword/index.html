<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Creating a COM server with .NET. C# versus VB.NET and the WithEvents keyword | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='ASP.net applications : a rich user experince for mort-al users' href='http://codebetter.com/petervanooijen/2005/07/29/asp-net-applications-a-rich-user-experince-for-mort-al-users/' />
<link rel='next' title='Handles versus Addhandler , a crash course in VB.NET event support (Error 459 revisited)' href='http://codebetter.com/petervanooijen/2005/08/02/handles-versus-addhandler-a-crash-course-in-vb-net-event-support-error-459-revisited/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=366' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,185] -->
<link rel="canonical" href="http://codebetter.com/petervanooijen/2005/08/02/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='/photos/peter.van.ooijen/images/130156/original.aspx' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-366" class="post-366 post type-post status-publish format-standard hentry category-coding">
					<h1 class="entry-title">Creating a COM server with .NET. C# versus VB.NET and the WithEvents keyword</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2005/08/02/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword/" title="4:11 pm" rel="bookmark"><span class="entry-date">August 2, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>I am a C# guy. This is a matter of personal preference,&nbsp; I know how to code with VB.NET but just prefer curly brackets. So far the differences were not really worth the (sometimes quite) flaming discussion, after all we&#8217;re all programming against the same framework. But recently I felt forced into using VB.NET for a part of a project. Let me explain what happened.</P><br />
<P>At first sight creating COM servers with .NET is a snap. When you set <I>Register for COM interop</I> to true in the project options all <B>public</B> types and their public members are published via COM and can be used in VBscript or from VBA code in an Office application. Use the ComVisible attribute to hide a public member from COM.</P><br />
<DIV><SPAN>Imports</SPAN> System.Runtime.InteropServices<BR><SPAN>Public</SPAN> <SPAN>Class</SPAN> MyfirstComClass<BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Sub</SPAN> DoSomethingForYourCOMclient()<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8216; Your code here</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN>End</SPAN> <SPAN>Sub</SPAN><BR><BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Sub</SPAN> DoMore()<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8216; More code</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN>End</SPAN> <SPAN>Sub</SPAN><BR><BR><B>&nbsp;&nbsp;&nbsp; &lt;ComVisible(<SPAN>False</SPAN>)&gt; _<BR></B>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Sub</SPAN> DotNetOnly()<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8216; This code cannot be called from a COM client</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN>End</SPAN> <SPAN>Sub</SPAN><BR><SPAN>End</SPAN> <SPAN>Class</SPAN><BR>&nbsp;</DIV><!--EndFragment--><br />
<P>A COM class, its interface and any events it might raise are identified by a couple of GUID&#8217;s. The moment you need a little more control&nbsp; over your class you apply these from code and identify an object as one raising events. In VB.NET this is all done in one attribute.</P><br />
<DIV><SPAN>Imports</SPAN> System.IO<BR><BR>&lt;ComClassAttribute(FileWatcher.ClassId, FileWatcher.InterfaceId, FileWatcher.EventsId)&gt; _<BR><SPAN>Public</SPAN> <SPAN>Class</SPAN> FileWatcher<BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Const</SPAN> ClassId = &#8220;44558DD7-87AD-433f-9B1B-C478233D6C69&#8243;<BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Const</SPAN> InterfaceId = &#8220;959A6835-4768-4cd5-89BE-7D408C2B86AA&#8221;<BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Const</SPAN> EventsId = &#8220;02E3954F-5DC1-4ad9-9167-354F0E82BCA3&#8243;<BR><BR>&nbsp;&nbsp;&nbsp; <SPAN>Private</SPAN> <SPAN>WithEvents</SPAN> watcher <SPAN>As</SPAN> FileSystemWatcher<BR>&nbsp;&nbsp;&nbsp; <SPAN>Private</SPAN> <SPAN>Sub</SPAN> watcher_Created(<SPAN>ByVal</SPAN> sender <SPAN>As</SPAN> <SPAN>Object</SPAN>, <SPAN>ByVal</SPAN> e <SPAN>As</SPAN> FileSystemEventArgs) <SPAN>Handles</SPAN> watcher.Created<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>RaiseEvent</SPAN> OnNewFile(e.FullPath)<BR>&nbsp;&nbsp;&nbsp; <SPAN>End</SPAN> <SPAN>Sub</SPAN><BR><BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Sub</SPAN> Watch(<SPAN>ByVal</SPAN> dirName <SPAN>As</SPAN> <SPAN>String</SPAN>, <SPAN>ByVal</SPAN> filter <SPAN>As</SPAN> <SPAN>String</SPAN>)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watcher = <SPAN>New</SPAN> FileSystemWatcher(dirName, filter)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watcher.EnableRaisingEvents = <SPAN>True</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN>End</SPAN> <SPAN>Sub</SPAN><BR><BR>&nbsp;&nbsp;&nbsp; <SPAN>Public</SPAN> <SPAN>Event</SPAN> OnNewFile(<SPAN>ByVal</SPAN> fullFileName <SPAN>As</SPAN> <SPAN>String</SPAN>)<BR><BR><SPAN>End</SPAN> <SPAN>Class</SPAN><BR>&nbsp;</DIV><!--EndFragment--><br />
<P>This example FileWatcher class contains the guids to identify it. The <B>ComClassAttribute</B> applies them. The class wraps up a .NET FileSytemWatcher. The Watch method instantiates the object, sets a directory to watch, and enables raising events. When a new file matching the filter is created the COMserver&#8217;s OnNewFile event will fire. You can use the server in Word like this:</P><br />
<DIV>Dim WithEvents mywatcher As WordUtilsVB.FileWatcher<BR><BR>Private Sub Document_Open()<BR>&nbsp;&nbsp; Set mywatcher = New WordUtilsVB.FileWatcher<BR>&nbsp;&nbsp; mywatcher.Watch &#8220;C:\USR&#8221;, &#8220;*.doc&#8221;<BR>End Sub<BR><BR>Private Sub mywatcher_OnNewFile(ByVal fullFileName As String)<BR>&nbsp;&nbsp; Documents.Open (fullFileName)<BR>End Sub<BR>&nbsp;</DIV><br />
<P>Opening the documents fires up the COM server which will start watching for new Word Documents in my <I>C:|USR</I> directory. When a new file is found Word will open it. (Note that the <I>*.doc</I> filter will also open Word temp file). This is a handy utility and took just a couple of VB.NET lines.</P><br />
<P>Being a C# guy I would like to refactor this to C# because I want to be able to make multiple call to the watch method which should result in multiple directories being watched. The way VB.NET handles event handlers is somewhat clumsy. In C# I could code like this.</P><br />
<DIV>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> FileWatcher <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> ClassId = &#8220;44558DD7-87AD-433f-9B1B-C478233D6C69&#8243;;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> InterfaceId = &#8220;959A6835-4768-4cd5-89BE-7D408C2B86AA&#8221;;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> EventsId = &#8220;02E3954F-5DC1-4ad9-9167-354F0E82BCA3&#8243;;<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> ArrayList watchers = <SPAN>new</SPAN> ArrayList();<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> Watch(<SPAN>string</SPAN> dirName, <SPAN>string</SPAN> filter)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; FileSystemWatcher watcher = <SPAN>new</SPAN> FileSystemWatcher(dirName, filter);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watcher.Created += <SPAN>new</SPAN> FileSystemEventHandler(watcher_Created);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watchers.Add(watcher);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> NewFile OnNewFile;<BR><BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> watcher_Created(<SPAN>object</SPAN> sender, FileSystemEventArgs e)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OnNewFile(e.FullPath);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; [ComVisible(<SPAN>false</SPAN>)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>delegate</SPAN> <SPAN>void</SPAN> NewFile(<SPAN>string</SPAN> fileName);<BR>&nbsp;</DIV><!--EndFragment--><br />
<P>To define the event I have to declare the <B>NewFile </B>delegate. This should not be exported to COM so the ComVisible attribute is applied. On every call to <B>Watch</B> a new FileSystemWatcher object is created and in C# I can attach an eventhandler on the fly, no need to declare a method which explicitly <B>handles<I> </I></B>a specific event of a specific object. (Perhaps my VB knowledge falls short here, but I don&#8217;t know how to do this elegantly in VB. The <B>handles</B> way does not work here) The ArrayList stores all watchers.</P><br />
<P>The hard part is registering this class in COM. The <B>COMclassAttribute</B> is part of the MicroSoft.VisualBasic namespace so it is by default not available in a C# project. The easy way would be to reference the Microsoft.VisualBasic.dll and use it nevertheless. Which works to get to VB specific functions like the financial ones (<A href="/blogs/peter.van.ooijen/archive/2004/06/11/16169.aspx">summary</A>).</P><br />
<DIV>&nbsp;&nbsp;&nbsp; [Microsoft.VisualBasic.ComClassAttribute(FileWatcher.ClassId, FileWatcher.InterfaceId, FileWatcher.EventsId)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> FileWatcher <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> ClassId = &#8220;44558DD7-87AD-433f-9B1B-C478233D6C69&#8243;;<BR>&nbsp;</DIV><!--EndFragment--><br />
<P>This code will build and run. But will not do what you want it to do. By default all public members are published in COM, the moment you start applying attributes results vary. Applying this VB attribute will result in a COM class without any members. To satisfy the COM registration process in C# requires these steps</P><br />
<UL><br />
<LI>Declare a public interface which describes the COMinterface of the class<br />
<LI>Declare the class as implementing this interface<br />
<LI>Declare a public interface which describes the events the class can sink (COM jargon for raising events)<br />
<LI>Decorate this interface with an <I>InterfaceType</I> attribute an IDispatch interface<br />
<LI>Decorate the class with a <I>ComSourceInterface</I> attribute<br />
<LI>Decorate the class with <I>ClassInterface</I> attribute<br />
<LI>Decorate the COMinterface, the eventsink interface and the class with <I>Guid</I> attributes</LI></UL><br />
<P>Resulting in :</P><br />
<DIV><SPAN>namespace</SPAN> WordUtils<BR>{<BR>&nbsp;&nbsp;&nbsp; [Guid(FileWatcher.InterfaceId)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IfileWatcher<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Watch(<SPAN>string</SPAN> dirName, <SPAN>string</SPAN> filter);<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; [Guid(FileWatcher.EventsId)]<BR>&nbsp;&nbsp;&nbsp; [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IfileWatcherEvents<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> OnNewFile(<SPAN>string</SPAN> fullFileName);<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; [Guid(FileWatcher.ClassId)]<BR>&nbsp;&nbsp;&nbsp; [ClassInterface(ClassInterfaceType.None)]<BR>&nbsp;&nbsp;&nbsp; [ComSourceInterfaces(<SPAN>typeof</SPAN>(IfileWatcherEvents))]<BR><BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> FileWatcher : IfileWatcher<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> ClassId = &#8220;44558DD7-87AD-433f-9B1B-C478233D6C69&#8243;;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> InterfaceId = &#8220;959A6835-4768-4cd5-89BE-7D408C2B86AA&#8221;;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>internal</SPAN> <SPAN>const</SPAN> <SPAN>string</SPAN> EventsId = &#8220;02E3954F-5DC1-4ad9-9167-354F0E82BCA3&#8243;;<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> ArrayList watchers = <SPAN>new</SPAN> ArrayList();<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> Watch(<SPAN>string</SPAN> dirName, <SPAN>string</SPAN> filter)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; FileSystemWatcher watcher = <SPAN>new</SPAN> FileSystemWatcher(dirName, filter);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watcher.Created += <SPAN>new</SPAN> FileSystemEventHandler(watcher_Created);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; watchers.Add(watcher);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> NewFile OnNewFile;<BR><BR><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> watcher_Created(<SPAN>object</SPAN> sender, FileSystemEventArgs e)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OnNewFile(e.FullPath);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; [ComVisible(<SPAN>false</SPAN>)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>delegate</SPAN> <SPAN>void</SPAN> NewFile(<SPAN>string</SPAN> fileName);<BR>}<BR>&nbsp;</DIV><!--EndFragment--><br />
<P>This is a lot more code than the VB.NET version. On the other hand in this code you do have a better overview of what this class looks to COM. Just read the two interfaces</P><br />
<DIV>&nbsp;&nbsp;&nbsp; [Guid(FileWatcher.InterfaceId)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IfileWatcher<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Watch(<SPAN>string</SPAN> dirName, <SPAN>string</SPAN> filter);<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; [Guid(FileWatcher.EventsId)]<BR>&nbsp;&nbsp;&nbsp; [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]<BR>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IfileWatcherEvents<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> OnNewFile(<SPAN>string</SPAN> fullFileName);<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;</DIV><!--EndFragment--><br />
<P>But there is a nasty problem with this code. When it comes to events it just does not work. The VBA designer in Word will &#8220;build&#8221; the code but as soon you run it it pops up a very nasty error:</P><br />
<P><IMG src="/photos/peter.van.ooijen/images/130156/original.aspx"></P><br />
<P>This is described in the MS knowledge base <A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbenlr98/html/vamsgobjdoesnotsupportevents.asp">here</A>, but that does not really help as it makes clear there is no workaround. What is happening exactly is hidden inside the framework, the C# code seems to delegate the sinking of events to an object which VBA cannot work with. You can build C# COM servers which sink events properly. In the beta days of 1.0 I have been ploughing my way into .NET via COM. At the time unaware of the great (intended) COM event support I created a base class with working event support, implementing the desired interfaces (IConnectionPointContainer and its allies) all by hand. It&#8217;s quite a long story, you can find it <A href="http://www.gekko-software.nl/DotNet/BigStory/AutomationInDotNet.htm">here</A> and it does have <A href="http://www.gekko-software.nl/DotNet/BigStory/COMinteropInDotNet.zip">sample code</A>.</P><br />
<P>I&#8217;m &#8220;afraid&#8221; this is another notch for VB.NET, the second one when it comes to COM. <A href="/blogs/peter.van.ooijen/archive/2003/10/22/2778.aspx">I have to admit</A> VB works very nice with named parameters and this is another one. But I&#8217;m going to be happy with the nice things of both languages. I&#8217;ll use C# to solve&nbsp; the internal event handling stuff and I&#8217;ll use VB.NET to make a COM wrapper. After all both languages live happy together in the .NET framework. To paraphrase <A href="http://www.chuckyeager.com/home.htm">Chuck Yeager</A>: &#8220;it&#8217;s the framework, not the language&#8221;.</P><br />
<P>&lt;Update&gt;It takes just one keyword to get the C# COM server working as intended. Change</P><br />
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> NewFile OnNewFile;</P><br />
<P>to</P><br />
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN>public <STRONG>event</STRONG></SPAN>&nbsp;NewFile OnNewFile;</P><br />
<P>and everything works. Read the background <A HREF="/blogs/peter.van.ooijen/archive/2005/08/31/131485.aspx">here</A>.</P><br />
<P>&lt;/Update&gt;<BR></P></p>
<div class="shr-publisher-366"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/coding/" title="View all posts in Coding" rel="category tag">Coding</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2005/08/02/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword/" title="Permalink to Creating a COM server with .NET. C# versus VB.NET and the WithEvents keyword" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2005/08/02/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword/feed/" title="Comments RSS to Creating a COM server with .NET. C# versus VB.NET and the WithEvents keyword" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-366 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2005/07/29/asp-net-applications-a-rich-user-experince-for-mort-al-users/" rel="prev"><span class="meta-nav">&larr;</span> ASP.net applications : a rich user experince for mort-al users</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2005/08/02/handles-versus-addhandler-a-crash-course-in-vb-net-event-support-error-459-revisited/" rel="next">Handles versus Addhandler , a crash course in VB.NET event support (Error 459 revisited) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-1602">
                    <div id="dsq-comment-header-1602" class="dsq-comment-header">
                        <cite id="dsq-cite-1602">
    http://spaces.msn.com/members/scarpenter                            <span id="dsq-author-user-1602">Sean</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1602" class="dsq-comment-body">
                        <div id="dsq-comment-message-1602" class="dsq-comment-message"><p>In VB.NET, you should be able to add your event handlers via code as in:</p>
<p>Dim watcher as FileSystemWatcher = New FileSystemWatcher(dirName, filter)<br />
AddHandler watcher.Created AddressOf watcher_Created<br />
watchers.Add(watcher)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1603">
                    <div id="dsq-comment-header-1603" class="dsq-comment-header">
                        <cite id="dsq-cite-1603">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1603">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1603" class="dsq-comment-body">
                        <div id="dsq-comment-message-1603" class="dsq-comment-message"><p>Thanks, that is the syntax I was looking for.</p>
<p>The most interesting thing is that after refactoring the VB class to the same pattern as the C# class results the VB class will show the same error.<br />
Now the 459 error begins to make more sense. Delegating the handling of the event to another object, in the case the watcher object, will produce the problem. In both languages.</p>
<p>So instead of looking for the VB addhandler syntax I&#8217;ll have to look for the C# equivalent of handles. </p>
<p>To be continued..</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1604">
                    <div id="dsq-comment-header-1604" class="dsq-comment-header">
                        <cite id="dsq-cite-1604">
                                <span id="dsq-author-user-1604">Visitor</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1604" class="dsq-comment-body">
                        <div id="dsq-comment-message-1604" class="dsq-comment-message"><p>To fix the nasty problem on using the C# COM server you have to declare the event with:</p>
<p>public event NewFile OnNewFile;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1605">
                    <div id="dsq-comment-header-1605" class="dsq-comment-header">
                        <cite id="dsq-cite-1605">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1605">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1605" class="dsq-comment-body">
                        <div id="dsq-comment-message-1605" class="dsq-comment-message"><p>That&#8217;s great. Now Word does create the object without any errors. But as far as I can see the events don&#8217;t hook in <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_confused.gif' alt=':?' class='wp-smiley' />  Look into that after my holiday.</p>
<p>A bit of a pitty you would need such a, at first sight superfluous keyword, to get it working. Not really in the spirit of C#.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1606">
                    <div id="dsq-comment-header-1606" class="dsq-comment-header">
                        <cite id="dsq-cite-1606">
                                <span id="dsq-author-user-1606">Visitor</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1606" class="dsq-comment-body">
                        <div id="dsq-comment-message-1606" class="dsq-comment-message"><p>You can see the events, if you enable the watcher to raise some events with:</p>
<p>watcher.EnableRaisingEvents = true;</p>
<p>So it should do what you want.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1607">
                    <div id="dsq-comment-header-1607" class="dsq-comment-header">
                        <cite id="dsq-cite-1607">
    http://www.pascalgamedeveloper.com                            <span id="dsq-author-user-1607">savage</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1607" class="dsq-comment-body">
                        <div id="dsq-comment-message-1607" class="dsq-comment-message"><p>I&#8217;m trying to get this very thing working between  Delphi and a C# application. I&#8217;m creating a COM class in C# and attempting to attach an event from within Delphi, but not having any luck. Any suggestions?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1608">
                    <div id="dsq-comment-header-1608" class="dsq-comment-header">
                        <cite id="dsq-cite-1608">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1608">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1608" class="dsq-comment-body">
                        <div id="dsq-comment-message-1608" class="dsq-comment-message"><p>The Events keyword indeed does the trick. I had indeed forgotten to set the filewatcher&#8217;s enableraisingevents property. Setting it gave me my intended utility.</p>
<p>I&#8217;ll write a wrapup post on the events keyword, it&#8217;s documentation is bad and the idea is (looking back) quite simple.</p>
<p>I&#8217;ll also write a post on eventsupport in Delphi, for the time you can find loads off material on this on my website <a href="http://www.gekko-software.nl" rel="nofollow">http://www.gekko-software.nl</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1609">
                    <div id="dsq-comment-header-1609" class="dsq-comment-header">
                        <cite id="dsq-cite-1609">
    http://sajadi.co.uk/dflat                            <span id="dsq-author-user-1609">Khash</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1609" class="dsq-comment-body">
                        <div id="dsq-comment-message-1609" class="dsq-comment-message"><p>I think I have found a bug in CCW<br />
Have a look at this:<br />
<a href="http://sajadi.co.uk/dflat/archives/2005/12/net_com_callabl.html" rel="nofollow">http://sajadi.co.uk/dflat/archives/2005/12/net_com_callabl.html</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1610">
                    <div id="dsq-comment-header-1610" class="dsq-comment-header">
                        <cite id="dsq-cite-1610">
    http://www.LasProfecias.com                            <span id="dsq-author-user-1610">Rogelio</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1610" class="dsq-comment-body">
                        <div id="dsq-comment-message-1610" class="dsq-comment-message"><p>I created a COM class using the first sample you provided:</p>
<p>Imports System.Runtime.InteropServices<br />
Public Class MyfirstComClass<br />
    Public Sub DoSomethingForYourCOMclient()<br />
        &#8216; Your code here<br />
    End Sub</p>
<p>    Public Sub DoMore()<br />
        &#8216; More code<br />
    End Sub</p>
<p>    <comvisible (False)> _<br />
    Public Sub DotNetOnly()<br />
        &#8216; This code cannot be called from a COM client<br />
    End Sub<br />
End Class</p>
<p>The problem I&#8217;m having is calling the DoMore() public sub from javascript. Is there a way to do this?</comvisible></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1611">
                    <div id="dsq-comment-header-1611" class="dsq-comment-header">
                        <cite id="dsq-cite-1611">
    http://codebetter.com/blogs/peter.van.ooijen/default.aspx                            <span id="dsq-author-user-1611">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1611" class="dsq-comment-body">
                        <div id="dsq-comment-message-1611" class="dsq-comment-message"><p>To make the call from JavaScript you have to create the COM object in JavaScript.  Creating a COM (ActiveX) object in the browser is not a path to follow except when you don&#8217;t see any other solution.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/petervanooijen/2005/08/02/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword/';
    var disqus_identifier = '366 /blogs/peter.van.ooijen/archive/2005/08/02/130157.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'codebetterpetergekkosblog';
    var disqus_title = "Creating a COM server with .NET. C# versus VB.NET and the WithEvents keyword";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=366');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2005\/08\/02\/creating-a-com-server-with-net-c-versus-vb-net-and-the-withevents-keyword\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='68 topics' style='font-size: 16.299401197605pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.383233532934pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.125748502994pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='46 topics' style='font-size: 14.874251497006pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.51497005988pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='14 topics' style='font-size: 10.766467065868pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.51497005988pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.790419161677pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='331 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.694610778443pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2012/10/25/a-crash-course-into-mac-recovery-for-windows-users-and-other-dummies/" title="A crash course into Mac recovery for Windows users and other dummies">A crash course into Mac recovery for Windows users and other dummies</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/23/facebooks-experience-sucks-comments-of-an-app-builder-on-projectxharen/" title="Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)">Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/14/domain-model-over-database-schema-using-fluent-nhibernate-to-generate-the-database/" title="Domain Model over Database Schema. Using fluent nHibernate to generate the database">Domain Model over Database Schema. Using fluent nHibernate to generate the database</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/07/20/small-digital-disappointments/" title="(Small) digital disappointments">(Small) digital disappointments</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2011/12/28/what-we-did-on-our-holidays-a-classic-guitar-an-ipad-fender-and-irig-2/" title="What we did on our holidays: a classic guitar, an iPad, Fender and iRig">What we did on our holidays: a classic guitar, an iPad, Fender and iRig</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2012/10/' title='October 2012'>October 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/09/' title='September 2012'>September 2012</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/07/' title='July 2012'>July 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/12/' title='December 2011'>December 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/11/' title='November 2011'>November 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/10/' title='October 2011'>October 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/09/' title='September 2011'>September 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/08/' title='August 2011'>August 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/07/' title='July 2011'>July 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/03/' title='March 2011'>March 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/02/' title='February 2011'>February 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/01/' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.734 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 23:47:37 -->
<!-- super cache -->