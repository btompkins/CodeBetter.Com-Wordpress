<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>ISO weeknumbers of a date, a C# implementation | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='The availability of  Vista beta&#8217;s' href='http://codebetter.com/petervanooijen/2005/09/26/the-availability-of-vista-betas/' />
<link rel='next' title='Disable an asp.net LinkButton (or HyperLink) without graying it out' href='http://codebetter.com/petervanooijen/2005/09/28/disable-an-asp-net-linkbutton-or-hyperlink-without-graying-it-out/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=385' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,155] -->
<link rel="canonical" href="http://codebetter.com/petervanooijen/2005/09/26/iso-weeknumbers-of-a-date-a-c-implementation/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-385" class="post-385 post type-post status-publish format-standard hentry category-coding">
					<h1 class="entry-title">ISO weeknumbers of a date, a C# implementation</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2005/09/26/iso-weeknumbers-of-a-date-a-c-implementation/" title="12:11 pm" rel="bookmark"><span class="entry-date">September 26, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>The DateTime class in the .NET framework is very rich in methods for manipulating and computing dates. In my former language Delphi working with dates was no fun. All had to be done by manipulating strings but given the fact that nobody can agree on what comes first, day or month, all code was tricky and prone to bugs.</P><br />
<P>The only thing which is missing in the class is a weeknumber property. Every workweek has its own number. In Europe this is very often used. There is an <A href="http://www.cl.cam.ac.uk/~mgk25/iso-time.html">ISO 8601</A> standard which describes how this number is calculated: <I>Week 01 of a year is per definition the first week that has the Thursday in this year, which is equivalent to the week that contains the fourth day of January. </I></P><br />
<P>There are plenty of implementations to be found on the web to calculate this number. Finding a good one in C# took some assembling. This one is based on a Delphi implementation on the <A href="http://www.sdn.nl/Default.aspx?tabid=186&amp;mid=648&amp;ctl=ViewArticle&amp;ItemID=241">SDN</A> site. Thanks to the DateTime class it needs only a fraction of the code.</P><br />
<DIV>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>int</SPAN> weekNumber(DateTime fromDate)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Get jan 1st of the year</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DateTime startOfYear = fromDate.AddDays(- fromDate.Day + 1).AddMonths(- fromDate.Month +1);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Get dec 31st of the year</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DateTime endOfYear = startOfYear.AddYears(1).AddDays(-1);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// ISO 8601 weeks start with Monday </SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// The first week of a year includes the first Thursday </SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// DayOfWeek returns 0 for sunday up to 6 for saterday</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>int</SPAN>[] iso8601Correction = {6,7,8,9,10,4,5};<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>int</SPAN> nds = fromDate.Subtract(startOfYear).Days&nbsp; + iso8601Correction[(<SPAN>int</SPAN>)startOfYear.DayOfWeek];<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>int</SPAN> wk = nds / 7;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>switch</SPAN>(wk)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>case</SPAN> 0 : <BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Return weeknumber of dec 31st of the previous year</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> weekNumber(startOfYear.AddDays(-1));<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>case</SPAN> 53 : <BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// If dec 31st falls before thursday it is week 01 of next year</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (endOfYear.DayOfWeek &lt; DayOfWeek.Thursday)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> 1;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>else</SPAN><BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> wk;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>default</SPAN> : <SPAN>return</SPAN> wk;<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<BR>&nbsp;</DIV><!--EndFragment--><br />
<P>The nice thing I used from the Delphi sample was the iso8601 correction array using the day of the week as index.</P><br />
<P>It would be even nicer to add the method as a property to a derived DateTime class. Alas that class is sealed. </P></p>
<div class="shr-publisher-385"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/coding/" title="View all posts in Coding" rel="category tag">Coding</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2005/09/26/iso-weeknumbers-of-a-date-a-c-implementation/" title="Permalink to ISO weeknumbers of a date, a C# implementation" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2005/09/26/iso-weeknumbers-of-a-date-a-c-implementation/feed/" title="Comments RSS to ISO weeknumbers of a date, a C# implementation" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-385 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2005/09/26/the-availability-of-vista-betas/" rel="prev"><span class="meta-nav">&larr;</span> The availability of  Vista beta&#8217;s</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2005/09/28/disable-an-asp-net-linkbutton-or-hyperlink-without-graying-it-out/" rel="next">Disable an asp.net LinkButton (or HyperLink) without graying it out <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-1658">
                    <div id="dsq-comment-header-1658" class="dsq-comment-header">
                        <cite id="dsq-cite-1658">
    http://www.tapmymind.com                            <span id="dsq-author-user-1658">daughtkom</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1658" class="dsq-comment-body">
                        <div id="dsq-comment-message-1658" class="dsq-comment-message"><p>In VB, you can do this:</p>
<p>DateAndTime.DatePart(DateInterval.WeekOfYear, DateTime.Now, FirstDayOfWeek.Sunday, FirstWeekOfYear.FirstFourDays)</p>
<p>The DateAndTime module is in the Microsoft.VisualBasic namespace, and syntax for the DatePart function is as follows (from MSDN):</p>
<p>Public Overloads Function DatePart( _<br />
    ByVal Interval As String, _<br />
   ByVal DateValue As Object, _<br />
   Optional ByVal DayOfWeek As FirstDayOfWeek = FirstDayOfWeek.Sunday, _<br />
   Optional ByVal WeekOfYear As FirstWeekOfYear = FirstWeekOfYear.Jan1 _<br />
) As Integer</p>
<p>The choices for FirstWeekOfYear are:<br />
  FirstWeekOfYear.System<br />
  FirstWeekOfYear.Jan1<br />
  FirstWeekOfYear.FirstFourDays<br />
  FirstWeekOfYear.FirstFullWeek</p>
<p>Am I missing something else, or could you just use Microsoft.VisualBasic.DateAndTime.DatePart(&#8230;) to do this?  To be honest, I&#8217;ve never had occasion to use week number myself.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1659">
                    <div id="dsq-comment-header-1659" class="dsq-comment-header">
                        <cite id="dsq-cite-1659">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1659">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1659" class="dsq-comment-body">
                        <div id="dsq-comment-message-1659" class="dsq-comment-message"><p>That will work as well. You can even use it in C#.</p>
<p>Add Microsoft.VisualBasic to the reference of your C# project</p>
<p>Add this to the uses clause</p>
<p>using Microsoft.VisualBasic;</p>
<p>An alternative implementation would be :</p>
<p>private int weekNumberVB(DateTime fromDate)	{<br />
	return DateAndTime.DatePart(DateInterval.WeekOfYear, fromDate, Microsoft.VisualBasic.FirstDayOfWeek.Monday, FirstWeekOfYear.FirstFourDays);</p>
<p>}</p>
<p>FirstDayOfWeek is ambigious, you have to fully qualify that one.</p>
<p>Nice <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  And even shorter.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1660">
                    <div id="dsq-comment-header-1660" class="dsq-comment-header">
                        <cite id="dsq-cite-1660">
    http://austegard.blogspot.com                            <span id="dsq-author-user-1660">Oskar Austegard</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1660" class="dsq-comment-body">
                        <div id="dsq-comment-message-1660" class="dsq-comment-message"><p>Keep in mind that there are different rules for calculating weeknumbers, depending on location.  The issue is with what week to consider as the first week of the year (is it the first complete week, or the first week that has the majority of days in the new year?, etc).</p>
<p>A few years ago, my then-employer&#8217;s European divisions requested weeknumbers in our intranet application&#8217;s calendar controls.  At the time there were no controls I could find that would handle this.  But I did some research and contacted Peter Blum, who had provided the Date package controls we were using.  He was very open to adding the feature to the controls, and  I was more than happy to test the added features.</p>
<p>A screenshot of the week number column can be seen half-way down the page here: <a href="http://www.peterblum.com/DateControls/CSCalendarHome.aspx" rel="nofollow">http://www.peterblum.com/DateControls/CSCalendarHome.aspx</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1661">
                    <div id="dsq-comment-header-1661" class="dsq-comment-header">
                        <cite id="dsq-cite-1661">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1661">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1661" class="dsq-comment-body">
                        <div id="dsq-comment-message-1661" class="dsq-comment-message"><p>There are indeed different ways to calculate these, with the many parameters of the VB DatePart function you can get any result you want. ISO is trying to standardize the weeknumbers by explicitly stating how to calculate. My implementation folllows ISO.<br />
In the Netherlands week numbers are often used, since the ISO standard is there people are beginning to agree on them. Before that there were differences. Leading to b2b misunderstandings.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1662">
                    <div id="dsq-comment-header-1662" class="dsq-comment-header">
                        <cite id="dsq-cite-1662">
    http://weblogs.asp.net/yreynhout                            <span id="dsq-author-user-1662">Yves Reynhout</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1662" class="dsq-comment-body">
                        <div id="dsq-comment-message-1662" class="dsq-comment-message"><p>Ever checked out System.Globalization?<br />
In this example CalendarWeekRule and DayOfWeek should be thought of as configurable.</p>
<p>public static int GetWeekOfYear(DateTime date){<br />
      return System.Threading.Thread.CurrentThread.CurrentCulture.Calendar.GetWeekOfYear(date, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday);<br />
}</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1663">
                    <div id="dsq-comment-header-1663" class="dsq-comment-header">
                        <cite id="dsq-cite-1663">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1663">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1663" class="dsq-comment-body">
                        <div id="dsq-comment-message-1663" class="dsq-comment-message"><p>OK, who needs VB ?<br />
It&#8217;s all in the framework.</p>
<p>A variation which adapts itself to the culture of the runtime environment :<br />
			System.Globalization.CultureInfo myCI = System.Threading.Thread.CurrentThread.CurrentCulture;<br />
			int weekNo = myCI.Calendar.GetWeekOfYear(date, myCI.DateTimeFormat.CalendarWeekRule, myCI.DateTimeFormat.FirstDayOfWeek);</p>
<p>For the Dutch code CalenderWeekRule and FirstDayOfWeek comply with ISO.</p>
<p>Thanks.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1664">
                    <div id="dsq-comment-header-1664" class="dsq-comment-header">
                        <cite id="dsq-cite-1664">
                                <span id="dsq-author-user-1664">Goffen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1664" class="dsq-comment-body">
                        <div id="dsq-comment-message-1664" class="dsq-comment-message"><p>NONE of your code work correctly for instance for the the last week of 2003   See <a href="http://konsulent.sandelien.no/VB_help/Week/" rel="nofollow">http://konsulent.sandelien.no/VB_help/Week/</a></p>
<p>(also for a solution in vb/c#)</p>
<p>According to the ISO 8601 rulebook, the week number of the transitionweek<br />
between two years, is linked to the year in which that week has most days.<br />
The final week of 2003 / first week of 2004 had three days in 2003 and four<br />
days in 2004 and should therefore in its entirety have been associated with<br />
2004 (as week number 1). </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1665">
                    <div id="dsq-comment-header-1665" class="dsq-comment-header">
                        <cite id="dsq-cite-1665">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1665">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1665" class="dsq-comment-body">
                        <div id="dsq-comment-message-1665" class="dsq-comment-message"><p>@ Goffen: I don&#8217;t agree.</p>
<p>ISO 8601 states &#8220;first thursday&#8221;, not your quote. How many days in a week that is depends on which day is day 1 of the week. Opinions on that vary !</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1666">
                    <div id="dsq-comment-header-1666" class="dsq-comment-header">
                        <cite id="dsq-cite-1666">
                                <span id="dsq-author-user-1666">Herbee</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1666" class="dsq-comment-body">
                        <div id="dsq-comment-message-1666" class="dsq-comment-message"><p>&#8230; but pvanooijen&#8217;s opinion doesn&#8217;t matter in this case. ISO 8601, section 3.28, defines Monday as the first day of the week.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1667">
                    <div id="dsq-comment-header-1667" class="dsq-comment-header">
                        <cite id="dsq-cite-1667">
    http://codebetter.com/blogs/peter.van.ooijen/                            <span id="dsq-author-user-1667">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1667" class="dsq-comment-body">
                        <div id="dsq-comment-message-1667" class="dsq-comment-message"><p>@ Herbee: I miss your point. My point is that there are several definitions for first day of the week around, one of them is ISO.<br />
I do agree that&#8217;s the one to follow but, as written in the original post, not al software producing week numbers follows ISO (yet).<br />
For the first week of the year it&#8217;s of no importance which day of the week comes first. First thirsday, as ISO says.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1668">
                    <div id="dsq-comment-header-1668" class="dsq-comment-header">
                        <cite id="dsq-cite-1668">
                                <span id="dsq-author-user-1668">Yves Goergen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1668" class="dsq-comment-body">
                        <div id="dsq-comment-message-1668" class="dsq-comment-message"><p>Is there a way to reverse that calculation? The only thing I find on the web is converting date to week number. Now when the user enters a year and a week number, I need to get the Monday (first day) of that week. How can that be done? Try, error and iterate?</p>
<p>Please reply via e-mail to <a href="mailto:nospam@unclassified.de">nospam@unclassified.de</a>.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1669">
                    <div id="dsq-comment-header-1669" class="dsq-comment-header">
                        <cite id="dsq-cite-1669">
    http://alicebobandmallory.com/                            <span id="dsq-author-user-1669">jonelf</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1669" class="dsq-comment-body">
                        <div id="dsq-comment-message-1669" class="dsq-comment-message"><p>System.Globalization.CultureInfo myCI = System.Threading.Thread.CurrentThread.CurrentCulture;</p>
<p>int weekNo = myCI.Calendar.GetWeekOfYear(<br />
new DateTime(2008,12,31), myCI.DateTimeFormat.CalendarWeekRule, myCI.DateTimeFormat.FirstDayOfWeek);</p>
<p>The above sets weekNo to 53. This is not correct according to ISO 8601. Seems the framework misses a parameter that says that only full weeks are allowed.</p>
<p>The VB.NET DateAndTime  fails in the same way.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1670">
                    <div id="dsq-comment-header-1670" class="dsq-comment-header">
                        <cite id="dsq-cite-1670">
    http://petersgekko.codebetter.com                            <span id="dsq-author-user-1670">pvanooijen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1670" class="dsq-comment-body">
                        <div id="dsq-comment-message-1670" class="dsq-comment-message"><p>As I read it ISO 8601 does not say anything about week 53, it just defines when week 1 starts.Which might result in a year with 53 weks.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1671">
                    <div id="dsq-comment-header-1671" class="dsq-comment-header">
                        <cite id="dsq-cite-1671">
                                <span id="dsq-author-user-1671">Peter</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1671" class="dsq-comment-body">
                        <div id="dsq-comment-message-1671" class="dsq-comment-message"><p>The point in jonelf&#8217;s comment is not that there can&#8217;t be 53 weeks in a year (which is possible as you say according to ISO 8601) but rather that 2008-12-31 was a Wednesday which makes 2009-01-01 a Thursday which makes that week number 1 and not 53.<br />
See <a href="http://en.wikipedia.org/wiki/ISO_week_date" rel="nofollow">http://en.wikipedia.org/wiki/ISO_week_date</a> for more information.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1672">
                    <div id="dsq-comment-header-1672" class="dsq-comment-header">
                        <cite id="dsq-cite-1672">
    http://alicebobandmallory.com/                            <span id="dsq-author-user-1672">jonelf</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1672" class="dsq-comment-body">
                        <div id="dsq-comment-message-1672" class="dsq-comment-message"><p>Thank you Peter, that&#8217;s exactly what I tried to say.</p>
<p>A couple of minutes ago I tried the same in Mono and it also returns week 53.</p>
<p>PS. Totally unrelated but Ruby gets it right:<br />
>> Date.parse(&#8220;2008-12-31&#8243;).strftime(&#8220;%V&#8221;)<br />
=> &#8220;01&#8243;<br />
DS.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1673">
                    <div id="dsq-comment-header-1673" class="dsq-comment-header">
                        <cite id="dsq-cite-1673">
    http://alicebobandmallory.com/                            <span id="dsq-author-user-1673">jonelf</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1673" class="dsq-comment-body">
                        <div id="dsq-comment-message-1673" class="dsq-comment-message"><p>Here&#8217;s a hack from Shawn Steele that also gives the ISO 8601 week.<br />
        // Seriously cheat.  If its Monday, Tuesday or Wednesday, then it&#8217;ll<br />
        // be the same week# as whatever Thursday, Friday or Saturday are,<br />
        // and we always get those right<br />
 <a href="http://blogs.msdn.com/shawnste/archive/2006/01/24/iso-8601-week-of-year-format-in-microsoft-net.aspx" rel="nofollow">http://blogs.msdn.com/shawnste/archive/2006/01/24/iso-8601-week-of-year-format-in-microsoft-net.aspx</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1674">
                    <div id="dsq-comment-header-1674" class="dsq-comment-header">
                        <cite id="dsq-cite-1674">
                                <span id="dsq-author-user-1674">doiremik</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1674" class="dsq-comment-body">
                        <div id="dsq-comment-message-1674" class="dsq-comment-message"><p>jonelf, this wont work either as it still generates 53. It does seem to work for the start of the years though so it might need modified for week 53. Can believe Microsoft hasnt fixed this when is knocking about since the start of this blog&#8230; </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1675">
                    <div id="dsq-comment-header-1675" class="dsq-comment-header">
                        <cite id="dsq-cite-1675">
                                <span id="dsq-author-user-1675">Mark</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1675" class="dsq-comment-body">
                        <div id="dsq-comment-message-1675" class="dsq-comment-message"><p>Here is my C# method which passes all of the test cases on </p>
<p><a href="http://en.wikipedia.org/wiki/ISO_week_date" rel="nofollow">http://en.wikipedia.org/wiki/ISO_week_date</a></p>
<p>    public class ISO_8601 {<br />
        public int year;<br />
        public int week;<br />
        public int dayOfWeek;</p>
<p>        public ISO_8601(DateTime dt)<br />
        {<br />
            dayOfWeek = 1 + ((int)dt.DayOfWeek + 1+5) % 7; // Mon=1 to Sun=7<br />
            DateTime NearestThu = dt.AddDays(4 &#8211; dayOfWeek);<br />
            year = NearestThu.Year;<br />
            DateTime Jan1 = new DateTime(year, 1, 1);<br />
            TimeSpan ts = NearestThu.Subtract(Jan1);<br />
            week = 1 + ts.Days / 7; // Count of Thursdays<br />
        }<br />
}</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1676">
                    <div id="dsq-comment-header-1676" class="dsq-comment-header">
                        <cite id="dsq-cite-1676">
                                <span id="dsq-author-user-1676">Cody</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1676" class="dsq-comment-body">
                        <div id="dsq-comment-message-1676" class="dsq-comment-message"><p>But is it possible make this work in the original monthCalender control?<br />
How to link it to the control?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1677">
                    <div id="dsq-comment-header-1677" class="dsq-comment-header">
                        <cite id="dsq-cite-1677">
                                <span id="dsq-author-user-1677">Cody</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1677" class="dsq-comment-body">
                        <div id="dsq-comment-message-1677" class="dsq-comment-message"><p>Testing</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-3366">
                    <div id="dsq-comment-header-3366" class="dsq-comment-header">
                        <cite id="dsq-cite-3366">
                                <span id="dsq-author-user-3366">Leonardo Martins</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-3366" class="dsq-comment-body">
                        <div id="dsq-comment-message-3366" class="dsq-comment-message"><p>Thanks, the codes of c# I find not work, but this code is very nice.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-3409">
                    <div id="dsq-comment-header-3409" class="dsq-comment-header">
                        <cite id="dsq-cite-3409">
                                <span id="dsq-author-user-3409">Kishore kharche</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-3409" class="dsq-comment-body">
                        <div id="dsq-comment-message-3409" class="dsq-comment-message"><p>Hi This is very good artical. Its work fine. Thanks</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/petervanooijen/2005/09/26/iso-weeknumbers-of-a-date-a-c-implementation/';
    var disqus_identifier = '385 /blogs/peter.van.ooijen/archive/2005/09/26/132466.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'codebetterpetergekkosblog';
    var disqus_title = "ISO weeknumbers of a date, a C# implementation";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=385');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2005\/09\/26\/iso-weeknumbers-of-a-date-a-c-implementation\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='68 topics' style='font-size: 16.299401197605pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.383233532934pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.125748502994pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='46 topics' style='font-size: 14.874251497006pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.51497005988pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='14 topics' style='font-size: 10.766467065868pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.51497005988pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.790419161677pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='331 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.694610778443pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2012/10/25/a-crash-course-into-mac-recovery-for-windows-users-and-other-dummies/" title="A crash course into Mac recovery for Windows users and other dummies">A crash course into Mac recovery for Windows users and other dummies</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/23/facebooks-experience-sucks-comments-of-an-app-builder-on-projectxharen/" title="Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)">Facebook&rsquo;s experience sucks (Comments of an app-builder on #ProjectXHaren)</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/09/14/domain-model-over-database-schema-using-fluent-nhibernate-to-generate-the-database/" title="Domain Model over Database Schema. Using fluent nHibernate to generate the database">Domain Model over Database Schema. Using fluent nHibernate to generate the database</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2012/07/20/small-digital-disappointments/" title="(Small) digital disappointments">(Small) digital disappointments</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2011/12/28/what-we-did-on-our-holidays-a-classic-guitar-an-ipad-fender-and-irig-2/" title="What we did on our holidays: a classic guitar, an iPad, Fender and iRig">What we did on our holidays: a classic guitar, an iPad, Fender and iRig</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2012/10/' title='October 2012'>October 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/09/' title='September 2012'>September 2012</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2012/07/' title='July 2012'>July 2012</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/12/' title='December 2011'>December 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/11/' title='November 2011'>November 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/10/' title='October 2011'>October 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/09/' title='September 2011'>September 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/08/' title='August 2011'>August 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/07/' title='July 2011'>July 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/03/' title='March 2011'>March 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/02/' title='February 2011'>February 2011</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2011/01/' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.472 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 18:20:34 -->
<!-- super cache -->