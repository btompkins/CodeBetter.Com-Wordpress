<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Change a database connection string from code | Peter van Ooijen</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/petervanooijen/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://cdn1.codebetter.com/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/petervanooijen/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Peter van Ooijen' href='http://codebetter.com/petervanooijen/' />
<link rel='start' title='Hello weblog' href='http://codebetter.com/petervanooijen/2003/06/03/hello-weblog/' />
<link rel='prev' title='Add a custom icon to your (mobile) app' href='http://codebetter.com/petervanooijen/2006/08/11/add-a-custom-icon-to-your-mobile-app/' />
<link rel='next' title='A (holiday) read into enterprise application architecture' href='http://codebetter.com/petervanooijen/2006/09/06/a-holiday-read-into-enterprise-application-architecture/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/petervanooijen/2006/08/11/change-a-database-connection-string-from-code/' />
<link rel='shortlink' href='http://codebetter.com/petervanooijen/?p=473' />
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.7" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/codebetterpetergekkosblog/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-473" class="post-473 post type-post status-publish format-standard hentry category-asp-net category-data">
					<h1 class="entry-title">Change a database connection string from code</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/petervanooijen/author/petervanooijen/" title="View all posts by Peter van Ooijen">Peter van Ooijen</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/petervanooijen/2006/08/11/change-a-database-connection-string-from-code/" title="11:46 am" rel="bookmark"><span class="entry-date">August 11, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/petervanooijen/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/petervanooijen/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>The connection string to a database should never be hard coded in your application. There is (almost) always a difference between the development and production database server. Besides that IT management should have an easy way to change the configuration. Part of this has been automated by the wizards of Visual Studio. When you add a dataset to a web site the wizard will create a web.config entry for the connection string. That&#039;s nice but, as I described in a <a href="/blogs/peter.van.ooijen/archive/2006/04/25/143308.aspx">another post</a>, when you add database code directly to your web site your site will be (sooner or later) toast. My way is to isolate all database code in a class library. But after building the datasets in there it has become harder to change the connection string later on. You have become the sorcerers apprentice. (For those unknown with that story: In there the pupil of a great wizard starts playing around on his own. In the end he&#039;s almost killed by a bewitched broom, the wizard himself comes back just in time to save him. The story has been beautiful visualized in Disney&#039;s Fantasia where Mickey Mouse is the sorcerers apprentice).</p>
<p>There is a way out. You can change the connection string of any table adapter at runtime by setting it&#039;s Connection.Connectionstring to the desired value. <a href="http://scottonwriting.net/sowblog/archive/06272006.aspx">Scott describes</a> how to add this functionality to the code of a dataset component. Which is nice but you have to write this code for every table adapter and you have to set the connection after every instantiation of the table adapter. Which is tedious and a possible source of bugs.</p>
<p>What the wizards do is store the value of the connection string in a setting of the app. There is a settings page under the properties of a project</p>
<p><img height="251" src="/photos/peter.van.ooijen/images/148210/original.aspx" width="1013" /></p>
<p>In here settings are stored in name-value pairs. The name is the name of the database; for sqlServer it&#039;s the DB name for <a href="/blogs/peter.van.ooijen/archive/2006/07/27/147706.aspx">FireBird</a> (as in the screenshot) the name is the full name of the database file.</p>
<p>In a web application these settings are stored in the web.config, in a class libray in the app.config file.</p>
<div style="font-size: 12pt;background: white;color: black;font-family: Courier New;border: windowtext 1pt solid;padding: 0pt">
<p style="margin: 0px"><span style="color: blue">&lt;?</span><span style="color: maroon">xml</span><span style="color: blue"> </span><span style="color: red">version</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;<span style="color: blue"> </span><span style="color: red">encoding</span><span style="color: blue">=</span>&quot;<span style="color: blue">utf-8</span>&quot;<span style="color: blue"> ?&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: maroon">configuration</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &lt;</span><span style="color: maroon">configSections</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &lt;/</span><span style="color: maroon">configSections</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &lt;</span><span style="color: maroon">connectionStrings</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &nbsp; &nbsp; &lt;</span><span style="color: maroon">add</span><span style="color: blue"> </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">DataLibrary.Properties.Settings.C__Documents_and_Settings_Peter_PETERSGEKKO_My_Documents_My_Custoners_DirActivity_DacPro_DACPRO_FDBConnectionString</span>&quot;</p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: red">connectionString</span><span style="color: blue">=</span>&quot;<span style="color: blue">port number=3050;charset=ISO8859_1;dialect=3;server type=0;database=</span><span style="color: red">&amp;quot;</span><span style="color: blue">C:\Documents and Settings\Peter.PETERSGEKKO\My Documents\My Custoners\DirActivity\DacPro\DACPRO.FDB</span><span style="color: red">&amp;quot;</span><span style="color: blue">;data source=Farlowella;user id=gebruiker;password=project</span>&quot;</p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: red">providerName</span><span style="color: blue">=</span>&quot;<span style="color: blue">FirebirdSql.Data.FirebirdClient</span>&quot;<span style="color: blue"> /&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&nbsp; &nbsp; &lt;/</span><span style="color: maroon">connectionStrings</span><span style="color: blue">&gt;</span></p>
<p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: maroon">configuration</span><span style="color: blue">&gt;</span></p>
</div>
<p><!--EndFragment-->
<p>What could work is editing this app.config file. But the downside is that you have to maintain besides the web.config an app.config for every class library which works with a database. Which is prone to error.</p>
<p>To good thing is that you can override the values of these settings from code. When the library is loaded the settings are available in <strong>Settings</strong>, a property of&nbsp; the namespace of the library. In this scenario I have a class library which wraps up access to a Firebird database. I add one public method.</p>
<div style="font-size: 12pt;background: white;color: black;font-family: Courier New;border: windowtext 1pt solid;padding: 0pt">
<p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> SetConnectionString(<span style="color: blue">string</span> connString)</p>
<p style="margin: 0px">{</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">const</span> <span style="color: blue">string</span> FBconnectionTEmplate = <span style="color: maroon">&quot;port number=3050;charset=ISO8859_1;dialect=3;server type=0;database=\&quot;{0}&quot;</span>;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">const</span> <span style="color: blue">string</span> SettingsName = <span style="color: maroon">&quot;C__Documents_and_Settings_Peter_PETERSGEKKO_My_Documents_My_Custoners_DirActivity_DacPro_DACPRO_FDBConnectionString&quot;</span>;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: teal">Settings</span>.Default[SettingsName] = <span style="color: blue">string</span>.Format(FBconnectionTEmplate, connString);</p>
<p style="margin: 0px">}</p>
</div>
<p><!--EndFragment-->
<p>The method has a template for a Firebird connection string. It expects the filename of the Firebird database to use. The setting has a horrible name, that&#039;s the fault of the Firebird designer support. When you use sqlserver it will be a simple database name. The name is the indexer to the Settings.Default array. To this I assign the composed connectionstring.</p>
<p>Now I make one call to this method, passing it a value read form the web.config</p>
<div style="font-size: 12pt;background: white;color: black;font-family: Courier New;border: windowtext 1pt solid;padding: 0pt">
<p style="margin: 0px"><span style="color: blue">string</span> dbConnString = System.Configuration.<span style="color: teal">ConfigurationManager</span>.AppSettings[<span style="color: maroon">&quot;dbConnection&quot;</span>];</p>
<p style="margin: 0px"><span style="color: teal">ConnectionStringSetter</span>.SetConnectionString(dbConnString);</p>
</div>
<p><!--EndFragment-->
<p>After that all table adapters will use the right connection. I have my database wrapped up in a separate layer and still have all configuration in the web.config.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/petervanooijen/category/asp-net/" title="View all posts in ASP.NET" rel="category tag">ASP.NET</a>, <a href="http://codebetter.com/petervanooijen/category/data/" title="View all posts in Data" rel="category tag">Data</a>. Bookmark the <a href="http://codebetter.com/petervanooijen/2006/08/11/change-a-database-connection-string-from-code/" title="Permalink to Change a database connection string from code" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/petervanooijen/2006/08/11/change-a-database-connection-string-from-code/feed/" title="Comments RSS to Change a database connection string from code" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-473 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/petervanooijen/2006/08/11/add-a-custom-icon-to-your-mobile-app/" rel="prev"><span class="meta-nav">&larr;</span> Add a custom icon to your (mobile) app</a></div>
					<div class="nav-next"><a href="http://codebetter.com/petervanooijen/2006/09/06/a-holiday-read-into-enterprise-application-architecture/" rel="next">A (holiday) read into enterprise application architecture <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-2219">
					<div id="dsq-comment-header-2219" class="dsq-comment-header">
						<cite id="dsq-cite-2219">
								<span id="dsq-author-user-2219">Peter Mounce</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2219" class="dsq-comment-body">
						<div id="dsq-comment-message-2219" class="dsq-comment-message"><p>&#8220;Now I make one call to this method, passing it a value read form the web.config&#8221;</p>
<p>Where do you make the call to the method?  I&#8217;m in a similar position &#8211; wanting to only maintain one CS, in web.config, but my DataSets live in a lower-tier class library.  That class library doesn&#8217;t have anything but DataSets &#8211; no classes.  So where does one make the call?  Application_Start?</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2220">
					<div id="dsq-comment-header-2220" class="dsq-comment-header">
						<cite id="dsq-cite-2220">
	http://codebetter.com/blogs/peter.van.ooijen/default.aspx							<span id="dsq-author-user-2220">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2220" class="dsq-comment-body">
						<div id="dsq-comment-message-2220" class="dsq-comment-message"><p>Peter, </p>
<p>you have to make the call only once. Canidates for the place are<br />
- You initilization routine. In case you have one<br />
- Application_start in global.asax<br />
- A static constructor in a class refrenced before you&#8217;re going to hit the db<br />
- A constructor or overriden endinit event in the dataset see <a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2006/04/25/143308.aspx" rel="nofollow">http://codebetter.com/blogs/peter.van.ooijen/archive/2006/04/25/143308.aspx</a><br />
That will be hit more than once, but you&#8217;re always sure it is hit.</p>
<p>Pick your choice</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2221">
					<div id="dsq-comment-header-2221" class="dsq-comment-header">
						<cite id="dsq-cite-2221">
								<span id="dsq-author-user-2221">Roh Collins</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2221" class="dsq-comment-body">
						<div id="dsq-comment-message-2221" class="dsq-comment-message"><p>Many Thanks.</p>
<p>Didn&#8217;t quite click initially that you had to use the indexer directly (should have looked at your code more closely the first time), I originally assumed that because the connection string was saved as an ApplicationScoped setting and that only a getter was autogenerated in the Settings class, that I couldn&#8217;t set this value from code. Duh! Got there in the end though.<br />
Cheers.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2222">
					<div id="dsq-comment-header-2222" class="dsq-comment-header">
						<cite id="dsq-cite-2222">
	http://jshipleyATmayfranDOTcom							<span id="dsq-author-user-2222">Jim Shipley</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2222" class="dsq-comment-body">
						<div id="dsq-comment-message-2222" class="dsq-comment-message"><p>Would you be able to post a VB.net version of this code?</p>
<p>Thanks!<br />
Jim</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2223">
					<div id="dsq-comment-header-2223" class="dsq-comment-header">
						<cite id="dsq-cite-2223">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2223">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2223" class="dsq-comment-body">
						<div id="dsq-comment-message-2223" class="dsq-comment-message"><p><a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2005/10/06/132812.aspx" rel="nofollow">http://codebetter.com/blogs/peter.van.ooijen/archive/2005/10/06/132812.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2224">
					<div id="dsq-comment-header-2224" class="dsq-comment-header">
						<cite id="dsq-cite-2224">
								<span id="dsq-author-user-2224">HSBF LEWE</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2224" class="dsq-comment-body">
						<div id="dsq-comment-message-2224" class="dsq-comment-message"><p>I tried your code to amend app.config, and I&#8217;v got two errors:</p>
<p>Error	1	The name &#8216;ConnectionStringSetter&#8217; does not exist in the current context	C:\Documents and Settings\My18\My Documents\Visual Studio 2005\Projects\WindowsApplication23\WindowsApplication23\Form1.cs	45	13	WindowsApplication23</p>
<p>and</p>
<p>Error	2	The name &#8216;Settings&#8217; does not exist in the current context	C:\Documents and Settings\Arabital18\My Documents\Visual Studio 2005\Projects\WindowsApplication23\WindowsApplication23\Form1.cs	54	13	WindowsApplication23</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2225">
					<div id="dsq-comment-header-2225" class="dsq-comment-header">
						<cite id="dsq-cite-2225">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2225">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2225" class="dsq-comment-body">
						<div id="dsq-comment-message-2225" class="dsq-comment-message"><p>Don&#8217;t take the classname Connectionstringsetter literally. Fill in the class to which you added the method.</p>
<p>Affter adding setting to the project the Settings object should be available in the namespace of your project. Check you namespaces.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2226">
					<div id="dsq-comment-header-2226" class="dsq-comment-header">
						<cite id="dsq-cite-2226">
								<span id="dsq-author-user-2226">Ron</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2226" class="dsq-comment-body">
						<div id="dsq-comment-message-2226" class="dsq-comment-message"><p>Peter,<br />
Shouldn&#8217;t the scope of your setting be &#8220;user&#8221; instead of &#8220;application&#8221;? Otherwise if one user changes the setting, wouldn&#8217;t that affect all users of the application?</p>
<p>Thanks,<br />
Ron</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2227">
					<div id="dsq-comment-header-2227" class="dsq-comment-header">
						<cite id="dsq-cite-2227">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2227">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2227" class="dsq-comment-body">
						<div id="dsq-comment-message-2227" class="dsq-comment-message"><p>Ron, it depends. In case all users are sharing the same db the scope is right. In case each user has his/her own db you are right <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2228">
					<div id="dsq-comment-header-2228" class="dsq-comment-header">
						<cite id="dsq-cite-2228">
								<span id="dsq-author-user-2228">Carlos </span>
							</cite>
					</div>
					<div id="dsq-comment-body-2228" class="dsq-comment-body">
						<div id="dsq-comment-message-2228" class="dsq-comment-message"><p>Peter</p>
<p>I had the same problem, wow the solution you found is very good, now i have one connectionstring in the settings.settings binding but i really use whatever i need from my app.config, in my case QA connections, and production connection, thank you.</p>
<p>Carlos</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2229">
					<div id="dsq-comment-header-2229" class="dsq-comment-header">
						<cite id="dsq-cite-2229">
								<span id="dsq-author-user-2229">sudhakar@3kal.com</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2229" class="dsq-comment-body">
						<div id="dsq-comment-message-2229" class="dsq-comment-message"><p>hello peter,</p>
<p>we have  the same problem, we have created a class library for my DAL. we have the scenario like each client has one database. Now I have to pass the DBname each time client (User) request for data from database. where exactly I have to place my code to take the database name before it hit the database. </p>
<p>we are calling DAL methods from web application.</p>
<p>is your solution suitable for us ?<br />
suggest me the best solution ?</p>
<p>thank you.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2230">
					<div id="dsq-comment-header-2230" class="dsq-comment-header">
						<cite id="dsq-cite-2230">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2230">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2230" class="dsq-comment-body">
						<div id="dsq-comment-message-2230" class="dsq-comment-message"><p>The connectionstring, conatianing the db-name, should be set before opening the connection, that is calling it&#8217;s open() method.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2231">
					<div id="dsq-comment-header-2231" class="dsq-comment-header">
						<cite id="dsq-cite-2231">
								<span id="dsq-author-user-2231">Peter</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2231" class="dsq-comment-body">
						<div id="dsq-comment-message-2231" class="dsq-comment-message"><p>Thanks.  Your solution works.  My 1st question is whether this is sort of a backdoor way to get around the readonly issue using the indexer.  Since the compiler cannot evaluate the property, it just provides a warning.  My 2nd question is where I should change the connection string.  I want to do it right after My.Settings are populated with value so the new connection string will be used by entire application.  I&#8217;m new to .net and don&#8217;t know the execution sequence of .net application and don&#8217;t know how to trace/profile to see every event/method executed.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2232">
					<div id="dsq-comment-header-2232" class="dsq-comment-header">
						<cite id="dsq-cite-2232">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2232">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2232" class="dsq-comment-body">
						<div id="dsq-comment-message-2232" class="dsq-comment-message"><p>The server cache can be a little slow, I deleted the second copy of your question.</p>
<p>- I miss your first point. The connectionstring is in the settings array, it&#8217; snice to be able to use a name as indexer, allthough that is prone to spelling errors.<br />
Which will not show up till runtime.<br />
- The correct connection string has to be set before the connection is opened. Which is, in .net code, allways as late as possible. Just before your start firing sql at the db. No sooner</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2233">
					<div id="dsq-comment-header-2233" class="dsq-comment-header">
						<cite id="dsq-cite-2233">
								<span id="dsq-author-user-2233">Peter</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2233" class="dsq-comment-body">
						<div id="dsq-comment-message-2233" class="dsq-comment-message"><p>Peter,</p>
<p>My 1st point is that if I simply use the My.Settings.NorthwindConnectString = the new connection string or My.Settings.Default.NorthwindConnectString = the new connection string, I will get a readonly error. But using the My.Settings.Default(NorthwindConnectString) = the new connectoin string is ok.  It seems to me that it works because the compiler does not yield error since it did not evaluate My.Settings.Default(NorthwindConnectString) to My.Settings.Default.NorthwindConnectString.  My interpretation may not be correct since I&#8217;m new to VB and .net but I assume that My.Settings.Default(NorthwindConnectString) is like an array element and it actually points to My.Settings.Default.NorthwindConnectString.</p>
<p>What is the reason to set the connection string as late as possible? My thinking is that if I set the connection string as early as possible, I don&#8217;t need to worry that any future codings (firing sql) will be coded before the correct connection string is assigned.</p>
<p>Peter</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2234">
					<div id="dsq-comment-header-2234" class="dsq-comment-header">
						<cite id="dsq-cite-2234">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2234">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2234" class="dsq-comment-body">
						<div id="dsq-comment-message-2234" class="dsq-comment-message"><p>- Ah, I see your first point. It has to do with the VB My.Settings object. Which is just a helper which wraps several things which can also be accesed directly. Apparantly this connectionstring is exposed as a readonly property. Both things point at the same connectionstring.</p>
<p>- Sorry about not clearly formulating my second answer. You shoud open the connection as late as possible. Before calling the open method the connectionstring has to be set. Your approach sounds fine to me.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2235">
					<div id="dsq-comment-header-2235" class="dsq-comment-header">
						<cite id="dsq-cite-2235">
								<span id="dsq-author-user-2235">George</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2235" class="dsq-comment-body">
						<div id="dsq-comment-message-2235" class="dsq-comment-message"><p>I&#8217;ve had the same problemm with getting my Data Access Layer to read it&#8217;s ConnectionString from the web.config file. I tried different solutions, an even got afew of them to work. But this is, by far, the most elegant in it&#8217;s simplicity and logic. Thank you for posting it.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2236">
					<div id="dsq-comment-header-2236" class="dsq-comment-header">
						<cite id="dsq-cite-2236">
								<span id="dsq-author-user-2236">Warren</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2236" class="dsq-comment-body">
						<div id="dsq-comment-message-2236" class="dsq-comment-message"><p>Here is a walk through on how to do it.. <a href="http://asp.net/learn/data-access/tutorial-72-vb.aspx" rel="nofollow">http://asp.net/learn/data-access/tutorial-72-vb.aspx</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2237">
					<div id="dsq-comment-header-2237" class="dsq-comment-header">
						<cite id="dsq-cite-2237">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2237">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2237" class="dsq-comment-body">
						<div id="dsq-comment-message-2237" class="dsq-comment-message"><p>That&#8217;s a bad tutorial becauses it builds a monolothic site.  As said in the post and described here in detail at <a href="http://codebetter.com/blogs/peter.van.ooijen/archive/2006/04/25/143308.aspx" rel="nofollow">http://codebetter.com/blogs/peter.van.ooijen/archive/2006/04/25/143308.aspx</a></p>
<p>The tutorial does not work when your DAL is in a separate assembly (class library) Which was exactly the reason for this solution</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2238">
					<div id="dsq-comment-header-2238" class="dsq-comment-header">
						<cite id="dsq-cite-2238">
								<span id="dsq-author-user-2238">Ram</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2238" class="dsq-comment-body">
						<div id="dsq-comment-message-2238" class="dsq-comment-message"><p>Hi,</p>
<p>It is a great Article and i tried to implement this solution in my project. But i have lost in between. i have a webservice project which refers three assemblies (actual service layers) which has DAL.cs and table adapter. Each assemblies has its owen app.config file. Each table adaper has its own designer.cs and property called &#8220;connectionstring&#8221; to initiate the connection. </p>
<p>In this situation, Where should i suppose to call your SetConnectionString() method. i tried to set the connstring in of my assemblies&#8230;but other assemblies still looking/taking values from app.config? please can you elaborate it? It will be very much helpful to resolve my issues.</p>
<p>~Ram</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2239">
					<div id="dsq-comment-header-2239" class="dsq-comment-header">
						<cite id="dsq-cite-2239">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2239">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2239" class="dsq-comment-body">
						<div id="dsq-comment-message-2239" class="dsq-comment-message"><p>To keep the app properly layered I would keep all knowledge about the connectionstrings in the assemblies which actualy use the db connection.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2240">
					<div id="dsq-comment-header-2240" class="dsq-comment-header">
						<cite id="dsq-cite-2240">
								<span id="dsq-author-user-2240">KKH</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2240" class="dsq-comment-body">
						<div id="dsq-comment-message-2240" class="dsq-comment-message"><p>Someone asked about the scope of your setting previously, saying that &#8220;Shouldn&#8217;t the scope of your setting be &#8220;user&#8221; instead of &#8220;application&#8221;? Otherwise if one user changes the setting, wouldn&#8217;t that affect all users of the application?&#8221;  This is a problem that I encountered. Depending on the user&#8217;s region, he/she needs to access the region&#8217;s database. (All the region&#8217;s databases have the same table structure.)  Any idea on how to do it?  Thanks for your hlep.</p>
<p>KKH.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2241">
					<div id="dsq-comment-header-2241" class="dsq-comment-header">
						<cite id="dsq-cite-2241">
	http://codebetter.com/blogs/peter.van.ooijen/							<span id="dsq-author-user-2241">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2241" class="dsq-comment-body">
						<div id="dsq-comment-message-2241" class="dsq-comment-message"><p>The source of the connectionstring could be anywhere, up to you what fits best. I wouldn&#8217;t rely on the user&#8217;s setting for your scenario as that assumes every user having it&#8217;s own database. In case there are two users in the same region you have a configuration redundancy which will hit back. Sooner or later.</p>
<p>Whatever way you are going to do it: just keep all setting together in one (custom) xml file.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2242">
					<div id="dsq-comment-header-2242" class="dsq-comment-header">
						<cite id="dsq-cite-2242">
								<span id="dsq-author-user-2242">New To 2.0</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2242" class="dsq-comment-body">
						<div id="dsq-comment-message-2242" class="dsq-comment-message"><p>Thanks very much, this approach requires very minimal effort and works very well.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2243">
					<div id="dsq-comment-header-2243" class="dsq-comment-header">
						<cite id="dsq-cite-2243">
								<span id="dsq-author-user-2243">voiger</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2243" class="dsq-comment-body">
						<div id="dsq-comment-message-2243" class="dsq-comment-message"><p>thank you! Beautiful solution!</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2244">
					<div id="dsq-comment-header-2244" class="dsq-comment-header">
						<cite id="dsq-cite-2244">
								<span id="dsq-author-user-2244">Denz</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2244" class="dsq-comment-body">
						<div id="dsq-comment-message-2244" class="dsq-comment-message"><p>i have tried doing that instructions one by one i have got the connection string, vb does not return error code but the connection state always return &#8220;0&#8243; zero which meant not connected or no connection was established.</p>
<p>i have search vbcode website and found nothing that really worked, may i request from any one that has a code version of the actual working vbcode regarding connecting firebird database? </p>
<p>Anything that may be embedded or not will be deeply appreciated pls send it to <a href="mailto:lukadun@yahoo.com">lukadun@yahoo.com</a> or just post it here so that anyone that shares the same problem can view. </p>
<p>thank you</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2245">
					<div id="dsq-comment-header-2245" class="dsq-comment-header">
						<cite id="dsq-cite-2245">
								<span id="dsq-author-user-2245">Lord karnash</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2245" class="dsq-comment-body">
						<div id="dsq-comment-message-2245" class="dsq-comment-message"><p>and how i can change the connection string in EF .. :S<br />
< ?xml version="1.0" encoding="utf-8"?><br />
<configuration><br />
  <connectionstrings><br />
    <add name="wattsEntities" connectionString="metadata=res://*/wattsModel.csdl|res://*/wattsModel.ssdl|res://*/wattsModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=.\sqlexpress;Initial Catalog=dbwts;Integrated Security=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" /><br />
  </connectionstrings><br />
</configuration></p>
<p>i wanna change the Connection string .\sqlexpress to another string  or IP or name to the server machine ok.. <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' /><br />
(fer_bolivia@hotmail.com)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2246">
					<div id="dsq-comment-header-2246" class="dsq-comment-header">
						<cite id="dsq-cite-2246">
	http://codebetter.com/members/pvanooijen/default.aspx							<span id="dsq-author-user-2246">pvanooijen</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2246" class="dsq-comment-body">
						<div id="dsq-comment-message-2246" class="dsq-comment-message"><p>By Using nHibernate instead <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
Which is another way of saying I don&#8217;t know ? Doesn&#8217;t EF have a connection object somewhere ? Set the connectionstring there before EF will actually open the connection.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-2247">
					<div id="dsq-comment-header-2247" class="dsq-comment-header">
						<cite id="dsq-cite-2247">
								<span id="dsq-author-user-2247">Ulrich Schmid</span>
							</cite>
					</div>
					<div id="dsq-comment-body-2247" class="dsq-comment-body">
						<div id="dsq-comment-message-2247" class="dsq-comment-message"><p>In visual basic use the following command to modify a readonly(Application scoped) settings variable ApplicationConnectionString:<br />
My.Settings(&#8220;ApplicationConnectionString&#8221;) = NewApplicationConnectionString.<br />
Note that a subsequent My.Settings.Save() doesn&#8217;t write this settings to the appl.config file</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/petervanooijen/2006/08/11/change-a-database-connection-string-from-code/ ';
	var disqus_identifier = '473 /blogs/peter.van.ooijen/archive/2006/08/11/Change-a-database-connection-string-from-code.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'codebetterpetergekkosblog';
	var disqus_title = "Change a database connection string from code";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData â€” fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=473');
		});
					};
	var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/petervanooijen\/2006\/08\/11\/change-a-database-connection-string-from-code\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">Small bio</h3><div class="ub-grav" style="margin:5px 5px 0px 5px;float: none;"><img alt='' src='http://1.gravatar.com/avatar/5cb0e972c5e405e6bff7e7f2da237c6d?s=96&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&amp;r=G' class='avatar avatar-96 photo' height='96' width='96' /></div>
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
					<li id="tag_cloud-3" class="widget-container widget_tag_cloud"><h3 class="widget-title">Post categories</h3><div class="tagcloud"><a href='http://codebetter.com/petervanooijen/category/asp-net/' class='tag-link-1725' title='67 topics' style='font-size: 16.3151515152pt;'>ASP.NET</a>
<a href='http://codebetter.com/petervanooijen/category/chatter/' class='tag-link-6709' title='69 topics' style='font-size: 16.4848484848pt;'>Chatter</a>
<a href='http://codebetter.com/petervanooijen/category/coding/' class='tag-link-6706' title='49 topics' style='font-size: 15.2121212121pt;'>Coding</a>
<a href='http://codebetter.com/petervanooijen/category/data/' class='tag-link-6708' title='45 topics' style='font-size: 14.8727272727pt;'>Data</a>
<a href='http://codebetter.com/petervanooijen/category/featured/' class='tag-link-1356' title='6 topics' style='font-size: 8pt;'>Featured</a>
<a href='http://codebetter.com/petervanooijen/category/hardware/' class='tag-link-4927' title='13 topics' style='font-size: 10.5454545455pt;'>Hardware</a>
<a href='http://codebetter.com/petervanooijen/category/mobile/' class='tag-link-6712' title='13 topics' style='font-size: 10.5454545455pt;'>Mobile</a>
<a href='http://codebetter.com/petervanooijen/category/outofcontrol/' class='tag-link-6705' title='13 topics' style='font-size: 10.5454545455pt;'>Out+of+control</a>
<a href='http://codebetter.com/petervanooijen/category/tabletpc/' class='tag-link-6707' title='45 topics' style='font-size: 14.8727272727pt;'>Tablet+PC</a>
<a href='http://codebetter.com/petervanooijen/category/uncategorized/' class='tag-link-1044' title='318 topics' style='font-size: 22pt;'>Uncategorized</a>
<a href='http://codebetter.com/petervanooijen/category/usergroupsandmeetings/' class='tag-link-6711' title='25 topics' style='font-size: 12.7515151515pt;'>User+groups+and+meetings</a></div>
</li>		<li id="recent-posts-3" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://codebetter.com/petervanooijen/2011/01/31/c-for-the-iphone-monotouch-is-here-to-stay/" title="C# for the iPhone: Monotouch is here to stay">C# for the iPhone: Monotouch is here to stay</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/12/28/seasons-gifts-from-the-monotouch-iphone-treasure-chest-background-gps-tasks-and-uicontrol/" title="Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl">Seasons gifts from the MonoTouch (iPhone) treasure chest. Background (GPS) tasks and UIControl</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/11/05/kalifescope-and-monotouch-from-idea-to-the-appstore/" title="Kalifescope and Monotouch, from idea to the AppStore">Kalifescope and Monotouch, from idea to the AppStore</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/10/28/monotouch-your-c-app-on-a-real-iphone/" title="Monotouch: your C# app on a real iPhone">Monotouch: your C# app on a real iPhone</a></li>
				<li><a href="http://codebetter.com/petervanooijen/2010/09/28/monotouch-drawing-an-image-pixel-by-pixel/" title="Monotouch: drawing an image pixel by pixel">Monotouch: drawing an image pixel by pixel</a></li>
				</ul>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.Gekko-Software.nl" title="Website Gekko Software">My company</a></li>

	</ul>
</li>
<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Post archive</h3>		<ul>
			<li><a href='http://codebetter.com/petervanooijen/2011/01/' title='January 2011'>January 2011</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/12/' title='December 2010'>December 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/11/' title='November 2010'>November 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/10/' title='October 2010'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/09/' title='September 2010'>September 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/08/' title='August 2010'>August 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/07/' title='July 2010'>July 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/06/' title='June 2010'>June 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/05/' title='May 2010'>May 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/04/' title='April 2010'>April 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/03/' title='March 2010'>March 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/02/' title='February 2010'>February 2010</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2010/01/' title='January 2010'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/12/' title='December 2009'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/11/' title='November 2009'>November 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/10/' title='October 2009'>October 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/09/' title='September 2009'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/08/' title='August 2009'>August 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/07/' title='July 2009'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/06/' title='June 2009'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/05/' title='May 2009'>May 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/04/' title='April 2009'>April 2009</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/03/' title='March 2009'>March 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/02/' title='February 2009'>February 2009</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2009/01/' title='January 2009'>January 2009</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/12/' title='December 2008'>December 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/11/' title='November 2008'>November 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/10/' title='October 2008'>October 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/09/' title='September 2008'>September 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/08/' title='August 2008'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/07/' title='July 2008'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/06/' title='June 2008'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/05/' title='May 2008'>May 2008</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/04/' title='April 2008'>April 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/03/' title='March 2008'>March 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/02/' title='February 2008'>February 2008</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2008/01/' title='January 2008'>January 2008</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/12/' title='December 2007'>December 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/11/' title='November 2007'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/10/' title='October 2007'>October 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/09/' title='September 2007'>September 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/08/' title='August 2007'>August 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/07/' title='July 2007'>July 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/06/' title='June 2007'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/05/' title='May 2007'>May 2007</a>&nbsp;(1)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/04/' title='April 2007'>April 2007</a>&nbsp;(2)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/03/' title='March 2007'>March 2007</a>&nbsp;(3)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/02/' title='February 2007'>February 2007</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2007/01/' title='January 2007'>January 2007</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/12/' title='December 2006'>December 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/11/' title='November 2006'>November 2006</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/10/' title='October 2006'>October 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/09/' title='September 2006'>September 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/08/' title='August 2006'>August 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/07/' title='July 2006'>July 2006</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/06/' title='June 2006'>June 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/05/' title='May 2006'>May 2006</a>&nbsp;(6)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/04/' title='April 2006'>April 2006</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/03/' title='March 2006'>March 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/02/' title='February 2006'>February 2006</a>&nbsp;(10)</li>
	<li><a href='http://codebetter.com/petervanooijen/2006/01/' title='January 2006'>January 2006</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/12/' title='December 2005'>December 2005</a>&nbsp;(4)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/11/' title='November 2005'>November 2005</a>&nbsp;(7)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/10/' title='October 2005'>October 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/09/' title='September 2005'>September 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/08/' title='August 2005'>August 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/07/' title='July 2005'>July 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/06/' title='June 2005'>June 2005</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/05/' title='May 2005'>May 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/04/' title='April 2005'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/03/' title='March 2005'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/02/' title='February 2005'>February 2005</a>&nbsp;(27)</li>
	<li><a href='http://codebetter.com/petervanooijen/2005/01/' title='January 2005'>January 2005</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/12/' title='December 2004'>December 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/11/' title='November 2004'>November 2004</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/10/' title='October 2004'>October 2004</a>&nbsp;(11)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/09/' title='September 2004'>September 2004</a>&nbsp;(9)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/08/' title='August 2004'>August 2004</a>&nbsp;(8)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/07/' title='July 2004'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/06/' title='June 2004'>June 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/05/' title='May 2004'>May 2004</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/04/' title='April 2004'>April 2004</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/03/' title='March 2004'>March 2004</a>&nbsp;(21)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/02/' title='February 2004'>February 2004</a>&nbsp;(23)</li>
	<li><a href='http://codebetter.com/petervanooijen/2004/01/' title='January 2004'>January 2004</a>&nbsp;(14)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/12/' title='December 2003'>December 2003</a>&nbsp;(15)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/11/' title='November 2003'>November 2003</a>&nbsp;(20)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/10/' title='October 2003'>October 2003</a>&nbsp;(30)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/09/' title='September 2003'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/08/' title='August 2003'>August 2003</a>&nbsp;(12)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/07/' title='July 2003'>July 2003</a>&nbsp;(5)</li>
	<li><a href='http://codebetter.com/petervanooijen/2003/06/' title='June 2003'>June 2003</a>&nbsp;(4)</li>
		</ul>
</li>				</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.741 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-31 12:57:52 -->
<!-- super cache -->