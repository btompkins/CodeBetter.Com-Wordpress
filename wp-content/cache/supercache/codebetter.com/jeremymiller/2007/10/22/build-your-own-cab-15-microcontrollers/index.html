<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Build your own CAB #15 &#8211; MicroControllers | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='It&#8217;s Smart to Challenge the ASP.NET Status Quo' href='http://codebetter.com/jeremymiller/2007/10/20/it-s-smart-to-challenge-the-asp-net-status-quo/' />
<link rel='next' title='How are you building WinForms applications?  What&#8217;s hard about it?' href='http://codebetter.com/jeremymiller/2007/10/23/how-are-you-building-winforms-applications-what-s-hard-about-it/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=444' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,156] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2007/10/22/build-your-own-cab-15-microcontrollers/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-444" class="post-444 post type-post status-publish format-standard hentry category-build-your-own-cab category-design-patterns">
					<h1 class="entry-title">Build your own CAB #15 &#8211; MicroControllers</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2007/10/22/build-your-own-cab-15-microcontrollers/" title="1:13 am" rel="bookmark"><span class="entry-date">October 22, 2007</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>After a bit of a hiatus and a fair amount of pestering,&nbsp;I&#8217;m back and ready to continue the <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx">&#8220;Build you own CAB&#8221; series</A>.&nbsp; The point isn&#8217;t really to go build a drop in replacement for the <A href="http://msdn2.microsoft.com/en-us/library/aa480450.aspx">Composite Application Block</A>&nbsp;(CAB), but rather to understand the design patterns you can use to build maintainable WinForms applications.&nbsp; I&#8217;m hopeful that the material in this series will be useful for both users of the CAB and those who are rolling application specific architectures sans CAB.&nbsp; The previous posts have been mostly&nbsp;written at the perspective of a single screen.&nbsp; For this post I want to go down to the granular control level before coming back up to finish the series with content on coordinating multiple screens and composite applications.&nbsp; My longer term goal is&nbsp;use the&nbsp;BYO CAB series as the&nbsp;kernel&nbsp;of a book on design patterns for fat clients and composite applications, so I&#8217;d love any kind of feedback no matter how negative.</P><br />
<P>&nbsp;</P><br />
<H4>MicroControllers</H4><br />
<P>I introduced what I call the MicroController pattern in <A href="http://codebetter.com/blogs/jeremy.miller/pages/build-your-own-cab-14-managing-menu-state-with-microcontroller-s-command-s-a-layer-supertype-some-structuremap-pixie-dust-and-a-dollop-of-fluent-interface.aspx">my last installment</A>.&nbsp; The basic idea is to use a small controller class to govern an atomic part of the screen, usually all the way down to the individual control or a small cluster of controls.&nbsp; The assumption is that it&#8217;ll be easy to reuse the very small controller classes across screens and also to test these little critters under an xUnit microscope.&nbsp; I&#8217;ve&nbsp;found&nbsp;that it&#8217;s often advantageous&nbsp;to then aggregate those MicroController&#8217;s to create powerful behaviors.&nbsp; I&#8217;m going to take this idea a little bit farther and show some usages of the MicroController pattern to create an alternative to <A href="http://www.akadia.com/services/dotnet_databinding.html">Data Binding</A> for screen synchronization.&nbsp; When I first wrote about this idea in <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/04/16/My-Crackpot-Idea-for-WinForms-Development.aspx">My Crackpot WinForms Idea</A>, I said that I&#8217;d do a further writeup if the technique was successful.&nbsp; I&#8217;ve used it long enough now&nbsp;to know that I&#8217;m happy with the results overall, and more importantly, I&#8217;d like some feedback on this approach before I think about using it again.&nbsp; As I&#8217;ll try to demonstrate in this post, I&#8217;m claiming the MicroController approach leads to improvements in productivity and testability.</P><br />
<P>&nbsp;</P><br />
<H4>Background</H4><br />
<P>I&#8217;m going to refer to two different projects in this post.</P><br />
<OL><br />
<LI><I>TradeCapture 1</I>:&nbsp; A project that I did late last year and early this year.&nbsp; We used WinForms data binding and ran into major stumbling blocks with automated testing </LI><br />
<LI><I>TradeCapture 2</I>:&nbsp; One of the projects I&#8217;ve been working on since April.&nbsp; I&#8217;d used the MicroController strategy on previous projects, but this is the project where all the techniques shown here were developed and tested.&nbsp; The design of <I>TradeCapture 2</I> was heavily influenced by my interpretation of our struggles from <I>TradeCapture 1</I>.</LI></OL><br />
<P>I&#8217;m using slightly obfuscated examples from <I>TradeCapture 2</I>. An early, but functional version of the MicroController strategy is in the StoryTeller codebase at <A title="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding" href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding">http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding</A>.&nbsp; If you down load the entire code tree at <A title="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding" href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding">http://storyteller.tigris.org/svn/storyteller/trunk</A>&nbsp;you&#8217;ll find a couple small screens that use the techniques from this article.&nbsp; ReSharper &#8220;Find Usages&#8221; is your friend.</P><br />
<P>&nbsp;</P><br />
<H4>What&#8217;s the Problem?</H4><br />
<P>If you stop and think about it, there&#8217;s a huge amount of repetitive tasks that you need to do at the individual control level.&nbsp; Here&#8217;s a partial list of the tedious chores that can easily fill up your day on a WinForms project:&nbsp; </P><br />
<UL><br />
<LI>Bind controls to a property of the Model </LI><br />
<LI>Fill dropdown boxes with reference data fetched from some sort of backend </LI><br />
<LI>Use the ErrorProvider to display validation errors by control </LI><br />
<LI>Disable or hide controls based on user permissions </LI><br />
<LI>Capture change events off controls to trigger some other sort of behavior </LI><br />
<LI>Do &#8220;IsDirty&#8221; checks </LI><br />
<LI>Reset all the values back to the original state </LI><br />
<LI>Inside of an automated test, you need to be able to find a certain control and then manipulate it </LI><br />
<LI>Format data in screen elements.&nbsp; In my project we need to make some textbox&#8217;s accept numeric values in the form &#8220;1k&#8221; or &#8220;1m&#8221; to enter large numbers.&nbsp; In other applications you may have other formatting and parsing rules repeated over controls.</LI></UL><br />
<P>The designer time support in Visual Studio&nbsp;makes it easy to create these types of behavior from scratch.&nbsp; That&#8217;s great, but it leads to a lot of duplication, code noise, and difficulty in making behavioral changes across multiple screens harder.&nbsp; In the last bullet point in my list above, I had to go back and accept &#8220;1b&#8221; as the value 1,000,000,000 in textbox&#8217;s representing monetary amounts.&nbsp; It wasn&#8217;t any big deal because I only had one single method in a single MicroController class to modify.&nbsp; But what if I&#8217;d created that behavior through implementing event handlers separately for each textbox?&nbsp; That&#8217;d be&nbsp;a lot of code to duplicate and change.</P><br />
<P>&nbsp;</P><br />
<H4>Screen Synchronization with MicroControllers</H4><br />
<P>For a variety of reasons I wanted more predictable screen synchronization than Data Binding provides.&nbsp; Add in the drag (I&#8217;ll talk about this at length in the next BYO CAB post) of Data Binding in automated testing scenarios and I was ready to try something different.&nbsp; I ended up using a scheme that I&#8217;d previously applied to Javascript heavy DHTML&nbsp;clients.&nbsp; I would create a MicroController class for each type of Control that knew how to bidirectionally synchronize data from the Model classes to the Controls.&nbsp; The mechanics for each type of control (textbox, radio buttons, checkbox, listbox, etc.) are slightly different, but the goals and intentions are basically the same.&nbsp; As an example, for every type of control I might want to:</P><br />
<UL><br />
<LI>Synchronize the value of a property on the Model with a Control on the screen</LI><br />
<LI>Apply changes from a Control value back to a property on the screen</LI><br />
<LI>Attach error messages to a Control by the name of the property the Control is bound to</LI><br />
<LI>Simulate a &#8220;Click&#8221; event</LI><br />
<LI>Register for changes in the Control&#8217;s value</LI><br />
<LI>Reset the Control values back to the original property value of the Model class</LI><br />
<LI>Determine if the Control is &#8220;dirty&#8221;</LI><br />
<LI>Enable or disable Controls</LI></UL><br />
<P>The key is to make each type of Control/MicroController look the same for basic operations.&nbsp; I do this by making each MicroController implement the <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/IScreenElement.cs">IScreenElement</A> interface partially shown below:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> <SPAN>IScreenElement</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN> LabelText { <SPAN>get</SPAN>; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN> FieldName { <SPAN>get</SPAN>; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>Label</SPAN> Label { <SPAN>get</SPAN>; <SPAN>set</SPAN>; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>ErrorProvider</SPAN> Provider {<SPAN>set</SPAN>;}</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8230;</SPAN></PRE><PRE><B>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Bind(<SPAN>object</SPAN> target);</B></PRE><PRE><B>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>bool</SPAN> ApplyChanges();</B></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> SetError(<SPAN>string</SPAN> errorMesssage);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Reset();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN> GetError();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> RegisterChangeHandler(<SPAN>VoidHandler</SPAN> handler);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Update();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> SetErrors(<SPAN>string</SPAN>[] errorMessages);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8230;</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Disable();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Enable();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Click();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>event</SPAN> <SPAN>VoidHandler</SPAN> OnDirty;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> StopBinding();</PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>At the moment, I&#8217;ll focus on getting information between a Control and a single property of a Model class (say we&nbsp;have a textbox called &#8220;nameTextbox&#8221; that is bound to the &#8220;Name&#8221; property of a Person Model class).&nbsp; The bidirectional binding of the property data to the control is done in the two methods in bold.&nbsp; Calling Bind(object) will&nbsp;take the value from the Model object property designated by the FieldName property and make that the value of the underlying Control.&nbsp; Likewise, calling ApplyChanges() will take the value of the underlying Control and push the value back into the Model object.&nbsp; The workflow of screen binding is similar enough to pull most of the functionality into a <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/ScreenElement.cs">ScreenElement</A> superclass.&nbsp; Here&#8217;s the implementation of the Bind(object) method from <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/ScreenElement.cs">ScreenElement</A>.</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>virtual</SPAN> <SPAN>void</SPAN> Bind(<SPAN>object</SPAN> target)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>try</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target = target;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _originalValue = (U) Property.GetValue(target, <SPAN>null</SPAN>);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; updateControl(_originalValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>catch</SPAN> (<SPAN>Exception</SPAN> e)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN> message = <SPAN>string</SPAN>.Format(<SPAN>&#8220;Unable to bind property &#8220;</SPAN> + Property.Name);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>throw</SPAN> <SPAN>new</SPAN> <SPAN>ApplicationException</SPAN>(message, e);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> updateControl(U newValue)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Set the latch while we&#8217;re setting the initial value of the </SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// bound control</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _latched = <SPAN>true</SPAN>;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; resetControl(newValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _latched = <SPAN>false</SPAN>;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>abstract</SPAN> <SPAN>void</SPAN> resetControl(U originalValue);</PRE></DIV><br />
<P>Let&#8217;s say that we do have a textbox bound to the &#8220;Name&#8221; property of a Person class.&nbsp; In the Bind(object) I keep a reference to the Person object that I&#8217;m binding to, then I use reflection to get the &#8220;Name&#8221; value off of the Person object, then I call updateControl() to actually set the Text property of the textbox.&nbsp; To build a specific ScreenElement for a&nbsp;textbox I just had to override the resetControl() template method in the <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/TextboxElement.cs">TextboxElement class</A>.</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// BoundControl is a Textbox</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> resetControl(<SPAN>object</SPAN> originalValue)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BoundControl.Text = originalValue == <SPAN>null</SPAN> ? <SPAN>string</SPAN>.Empty : _format(originalValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>There&#8217;s really not too much to it.&nbsp; &#8220;_format&#8221; is a reference to a delegate that can be swapped out at configuration time to handle differences like the number of decimal points in numeric fields.&nbsp; Just for completeness sake, here&#8217;s the same method in the <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/PicklistElement.cs">PicklistElement</A> (the implementation of ScreenElement for comboboxes)&nbsp;</P><br />
<DIV><PRE></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>IPicklist</SPAN> _list = <SPAN>new</SPAN> <SPAN>NulloPicklist</SPAN>();</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> resetControl(<SPAN>object</SPAN> originalValue)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _list.SetValue(BoundControl, originalValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE></DIV><br />
<H4>Aggregating MicroControllers</H4><br />
<P>By themselves, a single MicroController isn&#8217;t all that usefull, but aggregating them together is a different story.&nbsp; I use a class called <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/ScreenBinder.cs">ScreenBinder</A> to perform aggregate operations across a collection of IScreenElement MicroControllers.&nbsp; The public interface for IScreenBinder is down below:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> <SPAN>IScreenBinder</SPAN> : <SPAN>IScreenElementDriver</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> UpdateBinding();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> FillList(<SPAN>string</SPAN> fieldName, <SPAN>IPicklist</SPAN> list);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>object</SPAN> BoundObject { <SPAN>get</SPAN>;}</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8230;</SPAN></PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>event</SPAN> <SPAN>VoidHandler</SPAN> OnChange;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> BindScreen(<SPAN>object</SPAN> target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>bool</SPAN> ApplyChanges();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> ShowErrorMessages(<SPAN>Notification</SPAN> notification);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> ClearErrors();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> StopBinding();</PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>As I said before, ScreenBinder keeps an internal ArrayList&lt;IScreenElement&gt; member.&nbsp; When you add an IScreenElement to ScreenBinder it also adds a reference to the proper ErrorProvider for validation error display and sets up event listening for change events.&nbsp; Since ScreenBinder aggregates change events for all of its IScreenElement children, you can simply listen for a single event on IScreenBinder for enabling &#8220;Submit&#8221; and &#8220;Cancel&#8221; type buttons when any element changes.</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> AddElement(<SPAN>IScreenElement</SPAN> element)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Attach the ErrorProvider to the new IScreenElement</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; element.Provider = _provider;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _elements.Add(element);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Go ahead and Bind the new IScreenElement</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (isBound())</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; element.Bind(_target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Register for all OnDirty events</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; element.OnDirty += fireChanged;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>Now that we have a collection of IScreenElement children, we can bind the whole collection to the Model object one child at a time.</P><br />
<P>&nbsp;</P><br />
<DIV class="body"><br />
<P>&nbsp;</P><br />
<DIV class="postBody"><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> BindScreenTo(T target)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; withinLatch(<SPAN>delegate</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (<SPAN>IScreenElement</SPAN> element <SPAN>in</SPAN> _elements)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; element.Bind(target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target = target;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; });</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> withinLatch(<SPAN>VoidHandler</SPAN> handler)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>_isLatched = <SPAN>true</SPAN>;</B></PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; handler();</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>_isLatched = <SPAN>false</SPAN>;</B></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV></DIV><br />
<P>&nbsp;</P></DIV><br />
<P>Notice the lines of code in bold.&nbsp; When the ScreenBinder is binding each IScreenElement to the Model object it sets its internal &#8220;_latch&#8221; field to true.&nbsp; That&#8217;s important because we don&#8217;t want &#8220;IsDirty&#8221; event notifications popping up in the middle of the initial data binding.&nbsp; The <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/07/02/build-your-own-cab-12-rein-in-runaway-events-with-the-quot-latch-quot.aspx">&#8220;latch&#8221; strategy</A> comes into play in the method fireChanged() that raises the ScreenBinder&#8217;s OnChange event.&nbsp; That was a huge source of heartburn to me and my team on <I>TradeCapture 1</I>.&nbsp; One of my core goals for the MicroController strategy on <I>TradeCapture 2</I> was to systematically control the event latching in the screen synchronization.</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>event</SPAN> <SPAN>VoidHandler</SPAN> OnChange;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> fireChanged()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (_isLatched)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN>;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (OnChange != <SPAN>null</SPAN>)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OnChange();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>&nbsp;</P><br />
<P>The more predictable data binding by itself was a win, but I had other design goals as well.&nbsp; The remainder of the post is a rundown of those goals and how I used MicroControllers to achieve these goals.</P><br />
<P>&nbsp;</P><br />
<H4>Goal:&nbsp; Make the View behavioral code easier to maintain and verify by inspection</H4><br />
<P>Like I said earlier, the design time property editor is great for writing small behavioral and formatting functionality from scratch, but can you look at a screen in the designer and &#8220;see&#8221; what&#8217;s wired up to what?&nbsp; I&#8217;ll answer that one with &#8220;you can&#8217;t.&#8221;&nbsp; To find out what the screen is doing, which events are wired and to what, and what screen elements are bound to which property you&#8217;ve got to click on all of the elements and scroll through the Properties tab in Visual Studio.&nbsp; The information you need to maintain or patch the screen is scattered all over the place.&nbsp; I got very frustrated on <I>TradeCapture 1</I> with how hard it was to understand the behavior of complex screens.</P><br />
<P>To combat that problem in <I>TradeCapture 2</I> I wanted the wiring of the View to be compressed into a readable form without sacrificing the straightforward speed of using the designer.&nbsp; Setting up all the MicroController objects was going to lead to ugly, verbose code that made the readability of the code worse.&nbsp; What I ended up with is a <A href="http://martinfowler.com/bliki/FluentInterface.html">Fluent Interface</A> to configure MicroControllers against all the screen elements in a readable format.&nbsp; To remove a little more friction, I wrote a crude codegen tool that simply spits out a class with constants for all of the public properties for my Model classes like this one below for my Trade class.</P><br />
<P>public class TradeFields<BR>{<BR>&nbsp;&nbsp;&nbsp; public static readonly string Description = &#8220;Description&#8221;<BR>&nbsp;&nbsp;&nbsp; public static readonly string Status = &#8220;Status&#8221;<BR>&nbsp;&nbsp;&nbsp; public static readonly string TradeId = &#8220;TradeId&#8221;<BR>&nbsp;&nbsp;&nbsp; &#8230;<BR>} </P><br />
<P>Hey, if you have to work in a statically typed language you might as well take advantage of it right?&nbsp; Having the property names in Intellisense is definitely better than strings every which way.&nbsp; </P><br />
<P>Now that I have the property names as constants I can configure a screens behavior with code like this snippet down below:</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> Bind(<SPAN>IScreenBinder</SPAN> binder)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder = binder;</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.Trader).To(traderCombobox).WithLabel(traderLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .FillWith(<SPAN>ListType</SPAN>.Trader);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.Strategy).To(strategyCombobox).WithLabel(strategyLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .FillWith(<SPAN>ListType</SPAN>.Strategy);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// LegalEntity &amp; Book</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.Book).To(bookCombobox)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .FillWith(<SPAN>ListType</SPAN>.Book)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .WithLabel(bookLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .RebindOnChange()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .OnChange(<B><SPAN>delegate</SPAN> {_presenter.BookChanged();}</B>);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.LegalEntity).To(legalEntityCombobox).WithLabel(legalEntityLabel);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.CounterParty).To(counterPartyCombobox).WithLabel(counterPartyLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .FillWith(<SPAN>ListType</SPAN>.Counterparty);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.TradeDate).To(tradeDatePicker).WithLabel(tradeDateLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .OnChange(<B><SPAN>delegate</SPAN> { _tradePresenter.TradeDateChanged(); }</B>);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>In this one method I&#8217;m completely defining both the data binding from control to property and the wiring of the View to its Presenter for OnChange events&nbsp;(look at the&nbsp;two snippets of code above&nbsp;in bold).&nbsp; I&#8217;m arguing that this type of data binding and declarative attachment of behaviors and event tagging is better for maintainability than classic designer driven Data Binding because all of the relevant functionality is boiled down into such a smaller area of the code.&nbsp; I can scan this code and understand what the screen is doing and spot errors in the screen wiring.&nbsp; The speed issue of the initial write is at least on par with Data Binding through the designer by simply enabling Intellisense.</P><br />
<P>I&#8217;m not sure I really got all the way to my goal of clean, expressive language to describe the desired screen behavior because of the inherent limitations of C# 2.0.&nbsp; My thinking is that this approach will shine much more in IronRuby or even in C# 3.0.&nbsp; I thought a little bit about rewriting this entire data binding scheme as an open source project, but I think I&#8217;m shelving that idea indefinitely.&nbsp; I do think it would be an interesting project for IronRuby and WPF someday.</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;</P><br />
<H4>Goal:&nbsp; Reuse minor screen behavior</H4><br />
<P>Since coming to New York I&#8217;ve worked on two different &#8220;Trade Capture&#8221; applications.&nbsp; I&#8217;ve observed a lot of sameness of programming tasks across the screens in the two projects and I think I learned a lot of lessons from the first that have made the second more successful.&nbsp; One of the things we hit in the first project was this scenario:&nbsp; you have some sort of property that&#8217;s set by choosing a tab or a radio button in the screen.&nbsp; In <I>TradeCapture&nbsp;1</I> we wrote manual code that set the property on the underlying Trade object anytime the tab selection was changed.&nbsp; It&#8217;s subtle, but I&#8217;d almost call that an intrusion of business logic into the presentation code.&nbsp; Even if you make the case that that code was definitely presentation related, it added repetitive code and&nbsp;noise to the View.&nbsp; Much worse is the fact that that behavior wasn&#8217;t covered by an automated test because we gave up early on automating tests through the screen.</P><br />
<P>In <I>TradeCapture 2</I> I saw that same scenario coming and built a MicroController for that&nbsp;repetitive behavior.&nbsp; In this case I have several instances of an enumeration property, with a series of radio buttons representing each possible enumeration value.&nbsp; In the code we need to know how to set the property anytime a radio button is selected, and also to activate the correct radio button when an existing Trade is viewed.</P><br />
<P>I wrote two classes, a MicroController for each&nbsp;radio button&nbsp;called <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/RadioElement.cs" target="_blank">RadioElement</A> and a class to manage the radio button group called <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/RadioButtonGroup.cs">RadioButtonGroup</A>&nbsp;(If you&#8217;re curious, the source code is at the links for each).&nbsp; The actual code for each class isn&#8217;t that interesting, but I think this code is:&nbsp; </P><br />
<P>&nbsp;</P><br />
<DIV><PRE><SPAN></SPAN>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// FXOptionTradeFields is just a codegen&#8217;d class with a bunch of constants for </SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// the field names of the Model class</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; binder.BindProperty(<SPAN>FXOptionTradeFields</SPAN>.ExerciseType).ToRadioGroup&lt;<SPAN>ExerciseTypeEnum</SPAN>&gt;()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .RadioButton(<B>americanOptionButton</B>).IsBoundTo(<SPAN>ExerciseTypeEnum</SPAN>.American)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .RadioButton(<B>europeanOptionButton</B>).IsBoundTo(<SPAN>ExerciseTypeEnum</SPAN>.European)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .RadioButton(<B>bermudanOptionButton</B>).IsBoundTo(<SPAN>ExerciseTypeEnum</SPAN>.Bermuda);</PRE></DIV><br />
<P>All this code does is setup a&nbsp;RadioButtonGroup and a series of RadioElement&nbsp;objects to govern the data binding of the three radio buttons bolded&nbsp;above.&nbsp;&nbsp; It&#8217;s just a little bit of Fluent Interface to make the attachment of the behavior be as declarative as possible.</P><br />
<P>Now, back to the idea of testability.&nbsp; In the next post in this series I&#8217;ll show how to use the MicroController strategy to test through the screen, but for now let&#8217;s assume that we&#8217;re forgoing automated tests on the screen itself.&nbsp; In that case we&#8217;ve still made a gain.&nbsp; The behavior of the radio button binding is now more or less declarative, increasing the <A href="http://codebetter.com/blogs/scott.bellware/archive/2007/04/07/161406.aspx">solubility</A> of the code to make this code easier to trouble shoot by mere inspection.</P><br />
<P>You are reusing this code across different radio button groups, so it would help if the reused code were tested pretty thoroughly.&nbsp; While testing at the application or screen level is difficult, simply unit testing the MicroController classes in isolation was pretty simple.&nbsp; It&#8217;s easy to forget, but the Control classes in WinForms are just classes.&nbsp; You can instantiate them on the fly in code at will.&nbsp; Here&#8217;s what the unit tests for RadioElement look like:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; [<SPAN>TestFixture</SPAN>]</PRE><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> <SPAN>RadioElementTester</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>EnumTarget</SPAN> _target;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>RadioButton</SPAN> _button;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>RadioElement</SPAN>&lt;<SPAN>FakeEnum</SPAN>&gt; _element;</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>SetUp</SPAN>]</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> SetUp()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target = <SPAN>new</SPAN> <SPAN>EnumTarget</SPAN>();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target.State = <SPAN>FakeEnum</SPAN>.TX;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>PropertyInfo</SPAN> property = <SPAN>typeof</SPAN>(<SPAN>EnumTarget</SPAN>).GetProperty(<SPAN>&#8220;State&#8221;</SPAN>);</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _button = <SPAN>new</SPAN> <SPAN>RadioButton</SPAN>();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element = <SPAN>new</SPAN> <SPAN>RadioElement</SPAN>&lt;<SPAN>FakeEnum</SPAN>&gt;(property, _button, <SPAN>new</SPAN> <SPAN>RadioButtonGroup</SPAN>&lt;<SPAN>FakeEnum</SPAN>&gt;());</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>Test</SPAN>]</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> CheckTheRadioButtonIfTheEnumerationValueMatches()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element.BoundValue = <SPAN>FakeEnum</SPAN>.TX;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element.Bind(_target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>Assert</SPAN>.IsTrue(_button.Checked);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>Test</SPAN>]</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> DontCheckTheRadioButtonIfTheEnumerationValueDoesNotMatch()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target.State = <SPAN>FakeEnum</SPAN>.MO;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element.Bind(_target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>Assert</SPAN>.IsFalse(_button.Checked);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>Test</SPAN>]</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> ApplyChangesWhenTheButtonIsChecked()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target.State = <SPAN>FakeEnum</SPAN>.MO;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element.Bind(_target);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _button.Checked = <SPAN>true</SPAN>;</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// After applying the changes, the RadioButton was selected,</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// so the _target.State property should have been overwritten</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// with the value of the RadioElement.BoundValue</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _element.ApplyChanges();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>Assert</SPAN>.AreEqual(_element.BoundValue, _target.State);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>&nbsp;</P><br />
<P>&nbsp;</P><br />
<H4>Goal:&nbsp; Eliminate&nbsp;noise code&nbsp;in the Presenters</H4><br />
<P>My first exposure to <A href="http://www.object-arts.com/papers/TwistingTheTriad.PDF">Model View Presenter architectures</A> was an application built along <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/05/30/build-your-own-cab-part-4-the-passive-view.aspx">Passive View</A> lines.&nbsp; Passive View does a lot to promote testability, but you can end up with massive Presenter classes.&nbsp; The Presenter in a Passive View screen can become a dumping ground for all of the screen responsibilities if you&#8217;re not careful.&nbsp; One of my goals with my current screen architecture was to move to a <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/05/25/build-you-own-cab-part-3-the-supervising-controller-pattern.aspx">Supervising Controller</A> architecture&nbsp;and reduce the &#8220;noise&#8221; code in my Presenter&#8217;s by pushing tedious tasks back into the View.&nbsp; For example, I&#8217;ve written code to grab a list of values from some sort of backend service and stuff it into a setter on the View to fill dropdown boxes more than enough times in my life.&nbsp; That kind of stuff just ends up bloating the Presenter with trivialities.&nbsp; I want the &#8220;signal&#8221; in the Presenter to be screen behavior, not a bunch of boilerplate code filling in dropdown lists and attaching validation messages.&nbsp; </P><br />
<P>What does it really take to fill a dropdown list with values?&nbsp; My end goal was to simply say in the code that I want ComboBox A to be filled with List B without having to worry about the mechanics every time.&nbsp; I&#8217;m going to do this a hundred times or better over the life of the project, so it might as well be easy.&nbsp; I came up with a syntax that looks like this:</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _binder.BindProperty(<SPAN>TradeFields</SPAN>.Strategy).To(strategyField).WithLabel(strategyLabel)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>.FillWith(<SPAN>ListType</SPAN>.Strategy)</B>;</PRE></DIV><br />
<P>The screen that&nbsp;contains this&nbsp;code has a ComboBox named &#8220;strategyField.&#8221;&nbsp; The code in bold&nbsp;above is directing the MicroController for &#8220;strategyField&#8221; to fetch the list of &#8220;Strategy&#8221; values to fill the ComboBox.&nbsp; To pull this off I need two things.&nbsp; The first thing is a way to describe a dropdown list to allow for variances in type or display/value members.&nbsp; I use a class called <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Lists/Picklist.cs">Picklist</A> for this that has the public interface shown below:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> <SPAN>IPicklist</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Fill(<SPAN>ComboBox</SPAN> ComboBox);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> Fill(<SPAN>ListBox</SPAN> listBox);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8230;</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>The second thing I need is a single reference point to access IPicklist objects by key.&nbsp; To that end I use an interface called IListRepository:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> <SPAN>IListRepository</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>IPicklist</SPAN> GetPickList(<SPAN>ListType</SPAN> type);</PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>The actual concrete implementation is gathering up list data from a couple different sources, but it&#8217;s all accessible in a common way by calling the GetPickList(ListType) method.&nbsp; All the MicroController has to do now is grab an instance of IListRepository, find the right IPicklist, then fill its ComboBox control.&nbsp; Here&#8217;s the method in <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/PicklistElement.cs">PicklistElement</A> that does just that:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> FillWithList(<SPAN>ListType</SPAN> listType)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Grab IListRepository from StructureMap.&nbsp; It&#8217;s actually a singleton,</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// but we don&#8217;t have to care about that here</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>IListRepository</SPAN> repository = <SPAN>ObjectFactory</SPAN>.GetInstance&lt;<SPAN>IListRepository</SPAN>&gt;();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>IPicklist</SPAN> list = repository.GetPickList(listType);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; FillWithList(list);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>The example code here is very specific to my application, but I&#8217;ve used the basic idea of a &#8220;ListRepository&#8221; and &#8220;Picklist&#8221; on a couple different UI-intensive&nbsp;projects to great effect.&nbsp; You could happily roll your own equivalent.</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;</P><br />
<H4>Goal:&nbsp; Enable Model-centric validation via the Notification Pattern</H4><br />
<P>In an earlier installment on <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/06/13/build-your-own-cab-part-9-domain-centric-validation-with-the-notification-pattern.aspx">model centric validation</A>,&nbsp;I made the case for putting validation logic into the Model class where&nbsp;that logic is easier to&nbsp;test and share across screens. &nbsp;I also&nbsp;introduced the <A href="http://martinfowler.com/eaaDev/Notification.html">Notification pattern</A> as a way to transmit the validation messages tagged by field, but I purposely put off the mechanics of displaying those validation messages on the screen.&nbsp; So, here&#8217;s the situation, I&#8217;m in the View now and I&#8217;ve got a Notification object with lots of validation errors, how do I get those associated to the correct control?&nbsp; Elementary my dear Mr. Watson.&nbsp; All we need to do is have ScreenBinder loop through its IScreenElement children.&nbsp; Inside of ScreenBinder is this method called ShowErrorMessages(Notification) that:&nbsp;</P><br />
<OL><br />
<LI>Loop through each IScreenElement </LI><br />
<LI>Query the Notification object for all of the error messages for the IScreenElement.FieldName </LI><br />
<LI>Tell the IScreenElement to display these error messages.&nbsp; If the error messages are blank, the IScreenElement will clear out all error display.</LI></OL><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> ShowErrorMessages(<SPAN>Notification</SPAN> notification)</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Hack to replace &#8220;FieldName&#8221; with &#8220;Label Text&#8221; inside of validation messages</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (<SPAN>IScreenElement</SPAN> element <SPAN>in</SPAN> _elements)</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; notification.AliasFieldInMessages(element.FieldName, element.LabelText);</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<DIV><PRE>&nbsp;</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Call each ScreenElement to display the error messages for it&#8217;s field</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// It&#8217;s important to loop through each element so that the element knows</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// to show no messages if it&#8217;s field is valid</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (<SPAN>IScreenElement</SPAN> element <SPAN>in</SPAN> _elements)</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN>[] messages = notification.GetMessages(element.FieldName);</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; element.SetErrors(messages);</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<DIV><PRE>&nbsp;</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// I need to refactor the propagation of the children into a Composite pattern</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// here so that child IScreenBinder&#8217;s just look like IScreenElement.&nbsp; Someday soon.</SPAN></PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (<SPAN>KeyValuePair</SPAN>&lt;<SPAN>string</SPAN>, <SPAN>IScreenBinder</SPAN>&gt; pair <SPAN>in</SPAN> _children)</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>Notification</SPAN> childNotification = notification.GetChild(pair.Key);</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; pair.Value.ShowErrorMessages(childNotification);</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>At least for now, each individual IScreenElement is given a reference to the screen&#8217;s <A href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx">ErrorProvider</A> object.&nbsp; Since the IScreenElement has a reference to both the ErrorProvider and the Control, setting the error messages becomes pretty simple:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> SetErrors(<SPAN>string</SPAN>[] errorMessages)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SetError(<SPAN>string</SPAN>.Join(MESSAGE_SEPARATOR.ToString(), errorMessages));</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> SetError(<SPAN>string</SPAN> errorMesssage)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// _provider is the ErrorProvider for the screen</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (_provider == <SPAN>null</SPAN>)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN>;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _provider.SetError(_control, errorMesssage);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>I should point out here that it is perfectly possible to use the BindingDataSource from WinForms 2.0 to effect a similar effect to make a connection from field to control.&nbsp; All the same though, I like my way better.</P><br />
<P>&nbsp;</P><br />
<H4>Goal:&nbsp; Control extraneous &#8220;I just changed&#8221; events</H4><br />
<P>Here&#8217;s a common screen scenario:&nbsp; the submit and undo buttons should only be enabled when something on the screen changes.&nbsp; Easy enough, you just listen for &#8220;onchange&#8221; type events on all of the elements that you care about.&nbsp; There&#8217;s one little potential problem though.&nbsp; Those onchange events can and will fire during the initial loading of the control data.&nbsp; Or when the list items of a ComboBox changes.&nbsp; Or some sort of formatting is applied to a textbox.&nbsp; At these times you want to disregard the onchange events.&nbsp; You can simply unregister the change events while the original binding operation is taking place or use a <A href="http://codebetter.com/blogs/jeremy.miller/archive/2007/07/02/build-your-own-cab-12-rein-in-runaway-events-with-the-quot-latch-quot.aspx">&#8220;latch&#8221;</A>&nbsp;to stop the propagation of events when it&#8217;s not appropriate.&nbsp; I tend toward using the &#8220;latch&#8221; approach.&nbsp; </P><br />
<P>As you&#8217;ve probably guessed, we can bake the &#8220;latch&#8221; idea into a MicroController to put the onchange event latch closer to each Control.&nbsp; I register event handlers against&nbsp;a MicroController instead of directly against the bound controls.&nbsp; </P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; binder.BindProperty(<SPAN>FXOptionTradeFields</SPAN>.CurrencyPair)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .To(currencyPairField)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .FillWith(<SPAN>ListType</SPAN>.CurrencyPair)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .RebindOnChange()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>.OnChange(<SPAN>delegate</SPAN> { presenter.CurrencyPairSelected(); })</B></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .WithLabel(currencyLabel);</PRE></DIV><br />
<P>Intercepting the onchange events in the MicroController first&nbsp;enables the ability to &#8220;latch&#8221; the propagation of &#8220;onchange&#8221; events&nbsp;during the act of&nbsp;binding the Model to the control.&nbsp; Most of my MicroControllers inherit from a class called <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/ScreenElement.cs">ScreenElement</A>.&nbsp; In the fragment of code from ScreenElement below the updateControl() method is responsible for setting the value of the inner Control.&nbsp; Before ScreenElement calls through to the resetControl() method to actually set the value of the control it sets a field called _latch to true&nbsp;and sets _latch back to false as soon as resetControl() returns.&nbsp; Note the code in bold below.</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>virtual</SPAN> <SPAN>void</SPAN> Bind(<SPAN>object</SPAN> target)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>try</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _target = target;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _originalValue = (U) Property.GetValue(target, <SPAN>null</SPAN>);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; updateControl(_originalValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>catch</SPAN> (<SPAN>Exception</SPAN> e)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN> message = <SPAN>string</SPAN>.Format(<SPAN>&#8220;Unable to bind property &#8220;</SPAN> + Property.Name);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>throw</SPAN> <SPAN>new</SPAN> <SPAN>ApplicationException</SPAN>(message, e);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> updateControl(U newValue)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Set the latch while we&#8217;re setting the initial value of the </SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// bound control</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>_latched = <SPAN>true</SPAN>;</B></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; resetControl(newValue);</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <B>_latched = <SPAN>false</SPAN>;</B></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>The call to resetControl() will fire off an event because the value of the &nbsp;Control is changing, but that event will not be propagated on if the latch is set.&nbsp; Look at the code in bold&nbsp;below:</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>void</SPAN> elementValueChanged()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Guard clause.&nbsp; Don&#8217;t do anything if we&#8217;re latched</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<B> <SPAN>if</SPAN> (_latched)</B></PRE><PRE><B>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</B></PRE><PRE><B>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN>;</B></PRE><PRE><B>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</B></PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ApplyChanges();</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Re-calculate validation errors for only this field</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SetErrors(<SPAN>Validator</SPAN>.ValidateField(_target, _property.Name));</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Call the other registered handler&#8217;s for the onchange</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// event for this control</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (<SPAN>VoidHandler</SPAN> handler <SPAN>in</SPAN> _handlers)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; handler();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (isDirty())</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fireDirty(); </PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>Each subclass of <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/ScreenElement.cs">ScreenElement</A> needs to capture the appropriate &#8220;onchange&#8221; event and call the elementValueChanged() method inherited from the base.&nbsp; Here&#8217;s the implementation from <A href="http://storyteller.tigris.org/svn/storyteller/trunk/src/StoryTeller.DataBinding/Elements/CheckboxElement.cs">CheckboxElement</A>:</P><br />
<P>&nbsp;</P><br />
<DIV><PRE>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> <SPAN>CheckboxElement</SPAN> : <SPAN>ScreenElement</SPAN>&lt;<SPAN>CheckBox</SPAN>, <SPAN>bool</SPAN>&gt;, <SPAN>IToggleable</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> CheckboxElement(<SPAN>PropertyInfo</SPAN> property, <SPAN>CheckBox</SPAN> checkBox) : <SPAN>base</SPAN>(property, checkBox)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; checkBox.CheckedChanged += checkBox_CheckedChanged;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> tearDown()</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BoundControl.CheckedChanged -= checkBox_CheckedChanged;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>void</SPAN> checkBox_CheckedChanged(<SPAN>object</SPAN> sender, System.<SPAN>EventArgs</SPAN> e)</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; elementValueChanged();</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;</PRE><PRE>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>&#8230;</SPAN></PRE><PRE>&nbsp;&nbsp;&nbsp; }</PRE></DIV><br />
<P>&nbsp;</P><br />
<P>Catch Jeremy&#8217;s next &#8220;Build Your own CAB&#8221; adventure in <FONT size="6">Yes, Virginia.&nbsp; You CAN test the user interface</FONT>.&nbsp; Coming to an RSS aggregator near you in about four of Jeremy&#8217;s train ride commutes.</P></p>
<div class="shr-publisher-444"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/build-your-own-cab/" title="View all posts in Build your own CAB" rel="category tag">Build your own CAB</a>, <a href="http://codebetter.com/jeremymiller/category/design-patterns/" title="View all posts in Design Patterns" rel="category tag">Design Patterns</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2007/10/22/build-your-own-cab-15-microcontrollers/" title="Permalink to Build your own CAB #15 &#8211; MicroControllers" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2007/10/22/build-your-own-cab-15-microcontrollers/feed/" title="Comments RSS to Build your own CAB #15 &#8211; MicroControllers" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-444 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2007/10/20/it-s-smart-to-challenge-the-asp-net-status-quo/" rel="prev"><span class="meta-nav">&larr;</span> It&#8217;s Smart to Challenge the ASP.NET Status Quo</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2007/10/23/how-are-you-building-winforms-applications-what-s-hard-about-it/" rel="next">How are you building WinForms applications?  What&#8217;s hard about it? <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-2886">
                    <div id="dsq-comment-header-2886" class="dsq-comment-header">
                        <cite id="dsq-cite-2886">
    http://www.demetriusnunes.com                            <span id="dsq-author-user-2886">Demetrius Nunes</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2886" class="dsq-comment-body">
                        <div id="dsq-comment-message-2886" class="dsq-comment-message"><p>Hey Jeremy,</p>
<p>By the end of the CAB series, wouldn&#8217;t it be nice if you could release a sample application demonstrating all the CAB patterns you&#8217;ve shown us here?</p>
<p>Sometimes, reading your posts, I kinda of miss a good way to see the &#8220;big picture&#8221;, and maybe a sample app would do it. What da ya think?</p>
<p>Anyway, keep it coming, it&#8217;s been great!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2887">
                    <div id="dsq-comment-header-2887" class="dsq-comment-header">
                        <cite id="dsq-cite-2887">
    http://blog.omega-prime.co.uk                            <span id="dsq-author-user-2887">Max</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2887" class="dsq-comment-body">
                        <div id="dsq-comment-message-2887" class="dsq-comment-message"><p>Another great post Jeremy, thanks a lot <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> . I&#8217;ll certainly be buying your book when it&#8217;s released!</p>
<p>A possible extension here might be to use PropertyDescriptors instead of reflection for the GetValue business, as this would let you do things like use the ComponentModel Description stuff to fill out label text via your fluent API..</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2888">
                    <div id="dsq-comment-header-2888" class="dsq-comment-header">
                        <cite id="dsq-cite-2888">
    http://codebetter.com/blogs/david_laribee/                            <span id="dsq-author-user-2888">Dave Laribee</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2888" class="dsq-comment-body">
                        <div id="dsq-comment-message-2888" class="dsq-comment-message"><p>this is a print-and-read, but YAY! <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>now what to pester you about next&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2889">
                    <div id="dsq-comment-header-2889" class="dsq-comment-header">
                        <cite id="dsq-cite-2889">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2889">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2889" class="dsq-comment-body">
                        <div id="dsq-comment-message-2889" class="dsq-comment-message"><p>How about, Jeremy/David go finish your DevTeach talks?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2890">
                    <div id="dsq-comment-header-2890" class="dsq-comment-header">
                        <cite id="dsq-cite-2890">
    http://garoyeri.blogspot.com                            <span id="dsq-author-user-2890">Garo Yeriazarian</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2890" class="dsq-comment-body">
                        <div id="dsq-comment-message-2890" class="dsq-comment-message"><p>Wow, I&#8217;m implementing MVP in WinForms and I&#8217;m slowly running into some of the issues you are discussing (and I&#8217;m sure I&#8217;ll run into the rest as I get further in).  I really like the idea of MicroControllers, I currently have my binder class that knows how to tie certain types of controls to properties, but your approach is a lot more flexible.  I&#8217;m definitely going to have to read this through more thoroughly when I get a chance.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2891">
                    <div id="dsq-comment-header-2891" class="dsq-comment-header">
                        <cite id="dsq-cite-2891">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2891">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2891" class="dsq-comment-body">
                        <div id="dsq-comment-message-2891" class="dsq-comment-message"><p>Coincidentally Garo, I&#8217;ve been reading your posts on the same subject over the last couple days and the altnetconf discussion</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2892">
                    <div id="dsq-comment-header-2892" class="dsq-comment-header">
                        <cite id="dsq-cite-2892">
    http://garoyeri.blogspot.com                            <span id="dsq-author-user-2892">Garo Yeriazarian</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2892" class="dsq-comment-body">
                        <div id="dsq-comment-message-2892" class="dsq-comment-message"><p>Once I get some more pieces of my project posted, I&#8217;d really appreciate your comments on it.  We&#8217;re eventually going to go to CAB to standardize and I&#8217;m slowly working our existing architecture to something that would fit more easily into CAB.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2893">
                    <div id="dsq-comment-header-2893" class="dsq-comment-header">
                        <cite id="dsq-cite-2893">
                                <span id="dsq-author-user-2893">Paul</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2893" class="dsq-comment-body">
                        <div id="dsq-comment-message-2893" class="dsq-comment-message"><p>Just found your page as one of our new contractors at work, who i&#8217;m watching over is implement this exact thing. Nice high level of programming and very interesting. Watching out for the next post <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2894">
                    <div id="dsq-comment-header-2894" class="dsq-comment-header">
                        <cite id="dsq-cite-2894">
                                <span id="dsq-author-user-2894">Richard</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2894" class="dsq-comment-body">
                        <div id="dsq-comment-message-2894" class="dsq-comment-message"><p>Great post. It summarises what we have already tried to put together and abstracts the concepts nicely. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2895">
                    <div id="dsq-comment-header-2895" class="dsq-comment-header">
                        <cite id="dsq-cite-2895">
                                <span id="dsq-author-user-2895">Shane Courtrille</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2895" class="dsq-comment-body">
                        <div id="dsq-comment-message-2895" class="dsq-comment-message"><p>Awesome post.. I just got caught up with the series but I did have one question.</p>
<p>When you mention the model in relation to code gen and something like TradeFields are you talking about your domain model?  If not how do they relate to each other?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2896">
                    <div id="dsq-comment-header-2896" class="dsq-comment-header">
                        <cite id="dsq-cite-2896">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2896">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2896" class="dsq-comment-body">
                        <div id="dsq-comment-message-2896" class="dsq-comment-message"><p>@Shane,</p>
<p>I have a crude little codegen tool that simply creates a structure of constants for each Property in the Model.  It&#8217;s just a command line executable.  On a post build event on the assembly that has my domain model I run this tool to regenerate the constants file for use in the UserInterface assembly.  I also codegen Fit Fixture classes to set and check properties on my Domain Model classes as a testing shortcut.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2897">
                    <div id="dsq-comment-header-2897" class="dsq-comment-header">
                        <cite id="dsq-cite-2897">
                                <span id="dsq-author-user-2897">Paul Hatcher</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2897" class="dsq-comment-body">
                        <div id="dsq-comment-message-2897" class="dsq-comment-message"><p>Jeremy</p>
<p>Any chance of an example that shows use of the AddChild method for composing IScreenBinder and also how this plays with composite controls, e.g. I produce an Address control with Street, City, State &#038; ZipCode which should bind to my Customer&#8217;s Address object?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2898">
                    <div id="dsq-comment-header-2898" class="dsq-comment-header">
                        <cite id="dsq-cite-2898">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2898">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2898" class="dsq-comment-body">
                        <div id="dsq-comment-message-2898" class="dsq-comment-message"><p>Paul,</p>
<p>Give me a day or two on that one and I&#8217;ll post something at lunch.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2899">
                    <div id="dsq-comment-header-2899" class="dsq-comment-header">
                        <cite id="dsq-cite-2899">
                                <span id="dsq-author-user-2899">Blake</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2899" class="dsq-comment-body">
                        <div id="dsq-comment-message-2899" class="dsq-comment-message"><p>Great post as usual.  Do you plan to post an example of using this approach with a DataGridView?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2900">
                    <div id="dsq-comment-header-2900" class="dsq-comment-header">
                        <cite id="dsq-cite-2900">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2900">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2900" class="dsq-comment-body">
                        <div id="dsq-comment-message-2900" class="dsq-comment-message"><p>@Blake,</p>
<p>I hadn&#8217;t thought about it.  I&#8217;m not sure that sounds like that great of an idea offhand.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2901">
                    <div id="dsq-comment-header-2901" class="dsq-comment-header">
                        <cite id="dsq-cite-2901">
                                <span id="dsq-author-user-2901">Blake</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2901" class="dsq-comment-body">
                        <div id="dsq-comment-message-2901" class="dsq-comment-message"><p>Right.  I frequently encounter display logic tasks such as &#8220;If the user navigates to a row with a value of &#8216;X&#8217; in field &#8216;ItemType&#8217;, lock column &#8216;Cost&#8217;.  Otherwise, unlock column &#8216;Cost&#8217;.&#8221;  In such a case, the presenter would need to be able to track the current row in the grid and be able to manipulate the grid.  Currently, I&#8217;m doing this in the view in response to DataGridView events, which means it isn&#8217;t very testable.  There are other tricky tasks, too, such as monitoring/controlling the selected rows in the grid.  Do you deal with grids much?  Any insight into working with them?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2902">
                    <div id="dsq-comment-header-2902" class="dsq-comment-header">
                        <cite id="dsq-cite-2902">
                                <span id="dsq-author-user-2902">Steve</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2902" class="dsq-comment-body">
                        <div id="dsq-comment-message-2902" class="dsq-comment-message"><p>Blake,</p>
<p>I believe this kind of technique would be pretty difficult to implement on standard  WinForms DataGridView without first writing a ton of plumbing code.  It is, however, fairly easy to implement using 3rd party grids that already have lots of baked in functionality like DevExpress, Infragistics, SyncFusion, etc.  </p>
<p>I have implemented a similar solution with DevExpress grid.  I defined an IGridController<t> interface which is similar to Jeremy&#8217;s IScreenElement, basically allows the grid to be bound and basic functionality of the grid itself to be controlled, T is the type of GridView to be controlled.  Then there is IGridRowController</t><t> where T is the type of entity bound to that row, and the row controller then controls IGridCellElement</t><t , U> where T is the type of cell editor and U is the data type.  Then I define classes which inherit from DevExpress GridControl, GridView, GridRow and GridCell classes and implement the above interfaces.</p>
<p>One thing you have to be careful about is ensuring the controllers aren&#8217;t keeping the grid rows and cells from being garbage collected, that will send your memory usage through the roof pretty quickly  =)</t></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2903">
                    <div id="dsq-comment-header-2903" class="dsq-comment-header">
                        <cite id="dsq-cite-2903">
                                <span id="dsq-author-user-2903">Blake</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2903" class="dsq-comment-body">
                        <div id="dsq-comment-message-2903" class="dsq-comment-message"><p>Steve,<br />
  I had considered a similar approach for the DataGridView, but eventually shied away from it.  It sounds like you&#8217;re having success with it, and that&#8217;s good to know in case I venture back to it in the future.  Another, perhaps less elegant, solution I had considered involved creating components that could be dropped onto the design surface.  Such a component would expose a DataGridView property that would tell the component which DataGridView to monitor (i.e. catch events) and update (i.e. hide columns).  The component could be written to delegate the display logic to another entity or it could have the display logic built-in.  Either way, the logic should be easily testable since it has been removed from the form.  I haven&#8217;t attempted this approach yet, so who knows what kind of pitfalls it might entail!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2904">
                    <div id="dsq-comment-header-2904" class="dsq-comment-header">
                        <cite id="dsq-cite-2904">
    http://kentb.blogspot.com                            <span id="dsq-author-user-2904">Kent Boogaart</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2904" class="dsq-comment-body">
                        <div id="dsq-comment-message-2904" class="dsq-comment-message"><p>Hi Jeremy,</p>
<p>I know I&#8217;m late to this party, but I have a few comments/questions:</p>
<p>1. I agree that using the Winforms designer to set up bindings leads to pain in the long term. To that end, I typically write an InitializeBindings() method in my views that does this in code, much the same as your view&#8217;s Bind(IScreenBinder) method. I use the Winforms Binding class directly, though. Apart from not using a fluent interface (which could be added), the only disadvantage I can see compared to your approach is that you&#8217;re limited to what Winforms actually supports. Radio buttons, for example, just don&#8217;t support binding. Do you agree?</p>
<p>2. You mention that such a micro controller approach might be beneficial to WPF, but I tend to disagree. Unless you&#8217;re using the WPF designer (does anyone? I&#8217;m not sure), then the binding information is right where you expect it. Moving it to the code behind would make things more disparate and harder to grok, in my opinion. Then again, you could solve problems such as not being able to correctly bind radio buttons (yep, still a problem in WPF).</p>
<p>3. +1 on more info around doing this sort of thing with grids and other more complex controls. The typical LOB app has a whole bunch of grids in it, so it would be nice to see more guidance on achieving similar results with those kind of interfaces.</p>
<p>Thanks,<br />
Kent</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2905">
                    <div id="dsq-comment-header-2905" class="dsq-comment-header">
                        <cite id="dsq-cite-2905">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-2905">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2905" class="dsq-comment-body">
                        <div id="dsq-comment-message-2905" class="dsq-comment-message"><p>@Kent,</p>
<p>Thanks for the comment Kent.  Keep in mind it&#8217;s mostly just my pet way of doing screen synchronization and little screen behaviors.</p>
<p>&#8220;Radio buttons, for example, just don&#8217;t support binding. Do you agree?&#8221;</p>
<p>Yeah, I agree with you there.  I made data binding with radio buttons work, but it was one of the harder tasks we hit with the ScreenBinder.  I think that was the only place I had to fire up Reflector on the WinForms code (and came away wishing that I hadn&#8217;t looked there).  I think we definitely made screen synchronization easier with radio buttons once the MicroController for it was in place.  I&#8217;d do the same thing for tabbing controls embedded in screens that effectively act as radio buttons.</p>
<p>Data binding / screen synchronization is only one part of what the MicroControllers gave us.  When I move to WPF I might just have the fluent interface (FI) set up the WPF data binding, but there&#8217;s a lot of other &#8220;goodness&#8221; we are getting out of MicroControllers that goes beyond what data binding does.  If nothing else, the &#8220;latch&#8221; functionality, the testing support, and the repetitive behavior aspects pay for it, </p>
<p>&#8220;Moving it to the code behind would make things more disparate and harder to grok, in my opinion&#8221;</p>
<p>Actually, I&#8217;m going to disagree.  Not MicroControllers themselves, but the Fluent Interface mini language over the top can compress the behavioral code of a screen down to a much smaller surface area, making a complex screen easier to understand because all the behavior is in one place.  Add in C# 3.0 language constructs, and I think the DSL for screen behavior gets tighter and easier to read.  Xaml may be 10x better than the WinForms designer, but it&#8217;s still Xml, and angle brackets are noisy code.</p>
<p>On grids, I couldn&#8217;t agree more.  I&#8217;ve never met a 3rd party Grid API yet that didn&#8217;t suck.  I&#8217;m talking quite a bit with Ward Bell this week.  Both of us write some sort of  app-specific &#8220;GridHelper&#8221; classes.   I&#8217;ve been arguing that when we&#8217;re all doing Silverlight  and WPF work where dynamic layouts are sooooo much easier, that it&#8217;s going to be viable to roll your own simplistic Grid controls just to have an API that doesn&#8217;t suck.</p>
<p>In the end it&#8217;s kind of a moot point.  It&#8217;ll be at least the fall before I consider moving some of this to WPF. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2906">
                    <div id="dsq-comment-header-2906" class="dsq-comment-header">
                        <cite id="dsq-cite-2906">
                                <span id="dsq-author-user-2906">Mark</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2906" class="dsq-comment-body">
                        <div id="dsq-comment-message-2906" class="dsq-comment-message"><p>We did something similar mapping field elements to Domain Object properties by name.  It saved a lot of manual wiring and allowed us to do the data binding as user&#8217;s expect it to work.  It seems to work pretty well, I just can&#8217;t believe we *still* need to write this stuff ourselves.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-7298">
                    <div id="dsq-comment-header-7298" class="dsq-comment-header">
                        <cite id="dsq-cite-7298">
                                <span id="dsq-author-user-7298">amita sexana</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-7298" class="dsq-comment-body">
                        <div id="dsq-comment-message-7298" class="dsq-comment-message"><p><a href="http://www.access-file-repair.com" rel="nofollow">MS Access Repair Software</a><br />
<a href="http://www.accesspasswordrecovery.org" rel="nofollow">access password recovery</a><br />
<a href="http://www.accesspasswordrecovery.ws" rel="nofollow">Access Password Recovery Tool</a><br />
<a href="http://www.access-unlocker.com" rel="nofollow">MS Access Password Recovery</a><br />
<a href="http://www.excelfix.net" rel="nofollow">Excel Recovery</a><br />
<a href="http://www.bhartitechnology.com" rel="nofollow">download free key logger</a><br />
<a href="http://www.accesspasswordrecovery.us" rel="nofollow">Access Password Recovery</a><br />
<a href="http://www.chatdatarecovery.com" rel="nofollow">Chat Archive Recovery</a><br />
<a href="http://www.database-conversion.org" rel="nofollow">Database conversion software</a><br />
<a href="http://www.excel-file-repair.com" rel="nofollow">Excel file repair</a><br />
<a href="http://www.datarecoveryfreetrial.org" rel="nofollow">Data Recovery Tool</a><br />
<a href="http://www.eaglecop.us" rel="nofollow">Web Hosting</a><br />
<a href="http://www.data-wiper.ws" rel="nofollow">Data wiper software</a><br />
<a href="http://www.digitalcameradatarecovery.com" rel="nofollow">Digital camera photo recovery software</a><br />
<a href="http://www.diskrecovery.ws" rel="nofollow">Disk Recovery Software</a><br />
<a href="http://www.eaglecop.com" rel="nofollow">Data recovery software free download</a><br />
<a href="http://www.database-converter.com" rel="nofollow">Database Converters</a><br />
<a href="http://www.employee-monitoring.ws" rel="nofollow">Free Keylogger</a><br />
<a href="http://www.excelfilerecovery.ws" rel="nofollow">Excel Files Recovery</a><br />
<a href="http://www.access-unlocker.org" rel="nofollow">MS Access Password Recovery Tool</a><br />
<a href="http://www.excelrecovery.ws" rel="nofollow">Excel Recovery</a><br />
<a href="http://www.keyloggerdownload.us" rel="nofollow">free keylogger software</a><br />
<a href="http://www.floppyrecovery.ws" rel="nofollow">Floppy Recovery</a><br />
<a href="http://www.excelrepair.us" rel="nofollow">Excel Repair Software</a><br />
<a href="http://www.filesrepair.org" rel="nofollow">How to Repair Corrupted Excel Files</a><br />
<a href="http://www.find-msn-password.ws" rel="nofollow">recover msn password</a><br />
<a href="http://www.fixexcelfile.com" rel="nofollow">Excel recovery Software</a><br />
<a href="http://www.floppydatarecovery.ws" rel="nofollow">Floppy Disk Recovery</a><br />
<a href="http://www.harddiskrecovery.ws" rel="nofollow">Windows Data Recovery</a><br />
<a href="http://www.freewarekeylogger.ws" rel="nofollow">Keystroke Logger</a><br />
<a href="http://www.harddrivedatarecovery.ws" rel="nofollow">Hard drive data recovery</a><br />
<a href="http://www.freeexcelrecovery.com" rel="nofollow">Recover My Excel Files</a><br />
<a href="http://www.harddisk-recovery.ws" rel="nofollow">Windows Recovery Tools</a><br />
<a href="http://www.internetpasswordrecovery.ws" rel="nofollow">IE Password Recovery</a><br />
<a href="http://www.ipodrecovery.ws" rel="nofollow">IPod Recovery</a><br />
<a href="http://www.key-logger.us" rel="nofollow">Key logger</a><br />
<a href="http://www.excelrecoveryfreeware.com" rel="nofollow">Excel Recovery Tool</a><br />
<a href="http://www.keyloggerdownload.ws" rel="nofollow">download a free keylogger</a><br />
<a href="http://www.keyloggers.ws" rel="nofollow">keyloggers free</a><br />
<a href="http://www.keyloggersoftwaredownload.com" rel="nofollow">keylogger freeware</a><br />
<a href="http://www.keyloggerspysoftware.ws" rel="nofollow">Keylogger Spy Software</a><br />
<a href="http://www.key-logging-software.org" rel="nofollow">keylogger software free</a><br />
<a href="http://www.keystrokecapture.us" rel="nofollow">keystroke capture</a><br />
<a href="http://www.keystrokecapture.ws" rel="nofollow">Keylogger</a><br />
<a href="http://www.passwordrecovery.biz" rel="nofollow">Recovery Password</a><br />
<a href="http://www.keystroke-logging.ws" rel="nofollow">free keylogger downloads</a><br />
<a href="http://www.keystrokesrecorder.org" rel="nofollow">best keylogger free</a><br />
<a href="http://www.msnpasswordrecovery.ws" rel="nofollow">msn password recovery</a><br />
<a href="http://www.outlookpasswordrecovery.us" rel="nofollow">Free Download Outlook Express Password Recovery Software</a><br />
<a href="http://www.password-finder.ws" rel="nofollow">password finder</a><br />
<a href="http://www.keystroke-logger.org" rel="nofollow">Keylogger Software Download</a><br />
<a href="http://www.passwordrecovery.ws" rel="nofollow">Password Recovery</a><br />
<a href="http://www.passwordrecoverysoftware.org" rel="nofollow">password recovery software</a><br />
<a href="http://www.password-recovery-software.ws" rel="nofollow">password recovery software free</a><br />
<a href="http://www.pendrivedatarecovery.com" rel="nofollow">pen drive data recovery software</a><br />
<a href="http://www.pendrivedatarecovery.ws" rel="nofollow">Pen Drive Recovery</a><br />
<a href="http://www.powerpoint-file-repair.com" rel="nofollow">PowerPoint Repair Tool</a><br />
<a href="http://www.recoverchatdata.com" rel="nofollow">Chat Recovery Software</a><br />
<a href="http://www.recoverexcel.ws" rel="nofollow">Recover Excel Software</a><br />
<a href="http://www.recoverexcelfile.org" rel="nofollow">Fix Excel files</a><br />
<a href="http://www.recovermails.org" rel="nofollow">Email Recovery</a><br />
<a href="http://www.recoversms.com" rel="nofollow">Mobile phone data recovery software</a><br />
<a href="http://www.recoveryforexcel.com" rel="nofollow">recovery for excel</a><br />
<a href="http://www.repairexcel.ws" rel="nofollow">Repair Excel Files</a><br />
<a href="http://www.repairexcelfiles.com" rel="nofollow">Advanced Excel Repair</a><br />
<a href="http://www.restoredata.ws" rel="nofollow">Data Recovery Software</a><br />
<a href="http://www.restoresim.com" rel="nofollow">Sim Card Recovery</a><br />
<a href="http://www.restoresim.org" rel="nofollow">SIM Card Data Recovery</a><br />
<a href="http://www.sanmaxi.biz" rel="nofollow">Key logger software</a><br />
<a href="http://www.sanmaxi.com" rel="nofollow">downloadable keylogger</a><br />
<a href="http://www.sanmaxi.info" rel="nofollow">download keylogger freeware</a><br />
<a href="http://www.sanmaxi.net" rel="nofollow">free invisible keylogger</a><br />
<a href="http://www.sanmaxi.org" rel="nofollow">data recovery</a><br />
<a href="http://www.sanmaxi.us" rel="nofollow">Download Free Keylogger</a><br />
<a href="http://www.sanmaxi.ws" rel="nofollow">keystroke recorder</a><br />
<a href="http://www.sanmaxisoftware.com" rel="nofollow">software keylogger</a><br />
<a href="http://www.sanmaxisoftware.org" rel="nofollow">remote key logger</a><br />
<a href="http://www.simrecovery.biz" rel="nofollow">SIM card recovery software</a><br />
<a href="http://www.simrecovery.us" rel="nofollow">SIM card data recovery software</a><br />
<a href="http://www.backlinkchaker.com" rel="nofollow">Backlinks Checker Tool</a><br />
<a href="http://www.soico.net" rel="nofollow">remote keylogger free</a><br />
<a href="http://www.spysoftware.ws" rel="nofollow">Spy Keylogger</a><br />
<a href="http://www.usbdriverecovery.ws" rel="nofollow">USB drive data recovery</a><br />
<a href="http://www.freebacklinkfinder.com" rel="nofollow">Free Backlink Finder Tool</a><br />
<a href="http://www.datarecoverytrial.com" rel="nofollow">datarecovery</a><br />
<a href="http://www.zip-repair.org" rel="nofollow">Recover ZIP files</a><br />
<a href="http://www.key-logger.ws" rel="nofollow">keylogger</a><br />
<a href="http://www.datarecoverysoftwaretrial.ws" rel="nofollow">Data recovery software for NTFS</a><br />
<a href="http://www.datarecoverytrialdownload.com" rel="nofollow">Recovery Format Data</a><br />
<a href="http://www.datarecoverytrialsoftware.com" rel="nofollow">Partition recovery software</a><br />
<a href="http://www.eaglecop.org" rel="nofollow">SEO</a><br />
<a href="http://www.backlinkschecker.ws" rel="nofollow">Backlinks Checker</a><br />
<a href="http://www.simrecovery.ws" rel="nofollow">Mobile Phone Sim Card Recovery</a><br />
<a href="http://www.word-file-repair.com" rel="nofollow">Word File Repair Tool</a><br />
<a href="http://www.datarecoveryfreetrial.com" rel="nofollow">data recovery services</a></p>
<p>Thank you for you to tell us more interesting information, Thank you</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2007/10/22/build-your-own-cab-15-microcontrollers/';
    var disqus_identifier = '444 /blogs/jeremy.miller/archive/2007/10/21/build-your-own-cab-15-microcontrollers.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "Build your own CAB #15 &#8211; MicroControllers";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=444');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2007\/10\/22\/build-your-own-cab-15-microcontrollers\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.677 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 12:43:42 -->
<!-- super cache -->