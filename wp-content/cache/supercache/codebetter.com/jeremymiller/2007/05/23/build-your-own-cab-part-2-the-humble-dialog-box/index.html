<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Build your own CAB Part #2 &#8211; The Humble Dialog Box | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='New .Net group in Westchester (NY) &amp; Fairfield County (CT)' href='http://codebetter.com/jeremymiller/2007/05/22/new-net-group-in-westchester-ny-amp-fairfield-county-ct/' />
<link rel='next' title='Build your own CAB Part #3 &#8211; The Supervising Controller Pattern' href='http://codebetter.com/jeremymiller/2007/05/25/build-you-own-cab-part-3-the-supervising-controller-pattern/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=343' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,165] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-343" class="post-343 post type-post status-publish format-standard hentry category-build-your-own-cab category-design-patterns category-test-driven-development">
					<h1 class="entry-title">Build your own CAB Part #2 &#8211; The Humble Dialog Box</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box/" title="11:29 am" rel="bookmark"><span class="entry-date">May 23, 2007</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><a href="http://codebetter.com/blogs/jeremy.miller/archive/2007/05/21/build-your-own-cab-part-1-the-preamble.aspx">When last we left our hero</a>, D&#8217;Artagnan&nbsp;was chasing&nbsp;the evil Lady de Winter across the breadth of France trying to intercept her on her dastardly mission when he found himself beset by disparate responsibilities within the tight&nbsp;confines of a single autonomous view with no room for sword play.&nbsp; D&#8217;Artagnan, being a perspicacious&nbsp;young man,&nbsp;quickly sees a way to&nbsp;separate&nbsp;the numerous concerns&nbsp;he&#8217;s facing by&nbsp;opening his attack with&#8230;</p>
<h4>The Humble Dialog Box&nbsp;</h4>
<p>I&#8217;d say the very first concept to grasp in software design is separation of concerns.&nbsp; Divide and conquer.&nbsp; Eat the elephant one bite at a time.&nbsp; Learning how to decompose a bigger problem into a series of approachable goals.&nbsp; I&#8217;d rather work serially on a screen&nbsp;by completing one simple task before moving onto the next instead of working with all aspects of a screen in parallel.&nbsp;&nbsp;Division of responsibility for easier programming is a major consideration by itself, but there&#8217;s another piece of motivation almost as important.&nbsp;&nbsp;Because user interface code can be very complex to debug and is prone to change based on user experience, I really, really&nbsp;want to extend granular unit testing with automated tests as far into the presentation layer as I possibly can.&nbsp; </p>
<p>Traditionally, user interface code has appeared to repel all but the most serious attempts at test automation.&nbsp; Automated testing against UI code was just flat out deemed too much work for the gain.&nbsp; That equation has changed over the last several years with the rise of architectures&nbsp;inspired by&nbsp;<a href="http://codebetter.com/blogs/jeremy.miller/articles/129546.aspx">The Humble Dialog Box</a> from Michael Feathers.&nbsp; </p>
<p>Here&#8217;s the canonical example of the Humble Dialog Box I use to explain the concept.&nbsp; Say you have a user screen for some sort of data entry.&nbsp; You have a requirement that reads something like:</p>
<blockquote><p>If the user attempts to close the XYZ screen without saving any outstanding changes, a message box is displayed to warn the user that they are discarding changes.&nbsp; If the user wishes to retain the outstanding work, do not close the screen.&nbsp; The message box should not be shown if the&nbsp;data has not been changed.</p>
</blockquote>
<p>It&#8217;s not that complex of a requirement really, but it&#8217;s the kind of thing that makes a user interface client easy and convenient to use.&nbsp; We want this code to work.&nbsp; The code for it might look like this:</p>
<div style="background: white none repeat scroll 0% 50%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">void</span> ArrogantView_Closing(<span style="color: blue">object</span> sender, <span style="color: teal">CancelEventArgs</span> e)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// Let&#8217;s not worry for now about how we figure out the screen has unsaved data</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (isDirty())</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">bool</span> canClose = <span style="color: teal">MessageBox</span>.Show(<span style="color: maroon">&#8220;Ok to discard changes or cancel to keep working&#8221;</span>) == <span style="color: teal">DialogResult</span>.OK;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; e.Cancel = !canClose;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
</div>
<p>That code really isn&#8217;t that complex,&nbsp;but let&#8217;s think about how we could&nbsp;automate a test for&nbsp;this requirement to run within our regression test suite.&nbsp; That little bitty call to MessageBox.Show() and the modal dialog box that results&nbsp;is a serious pain to deal with in an automated test (it is possible, and I&#8217;ve done it before, but I&#8217;d strongly recommend you keep reading before you run off and try it).&nbsp;&nbsp;Observing the UI&nbsp;getting closed or not is also tricky, but I think the worst part is&nbsp;that to test this logic you have to fire up the UI, navigate to the screen, change some data on the screen, then trigger the close screen request.&nbsp; That&#8217;s a lot of work just to get to the point at which you&#8217;re exercising the code you care about.</p>
<p>Now, let&#8217;s rewrite this feature as&nbsp;a &#8220;Humble&#8221; view, but&nbsp;before I show the new code, let&#8217;s talk about the Humble view&nbsp;philosophy.&nbsp; The first thing to do is to put the view on a diet.&nbsp; Any code in a WinForms&nbsp;UserControl or Form is almost automatically harder to test than it would be in a POCO.&nbsp; A Humble view should be the smallest possible wrapper around the actual presentation code.&nbsp; Going farther, I don&#8217;t want implementation details of the view mechanics to leak into other areas of the code, so I want to hide the View behind a POCO-ish interface.&nbsp; All that being said, the abstracted interface for our View could look like:</p>
<div style="background: white none repeat scroll 0% 50%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">interface</span> <span style="color: teal">IHumbleView</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">bool</span> IsDirty();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">bool</span> AskUserToDiscardChanges();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">void</span> Close();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>The view is also &#8220;passive,&#8221; meaning that it doesn&#8217;t really&nbsp;take any actions on its own without some sort of stimulus from outside the view.&nbsp; I&#8217;ll discuss handling user events in depth in a later chapter, but for now let&#8217;s just say that the view simply relays user input events to somewhere else with little or no interpretation.&nbsp; </p>
<p>One of the goals of a Humble view is to separate responsibilities.&nbsp; As in most designs, we want to&nbsp;assign&nbsp;different&nbsp;responsibilities to different areas of the code.&nbsp; In this case, we want to pull behavioral logic out of the view and&nbsp;into non-visual classes.&nbsp; If we put the view itself on a diet and pull out anything that isn&#8217;t directly related to presentation, that extra code that implements things like behavior and authorization rules has to go somewhere.&nbsp; In this case we&#8217;re going to move those responsibilities into a Presenter class:</p>
<div style="background: white none repeat scroll 0% 50%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: teal">OverseerPresenter</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span style="color: teal">IHumbleView</span> _view;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> OverseerPresenter(<span style="color: teal">IHumbleView</span> view)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _view = view;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> Close()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">bool</span> canClose = <span style="color: blue">true</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (_view.IsDirty())</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; canClose = _view.AskUserToDiscardChanges();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (canClose)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _view.Close();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>In particular, look at the Close() method.&nbsp; Some user event causes a call to the OverseerPresenter.Close() method.&nbsp; Inside this method we check the &#8220;dirty&#8221; state of the IHumbleView member and potentially ask the user to discard changes before proceeding to close the actual view.&nbsp; It&#8217;s just about the exact same code, only now we can write an automated unit test to express this logic &#8212; with just a little help from our good friend RhinoMocks.</p>
<div style="background: white none repeat scroll 0% 50%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; [<span style="color: teal">TestFixture</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: teal">OverseerPresenterTester</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<span style="color: teal">Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> CloseTheScreenWhenTheScreenIsNotDirty()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">MockRepository</span> mocks = <span style="color: blue">new</span> <span style="color: teal">MockRepository</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">IHumbleView</span> view = mocks.CreateMock&lt;<span style="color: teal">IHumbleView</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Expect</span>.Call(view.IsDirty()).Return(<span style="color: blue">false</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; view.Close();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.ReplayAll();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">OverseerPresenter</span> presenter = <span style="color: blue">new</span> <span style="color: teal">OverseerPresenter</span>(view);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; presenter.Close();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.VerifyAll();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<span style="color: teal">Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> CloseTheScreenWhenTheScreenIsDirtyAndTheUserDecidesToDiscardTheChanges()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">MockRepository</span> mocks = <span style="color: blue">new</span> <span style="color: teal">MockRepository</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">IHumbleView</span> view = mocks.CreateMock&lt;<span style="color: teal">IHumbleView</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Expect</span>.Call(view.IsDirty()).Return(<span style="color: blue">true</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Expect</span>.Call(view.AskUserToDiscardChanges()).Return(<span style="color: blue">true</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; view.Close();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.ReplayAll();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">OverseerPresenter</span> presenter = <span style="color: blue">new</span> <span style="color: teal">OverseerPresenter</span>(view);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; presenter.Close();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.VerifyAll();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<span style="color: teal">Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> CloseTheScreenWhenTheScreenIsDirtyAndTheUserDecidesNOTToDiscardTheChanges()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">MockRepository</span> mocks = <span style="color: blue">new</span> <span style="color: teal">MockRepository</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">IHumbleView</span> view = mocks.CreateMock&lt;<span style="color: teal">IHumbleView</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Expect</span>.Call(view.IsDirty()).Return(<span style="color: blue">true</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">Expect</span>.Call(view.AskUserToDiscardChanges()).Return(<span style="color: blue">false</span>);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// No call should be made to view.Close()</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: green">// view.Close();</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.ReplayAll();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: teal">OverseerPresenter</span> presenter = <span style="color: blue">new</span> <span style="color: teal">OverseerPresenter</span>(view);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; presenter.Close();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mocks.VerifyAll();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>So I know what you might be thinking, what have I really gained here?&nbsp; Let me try to answer this:</p>
<ul>
<li>Orthogonality.&nbsp; We&#8217;ve moved behavioral logic out of the actual view.&nbsp; We can change the presentation or the behavior independently.&nbsp; That is a big deal.&nbsp;</li>
<li>The screen behavior is easier to understand.&nbsp; I&#8217;m going to argue that this is a case of <a href="http://weblog.raganwald.com/2006/01/finding-signal-to-noise-ratio-in-never.html">Reg Braithwaite&#8217;s Signal to Noise Ratio in code</a>&nbsp;(basically, expressing the intent of the code with little code that isn&#8217;t directly related to the intent).&nbsp; When I want to understand the screen behavior, that behavior is the only signal I care about.&nbsp; Seeing (<span style="color: blue">object</span> sender, <span style="color: teal">CancelEventArgs</span> e) everywhere in the middle of the behavioral code is noise.&nbsp; The converse is true as well when I&#8217;m working on the presentation itself.</li>
<li>The screen behavior is easier to test and modify.&nbsp; That&#8217;s enough by itself to justify the Humble&nbsp;View style.&nbsp;&nbsp;What if this closing&nbsp;behavior changes tomorrow with a requirement to set a user&nbsp;preference to never ask users to discard changes?&nbsp; If I&#8217;m working in&nbsp;a Humble View style, I can probably make that screen behavior change completely, including unit tests,&nbsp;in the Presenter class by itself without ever having to fire up the user interface until the very last sanity check.&nbsp; Verifying little behavior changes with NUnit is a far, far tighter feedback cycle than doing the save verification by firing up the user interface and doing the manual input steps necessary to exercise the functionality.&nbsp; Tight feedback cycles == productivity.&nbsp; </li>
<li>By extending the reach of granular and automated unit tests farther into the potentially complex user interface code, we can drastically slow down the rate of screen defects getting through to the testers.&nbsp; If nothing else, we can knock down all the common uses of the user interface quickly through tests to give the testers more time to break the application with edge cases and exploratory testing.</li>
</ul>
<p>&nbsp;</p>
<p>An astute reader will note that we didn&#8217;t write any unit tests for the View.&nbsp; I&#8217;ll show an example in&nbsp;later chapters of testing the View itself, but the philosophy in general is to make the hard to test view code so simple as to be reliably verified by inspection alone.&nbsp; I.e.,&nbsp;you should make the View code so simple that it&#8217;s almost hard to screw it up.&nbsp;</p>
<p>&nbsp;</p>
<h4>A Taxonomy of Humble Views&nbsp;</h4>
<p>Arguably the first Humble View is the original Model View Controller architecture handed down, as basically everything good in software developer&nbsp;seems to be, from the Smalltalk community.&nbsp; As I&#8217;ve mentioned before, you can read about the evolution of the <a href="http://www.object-arts.com/papers/TwistingTheTriad.PDF">Model View Controller (MVC)&nbsp;pattern and the formulation of the Model View Presenter (MVP)&nbsp;patterns</a> that we&#8217;re mostly talking about in this series as user interface toolkits changed.</p>
<p>D&#8217;Artagnan&#8217;s masterful implementation of the Humble Dialog Box&nbsp;vanquishes his foes, but he knows he&#8217;ll need trusted companions now that the evil Lady de Winter surely knows he is in pursuit.&nbsp; Fortunately, D&#8217;Artagnan&#8217;s trusty three companions are riding hard to join him.&nbsp; D&#8217;Artagnan smiles to himself and imagines his friends coming around the bend in the road:</p>
<ol>
<li>Supervising Controller &#8212; I&#8217;m here to help the View with the harder cases!</li>
<li>Passive View &#8212; I only do what I&#8217;m told</li>
<li>Presentation Model &#8212; Just do what I do</li>
</ol>
<p>D&#8217;Artagnan sees dust rising in the air, a traveler is coming&#8230;</p>
<p>&nbsp;</p>
<p>To be continued in Part 3:&nbsp; Supervising Controller</p>
<ol>
<p>&nbsp;</p>
</ol>
<p>QUICK NOTE:&nbsp; I showed the MessageBox stuff happening as a consequence of calling a method on the IView interface.&nbsp; In the past I&#8217;ve also used some sort of IMessageBoxCreator interface to create message boxes directly.&nbsp; There are advantages either way. </p>
<div class="shr-publisher-343"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/build-your-own-cab/" title="View all posts in Build your own CAB" rel="category tag">Build your own CAB</a>, <a href="http://codebetter.com/jeremymiller/category/design-patterns/" title="View all posts in Design Patterns" rel="category tag">Design Patterns</a>, <a href="http://codebetter.com/jeremymiller/category/test-driven-development/" title="View all posts in Test Driven Development" rel="category tag">Test Driven Development</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box/" title="Permalink to Build your own CAB Part #2 &#8211; The Humble Dialog Box" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box/feed/" title="Comments RSS to Build your own CAB Part #2 &#8211; The Humble Dialog Box" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-343 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2007/05/22/new-net-group-in-westchester-ny-amp-fairfield-county-ct/" rel="prev"><span class="meta-nav">&larr;</span> New .Net group in Westchester (NY) &amp; Fairfield County (CT)</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2007/05/25/build-you-own-cab-part-3-the-supervising-controller-pattern/" rel="next">Build your own CAB Part #3 &#8211; The Supervising Controller Pattern <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-1981">
                    <div id="dsq-comment-header-1981" class="dsq-comment-header">
                        <cite id="dsq-cite-1981">
                                <span id="dsq-author-user-1981">DeveloperDan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1981" class="dsq-comment-body">
                        <div id="dsq-comment-message-1981" class="dsq-comment-message"><p>Great lesson Jeremy.  I&#8217;ve known it&#8217;s wrong for me to have so much code in the button_click events, but I&#8217;ve struggled with the best way to do that.  Any chance you&#8217;ll provide sample code downloads?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1982">
                    <div id="dsq-comment-header-1982" class="dsq-comment-header">
                        <cite id="dsq-cite-1982">
                                <span id="dsq-author-user-1982">ScottC</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1982" class="dsq-comment-body">
                        <div id="dsq-comment-message-1982" class="dsq-comment-message"><p>I&#8217;m hoping to see how to make the most of StructureMap as you continue this series also &#8212; Thanks Jeremy!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1983">
                    <div id="dsq-comment-header-1983" class="dsq-comment-header">
                        <cite id="dsq-cite-1983">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-1983">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1983" class="dsq-comment-body">
                        <div id="dsq-comment-message-1983" class="dsq-comment-message"><p>@DeveloperDan &#038; @ScottC -</p>
<p>Whoa!  One thing at a time.  I&#8217;ve got stuff for both topics, I&#8217;ve just got to get through more bad Three Musketeer references first.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1984">
                    <div id="dsq-comment-header-1984" class="dsq-comment-header">
                        <cite id="dsq-cite-1984">
    http://www.philosophicalgeek.com                            <span id="dsq-author-user-1984">Ben</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1984" class="dsq-comment-body">
                        <div id="dsq-comment-message-1984" class="dsq-comment-message"><p>Thanks for this series. I&#8217;m just starting to build my first larger, multiple-view, complex application in .Net, and I&#8217;m very interested in overall design guidelines like these. Thanks!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1985">
                    <div id="dsq-comment-header-1985" class="dsq-comment-header">
                        <cite id="dsq-cite-1985">
    http://scourtrille.wordpress.com                            <span id="dsq-author-user-1985">Shane Courtrille</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1985" class="dsq-comment-body">
                        <div id="dsq-comment-message-1985" class="dsq-comment-message"><p>Awesome second post</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1986">
                    <div id="dsq-comment-header-1986" class="dsq-comment-header">
                        <cite id="dsq-cite-1986">
    http://dmihalik.com                            <span id="dsq-author-user-1986">Dustin</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1986" class="dsq-comment-body">
                        <div id="dsq-comment-message-1986" class="dsq-comment-message"><p>Thank you for writing this series.  I&#8217;m very much looking forward to reading the rest.  Also, thanks for StructureMap.  It makes my job much easier.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1987">
                    <div id="dsq-comment-header-1987" class="dsq-comment-header">
                        <cite id="dsq-cite-1987">
                                <span id="dsq-author-user-1987">Dan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1987" class="dsq-comment-body">
                        <div id="dsq-comment-message-1987" class="dsq-comment-message"><p>Great post,<br />
I would love reading your view  on hooking up the M with the V and the P using an Ioc container.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1988">
                    <div id="dsq-comment-header-1988" class="dsq-comment-header">
                        <cite id="dsq-cite-1988">
    http://roytate.blogspot.com                            <span id="dsq-author-user-1988">Roy Tate</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1988" class="dsq-comment-body">
                        <div id="dsq-comment-message-1988" class="dsq-comment-message"><p>I always ask my fellow developers to write any production code so that we can use it from the command line or the web as well as from Windows Forms.  This usually forces some separation.  <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1989">
                    <div id="dsq-comment-header-1989" class="dsq-comment-header">
                        <cite id="dsq-cite-1989">
    http://www.elilopian.com/2007/05/31/the-humble-dialog-and-famous-musketeers/                            <span id="dsq-author-user-1989">Eli Lopian</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1989" class="dsq-comment-body">
                        <div id="dsq-comment-message-1989" class="dsq-comment-message"><p>Although MVC/MCP is a really nice Pattern, like many patterns, you have to know when to use them. For simple screens they are over-designed. Here is how d’Artagnan handles those simple dialogs (and manages to test them) </p>
<p>See <a href="http://www.elilopian.com/2007/05/31/the-humble-dialog-and-famous-musketeers/" rel="nofollow">http://www.elilopian.com/2007/05/31/the-humble-dialog-and-famous-musketeers/</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1990">
                    <div id="dsq-comment-header-1990" class="dsq-comment-header">
                        <cite id="dsq-cite-1990">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-1990">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1990" class="dsq-comment-body">
                        <div id="dsq-comment-message-1990" class="dsq-comment-message"><p>Eli,</p>
<p>It was a nice post, but I don&#8217;t think you ever put enough importance on separation of concerns.  Yes, TypeMock is clever as hell and it makes some of the &#8220;Mock Driven&#8221; design go away, but separation of concerns is important even if it isn&#8217;t necessary for testability.  My fear with TypeMock is that people will use it as a crutch for bad design.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1991">
                    <div id="dsq-comment-header-1991" class="dsq-comment-header">
                        <cite id="dsq-cite-1991">
    http://www.elilopian.com/2007/05/31/the-humble-dialog-and-famous-musketeers/                            <span id="dsq-author-user-1991">Eli Lopian</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1991" class="dsq-comment-body">
                        <div id="dsq-comment-message-1991" class="dsq-comment-message"><p>Jeremy,</p>
<p>I want to Quote You<br />
&#8220;but let&#8217;s think about how we could automate a test for this requirement to run within our regression test suite.That little bitty call to MessageBox.Show() and the modal dialog box that results is a serious pain to deal with in an automated test&#8221;<br />
This is what you based the need to change the design. I am challenging this. You never talked about separation of concern in this article or said that the design was bad &#8211; only that you cannot automate the tests.</p>
<p>Now to quell your fears:<br />
Having a good design is one of the responsibilities of the developer / team leader. You must refactor your code to get the best design. Seperation of concerns is one of the many design factors, as well as YAGNI, SRP and more. This should have nothing to do with the tools you use. </p>
<p>Tests are a safety net that allows you to change your code/design, not twist your arm into using only one Pattern.</p>
<p>Using this technique will allow you to refactor the code into MVP (in the future, when you really need it), but add value to your customers by having the feature simply designed. That is what agile is about.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1992">
                    <div id="dsq-comment-header-1992" class="dsq-comment-header">
                        <cite id="dsq-cite-1992">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-1992">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1992" class="dsq-comment-body">
                        <div id="dsq-comment-message-1992" class="dsq-comment-message"><p>Eli,</p>
<p>Fair enough, but I most certainly did talk about responsibilities and separation of concerns in the other posts in this series.  The MessageBox is a simplistic example, but an easy one to use.  I would go for MVP in all but the most simple screens.</p>
<p>Going to an IMessageBoxCreator frankly isn&#8217;t all that difficult, and helps more in full blown integrated testing as well.</p>
<p>&#8220;Having a good design is one of the responsibilities of the developer / team leader. You must refactor your code to get the best design. Seperation of concerns is one of the many design factors, as well as YAGNI, SRP and more. This should have nothing to do with the tools you use.&#8221;</p>
<p>Cool, now *you* go say that somewhere please.  You know full well that people are interpreting TypeMock and your &#8220;no designing for testability any longer&#8221; statements to mean that they don&#8217;t have to take as much care with design.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1993">
                    <div id="dsq-comment-header-1993" class="dsq-comment-header">
                        <cite id="dsq-cite-1993">
    http://www.elilopian.com/2007/05/31/the-humble-dialog-and-famous-musketeers/                            <span id="dsq-author-user-1993">Eli Lopian</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1993" class="dsq-comment-body">
                        <div id="dsq-comment-message-1993" class="dsq-comment-message"><p>Where ever did you get that idea from:<br />
&#8220;people are interpreting TypeMock and your &#8220;no designing for testability any longer&#8221; statements to mean that they don&#8217;t have to take as much care with design. &#8221;</p>
<p>The opposite is correct. I have always said -> Business Drives Design as opposed to being testable drives design.</p>
<p>You know very well that people are interpreting &#8220;Testable&#8221; to mean, &#8220;if I am Testable then I have a good design&#8221;, so I don&#8217;t have to think of designing any more.  I recall that TDD should be:<br />
Write Test -> Write Code -> Refactor.<br />
Not:<br />
Design (for testability)->Write Test->Write Code. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1994">
                    <div id="dsq-comment-header-1994" class="dsq-comment-header">
                        <cite id="dsq-cite-1994">
                                <span id="dsq-author-user-1994">JohnV</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1994" class="dsq-comment-body">
                        <div id="dsq-comment-message-1994" class="dsq-comment-message"><p>I don&#8217;t quite understand this code. If the screen is Dirty and the user Decides NOT To Discard the Changes, shouldn&#8217;t we keep the screen open. In that case wouldn&#8217;t  &#8220;DoNOTCloseTheScreenWhenTheScreenIsDirtyAndTheUserDecidesNOTToDiscardTheChanges&#8221; be a better name? I used NMock2 to do this and so I had a line in there to show that Close is NOT Called:</p>
<p>Expect.Never.On( mockview ).<br />
        Method( &#8220;Close&#8221; );</p>
<p>Is there a way to do something similar for RhinoMocks? I know this is a record replay type of thing so if we don&#8217;t record that action we are saying that it does NOT happen?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1995">
                    <div id="dsq-comment-header-1995" class="dsq-comment-header">
                        <cite id="dsq-cite-1995">
                                <span id="dsq-author-user-1995">Pascal Laurin</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1995" class="dsq-comment-body">
                        <div id="dsq-comment-message-1995" class="dsq-comment-message"><p>@Jeremy</p>
<p>I must agree with Eli that it&#8217;s important not to put the priority on:</p>
<p>Design (for testability) ->Write Test->Write Code</p>
<p>before</p>
<p>Write Test -> Write Code -> Refactor</p>
<p>I guess the experience you gathered lead you to sometimes skip a few steps the rest of us still need tackle before really understand *why* it&#8217;s better to design the application in *that* specific way.  And mind you, every project has their own problems and there is just not the one solution for all the cases.</p>
<p>I think your Build your own CAB series should be taken only as an example and not *the* CAB solution for every project.  But that&#8217;s the readers’ job to be objective about it.</p>
<p>That&#8217;s the way I fell reading it and I do like your posts a lot.  I&#8217;m sure I&#8217;ll be looking back at your CAB design when ever I&#8217;ll start a new project. </p>
<p>@Eli</p>
<p>If you never had problem dealing with MessageBox in your testing then fine but that might not always be the case.</p>
<p>At my current job we needed some kind of automated acceptance testing.  I must tell you that the MessageBox problem was one of the many problems related to UI design and usage we had while implementing our testing framework.</p>
<p>Again, if your needs are not the same than ours then using the MessageBox class directly might be Ok.  Just keep in mind that it may be just another technical debt you&#8217;re introducing into your code base.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1996">
                    <div id="dsq-comment-header-1996" class="dsq-comment-header">
                        <cite id="dsq-cite-1996">
    http://mattwynne.wordpress.com                            <span id="dsq-author-user-1996">Matt Wynne</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1996" class="dsq-comment-body">
                        <div id="dsq-comment-message-1996" class="dsq-comment-message"><p>Jeremy,</p>
<p>Thanks for your insightfull blogs posts about the MVP pattern recently, you have been a guiding light amongst a lot of confused and confusing interpretations of this pattern as I try to implement it on our application.</p>
<p>Having had to go and refactor some of our earlier (and slightly misguided) implementation of the pattern I wrote up what I&#8217;d learned here[1] &#8211; I&#8217;d love to know your thoughts.</p>
<p>[1]http://mattwynne.wordpress.com/2007/06/13/mvp-smells/</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1997">
                    <div id="dsq-comment-header-1997" class="dsq-comment-header">
                        <cite id="dsq-cite-1997">
                                <span id="dsq-author-user-1997">Pascal Laurin</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1997" class="dsq-comment-body">
                        <div id="dsq-comment-message-1997" class="dsq-comment-message"><p>@Matt</p>
<p>I&#8217;ve read your post and it&#8217;s good but do I understand you avoid compositing your presenters as much as possible?  That you are re-using (copying) code over and over to new presenter in your 1-1 presenter / view model?</p>
<p>Actually that is a question I had for some time now&#8230;</p>
<p>@Jeremy</p>
<p>How do you do the presenter for very complex screen?  I bet it is composition of many reusable presenters if possible.  I&#8217;m not sure if you talked about that in another post, might have missed it.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1998">
                    <div id="dsq-comment-header-1998" class="dsq-comment-header">
                        <cite id="dsq-cite-1998">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-1998">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1998" class="dsq-comment-body">
                        <div id="dsq-comment-message-1998" class="dsq-comment-message"><p>@Pascal,</p>
<p>Exactly what you said.  Even if you can&#8217;t reuse the sub-Presenters, it&#8217;s good to keep the size of the main Presenter down.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1999">
                    <div id="dsq-comment-header-1999" class="dsq-comment-header">
                        <cite id="dsq-cite-1999">
    http://blog.mattwynne.net                            <span id="dsq-author-user-1999">Matt Wynne</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1999" class="dsq-comment-body">
                        <div id="dsq-comment-message-1999" class="dsq-comment-message"><p>@Pascal,</p>
<p>So far we&#8217;ve managed to use an inheritance hierarchy within the Presenters assembly to manage duplication &#8211; so if I have two pages that both need to look up and display a Widget from a widgetId in the querystring, then I&#8217;ll put that code into a WidgetPresenter base class from which both those pages&#8217; presenters inherit.</p>
<p>What we found when we had &#8216;too many presenters spoiling the broth&#8217; was that sometimes we had two presenters independently making similar, potentially expensive, calls to the model in order to render different bits of the page. By ensuring that there was only one main guy in charge of presenting the page, it&#8217;s easier to see when this is happening, and easier to test for it.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-2000">
                    <div id="dsq-comment-header-2000" class="dsq-comment-header">
                        <cite id="dsq-cite-2000">
    http://blog.mattwynne.net                            <span id="dsq-author-user-2000">Matt Wynne</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-2000" class="dsq-comment-body">
                        <div id="dsq-comment-message-2000" class="dsq-comment-message"><p>I moved my blog, by the way, so the above link may not work for ever. Go here to find it instead, if you&#8217;re interested:</p>
<p><a href="http://blog.mattwynne.net/2007/06/13/mvp-smells/" rel="nofollow">http://blog.mattwynne.net/2007/06/13/mvp-smells/</a></p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box/';
    var disqus_identifier = '343 /blogs/jeremy.miller/archive/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "Build your own CAB Part #2 &#8211; The Humble Dialog Box";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=343');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2007\/05\/23\/build-your-own-cab-part-2-the-humble-dialog-box\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.636 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 12:40:06 -->
<!-- super cache -->