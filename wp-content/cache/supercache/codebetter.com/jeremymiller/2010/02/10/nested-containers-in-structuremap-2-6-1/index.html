<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>“Nested Containers” in StructureMap 2.6.1 | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='More signs of FubuMVC getting real' href='http://codebetter.com/jeremymiller/2010/02/09/more-signs-of-fubumvc-getting-real/' />
<link rel='next' title='Introducing the &quot;Ignite Your Coding!&quot; Podcast' href='http://codebetter.com/jeremymiller/2010/02/10/introducing-the-quot-ignite-your-coding-quot-podcast/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=761' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,154] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-761" class="post-761 post type-post status-publish format-standard hentry category-structuremap">
					<h1 class="entry-title">“Nested Containers” in StructureMap 2.6.1</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/" title="5:36 am" rel="bookmark"><span class="entry-date">February 10, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>This is the first of a promised series of blog posts to explain and demonstrate the new features of the <a href="/blogs/jeremy.miller/archive/2010/02/04/structuremap-2-6-and-2-5-4-is-released.aspx">StructureMap 2.6 release</a>.&nbsp; First, in order to use this feature, you absolutely must be on StructureMap 2.6.1 (or 2.5.4).&nbsp; Your friendly neighborhood Shade Tree Developer introduced a bug into the 2.6.0 codebase that makes this feature screw up the parent container (mea culpa).</p>
<p>I want to start with the new &ldquo;Nested Container&rdquo; feature.&nbsp; In a nutshell, the Nested Container is kind of like a temporary clone of a Container that&rsquo;s invoked like this:</p>
<div style="border-bottom: black thin solid;border-left: black thin solid;font-family: courier new;background: white;color: black;font-size: 10pt;border-top: black thin solid;border-right: black thin solid">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Let&#8217;s just say that ObjectFactory.Initialize() has already been</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// called so the main Container is already built and ready</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// to use</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">using</span> (<span style="color: #2b91af">IContainer</span> nested = <span style="color: #2b91af">ObjectFactory</span>.Container.GetNestedContainer())</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// pull other objects from the nested</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// container and do work with those services</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> service = nested.GetInstance&lt;<span style="color: #2b91af">IService</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; service.DoSomething();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>What did I do up above?&nbsp; I simply created a new Container (nested) from an existing Container, then pulled a service from the new nested container, did some work with it, then let the C# &ldquo;using&rdquo; block auto magically call the Dispose() method on the new nested container object.&nbsp; You might be asking, why do I need a second Container?&nbsp; Well, the nested container has some special properties:</p>
<ol>
<li>The nested container will track all of the transient objects that it creates.&nbsp; When the nested container itself is disposed, it will call Dispose() on any of the transient objects that it created.&nbsp; A normal StructureMap Container does not track the transient objects that it creates (and nor should it IMHO).</li>
<li>The nested container &ldquo;pulls&rdquo; all instances scoped as anything but transients (Singletons, HttpContext scoped objects, ThreadLocalStorage scoped objects, etc.) from the parent container.&nbsp; These objects are not disposed from the nested container.</li>
<li><b>&ldquo;Transient&rdquo; objects are scoped to the nested container</b>.&nbsp; I&rsquo;d try to explain that, but why don&rsquo;t I just show the unit test instead:</li>
</ol>
<div style="border-bottom: black thin solid;border-left: black thin solid;font-family: courier new;background: white;color: black;font-size: 10pt;border-top: black thin solid;border-right: black thin solid">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: #2b91af">Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> transient_service_in_the_parent_container_is_effectively_a_singleton_for_the_nested_container()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> parent = <span style="color: blue">new</span> <span style="color: #2b91af">Container</span>(x =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// IWidget is a &#8220;transient&#8221;</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x.For&lt;<span style="color: #2b91af">IWidget</span>&gt;().Use&lt;<span style="color: #2b91af">AWidget</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">IContainer</span> child = parent.GetNestedContainer();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> childWidget1 = child.GetInstance&lt;<span style="color: #2b91af">IWidget</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> childWidget2 = child.GetInstance&lt;<span style="color: #2b91af">IWidget</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> childWidget3 = child.GetInstance&lt;<span style="color: #2b91af">IWidget</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> parentWidget = parent.GetInstance&lt;<span style="color: #2b91af">IWidget</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; childWidget1.ShouldBeTheSameAs(childWidget2);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; childWidget1.ShouldBeTheSameAs(childWidget3);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; childWidget1.ShouldNotBeTheSameAs(parentWidget);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>&nbsp;</p>
<p> It&rsquo;s not the most exciting thing in the world, but it&rsquo;s helpful in some specific scenarios:</p>
<ol>
<li>Web requests.&nbsp; Inside a single web request I need every object to access the exact same NHibernate ISession instance (substitute the analogue in your persistence tooling of choice).&nbsp; At the end of the web request I may want to tear down and dispose all the services created during that web request &ndash; i.e. make damn sure the database connection is closed and cleaned up at the end.&nbsp; I&rsquo;m not exactly sure how you would use this in ASP.Net MVC (not saying you can&rsquo;t, just that I haven&rsquo;t given it much thought), but it&rsquo;s working out very well for us with a FubuMVC Behavior like <a href="/blogs/jeremy.miller/archive/2010/01/06/how-dovetail-uses-structuremap-with-nhibernate.aspx">I showed here</a>.</li>
<li>Short lived atomic transactions.&nbsp; We use the nested container within our rules engine.&nbsp; Within a single NHibernate ISession and transaction block, we create several object graphs with service location calls to the nested container.*&nbsp; Using the nested container feature made it much simpler for us to &ldquo;scope&rdquo; the ISession and even rules state objects within a logical transaction.</li>
<li>User Interface composition.&nbsp; From a twitter conversation with <a href="/blogs/glenn.block/Default.aspx">Glenn Block</a> a couple weeks back.&nbsp; Let&rsquo;s say that you have a distinct area of the UI where you have a long running workflow like a wizard that replaces the controls and Presenters / ViewModels currently active.&nbsp; When those Views, ViewModel&rsquo;s, and Presenters are created, you probably want those objects to have shared state and layout &ldquo;region manager&rdquo; type classes injected into them.&nbsp; Using a nested container for the wizard is &ldquo;a&rdquo; way to build those objects with the proper shared services.</li>
</ol>
<p>&nbsp;</p>
<h4><b>Sample Usage</b></h4>
<p>Most of our nested container usage is wrapped up within the class shown below:</p>
<div style="border-bottom: black thin solid;border-left: black thin solid;font-family: courier new;background: white;color: black;font-size: 10pt;border-top: black thin solid;border-right: black thin solid">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">TransactionProcessor</span> : <span style="color: #2b91af">ITransactionProcessor</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span style="color: blue">object</span> _locker = <span style="color: blue">new</span> <span style="color: blue">object</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: #2b91af">IContainer</span> _container;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// This IContainer is the parent container from</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// ObjectFactory.Container</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> TransactionProcessor(<span style="color: #2b91af">IContainer</span> container)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _container = container;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> Execute&lt;T&gt;(<span style="color: #2b91af">Action</span>&lt;T&gt; action)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; execute(c =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> service = c.GetInstance&lt;T&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; action(service);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="color: blue"></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// This code is used in our codebase as a generic way to invoke</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// a service or action within the scope of a nested container</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">void</span> execute(<span style="color: #2b91af">Action</span>&lt;<span style="color: #2b91af">IContainer</span>&gt; action)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">IContainer</span> container = <span style="color: blue">null</span>;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">lock</span> (_locker)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container = _container;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// ITransactionBoundary is a Dovetail specific interface / class</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// we use just to manage an NHibernate ISession object</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">using</span> (<span style="color: #2b91af">IContainer</span> nestedContainer = container.GetNestedContainer())</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> boundary = nestedContainer.GetInstance&lt;<span style="color: #2b91af">ITransactionBoundary</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boundary.Start();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; action(nestedContainer);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boundary.Commit();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p>In real usage, we invoke services within a transaction with code like this:</p>
<div style="border-bottom: black thin solid;border-left: black thin solid;font-family: courier new;background: white;color: black;font-size: 10pt;border-top: black thin solid;border-right: black thin solid">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> transaction = <span style="color: #2b91af">ObjectFactory</span>.GetInstance&lt;<span style="color: #2b91af">ITransactionProcessor</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transaction.Execute&lt;<span style="color: #2b91af">DataDriver</span>&gt;(x =&gt; x.ClearData());</p>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>* Some of you are going to read that sentence and do a kneejerk &ldquo;&hellip;but Ayende says you&rsquo;re only supposed to do one service locator call in the entire application!&rdquo;&nbsp; Don&rsquo;t do the kneejerk thing without understanding the context. </p>
<div class="shr-publisher-761"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/structuremap/" title="View all posts in StructureMap" rel="category tag">StructureMap</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/" title="Permalink to “Nested Containers” in StructureMap 2.6.1" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/feed/" title="Comments RSS to “Nested Containers” in StructureMap 2.6.1" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-761 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2010/02/09/more-signs-of-fubumvc-getting-real/" rel="prev"><span class="meta-nav">&larr;</span> More signs of FubuMVC getting real</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2010/02/10/introducing-the-quot-ignite-your-coding-quot-podcast/" rel="next">Introducing the &quot;Ignite Your Coding!&quot; Podcast <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-6187">
                    <div id="dsq-comment-header-6187" class="dsq-comment-header">
                        <cite id="dsq-cite-6187">
                                <span id="dsq-author-user-6187">Van</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6187" class="dsq-comment-body">
                        <div id="dsq-comment-message-6187" class="dsq-comment-message"><p>I love the nested container.<br />
I used it for scope based DI.</p>
<p>Basically, there are cases when the DI container has to be aware of the scope it&#8217;s in. With nested container, I can now deploy DI into these scopes.</p>
<p>Simple example:<br />
Let&#8217;s take Word for example.</p>
<p>Word has IFileSaveService to allow the UI to save the file. The service is at global scope.</p>
<p>Word also have ITextFormatService, which keeps track of format of the text at cursor position. This service must be at document scope, so that it will not affect other documents.</p>
<p>With nested container, scoped container is now so much easier.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6188">
                    <div id="dsq-comment-header-6188" class="dsq-comment-header">
                        <cite id="dsq-cite-6188">
    http://realfiction.net                            <span id="dsq-author-user-6188">Frank Quednau</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6188" class="dsq-comment-body">
                        <div id="dsq-comment-message-6188" class="dsq-comment-message"><p>More abstract: A nested container can be subject to additional configuration via &#8220;Configure&#8221;, which allows you to overwrite dependencies that are already stated in the parent container for the scope of the nexted container.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6189">
                    <div id="dsq-comment-header-6189" class="dsq-comment-header">
                        <cite id="dsq-cite-6189">
                                <span id="dsq-author-user-6189">Jacob</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6189" class="dsq-comment-body">
                        <div id="dsq-comment-message-6189" class="dsq-comment-message"><p>Why the lock? How can the container reference change.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6190">
                    <div id="dsq-comment-header-6190" class="dsq-comment-header">
                        <cite id="dsq-cite-6190">
                                <span id="dsq-author-user-6190">flipdoubt</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6190" class="dsq-comment-body">
                        <div id="dsq-comment-message-6190" class="dsq-comment-message"><p>Interested in using nested containers to build a composite UI as per the third usage scenario, but the using clause disposes of my controls as I take them out of the nested container. Can you point to further examples of this? Is the best work around to (a) not use the using clause or (b) scope the objects so they are not disposed by the nested container? Thanks.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6999">
                    <div id="dsq-comment-header-6999" class="dsq-comment-header">
                        <cite id="dsq-cite-6999">
    http://www.backlinkschecker.ws/backlinks/buylinks.html                            <span id="dsq-author-user-6999">Purchase High PR Backlink</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6999" class="dsq-comment-body">
                        <div id="dsq-comment-message-6999" class="dsq-comment-message"><p>wow great! Thx for sharing this  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-7186">
                    <div id="dsq-comment-header-7186" class="dsq-comment-header">
                        <cite id="dsq-cite-7186">
                                <span id="dsq-author-user-7186">ms007</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-7186" class="dsq-comment-body">
                        <div id="dsq-comment-message-7186" class="dsq-comment-message"><p>finally i got it. If you use the nested container in the composition root, and pass all of your dependencies to your services (i&#8217;m trying not to use StructureMap as a ServiceLocator), then all is proper disposed at the end of the request. What a great thing, this nested container. Looking forward for the version 3.0 of StructureMap.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-7301">
                    <div id="dsq-comment-header-7301" class="dsq-comment-header">
                        <cite id="dsq-cite-7301">
                                <span id="dsq-author-user-7301">amita sexana</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-7301" class="dsq-comment-body">
                        <div id="dsq-comment-message-7301" class="dsq-comment-message"><p><a href="http://www.access-file-repair.com" rel="nofollow">MS Access Repair Software</a><br />
<a href="http://www.accesspasswordrecovery.org" rel="nofollow">access password recovery</a><br />
<a href="http://www.accesspasswordrecovery.ws" rel="nofollow">Access Password Recovery Tool</a><br />
<a href="http://www.access-unlocker.com" rel="nofollow">MS Access Password Recovery</a><br />
<a href="http://www.excelfix.net" rel="nofollow">Excel Recovery</a><br />
<a href="http://www.bhartitechnology.com" rel="nofollow">download free key logger</a><br />
<a href="http://www.accesspasswordrecovery.us" rel="nofollow">Access Password Recovery</a><br />
<a href="http://www.chatdatarecovery.com" rel="nofollow">Chat Archive Recovery</a><br />
<a href="http://www.database-conversion.org" rel="nofollow">Database conversion software</a><br />
<a href="http://www.excel-file-repair.com" rel="nofollow">Excel file repair</a><br />
<a href="http://www.datarecoveryfreetrial.org" rel="nofollow">Data Recovery Tool</a><br />
<a href="http://www.eaglecop.us" rel="nofollow">Web Hosting</a><br />
<a href="http://www.data-wiper.ws" rel="nofollow">Data wiper software</a><br />
<a href="http://www.digitalcameradatarecovery.com" rel="nofollow">Digital camera photo recovery software</a><br />
<a href="http://www.diskrecovery.ws" rel="nofollow">Disk Recovery Software</a><br />
<a href="http://www.eaglecop.com" rel="nofollow">Data recovery software free download</a><br />
<a href="http://www.database-converter.com" rel="nofollow">Database Converters</a><br />
<a href="http://www.employee-monitoring.ws" rel="nofollow">Free Keylogger</a><br />
<a href="http://www.excelfilerecovery.ws" rel="nofollow">Excel Files Recovery</a><br />
<a href="http://www.access-unlocker.org" rel="nofollow">MS Access Password Recovery Tool</a><br />
<a href="http://www.excelrecovery.ws" rel="nofollow">Excel Recovery</a><br />
<a href="http://www.keyloggerdownload.us" rel="nofollow">free keylogger software</a><br />
<a href="http://www.floppyrecovery.ws" rel="nofollow">Floppy Recovery</a><br />
<a href="http://www.excelrepair.us" rel="nofollow">Excel Repair Software</a><br />
<a href="http://www.filesrepair.org" rel="nofollow">How to Repair Corrupted Excel Files</a><br />
<a href="http://www.find-msn-password.ws" rel="nofollow">recover msn password</a><br />
<a href="http://www.fixexcelfile.com" rel="nofollow">Excel recovery Software</a><br />
<a href="http://www.floppydatarecovery.ws" rel="nofollow">Floppy Disk Recovery</a><br />
<a href="http://www.harddiskrecovery.ws" rel="nofollow">Windows Data Recovery</a><br />
<a href="http://www.freewarekeylogger.ws" rel="nofollow">Keystroke Logger</a><br />
<a href="http://www.harddrivedatarecovery.ws" rel="nofollow">Hard drive data recovery</a><br />
<a href="http://www.freeexcelrecovery.com" rel="nofollow">Recover My Excel Files</a><br />
<a href="http://www.harddisk-recovery.ws" rel="nofollow">Windows Recovery Tools</a><br />
<a href="http://www.internetpasswordrecovery.ws" rel="nofollow">IE Password Recovery</a><br />
<a href="http://www.ipodrecovery.ws" rel="nofollow">IPod Recovery</a><br />
<a href="http://www.key-logger.us" rel="nofollow">Key logger</a><br />
<a href="http://www.excelrecoveryfreeware.com" rel="nofollow">Excel Recovery Tool</a><br />
<a href="http://www.keyloggerdownload.ws" rel="nofollow">download a free keylogger</a><br />
<a href="http://www.keyloggers.ws" rel="nofollow">keyloggers free</a><br />
<a href="http://www.keyloggersoftwaredownload.com" rel="nofollow">keylogger freeware</a><br />
<a href="http://www.keyloggerspysoftware.ws" rel="nofollow">Keylogger Spy Software</a><br />
<a href="http://www.key-logging-software.org" rel="nofollow">keylogger software free</a><br />
<a href="http://www.keystrokecapture.us" rel="nofollow">keystroke capture</a><br />
<a href="http://www.keystrokecapture.ws" rel="nofollow">Keylogger</a><br />
<a href="http://www.passwordrecovery.biz" rel="nofollow">Recovery Password</a><br />
<a href="http://www.keystroke-logging.ws" rel="nofollow">free keylogger downloads</a><br />
<a href="http://www.keystrokesrecorder.org" rel="nofollow">best keylogger free</a><br />
<a href="http://www.msnpasswordrecovery.ws" rel="nofollow">msn password recovery</a><br />
<a href="http://www.outlookpasswordrecovery.us" rel="nofollow">Free Download Outlook Express Password Recovery Software</a><br />
<a href="http://www.password-finder.ws" rel="nofollow">password finder</a><br />
<a href="http://www.keystroke-logger.org" rel="nofollow">Keylogger Software Download</a><br />
<a href="http://www.passwordrecovery.ws" rel="nofollow">Password Recovery</a><br />
<a href="http://www.passwordrecoverysoftware.org" rel="nofollow">password recovery software</a><br />
<a href="http://www.password-recovery-software.ws" rel="nofollow">password recovery software free</a><br />
<a href="http://www.pendrivedatarecovery.com" rel="nofollow">pen drive data recovery software</a><br />
<a href="http://www.pendrivedatarecovery.ws" rel="nofollow">Pen Drive Recovery</a><br />
<a href="http://www.powerpoint-file-repair.com" rel="nofollow">PowerPoint Repair Tool</a><br />
<a href="http://www.recoverchatdata.com" rel="nofollow">Chat Recovery Software</a><br />
<a href="http://www.recoverexcel.ws" rel="nofollow">Recover Excel Software</a><br />
<a href="http://www.recoverexcelfile.org" rel="nofollow">Fix Excel files</a><br />
<a href="http://www.recovermails.org" rel="nofollow">Email Recovery</a><br />
<a href="http://www.recoversms.com" rel="nofollow">Mobile phone data recovery software</a><br />
<a href="http://www.recoveryforexcel.com" rel="nofollow">recovery for excel</a><br />
<a href="http://www.repairexcel.ws" rel="nofollow">Repair Excel Files</a><br />
<a href="http://www.repairexcelfiles.com" rel="nofollow">Advanced Excel Repair</a><br />
<a href="http://www.restoredata.ws" rel="nofollow">Data Recovery Software</a><br />
<a href="http://www.restoresim.com" rel="nofollow">Sim Card Recovery</a><br />
<a href="http://www.restoresim.org" rel="nofollow">SIM Card Data Recovery</a><br />
<a href="http://www.sanmaxi.biz" rel="nofollow">Key logger software</a><br />
<a href="http://www.sanmaxi.com" rel="nofollow">downloadable keylogger</a><br />
<a href="http://www.sanmaxi.info" rel="nofollow">download keylogger freeware</a><br />
<a href="http://www.sanmaxi.net" rel="nofollow">free invisible keylogger</a><br />
<a href="http://www.sanmaxi.org" rel="nofollow">data recovery</a><br />
<a href="http://www.sanmaxi.us" rel="nofollow">Download Free Keylogger</a><br />
<a href="http://www.sanmaxi.ws" rel="nofollow">keystroke recorder</a><br />
<a href="http://www.sanmaxisoftware.com" rel="nofollow">software keylogger</a><br />
<a href="http://www.sanmaxisoftware.org" rel="nofollow">remote key logger</a><br />
<a href="http://www.simrecovery.biz" rel="nofollow">SIM card recovery software</a><br />
<a href="http://www.simrecovery.us" rel="nofollow">SIM card data recovery software</a><br />
<a href="http://www.backlinkchaker.com" rel="nofollow">Backlinks Checker Tool</a><br />
<a href="http://www.soico.net" rel="nofollow">remote keylogger free</a><br />
<a href="http://www.spysoftware.ws" rel="nofollow">Spy Keylogger</a><br />
<a href="http://www.usbdriverecovery.ws" rel="nofollow">USB drive data recovery</a><br />
<a href="http://www.freebacklinkfinder.com" rel="nofollow">Free Backlink Finder Tool</a><br />
<a href="http://www.datarecoverytrial.com" rel="nofollow">datarecovery</a><br />
<a href="http://www.zip-repair.org" rel="nofollow">Recover ZIP files</a><br />
<a href="http://www.key-logger.ws" rel="nofollow">keylogger</a><br />
<a href="http://www.datarecoverysoftwaretrial.ws" rel="nofollow">Data recovery software for NTFS</a><br />
<a href="http://www.datarecoverytrialdownload.com" rel="nofollow">Recovery Format Data</a><br />
<a href="http://www.datarecoverytrialsoftware.com" rel="nofollow">Partition recovery software</a><br />
<a href="http://www.eaglecop.org" rel="nofollow">SEO</a><br />
<a href="http://www.backlinkschecker.ws" rel="nofollow">Backlinks Checker</a><br />
<a href="http://www.simrecovery.ws" rel="nofollow">Mobile Phone Sim Card Recovery</a><br />
<a href="http://www.word-file-repair.com" rel="nofollow">Word File Repair Tool</a><br />
<a href="http://www.datarecoveryfreetrial.com" rel="nofollow">data recovery services</a></p>
<p>Thank you for you to tell us more interesting information, Thank you</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/';
    var disqus_identifier = '761 /blogs/jeremy.miller/archive/2010/02/10/nested-containers-in-structuremap-2-6-1.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "“Nested Containers” in StructureMap 2.6.1";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=761');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2010\/02\/10\/nested-containers-in-structuremap-2-6-1\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.514 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 12:58:33 -->
<!-- super cache -->