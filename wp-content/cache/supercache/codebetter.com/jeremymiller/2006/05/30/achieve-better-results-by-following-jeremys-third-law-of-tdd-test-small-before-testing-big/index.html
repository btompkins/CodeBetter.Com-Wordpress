<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Achieve Better Results by following Jeremy&#8217;s Third Law of TDD:  Test Small Before Testing Big | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Grab bag of follow up&#8217;s for data access, persistence, query engines, and o/r mapping' href='http://codebetter.com/jeremymiller/2006/05/26/grab-bag-of-follow-ups-for-data-access-persistence-query-engines-and-or-mapping/' />
<link rel='next' title='Nick Parker on StructureMap' href='http://codebetter.com/jeremymiller/2006/06/01/nick-parker-on-structuremap/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=168' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,208] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2006/05/30/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-168" class="post-168 post type-post status-publish format-standard hentry category-test-driven-development">
					<h1 class="entry-title">Achieve Better Results by following Jeremy&#8217;s Third Law of TDD:  Test Small Before Testing Big</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2006/05/30/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big/" title="6:37 pm" rel="bookmark"><span class="entry-date">May 30, 2006</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P>Getting back on track with TDD content.&nbsp; One of the most important lessons learned the software development community has learned is that productivity follows from <A href="http://www.ambysoft.com/essays/whyAgileWorksFeedback.html">more frequent feedback cycles</A>.&nbsp; How fast can you go from writing a piece of code to <B>knowing</B> that code does what it&#8217;s supposed to do?&nbsp; Do the symbols on the UML diagram you&#8217;ve worked on all week translate to a design that works?&nbsp; Does the code you just wrote work?&nbsp; How often can you get working screens in front of the end users to get usability feedback?&nbsp; How quickly can you get code into testing, and how fast can the testers validate that code against the desired functionality?&nbsp; How fast can you identify and correct problems with your code/design/architecture?&nbsp; All of these &#8220;how fast?&#8221; questions are directly related to the granularity of your testing and coding.</P><br />
<P>Test Driven Development is an important and valuable tool to achieve rapid feedback cycles, but I&#8217;ve found that the benefits of TDD are only achieved if you religiously write and test software in small pieces.&nbsp; That lesson is my third (but arguably the most important) law of TDD &#8212; &#8220;Test Small Before Testing Big.&#8221;&nbsp; Putting it another way, &#8220;<A HREF="/blogs/jeremy.miller/archive/2005/07/20/129540.aspx">Code from the Bottom Up.</A>&#8220;&nbsp; Don&#8217;t get fooled by <I>Test</I> Driven Development, the benefits of TDD are felt throughout the software lifecycle.&nbsp; It&#8217;s not just extra overhead in writing more unit tests, truly adopting TDD is about:</P><br />
<UL><br />
<LI>Coding in an efficient manner, and sustaining that efficiency over time</LI><br />
<LI>Enabling continuous and adaptive design techniques</LI><br />
<LI>Designing an application that is resilient in the face of change</LI><br />
<LI>Faster removal of defects from code</LI><br />
<LI>Making an application easier and quicker to test</LI></UL><br />
<P>TDD felt like more work to me at first, but over the last three or four years I&#8217;ve learned how to design and build code as a series of small steps that are validated every stop along the way and my results have improved considerably.&nbsp; To soften the learning curve for people new to TDD, and to gain some lucidity with my own thinking on TDD, I am distilling the lessons (lumps) I&#8217;ve learned about TDD into <I>Jeremy&#8217;s Laws of TDD</I> (not that the list is particularly original or new).</P><br />
<OL><br />
<LI><A HREF="/blogs/jeremy.miller/archive/2005/10/20/133437.aspx">Isolate the Ugly Stuff</A> </LI><br />
<LI><A HREF="/blogs/jeremy.miller/archive/2006/03/09/140465.aspx">Push, Don&#8217;t Pull</A></LI><br />
<LI>Test Small before Testing Big (this post)</LI><br />
<LI>Avoid a long tail </LI><br />
<LI>Favor composition over inheritance </LI><br />
<LI>Go declarative whenever possible </LI><br />
<LI>Don&#8217;t treat testing code like a second class citizen </LI><br />
<LI>Isolate your unit tests, or suffer the consequences! </LI><br />
<LI>The unit tests will break someday </LI><br />
<LI>Unit tests shall be easy to setup</LI></OL><br />
<P>And the overriding &#8220;Zeroeth Law&#8221; is &#8220;If code is hard to test, change it.&#8221;</P><br />
<H4><A name="CodeFromTheBottomUp"></A>Case Study #1:&nbsp; Code from the Bottom Up</H4><br />
<P>Last week my colleague and I coded a couple of related user stories that illustrate the advantages of following the &#8220;Code from the Bottom Up&#8221; law, both in the negative and positive.&nbsp; </P><br />
<P>In the first story we were taking a &#8220;manifest&#8221; message that contained a summary of an invoice in progress.&nbsp; We needed to run a series of validations against the manifest, compare the manifest to existing data, then run the manifest data through a subset of our existing rules engine.&nbsp; I noticed my colleague had that furrowed brow look we all get when the code isn&#8217;t flowing out of our fingertips.&nbsp; When I asked what was up he told me he was having trouble getting started because he couldn&#8217;t see how all the pieces fit together.&nbsp; I gave the best advice I know for that situation &#8212; &#8220;Don&#8217;t care [about the whole].&nbsp; What do you know how to do?&#8221;&nbsp; In this case we could start by validating the requested sender and recipient of the invoice message.&nbsp; We first built a class that would take in the sender and recipient id&#8217;s and return a list of possible problems (users don&#8217;t exist, sender doesn&#8217;t have a relationship to the recipient, etc.).&nbsp; That class would take in an <FONT face="Courier New">IDomainSource</FONT> object that acts as a <A href="http://www.martinfowler.com/eaaCatalog/repository.html">repository</A> to User objects:</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Checks the validity of a sender/recipient id pair</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Uses the IDomainSource repository to locate User objects</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> and their relationships to each other</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> AddressBookValidator(IDomainSource source)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _source = source;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>with a method for the validation like this:</P><br />
<DIV><br />
<P><SPAN>public</SPAN> EventMessage[] ValidateAll(<SPAN>string</SPAN> senderId, <SPAN>string</SPAN> receiverId)</P></DIV><br />
<P>We went on to unit test this class by mocking the <FONT face="Courier New">IDomainSource</FONT> dependency and exercising all the permutations we could think of.&nbsp; With that task completed, we moved onto the next validation against an existing domain object (a &#8220;Bundle&#8221;).&nbsp; We started by assuming we had already fetched the existing <FONT face="Courier New">Bundle</FONT> object and were comparing it to the <FONT face="Courier New">Manifest</FONT> message.&nbsp; That leads to a simple method that can be tested with pure state-based testing (we just needed to check the values of the <FONT face="Courier New">EventMessage</FONT> objects being returned):</P><br />
<DIV><br />
<P><SPAN>public</SPAN> <SPAN>static</SPAN> EventMessage[] ValidateManifestAgainstBundle(Manifest manifest, Bundle bundle)</P></DIV><br />
<P>Once we have this method completely tested, we do still have the issue of fetching the correct Bundle object to validate against.&nbsp; We move onto this method and mock the <FONT face="Courier New">IBundleRepository</FONT> class in the unit tests.</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN>[] Validate(Manifest manifest)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Bundle bundle = _bundleRepository.FindBundle(manifest.ControlNumber);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EventMessage[] messages = ValidateManifestAgainstBundle(manifest, bundle);</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> ResourceMessageProcessor.ToMessageArray(messages);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>Now, we&#8217;ve dodged around the rules engine enough.&nbsp; To activate the core of the rules engine we need to pass it data in the form of its own canonical data structure and an array of rule objects.&nbsp; First we need to translate the Manifest object into the rules data structure.&nbsp; That led us to build and test the method below:</P><br />
<DIV><br />
<P><SPAN>public</SPAN> InvoiceDataSet BuildInvoiceDataSet(Manifest manifest)</P></DIV><br />
<P>Next we built a class that used the normal rules engine configuration service to retrieve all the rules for a specific receiver and select the subset of the rules that are useful in the new context.&nbsp; Once we had those two pieces completed, activating the rules engine was simple.</P><br />
<P>At this point we have little classes that execute all of the various validation rules, but we&#8217;re still lacking the actual service endpoint.&nbsp; Looking at our validation classes we noticed a basic pattern, so we lifted a common interface for all of the validation classes:</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IManifestValidator</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN>[] Validate(Manifest manifest);</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>We knew the &#8220;contract&#8221; of the service entry point all along.&nbsp; Now that we&#8217;ve built all of the underlying validation pieces, the rest of the service is simply an exercise in connecting the dots:</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> ManifestValidationResponse ValidateManifest(Manifest manifest)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ManifestValidationResponse response = <SPAN>new</SPAN> ManifestValidationResponse();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; response.ControlNumber = manifest.ControlNumber;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Simply loop through all of the manifest validators</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// and collect all of the validation messages</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>foreach</SPAN> (IManifestValidator manifestValidator <SPAN>in</SPAN> _validators)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>string</SPAN>[] messages = manifestValidator.Validate(manifest);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; response.AddMessages(messages);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> response;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>We didn&#8217;t completely understand what all of the pieces of the service method was going to be at the beginning of the coding session, yet we still managed to create working code in short order.&nbsp; By focusing on little &#8220;worker&#8221; classes that performed small tasks, <B>the aggregate structure fell into place</B>.</P><br />
<P>In the second story we had to accept a new message representing an invoice submission.&nbsp; We had to take this message and run a series of transformations and validations against the invoice data to create a human readable report of validation problems to correct the invoice, or to accept the invoice.&nbsp; Most of the functionality already existed, but the validation and translation code was bound up into coarse-grained workflow classes.&nbsp; There wasn&#8217;t any way to exercise the logic we wanted without causing side effects.&nbsp; Most of the effort in that story was a series of refactorings to extract the smaller pieces of code into separate classes that could be called independent of the larger workflow.&nbsp; We had a safety net of coarse grained integration and regression tests, but no unit tests.&nbsp; Because of the risk, we had to make the changes in very small steps while constantly running the sluggish end to end tests to make sure we didn&#8217;t break anything.</P><br />
<P>So what&#8217;s the point of the second user story, and how does this experience relate to &#8220;test small?&#8221;&nbsp; In the first story the rules engine had originally been coded with Test Driven Development, and pursuing testability directly led to the rules engine component being composed of little loosely coupled, cohesive classes.&nbsp; We didn&#8217;t have to change the rules engine code at all, even though we were using it in a completely new way.&nbsp; All we had to do was recombine some of the existing objects within a different coordinator class.&nbsp; The code in the second story had not been written with TDD or testability in mind, and it showed.&nbsp; The TDD code followed the <A href="http://www.objectmentor.com/resources/articles/ocp.pdf">Open/Closed Principle</A> as a byproduct of working &#8220;test first,&#8221; the non-TDD code required a lot of change to the existing code to create new functionality.&nbsp; The TDD code was <A href="http://www.binaryshift.com/main/SDForumTalk-11-17-2004.m">healthier code</A> than the non-TDD code.</P><br />
<H4><A name="MakingItWork"></A>Purposely Designing with Test Driven Development</H4><br />
<P>I know this is controversial and I didn&#8217;t believe this initially either, but <B>TDD is designing while coding</B>.&nbsp; Coding one task at a time helps me to discover the structure of the larger whole.&nbsp; My vision of the whole is informed by the creation of the small pieces.&nbsp; Using some terminology from <A href="http://www.wirfs-brock.com/PDFs/A%20Brief%20Tour%20of%20RDD%20in%202004.pdf">Responsibility Driven Design</A>, consciously divide up responsibilities by class stereotypes:</P><br />
<UL><br />
<LI>Service providers &#8211; classes that perform a specific operations</LI><br />
<LI>Information Holders &#8211; classes that have, or provide, data to other classes</LI><br />
<LI>Coordinators &#8211; classes that coordinate the activities of other classes</LI><br />
<LI>Controllers &#8211; classes that control the application flow</LI></UL><br />
<P>The key for doing emergent design is to focus on creating the service provider and information holder classes first that perform small tasks.&nbsp; After these classes are built and tested the construction of the coordinator and controller classes often turns into a simple game of &#8220;connect the dots.&#8221;&nbsp; Get the business logic and the workflow decisions complete first.&nbsp; Push off tasks like configuration and even data access closer to the end.&nbsp; Let the needs of the business logic and workflow dictate the interface and design of the ancillary services.</P><br />
<P>To make this approach work you need to consciously maximize &#8220;<A href="http://www.martinfowler.com/articles/designDead.html#IDAZFMXB">reversibility</A>&#8221; throughout the system.&nbsp; Notice how we started the user story above by working on the validation of a Manifest object to a Bundle object.&nbsp; The initial class method isn&#8217;t coupled to any particular message handler, data access mechanism, or configuration subsystem.&nbsp; It simply takes in two objects and returns an array of strings.&nbsp; The loose coupling is just a side effect of coding for testability, but it enables us to use that class in a multitude of ways.&nbsp; It isn&#8217;t bound to a particular workflow.&nbsp; If the requirements of the overall workflow changes (and it will), or we determine a better overall design, we can change the workflow controllers and coordinators by rearranging the service providers and information holders.&nbsp; You&#8217;ve also maximized the potential for reuse at a later time.&nbsp; In the first user story we were able to take the smaller classes of the rules engine and combine them differently for all new functionality.&nbsp; In the second story we had to spend a lot of energy extracting code out of the large workflow classes to create the new functionality.&nbsp; Guess which story went faster?</P><br />
<P>When I was in school I worked with my father building houses in the summer.&nbsp; On one memorable occasion I watched a pair of plumbers looking glumly at a series of pipes sticking out of the slab concrete form.&nbsp; It turned out that the plumbers had put the pipes in the wrong place before the concrete was poured around the pipes.&nbsp; They ended up renting a giant two man concrete saw and cutting up the foundation to move the pipes on a blistering summer day (they missed the second time around too!).&nbsp; Placing pipes that will have concrete poured around them is an irreversible decision, you simply can&#8217;t get that decision wrong because there isn&#8217;t going to be a second chance.&nbsp; </P><br />
<P>Software doesn&#8217;t have to be that way.&nbsp; So what can you do to maximize reversibility in your systems?&nbsp; You guessed it, write small cohesive classes that can be moved around and used in different contexts.&nbsp; Somebody will comment that evolutionary design techniques are inefficient and you should just be doing&nbsp;more research upfront.&nbsp; Maybe, but designing fluid code that can change covers a lot of potential scenarios.&nbsp; Building code from an upfront design, especially a design that happens from the top down, can easily result in code that only works for the cases known upfront &#8212; and the requirements will change, maybe not tomorrow or the next quarter, but they will change. </P><br />
<H4><A name="Permutations"></A>Case Study #2:&nbsp; Permutations</H4><br />
<P>The heart of the first big system I designed was a complex supply chain routing engine* that determined the best way to route requests from the factory lines for parts.&nbsp; The engine first queried and correlated (with a full outer join no less) data from three different sets of database tables, then applied a complex series of business rules against the data to select the best part channel (part, inventory source, and factory line destination).&nbsp; Adding to the complexity was a set of business rules that varied by region.&nbsp; All told, there was a mountainous stack of possible permutations of input to check.&nbsp; Needless to say, the testers struggled mightily with the engine because they only tested manually and with end to end blackbox tests.&nbsp; The engine worked great and we found very few defects with it in testing, but because it sucked down such a disproportionate amount of testing resources other parts of the system didn&#8217;t receive nearly the same level of testing and serious defects made it into production.&nbsp; We worked inefficiently.</P><br />
<P>So with the wisdom conferred upon me by hindsight, let&#8217;s take a look at a cleaner way to test this functionality that won&#8217;t drown the team in endless permutations.&nbsp; The first and foremost thing to do is to solve the routing in two steps, first correlate the data from the database tables into an object structure, then from this object structure select the best routing.&nbsp; I described the full model of the part sourcing as a bookshelf.&nbsp; On the top shelf are all the books you know you&#8217;ll enjoy.&nbsp; The second and third shelves are books that aren&#8217;t as good.&nbsp; The full model works by dividing the <FONT face="Courier New">PartSourceChannel</FONT> objects into several shelves of decreasing ability to fulfill the request for the part.&nbsp; </P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PurchaseOrder{}</P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> SupplyChainSource{}</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Represents a valid source for a part &#8211; the &#8220;Books&#8221;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourceChannel</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> PartNumber;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> ChannelNumber;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PurchaseOrder PurchaseOrder;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>long</SPAN> Inventory;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> SupplyChainSource SupplyChainSource;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>double</SPAN> AllocationPercentage;</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Collection of related PartSourceChannel&#8217;s &#8211; the &#8220;Shelf&#8221;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourcing</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceChannel[] Channels;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceChannel SelectChannelWithMostInventory()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceChannel SelectChannelByAllocation()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>bool</SPAN> HasChannels()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> <SPAN>true</SPAN>;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>And the bookshelf itself is:</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Represents all of the possible PartSourceChannel&#8217;s</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> for a given part, factory line, and region &#8211; the &#8220;Bookshelf&#8221;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourceRouting</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourcing Shelf1;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourcing Shelf2;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourcing Shelf3;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Select the PartSourceChannel</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceChannel Route()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (Shelf1.HasChannels())</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> Shelf1.SelectChannelByAllocation();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (Shelf2.HasChannels())</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> Shelf2.SelectChannelWithMostInventory();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>if</SPAN> (Shelf3.HasChannels())</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> Shelf3.SelectChannelByAllocation();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> <SPAN>null</SPAN>;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><!--EndFragment--><br />
<P>My strong recommendation is to drive design from the behavior of the business objects and then work forward to the service point and backwards to the data store.&nbsp; Starting small, assume you already have a <FONT face="Courier New">PartSourcing</FONT> bookshelf.&nbsp; The algorithm to select a part source from a shelf came in two basic flavors, choose by allocation to a supply chain partner or choose the <FONT face="Courier New">PartSourceChannel</FONT> with the most available inventory.&nbsp; The first set of unit tests could be to start the <FONT face="Courier New">PartSourcing</FONT> shelf class and test the <FONT face="Courier New">SelectChannelWithMostInventory()</FONT> and <FONT face="Courier New">SelectChannelByAllocation()</FONT> methods first.&nbsp; It&#8217;s an easy place to start because you can simply create an array of <FONT face="Courier New">PartSourceChannel</FONT> objects, pass them into a <FONT face="Courier New">PartSourcing</FONT> object, and verify that <FONT face="Courier New">PartSourcing</FONT> returns the correct <FONT face="Courier New">PartSourceChannel</FONT>.</P><br />
<DIV><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; [TestFixture]</P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourcingTester</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [Test]</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> SelectChannelWithMostInventoryWithMoreThanOneChannel()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel1 = <SPAN>new</SPAN> PartSourceChannel(100);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel2 = <SPAN>new</SPAN> PartSourceChannel(400);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel3 = <SPAN>new</SPAN> PartSourceChannel(200);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel4 = <SPAN>new</SPAN> PartSourceChannel(300);</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourcing sourcing = <SPAN>new</SPAN> PartSourcing();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sourcing.Channels = <SPAN>new</SPAN> PartSourceChannel[]</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; channel1, channel2, channel3, channel4</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; };</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel = sourcing.SelectChannelWithMostInventory();</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Assert.AreSame(channel4, channel, &#8220;Channel 4 has the most inventory&#8221;);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><!--EndFragment--><br />
<P>That was simple enough.&nbsp; Once the unit tests for <FONT face="Courier New">PartSourcing</FONT> are complete you could move onto the <FONT face="Courier New">PartSourceRouting.Route()</FONT> method.&nbsp; Following the &#8220;<A HREF="/blogs/jeremy.miller/archive/2006/03/09/140465.aspx">Push, Don&#8217;t Pull</A>&#8221; law, <FONT face="Courier New">PartSourceRouting</FONT> is completely ignorant of how or where the <FONT face="Courier New">PartSourceChannel</FONT> data is stored, it just processes the data it&#8217;s given.&nbsp; Now that we trust the <FONT face="Courier New">PartSourcing</FONT> class, we can start building the <FONT face="Courier New">PartSourcing</FONT> members of a <FONT face="Courier New">PartSourceRouting</FONT> class and then call <FONT face="Courier New">Route()</FONT> to verify the expected outcome.&nbsp; </P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; [TestFixture]</P><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourceRoutingTester</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [Test]</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>void</SPAN> RouteWithOnlyPartSourceChannelsOnShelf2()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// Build a PartSourceRouting in memory</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel1 = <SPAN>new</SPAN> PartSourceChannel(100);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel2 = <SPAN>new</SPAN> PartSourceChannel(400);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel3 = <SPAN>new</SPAN> PartSourceChannel(200);</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourcing sourcing = <SPAN>new</SPAN> PartSourcing();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sourcing.Channels = <SPAN>new</SPAN> PartSourceChannel[]</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; channel1, channel2, channel3</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; };</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceRouting routing = <SPAN>new</SPAN> PartSourceRouting();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; routing.Shelf2 = sourcing;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel = routing.Route();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Assert.AreSame(channel2, channel, &#8220;Channel 2 has the most inventory&#8221;);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>So now that the entire &#8220;bookshelf&#8221; routing is working we can move onto the next task &#8212; actually building the bookshelf.&nbsp; We&#8217;re still not ready to touch the database though.&nbsp; Create a new <FONT face="Courier New">PartSourceRoutingBuilder</FONT> class that takes in an existing array of <FONT face="Courier New">PartSourceChannel</FONT> objects and creates a new <FONT face="Courier New">PartSourceRouting</FONT> with all of the <FONT face="Courier New">PartSourceChannel</FONT> objects on the proper shelves.</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourceRoutingBuilder</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>readonly</SPAN> PartSourceChannel[] _channels;</P><br />
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>readonly</SPAN> PartRequest _request;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceRoutingBuilder(PartSourceChannel[] channels, PartRequest request)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _channels = channels;</P><br />
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _request = request;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceRouting Build()</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>Just to write simpler tests first, I would try to first test how to shelf a single <FONT face="Courier New">PartSourceChannel</FONT> before trying out the larger <FONT face="Courier New">Build()</FONT> method.&nbsp; </P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// I&#8217;m using a static method here so there&#8217;s no issue</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// with prior state of a PartSourceRoutingBuilder</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// instance</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>static</SPAN> <SPAN>void</SPAN> ShelvePartSourceChannel(</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel channel, </P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceRouting routing, </P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MaterialRequest request)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// analyze the channel against the request and</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// put the channel on the proper shelf</SPAN></P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>Once the <FONT face="Courier New">ShelvePartSourceChannel()</FONT> is unit tested with all the scenarios we can think of, then move onto the <FONT face="Courier New">Build()</FONT> method that will delegate to <FONT face="Courier New">ShelvePartSourceChannel()</FONT>.&nbsp; If we unit test <FONT face="Courier New">ShelvePartSourceChannel()</FONT> thoroughly, we don&#8217;t need to write a unit test for nearly as many permutations of <FONT face="Courier New">PartSourceChannel</FONT> arrays through the larger <FONT face="Courier New">Build()</FONT> method, reducing the complexity of testing.&nbsp; </P><br />
<P>Back to my team&#8217;s struggle with testing the original routing engine.&nbsp; In no small part due to the experience with the routing engine I&#8217;m a big, big believer in <A href="http://en.wikipedia.org/wiki/White_box_testing">white-box testing</A>.&nbsp; Because of the way we&#8217;ve built the pieces of the routing engine here we can easily write a series of <A href="http://fitnesse.org/">FitNesse</A> fixtures that allow the testers to quickly define a list of <FONT face="Courier New">PartSourceChannel</FONT>&#8216;s and check the routing selection for a given <FONT face="Courier New">MaterialRequest</FONT> without the database or any kind of web service or user interface being involved.&nbsp; That should cut down the difficulty of writing automated tests for the routing engine to validate the business rules of the routing engine in isolation before we try to test the engine from service invocation to database.&nbsp; We can go into the black box testing with confidence that the engine itself works first.</P><br />
<P>So the business rules are verified, but we still need a service entry point and the database access to correlate the data from the database into the <FONT face="Courier New">PartSourceChannel</FONT> objects.&nbsp; Because we know it&#8217;s easier to test by building from the ground up we&#8217;ll code and test the correlation from the database first and following the <A HREF="/blogs/jeremy.miller/articles/129543.aspx">Dependency Inversion Principle</A> we&#8217;ll put this functionality behind an interface.</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>interface</SPAN> IPartSourcingDataService</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel[] FindRoutingOptions(MaterialRequest request);</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>Finally, we can move on to the service class that will be called by the rest of the application to access the routing logic.</P><br />
<DIV><br />
<P>&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> PartSourceRoutingEngine</P><br />
<P>&nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>readonly</SPAN> IPartSourcingDataService _service;</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceRoutingEngine(IPartSourcingDataService service)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _service = service;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> PartSourceChannel Route(MaterialRequest request)</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceChannel[] channels = _service.FindRoutingOptions(request);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceRoutingBuilder builder = <SPAN>new</SPAN> PartSourceRoutingBuilder(channels);</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PartSourceRouting routing = builder.Build();</P><br />
<P>&nbsp;</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> routing.Route();</P><br />
<P>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P><br />
<P>&nbsp;&nbsp;&nbsp; }</P></DIV><br />
<P>That class was easy &#8212; and that&#8217;s a big point to following the &#8220;Code from the Bottom Up&#8221; rule.&nbsp; The flow of the <FONT face="Courier New">PartSourceRoutingEngine</FONT> controller class falls out because all of the little pieces are already defined and built.&nbsp; <FONT face="Courier New">PartSourceRoutingEngine</FONT> simply has to coordinate the actions of the existing <FONT face="Courier New">IPartSourceDataService</FONT>, <FONT face="Courier New">PartSourceRoutingBuilder</FONT>, and <FONT face="Courier New">PartSourceRouting</FONT> classes.</P><br />
<H4>Controlling Testing Permutations</H4><br />
<P>I started this case study as an exercise in controlling permutations.&nbsp; In the real world project the possible pathways through the routing looked something like this (feel free to mock my math here):</P><br />
<OL><br />
<LI>12 different combinations of table joins across the three tables * 3 sets of region specific rules for a total of 36 permutations</LI><br />
<LI>5 valid shelves * 0, 1, 2, or 3 channels per shelf = 4 ^ 5 = 1024</LI></OL><br />
<P>I&#8217;m not sure how the 36 related to the 1024, but suffice it to say the final answer is &gt;10000.&nbsp; Covering every permutation simply isn&#8217;t feasible, but by focusing on completely testing the smaller steps first we might get something like:</P><br />
<OL><br />
<LI>The 36 permutations of the data correlation</LI><br />
<LI>Test the selection process of each shelf individually with 0, 1, 2, or 3 channels &#8212; 4 * 5 = 20</LI><br />
<LI>Maybe test the selection of the five shelves &#8212; has channels or not = 2 ^ 5 = 32 (but I think you could get by with many fewer)</LI></OL><br />
<P>That math gives you 80+ tests.&nbsp; Say you add half again as many tests that run end to end to prove that the pieces work together.&nbsp; That adds up to 120 tests, far smaller than the 10,000+ combinations from end-to-end.&nbsp; </P><br />
<H4>Easing the Testing Burden</H4><br />
<P>Quoting my esteemed tester colleague Jim Matthews &#8211;</P><br />
<BLOCKQUOTE>Testing takes a lot longer if all you can do is write end-to-end tests.&nbsp; It&#8217;s also easier to find and remove problems from smaller tests.</BLOCKQUOTE><br />
<P>When I wrote the routing engine I wasn&#8217;t using Test Driven Development much less Acceptance Test Driven Development in conjunction with the testers and analysts.&nbsp; The testers had no other way to test than to load up the database with data, run the routing engine, and see if the results matched up with expectations.&nbsp; Three years of development with Agile processes has given me a much greater appreciation for a <A HREF="/blogs/jeremy.miller/archive/2005/08/17/130864.aspx">holistic approach for software development</A>.&nbsp; Much of the coding process is simply removing defects &#8212; compile time checks, code reviews, unit tests, acceptance tests, etc.&nbsp; The faster you can purify the code by removing defects the better the real productivity of the team.&nbsp; My productivity on the routing engine in terms of coding alone was actually pretty good, but the tester&#8217;s productivity was awful.&nbsp; In terms of Lean Programming I made a point optimization that didn&#8217;t help the whole process.&nbsp; The lesson I&#8217;ve taken away from the routing engine is to write code that is easier for the testers to test &#8212; and make sure that the testers are aware of the potential for smaller tests, but that&#8217;s a post for a different day&#8230;</P><br />
<P>Looking back, we could have made the testing of the routing engine much smoother is we had focused on testing the business rules in isolation from the database and the interface.&nbsp; The testers bogged down in the database setup and flat file creation just to setup a business rules scenario.&nbsp; If they could have just started by saying &#8220;I have these <FONT face="Courier New">PartSourceChannel</FONT>&#8216;s and this <FONT face="Courier New">MaterialRequest</FONT>, I expect this <FONT face="Courier New">PartSourceChannel</FONT> to be selected&#8221; we could have nailed down the business rules much faster with tests that were human readable.&nbsp; Once we were confident in the implementation of the business rules we could have moved onto integration with the front end and the database.&nbsp; </P><br />
<P>To write acceptance tests in a white box fashion, the system has to have seams, places where we can exercise the business rules in isolation without running the full application stack.&nbsp; The good news is that you don&#8217;t have to spend countless hours in front of a whiteboard devising seams for your testers.&nbsp; Simply proceed in a &#8220;test small, before testing big&#8221; manner of constructing code and those seams will already be there in your code.</P><br />
<P>&nbsp;</P><br />
<H4>Wrapping Up</H4><br />
<P>We&#8217;ve always known that software development works best when we can divide larger problems into smaller, more easily manageable pieces, it&#8217;s just the mechanism for determining the smaller pieces that&#8217;s always difficult.&nbsp; To get the full benefits of TDD it really must be used in combination with other practices like Continuous Integration and true Iterative Development.&nbsp; </P><br />
<P>You might ask, why can&#8217;t I achieve all of this with upfront design and just plain old unit testing? Maybe you can, at least some of the time, if your design skills are good and the requirements are stable.&nbsp; I&#8217;d argue that over time the odds are in favor of adaptive techniques that give you more opportunities to make corrections along the way.&nbsp; As far as just plain unit testing goes, TDD gets unit testing into play much earlier and more consistently.&nbsp; If you build code without thinking about how you will test the code, you&#8217;ll often find yourself with code that is hard to test.&nbsp; Writing unit tests first forces you to write testable code and goes a long way toward better unit test coverage.</P><br />
<P>Hopefully this post addressed the usage of TDD to solve bigger problems in pieces. I did cut some things out of this post for the sake of length, so there will be some follow up posts this week on TDD and Debugging, TDD and Flow, and using Mock objects to create smaller tests and avoid context switching.</P></p>
<div class="shr-publisher-168"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/test-driven-development/" title="View all posts in Test Driven Development" rel="category tag">Test Driven Development</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2006/05/30/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big/" title="Permalink to Achieve Better Results by following Jeremy&#8217;s Third Law of TDD:  Test Small Before Testing Big" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2006/05/30/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big/feed/" title="Comments RSS to Achieve Better Results by following Jeremy&#8217;s Third Law of TDD:  Test Small Before Testing Big" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-168 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2006/05/26/grab-bag-of-follow-ups-for-data-access-persistence-query-engines-and-or-mapping/" rel="prev"><span class="meta-nav">&larr;</span> Grab bag of follow up&#8217;s for data access, persistence, query engines, and o/r mapping</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2006/06/01/nick-parker-on-structuremap/" rel="next">Nick Parker on StructureMap <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-727">
                    <div id="dsq-comment-header-727" class="dsq-comment-header">
                        <cite id="dsq-cite-727">
    http://intrepidnoodle.com                            <span id="dsq-author-user-727">Aaron Robson</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-727" class="dsq-comment-body">
                        <div id="dsq-comment-message-727" class="dsq-comment-message"><p>Nice article.<br />
I especially liked the bit about the class responsibilities &#8211; service providers, information holders etc. I haven&#8217;t ever explicitly considered my classes in that way, and I can see how the combination of IOC and test driving the service providers first can simplify things.</p>
<p>I think there is still some top down work needed (for myself at least) in order to determine which service providers are actually needed in the first place. While this is potentially straightforward with a good story in place, I find it&#8217;s often harder to do when specifically developing a framework and not an application itself &#8211;  this was always mentioned as a difficulty with eXtreme Programming too.</p>
<p>Aaron</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-728">
                    <div id="dsq-comment-header-728" class="dsq-comment-header">
                        <cite id="dsq-cite-728">
                                <span id="dsq-author-user-728">Liang</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-728" class="dsq-comment-body">
                        <div id="dsq-comment-message-728" class="dsq-comment-message"><p>It is a great post! But I still have a question for Jeremy. Could you let me know if you have a basic application architecture design in mind before you write the first line of code? Or you just let the test/code lead you to a design. For example, if you find a common method in related classes, you create a Interface, just as you metioned in validation. If that is correct, I think TDD is pretty hard for a beginner, since the developers should have very good knowledge in OO, design pattern, refactoring before beginning implementing TDD. otherwise how she/he know how and when to refactoring?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-729">
                    <div id="dsq-comment-header-729" class="dsq-comment-header">
                        <cite id="dsq-cite-729">
                                <span id="dsq-author-user-729">jmiller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-729" class="dsq-comment-body">
                        <div id="dsq-comment-message-729" class="dsq-comment-message"><p>Liang, </p>
<p>That&#8217;s a pretty good question/concern.  I think I want to write a short follow up for your question early next week.</p>
<p>Jeremy</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-730">
                    <div id="dsq-comment-header-730" class="dsq-comment-header">
                        <cite id="dsq-cite-730">
    http://emmanuel                            <span id="dsq-author-user-730">emmanuel adjabeng</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-730" class="dsq-comment-body">
                        <div id="dsq-comment-message-730" class="dsq-comment-message"><p>please send me some your items thanks<br />
    greater grace church<br />
      box193 ashaiman<br />
        westafrica 00233<br />
              ghana</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-731">
                    <div id="dsq-comment-header-731" class="dsq-comment-header">
                        <cite id="dsq-cite-731">
                                <span id="dsq-author-user-731">Amandeep Kaur</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-731" class="dsq-comment-body">
                        <div id="dsq-comment-message-731" class="dsq-comment-message"><p>Can we test services efficiently with Visual studio Teamsystem 2008&#8242;s Test Edition? If yes What can be the best approach?</p>
<p>Thanks.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2006/05/30/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big/';
    var disqus_identifier = '168 /blogs/jeremy.miller/archive/2006/05/30/145752.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "Achieve Better Results by following Jeremy&#8217;s Third Law of TDD:  Test Small Before Testing Big";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=168');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2006\/05\/30\/achieve-better-results-by-following-jeremys-third-law-of-tdd-test-small-before-testing-big\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.674 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 12:36:19 -->
<!-- super cache -->