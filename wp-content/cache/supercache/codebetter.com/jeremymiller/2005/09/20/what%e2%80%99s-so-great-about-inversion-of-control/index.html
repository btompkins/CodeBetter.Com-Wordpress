<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>What’s so great about Inversion of Control? | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Slides from the Continuous Integration Talk Last Night (With Fixed Link)' href='http://codebetter.com/jeremymiller/2005/09/20/slides-from-the-continuous-integration-talk-last-night-with-fixed-link/' />
<link rel='next' title='Database per Developer and Environment' href='http://codebetter.com/jeremymiller/2005/09/21/database-per-developer-and-environment/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=77' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,154] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2005/09/20/what%e2%80%99s-so-great-about-inversion-of-control/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-77" class="post-77 post type-post status-publish format-standard hentry category-design-patterns category-test-driven-development">
					<h1 class="entry-title">What’s so great about Inversion of Control?</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2005/09/20/what%e2%80%99s-so-great-about-inversion-of-control/" title="10:50 pm" rel="bookmark"><span class="entry-date">September 20, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><P class="MsoNormal"><A href="/blogs/jeremy.miller/archive/2005/09/13/131897.aspx">Inversion of Control</A> (IoC) is an essential tool for any software designer’s design toolbox because it’s often a great way to break dependencies between classes and promote loose coupling.<SPAN>&nbsp; </SPAN>IoC is vital for doing Test Driven Development without pulling out all of your hair in frustration.<SPAN>&nbsp; </SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><B>Real Life Example</B></P><br />
<P class="MsoNormal"><B>&nbsp;</B></P><br />
<P class="MsoNormal">I’m doing an interesting refactoring early this week on some existing code.<SPAN>&nbsp; </SPAN>I apologize in advance for being a little vague, but the NDA thingy gets in the way a bit here.<SPAN>&nbsp; </SPAN>The product that my team works on is basically a B2B hub between sender companies (spokes) and receiving companies.<SPAN>&nbsp; </SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">The application: </P><br />
<OL type="1"><br />
<LI class="MsoNormal">Receives a message in one of a handful of industry standards and 3<SUP>rd</SUP> party formats<br />
<LI class="MsoNormal">Converts the data into a <A href="/blogs/jeremy.miller/archive/2005/09/13/131897.aspx">canonical data format</A><br />
<LI class="MsoNormal">Performs a variety of business validations<br />
<LI class="MsoNormal">Translates the results into yet another industry standard for transmittal to another downstream system</LI></OL><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">The translation code is obviously critical to the system, so it’s very important that the automated testing is rock solid.<SPAN>&nbsp; </SPAN>Moreover, that code would be extremely useful in many other contexts throughout our enterprise.<SPAN>&nbsp; </SPAN>The code works just fine and there is a robust suite of automated tests ensuring that the code continues to work.<SPAN>&nbsp; </SPAN>I had tried in the past to adapt this code inside of an automated regression test tool without any success because it had too much “tail.”<SPAN>&nbsp; </SPAN>What I mean by this is that the code can only function with some specific dependencies on a couple of different data sources that weren’t necessarily easy or even possible to recreate without bringing in a large fraction of the system.<SPAN>&nbsp; </SPAN>Using the translation code requires some data access code which in turn requires some configuration code and external settings in a Registry (We’re going to make this go away too.<SPAN>&nbsp; </SPAN>I detest using the Registry for any configuration, much less as a Plugin strategy.).</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">In an ongoing effort to speed up a slow (15-20 minutes) build, I managed to break the integration tests for the translation classes and had an opportunity to look much closer at this code.<SPAN>&nbsp; </SPAN>Here’s roughly what I found:</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> Translator1</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>readonly</SPAN> IDataSource _source;</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> Translator1(IDataSource source)</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_source = source;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> Translator1()</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_source = <SPAN>new</SPAN> CompanyDataSource();</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> XmlDocument TranslateFlatFile(<SPAN>byte</SPAN>[] contents, <SPAN>string</SPAN> senderId, <SPAN>string</SPAN> receiverId)</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlDocument document = <SPAN>this</SPAN>.startNewXmlDocument();</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CompanyInfo sender = _source.FetchCompanyInfo(senderId);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CompanyInfo receiver = _source.FetchCompanyInfo(receiverId);</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>this</SPAN>.createSenderNode(sender, document);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>this</SPAN>.createReceiverNode(receiver, document);</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// Do a lot of other stuff</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>return</SPAN> document;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>void</SPAN> deepInTheBowelsOfTheClass(<SPAN>string</SPAN> key)</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>string</SPAN> something = DataSourceSingleton.Instance.LookupValue(key);<SPAN> </SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// do something with &#8220;something&#8221;</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>[OTHER METHODS]</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal">And the test fixture looks a bit like this:</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>[TestFixture]</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> Translator1TestFixture</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>[Test]</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>void</SPAN> WriteTheSenderNode()</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// The sender and receiver data is assumed to be in the database &#8212; somewhere</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Translator1 translator = <SPAN>new</SPAN> Translator1();</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>byte</SPAN>[] contents = <SPAN>this</SPAN>.readFlatFile();</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlDocument document = translator.TranslateFlatFile(contents, &#8220;ID00001&#8243;, &#8220;ID00210&#8243;);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlNode senderNode = document.DocumentElement.SelectSingleNode(&#8220;Sender&#8221;);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Assert.AreEqual(&#8220;Austin&#8221;, senderNode["City"].InnerText);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>byte</SPAN>[] readFlatFile()…</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">So what’s so terribly wrong with this code?<SPAN>&nbsp; </SPAN>From my standpoint there are several problems.</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<UL type="disc"><br />
<LI class="MsoNormal"><B>Setting up the tests</B>.<SPAN>&nbsp; </SPAN>The unit tests cannot function today without known data being previously setup in the database external to the TestFixture.<SPAN>&nbsp; </SPAN>When you do write tests against a live database you’re forced into a “least evil” decision.<SPAN>&nbsp; </SPAN>One of the things I talked about in an <A href="/blogs/jeremy.miller/archive/2005/07/20/129552.aspx">earlier post</A> was the desire for tests to reveal the intention of the code.<SPAN>&nbsp; </SPAN>One of the best ways to do this is to make sure that the test is largely self-contained.<SPAN>&nbsp; </SPAN>In this case the data assumed to be inserted into the database prior to the test running.<SPAN>&nbsp; </SPAN>One way we can make this test self-contained is to do the database data setup inside the TestFixture class itself.<SPAN>&nbsp; </SPAN>That’s okay with small chunks of data, but it doesn’t scale very well.<SPAN>&nbsp; </SPAN><br />
<LI class="MsoNormal"><B>The tests are not isolated</B>.<SPAN>&nbsp; </SPAN>The tests break if other tests overwrite the data in the database.<SPAN>&nbsp; </SPAN>Life is happier by far when each test is truly isolated and order-independent.<SPAN>&nbsp; </SPAN>The dependency on the singleton in the <SPAN>Translator1</SPAN> class certainly doesn’t help either.<SPAN>&nbsp; </SPAN>I’m fighting with a set of tests today that are not isolated.<SPAN>&nbsp; </SPAN>They exhibit some interesting behavior like running successfully one at a time but failing occasionally when they’re run with other tests.<SPAN>&nbsp; </SPAN>I’m not happy.<br />
<LI class="MsoNormal"><B>Debugging the unit tests</B>.<SPAN>&nbsp; </SPAN>Look at the <SPAN>WriteTheSenderNode</SPAN> test method.<SPAN>&nbsp; </SPAN>There is an assertion that checks that the “City” node has a value of “Austin.”<SPAN>&nbsp; </SPAN>Just looking at the test code you won’t be able to see where this value comes from.<SPAN>&nbsp; </SPAN>It’s not clear from the test code why the value of the xml node is supposed to be “Austin.”<SPAN>&nbsp; </SPAN>You can partially beat this problem with comments in the assertions, but that’s not enough in my book.<SPAN>&nbsp; </SPAN>Comments are often a crutch for obfuscated code and this isn’t an exception.<SPAN>&nbsp; </SPAN>Another thing to keep in mind is that granular tests are easier to debug than coarse tests.<SPAN>&nbsp; </SPAN>This code today only has integrated tests without any unit tests.<br />
<LI class="MsoNormal"><B>Test execution time</B>.<SPAN>&nbsp; </SPAN>Tests that run against the database are slower than tests that run completely inside one process.<SPAN>&nbsp; </SPAN>I’m writing this post while I wait for some <B>very</B> slow integrated tests to run.<SPAN>&nbsp; </SPAN>Slow tests are a form of inefficiency.<SPAN>&nbsp; </SPAN>I really want to test the translation code here, not the data access.<SPAN>&nbsp; </SPAN>If I can isolate the translation functionality away from the database structure, I can make the tests faster.<br />
<LI class="MsoNormal"><B>Reuse the code</B>.<SPAN>&nbsp; </SPAN>As I’ve stated before, it would be very advantageous to reuse this translation code.<SPAN>&nbsp; </SPAN>Today this is difficult because of the tight coupling to other classes.<SPAN>&nbsp; </SPAN>The dependency on the specific data access class is easily remedied by a little “constructor injection,” but there is still the dependency on the singleton buried deep inside the class.<SPAN>&nbsp; </SPAN>To use the translation code I have to bring with me everything that damn singleton needs too.<SPAN>&nbsp; </SPAN>Moreover, it’s not going to be obvious to someone else attempting to use the translation code what they need without tracing deep into the translation to figure out the external dependencies of the singleton.<SPAN>&nbsp; </SPAN><A href="/blogs/jeremy.miller/archive/2005/08/04/130302.aspx">Singleton == testing pain</A>.<SPAN>&nbsp; </SPAN>I haven’t done enough research into the singleton usage, but one way or another we’ll remove the dependency on the singleton.</LI></UL><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><B>Refactoring to Inversion of Control</B></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">My thought on the translation code is to apply Inversion of Control to the translation code to remove the database dependency.<SPAN>&nbsp; </SPAN>Let some other class be responsible for running out and fetching the receiver and sender information and “push” it into the translator.<SPAN>&nbsp; </SPAN>I could have abstracted the data source class as an interface and used Constructor Injection to push alternative classes or mocks into the Translator2 class.<SPAN>&nbsp; </SPAN>My thinking in this case is to simplify both the reuse of the translation code and eliminate the mocking overhead (~70 automated tests) by eliminating the interaction with a data source class altogether.</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">The code below is a skeleton of the approach I’m going to take to refactor our translation code (someday).<SPAN>&nbsp; </SPAN>Here’s how I think the new code stacks up to the old code.</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<UL type="disc"><br />
<LI class="MsoNormal"><B>Setting up the tests</B>.<SPAN>&nbsp; </SPAN>The input data is created within the test itself because the inputs are just objects.<SPAN>&nbsp; </SPAN>Don’t ever discount the value of Intellisense in creating test data.<SPAN>&nbsp; </SPAN>Working with SQL statements or DataSet’s is laborious and error prone.<br />
<LI class="MsoNormal"><B>The tests are isolated.</B><SPAN>&nbsp; </SPAN>The translation code no longer depends on any kind of external or shared data inside the tests.<br />
<LI class="MsoNormal"><B>Debugging.</B><SPAN>&nbsp; </SPAN>The tests are somewhat easier to debug because the tests are self-contained.<SPAN>&nbsp; </SPAN>Debugging one of these tests if they break is simpler because you don’t have to keep “ALT-Tabbing” between the database window and the code.<SPAN>&nbsp; </SPAN>I’d also argue that the test code is much more intention revealing.<br />
<LI class="MsoNormal"><B>Test execution time</B>.<SPAN>&nbsp; </SPAN>These tests will run faster because the external network hops to the database are eliminated.<SPAN>&nbsp; </SPAN>Don’t underestimate the importance of fast tests.<br />
<LI class="MsoNormal"><B>Code reuse</B>.<SPAN>&nbsp; </SPAN>I can now reuse the translation code more easily in other contexts.<SPAN>&nbsp; </SPAN>I don’t have to have any special database structure or external configuration anymore to use the translation code.</LI></UL><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> Translator2</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> Translator2()</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> XmlDocument TranslateFlatFile(<SPAN>byte</SPAN>[] contents, CompanyInfo sender, CompanyInfo receiver )</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlDocument document = <SPAN>this</SPAN>.startNewXmlDocument();</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>this</SPAN>.createSenderNode(sender, document);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>this</SPAN>.createReceiverNode(receiver, document);</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// Do a lot of other stuff</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>return</SPAN> document;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>#region</SPAN><SPAN> other methods<SPAN>…</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>[TestFixture]</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> Translator2TestFixture</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>[Test]</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>void</SPAN> WriteTheSenderNode()</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CompanyInfo sender = <SPAN>new</SPAN> CompanyInfo();</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>sender.City = &#8220;Austin&#8221;;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// set other sender properties</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CompanyInfo receiver = <SPAN>new</SPAN> CompanyInfo();</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>// set receiver properties</SPAN></SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>byte</SPAN>[] contents = <SPAN>this</SPAN>.readFlatFile();</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Translator2 translator = <SPAN>new</SPAN> Translator2();</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlDocument document = translator.TranslateFlatFile(contents, sender, receiver);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>XmlNode senderNode = document.DocumentElement.SelectSingleNode(&#8220;Sender&#8221;);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Assert.AreEqual(sender.City, senderNode["City"].InnerText);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>byte</SPAN>[] readFlatFile()…</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal">All I’ve really done is move the responsibility for fetching data out of the database into another class.<SPAN>&nbsp; </SPAN>It’s a small change but it had a positive impact on both the code and the testing.<SPAN>&nbsp; </SPAN>If you think about it, you could actually say that software design boils down to “Where should this code go?”<SPAN>&nbsp; </SPAN>I think there’s a watershed moment in every developer’s career when they start look more at their code as a structure and less as a bag of statements.<SPAN>&nbsp; </SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><B>Other Examples</B></P><br />
<P class="MsoNormal"><B>&nbsp;</B></P><br />
<P class="MsoNormal">We’re taught that the key to safe lifting is “<A href="http://northonline.northseattle.edu/backcare/tutorials/slide9.html">push, don’t pull</A>.” <SPAN>&nbsp;</SPAN>I like to think of Inversion of Control as applying this mantra to code.<SPAN>&nbsp; </SPAN>IoC is fairly common, and much more so with Test Driven Development practices.<SPAN>&nbsp; </SPAN>Here are some other examples of IoC you might run into.</P><br />
<P class="MsoNormal">&nbsp;</P><br />
<UL type="disc"><br />
<LI class="MsoNormal">The <A href="http://martinfowler.com/eaaCatalog/dataMapper.html">Data Mapper</A> pattern is the central concept in many Object/Relational Mapping tools.<SPAN>&nbsp; </SPAN>Using an external mapper class to handle persistence duties for a business domain class has several advantages.<SPAN>&nbsp; </SPAN>The domain classes can become simpler because they’re no longer interacting with any kind of data class.<SPAN>&nbsp; </SPAN>You can also insulate the business domain from the database structure and vice versa.<SPAN>&nbsp; </SPAN>Testing the business logic can be much simpler with a <A href="http://martinfowler.com/eaaCatalog/domainModel.html">domain model</A>.<SPAN>&nbsp; </SPAN>My company’s main application today relies on far too many T-SQL stored procedures.<SPAN>&nbsp; </SPAN>Some of our multi-billion dollar clients seem to think they have the right to run our application on Oracle instead.<SPAN>&nbsp; </SPAN>We’re eventually going to arrange our business logic along domain model principles and take advantage of an O/R mapping tool for multi-database support.<br />
<LI class="MsoNormal"><A href="http://martinfowler.com/eaaDev/ModelViewPresenter.html">Model View Presenter</A> (MVP) might not be a true example of IoC, but it’s similar in philosophy.<SPAN>&nbsp; </SPAN>When you use the MVP you make the “view” classes completely passive.<SPAN>&nbsp; </SPAN>Instead of the view making requests to the controller, the controller tells the view what to do.<SPAN>&nbsp; </SPAN>MVP is the best mechanism that I know for doing TDD with user interface clients.<br />
<LI class="MsoNormal">A side effect of using Dependency Injection for configuration is that your classes are no longer dependent on any kind of external configuration file (or God forbid, the registry).<SPAN>&nbsp; </SPAN>Here’s a simple example of “push” configuration.<SPAN>&nbsp; </SPAN>The <SPAN>PushClass</SPAN> will be constructed by some kind of Builder class that reads the configuration and returns a PushClass object.<SPAN>&nbsp; </SPAN>I’m a huge fan of this technique after a couple of projects now.</LI></UL><br />
<P class="MsoNormal">&nbsp;</P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> PullClass</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>int</SPAN> _threshold;</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> PullClass()</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_threshold = <SPAN>int</SPAN>.Parse(System.Configuration.ConfigurationSettings.AppSettings["Threshold"]);</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>class</SPAN> PushClass</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>private</SPAN> <SPAN>readonly</SPAN> <SPAN>int</SPAN> _threshold;</SPAN></P><br />
<P class="MsoNormal"><SPAN>&nbsp;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>public</SPAN> PushClass(<SPAN>int</SPAN> threshold)</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_threshold = threshold;</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal"><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</SPAN></P><br />
<P class="MsoNormal">&nbsp;</P><br />
<UL type="disc"><br />
<LI class="MsoNormal">If you look at the example user story from my article on <A href="/blogs/jeremy.miller/articles/131726.aspx">Assigning Responsibilities</A>, I used IoC to isolate the functionality for creating HTML from an Invoice so that this functionality could be tested without a lot of interaction with other classes.</LI></UL><br />
<H2><EM><FONT face="Arial">&nbsp;</FONT></EM></H2><br />
<P class="MsoNormal">The obvious example of IoC from the blogosphere is Dependency Injection.<SPAN>&nbsp; </SPAN>My next post will be an introduction to Dependency Injection (DI) as a concept independent of the DI/IoC tools.<SPAN>&nbsp;&nbsp;&nbsp; </SPAN></P></p>
<div class="shr-publisher-77"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/design-patterns/" title="View all posts in Design Patterns" rel="category tag">Design Patterns</a>, <a href="http://codebetter.com/jeremymiller/category/test-driven-development/" title="View all posts in Test Driven Development" rel="category tag">Test Driven Development</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2005/09/20/what%e2%80%99s-so-great-about-inversion-of-control/" title="Permalink to What’s so great about Inversion of Control?" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2005/09/20/what%e2%80%99s-so-great-about-inversion-of-control/feed/" title="Comments RSS to What’s so great about Inversion of Control?" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-77 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2005/09/20/slides-from-the-continuous-integration-talk-last-night-with-fixed-link/" rel="prev"><span class="meta-nav">&larr;</span> Slides from the Continuous Integration Talk Last Night (With Fixed Link)</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2005/09/21/database-per-developer-and-environment/" rel="next">Database per Developer and Environment <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-228">
                    <div id="dsq-comment-header-228" class="dsq-comment-header">
                        <cite id="dsq-cite-228">
    http://blogs.telussa.com/danwatts/                            <span id="dsq-author-user-228">Dan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-228" class="dsq-comment-body">
                        <div id="dsq-comment-message-228" class="dsq-comment-message"><p>Great post! Thanks for sharing!</p>
<p>Another downfall with data access dependancy : If the database is readonly, your test will have to run under a special user to insert test data.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-229">
                    <div id="dsq-comment-header-229" class="dsq-comment-header">
                        <cite id="dsq-cite-229">
                                <span id="dsq-author-user-229">Gregory Madsen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-229" class="dsq-comment-body">
                        <div id="dsq-comment-message-229" class="dsq-comment-message"><p>There has been a lot written about Dependency Injection (DI) and Inversion of Control (IoC) and while I think I understand the ideas behind them (separation of responsibility, testability, orthogonality, etc.), there is something nagging at the back of mind that says that doing DI means breaking OO encapsulation. One could almost say that it is a move backwards towards the bad old days where we had data structures and procedures that operated on them. We are now passing the dependencies into the object and asking it to work on them. To me this is not that far removed from passing a structure into a standalone subroutine. I always thought that the idea behind encapsulation was that you could ask the object to do something and you didn’t need to know or care how it did it, but that it just did it. It was up to the object to create or get whatever it needed to do its job. Now we seem to be saying that the object needs to depend on a master object of some kind to give it its data, which smacks of the old “main routine” with subroutines model. </p>
<p>Now I will admit that over the years I have found my own code moving towards IoC as it seemed the natural thing to do, but back then (2001-2003) I had no idea that it had a name, as I was working mostly on my own. As I worked to improve my code and reduce duplication, etc., it seemed like what was really needed was some sort of a configuration driven “builder” of my classes at run time so that the pieces would be much more reusable and modular. (I hadn’t learned of TDD then.) That particular project ended before I could implement these ideas, and to this day, it retains its awkward design, but it is now the responsibility of others, a decision that I had no control over. </p>
<p>I guess what it all boils down to is that there are competing interests in software design, and while strong encapsulation of everything sounds good in theory, it falls down a bit in the real world. Maybe I’m answering my own question here, but I guess if one sticks to using well formed interfaces inside a class, then the overall behaviour of that class is in fact fixed and is encapsulated along with its data. What is not fixed by the class design is the actual classes that implement that required behaviour. Subtle, but a very important distinction.</p>
<p>Does this make any sense to anyone else?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-230">
                    <div id="dsq-comment-header-230" class="dsq-comment-header">
                        <cite id="dsq-cite-230">
    http://revizyonileorganizematbaacilikbrnckvvtmllttrhaberi.bloggum.com                            <span id="dsq-author-user-230">revizyon ile organize matbaacılık brnckvvtmllttrhaberi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-230" class="dsq-comment-body">
                        <div id="dsq-comment-message-230" class="dsq-comment-message"><p>thanks for all</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-7234">
                    <div id="dsq-comment-header-7234" class="dsq-comment-header">
                        <cite id="dsq-cite-7234">
                                <span id="dsq-author-user-7234">Andy Nagai</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-7234" class="dsq-comment-body">
                        <div id="dsq-comment-message-7234" class="dsq-comment-message"><p>whats with all the spacing in this post? A  bunch of empty p tags.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2005/09/20/what%e2%80%99s-so-great-about-inversion-of-control/';
    var disqus_identifier = '77 /blogs/jeremy.miller/archive/2005/09/20/132290.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "What’s so great about Inversion of Control?";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=77');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2005\/09\/20\/what%e2%80%99s-so-great-about-inversion-of-control\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.621 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 11:55:05 -->
<!-- super cache -->