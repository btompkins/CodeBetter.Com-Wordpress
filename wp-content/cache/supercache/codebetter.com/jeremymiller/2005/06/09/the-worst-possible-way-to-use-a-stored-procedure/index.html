<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>The Worst Possible Way to use a Stored Procedure | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Learning Lessons &#8212; Can You Make Mistakes at Work?' href='http://codebetter.com/jeremymiller/2005/06/03/learning-lessons-can-you-make-mistakes-at-work/' />
<link rel='next' title='A classic article from Alistair Cockburn and horror stories just for fun' href='http://codebetter.com/jeremymiller/2005/06/14/a-classic-article-from-alistair-cockburn-and-horror-stories-just-for-fun/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=13' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,157] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2005/06/09/the-worst-possible-way-to-use-a-stored-procedure/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-13" class="post-13 post type-post status-publish format-standard hentry category-database-and-persistence category-ranting">
					<h1 class="entry-title">The Worst Possible Way to use a Stored Procedure</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2005/06/09/the-worst-possible-way-to-use-a-stored-procedure/" title="2:01 pm" rel="bookmark"><span class="entry-date">June 9, 2005</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p><DIV>Rant time&#8230; <BR><BR>Repeat after me please, <BR><BR>I will not put any <STRONG>business logic</STRONG> into a stored procedure. <BR>I will not put any <STRONG>business logic</STRONG> into a stored procedure. <BR>I will not put any <STRONG>business logic</STRONG> into a stored procedure. <BR>I will not put any <STRONG>business logic</STRONG> into a stored procedure. <BR>I will not put any <STRONG>business logic</STRONG> into a stored procedure. <BR><BR>Okay, if your business logic can be expressed easiest through a declarative SQL WHERE clause, a SPROC can be a cool way to go. Set-based logic is almost always simpler to do with SQL than mucking through with procedural C#, but that&#8217;s a different rant for another day, and I&#8217;m definitely talking about procedural code within sproc&#8217;s here. <BR><BR>Question: How do I know if I might be doing something in a sproc that I shouldn&#8217;t be doing? Answer: If there is *anything* other than CRUD in your sproc (IF/ELSE/ENDIF, LOOP/END LOOP, etc.). <BR><BR><STRONG>The all time dumbest thing to do is to <EM>split</EM> your business logic between a SPROC and the consuming middle tier code.</STRONG> Twice now in the past 12 months I&#8217;ve bumped into cases where business logic is performed inside a sproc, then interpreted by middle tier C# or VB6 code. Splitting the logic into multiple spots like this makes a system harder to understand. It also makes a system brittle to change because some logic is duplicated in both places. A change in the sproc or C# can, and usually does, break the other. This is a case of the <A href="http://www.artima.com/intv/dry.html">Don&#8217;t Repeat Yourself</A> principle the <A href="http://www.pragmaticprogrammer.com/">Pragmatic Programmer</A> guys talk about. <BR><BR>I had an interesting experience as a consultant one time. I was fresh into the project working with some legacy C# code (yes, there is already legacy .NET code). I had just stumbled on the fact that most of the business logic was really in T-SQL procedures. In many cases, the C# code undid some of the T-SQL transformations to filter the results further. The client architect was giving us a bit of a tongue-lashing (&#8220;you consultants better not write crappy code, and there better be tests for everything you write&#8221;) while I was looking at a 5,000 line stored procedure, with his name all over the comments, trying to decide if some erroneous data was coming out of the database or being transformed in the C# code. This particular system is the subject of a case study/testimonial on MSDN as an example of all the wonderful things about .NET;) <BR><BR>&#8220;Thank you for listening, I feel better now.&#8221; &#8212; Roy Moore</DIV></p>
<div class="shr-publisher-13"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/database-and-persistence/" title="View all posts in Database and Persistence" rel="category tag">Database and Persistence</a>, <a href="http://codebetter.com/jeremymiller/category/ranting/" title="View all posts in Ranting" rel="category tag">Ranting</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2005/06/09/the-worst-possible-way-to-use-a-stored-procedure/" title="Permalink to The Worst Possible Way to use a Stored Procedure" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2005/06/09/the-worst-possible-way-to-use-a-stored-procedure/feed/" title="Comments RSS to The Worst Possible Way to use a Stored Procedure" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-13 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2005/06/03/learning-lessons-can-you-make-mistakes-at-work/" rel="prev"><span class="meta-nav">&larr;</span> Learning Lessons &#8212; Can You Make Mistakes at Work?</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2005/06/14/a-classic-article-from-alistair-cockburn-and-horror-stories-just-for-fun/" rel="next">A classic article from Alistair Cockburn and horror stories just for fun <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-13">
                    <div id="dsq-comment-header-13" class="dsq-comment-header">
                        <cite id="dsq-cite-13">
                                <span id="dsq-author-user-13">pwstevens</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-13" class="dsq-comment-body">
                        <div id="dsq-comment-message-13" class="dsq-comment-message"><p>This topic is a pet peave of mine; I&#8217;m constantly battling with developers to not do this; however there are cases that I can&#8217;t see how to eliminate the database business logic.  Have you found a way around this scenario (note: this is a trivial example since a simple foreign key could solve this problem&#8230;  but conceptually the problem exists in other areas where a FK wouldn&#8217;t work):<br />
Rule:<br />
A Customer can&#8217;t be deleted if he has any orders. </p>
<p>Possible business flow:<br />
1.  Object checks to see if any orders exist, none do.<br />
2.  Someone else enters order<br />
3.  Customer is deleted</p>
<p>Putting the business check in the SPROC would then put the rule in a context of a transaction.</p>
<p>Any way to avoid this (note: see note abou FK above).</p>
<p>Thank you.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-14">
                    <div id="dsq-comment-header-14" class="dsq-comment-header">
                        <cite id="dsq-cite-14">
                                <span id="dsq-author-user-14">Slevdi Davoteca</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-14" class="dsq-comment-body">
                        <div id="dsq-comment-message-14" class="dsq-comment-message"><p>Business Logic? Surely business logic is a combination of two different things:</p>
<p>1 transformation of data (the job of the application)<br />
2 preservation of data integrity according to current business rules (the job of the dbms)</p>
<p>One of the skills of the system designer is to know which things go where. It is always right to get the dbms to preserve data integrity. Applications can do so as well, of course, but should get business rules from a common place.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-15">
                    <div id="dsq-comment-header-15" class="dsq-comment-header">
                        <cite id="dsq-cite-15">
                                <span id="dsq-author-user-15">Jayant</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-15" class="dsq-comment-body">
                        <div id="dsq-comment-message-15" class="dsq-comment-message"><p>Does a stored procedure run slow (In general) than the application code? We have a situation where we have a heavy use of stored procedure and although there is a lot of validation needs to be performed, we take 28 hours to process 60,000 records and this looks way too slow to me.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-16">
                    <div id="dsq-comment-header-16" class="dsq-comment-header">
                        <cite id="dsq-cite-16">
                                <span id="dsq-author-user-16">RogerBlake</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-16" class="dsq-comment-body">
                        <div id="dsq-comment-message-16" class="dsq-comment-message"><p>< <Okay, if your business logic can be expressed easiest through a declarative SQL WHERE clause, a SPROC can be a cool way to go. Set-based logic is almost always simpler to do with SQL than mucking through with procedural C#, but that's a different rant for another day, and I'm definitely talking about procedural code within sproc's here.>></p>
<p>Using procedural oriented code is totally meaningless in SQL.  SQL is optimized if and only if it is *not* procedural.  Besides set oriented processing is orders of magnitude much more powerful then procedural resource consuming loop holes.</p>
<p>< <The all time dumbest thing to do is to split your business logic between a SPROC and the consuming middle tier code.>><br />
No.  That&#8217;s the second dumbest thing. The dumbest thing is to put business logic anywhere else than in the dbms.  What is the business logic anyway etc a set of constraints that bring meaning to data: question is what can best implement constraints: DBMS.  What is better spend time searching tons of mixed up code generated by a confused spaghetti coder or find it a specific centralized place? </p>
<p>< <. A change in the sproc or C# can, and usually does, break the other. This is a case of the Don't Repeat Yourself principle the Pragmatic Programmer guys talk about. >><br />
Then you should review your HR dept qualifications required for people you hire in db design.  That is a competence issue.  If you hire a developper to do dbms don&#8217;t expect him/her to do a clean job in such area.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-17">
                    <div id="dsq-comment-header-17" class="dsq-comment-header">
                        <cite id="dsq-cite-17">
                                <span id="dsq-author-user-17">RogerBlake</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-17" class="dsq-comment-body">
                        <div id="dsq-comment-message-17" class="dsq-comment-message"><p>Business Logic should not be handled applicatively (API code, stored procedure) but declaratively through the use of constraints.  TRying to implement business rules applicatively is basically the most unefficient way to do it.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-18">
                    <div id="dsq-comment-header-18" class="dsq-comment-header">
                        <cite id="dsq-cite-18">
                                <span id="dsq-author-user-18">Ivan</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-18" class="dsq-comment-body">
                        <div id="dsq-comment-message-18" class="dsq-comment-message"><p>And finally, I&#8217;m completely confused&#8230; I&#8217;m looking for information about stored procedures, whether to use them or not&#8230; the more I read, the last I know&#8230;</p>
<p>And the worst thing is that I have to explain to my development team the reasons of my decisions. But there&#8217;s no simple choose.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-19">
                    <div id="dsq-comment-header-19" class="dsq-comment-header">
                        <cite id="dsq-cite-19">
    http://www.nitinkatkam.com                            <span id="dsq-author-user-19">Nitin Reddy Katkam</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-19" class="dsq-comment-body">
                        <div id="dsq-comment-message-19" class="dsq-comment-message"><p>On my first job (and my first software project at a software development firm), I had a project manager on the project who insisted that I write the stored procedures, being the DBA on the project. The client shared his opinion.</p>
<p>The development team, headed by a lead developer, kept pushing business logic my way, into the stored procedures. I stepped up and said, &#8220;This isn&#8217;t how code was meant to be written.&#8221; The project manager called me away and said, &#8220;Look, you can write SQL. They can&#8217;t. Provide a simple enough interface with which they can accomplish all they need to with a single database call.&#8221;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-20">
                    <div id="dsq-comment-header-20" class="dsq-comment-header">
                        <cite id="dsq-cite-20">
                                <span id="dsq-author-user-20">Andy</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-20" class="dsq-comment-body">
                        <div id="dsq-comment-message-20" class="dsq-comment-message"><p>Remind me to put you on the &#8221; do not hire list&#8221;&#8230; as a DBA , in ORACLE, and MSSQL, BL in the RDBMS is mandentory as languages used to interface with the RDBMS can be anything&#8230; and I don&#8217;t like cleaning up your mess.</p>
<p>and yes, DBA since 1988, so got some experience&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-21">
                    <div id="dsq-comment-header-21" class="dsq-comment-header">
                        <cite id="dsq-cite-21">
                                <span id="dsq-author-user-21">Chad Myers</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-21" class="dsq-comment-body">
                        <div id="dsq-comment-message-21" class="dsq-comment-message"><p>@Andy:  Put me on that list, too. It&#8217;s quite possibly the highest compliment you could pay me and Jeremy and most of the people reading this blog.</p>
<p>Putting critical business logic in a black hole of no version control, no change control, and no way of doing automated repeatable testing is quite frankly the dumbest thing you can do.</p>
<p>The motivation is usually one of fear and mistrust of developers. The solution (dumping into the black whole of the database) is the wrong solution and only treating the symptoms (incompetent developers and fearful DBAs).</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-22">
                    <div id="dsq-comment-header-22" class="dsq-comment-header">
                        <cite id="dsq-cite-22">
                                <span id="dsq-author-user-22">mendicant</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-22" class="dsq-comment-body">
                        <div id="dsq-comment-message-22" class="dsq-comment-message"><p>I&#8217;ll go on that &#8220;no hire&#8221; list too. I can&#8217;t imagine what it must be like for you having worked 32 years with such poor and untrustworthy developers.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-23">
                    <div id="dsq-comment-header-23" class="dsq-comment-header">
                        <cite id="dsq-cite-23">
                                <span id="dsq-author-user-23">Roman</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-23" class="dsq-comment-body">
                        <div id="dsq-comment-message-23" class="dsq-comment-message"><p>What are you all talking about? How can you NOT have business logic in the DB if you have disperate systems connecting in a SOA environment? if your DB is serving data to more than exactly 1 application, how is it that you can purport to maintain data integrity and understandable logic outside of the database?  </p>
<p>This comment:  </p>
<p>&#8220;The motivation is usually one of fear and mistrust of developers. The solution (dumping into the black whole of the database) is the wrong solution and only treating the symptoms (incompetent developers and fearful DBAs).&#8221;</p>
<p>That is  just priceless. Fear? YOU are calling it the &#8220;Black Hole of the Database&#8221; Who&#8217;s the one afraid of SQL  here?  </p>
<p>If you&#8217;re writing one-offs or throwing together a little blog or online shop, I guess your slow, SQL-laden scripting layer is OK, but not if you really need to make something work in an enterprise environment where homogeneous, service oriented  access over a common interface is called for. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-24">
                    <div id="dsq-comment-header-24" class="dsq-comment-header">
                        <cite id="dsq-cite-24">
    http://codebetter.com/members/jmiller/default.aspx                            <span id="dsq-author-user-24">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-24" class="dsq-comment-body">
                        <div id="dsq-comment-message-24" class="dsq-comment-message"><p>Ok Roman,</p>
<p>Let&#8217;s try this one:</p>
<p>A.) I think that more than one application or service accessing the same database is moronic.  Very common in the average enterprise, but still stupid as the day is long.  </p>
<p>B.)  I&#8217;ve written an absurd amount of SQL and even stored procedures in my career.  I&#8217;m not particularly afraid of a relational database.  </p>
<p>C.) What I most definitely know is that I can write much more maintainable business logic in a real programming language like C#/Java/Ruby/Python/Scala etc. &#8212; especially when I can back that logic up with a good set of automated unit tests.  A language like T-SQL or PL/SQL just results in a procedural mess and the database environment is miserable from a feedback and automation standpoint.</p>
<p>D.) For your information, my team has a very large application that&#8217;s performing perfectly well with zero stored procedures, only a bare handful of lines of sql embedded in the code, but a pretty good suite of automated tests that run relatively quickly.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-25">
                    <div id="dsq-comment-header-25" class="dsq-comment-header">
                        <cite id="dsq-cite-25">
                                <span id="dsq-author-user-25">Roman</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-25" class="dsq-comment-body">
                        <div id="dsq-comment-message-25" class="dsq-comment-message"><p>Jeremy,<br />
Why would you think things would be more maintainable in a scripting language? We do version control for DB structure, schema, including SPs for 3-5 DBAs across several databases on a daily basis. </p>
<p>There is absolutely no problem with this. </p>
<p>As far as automated testing goes, that&#8217;s a very subjective avenue depending on how/what you test. We can (and do) easily write tests to iterate datasets, check for correct execution, return, etc. that test all layers, including SPs.  We have no issues with testing for this scenario. </p>
<p>You say yourself that you do not write stored procedures. I guess since your experience is very limited in this respect, then your (a bit too vehement) opinion on the subject should be taken, as they say, with a grain of salt. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-26">
                    <div id="dsq-comment-header-26" class="dsq-comment-header">
                        <cite id="dsq-cite-26">
                                <span id="dsq-author-user-26">Roman</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-26" class="dsq-comment-body">
                        <div id="dsq-comment-message-26" class="dsq-comment-message"><p>One (a few) more thing(s): </p>
<p>Your comment: </p>
<p>&#8220;A.) I think that more than one application or service accessing the same database is moronic.  Very common in the average enterprise, but still stupid as the day is long.  &#8221;</p>
<p>You may live in a world where you are allowed to specify infrastructure, design, technologies, etc. all by yourself, but most of us work for someone else . </p>
<p>I have a client that has a central database of students, where disperate systems access student data directly from the central admin system. (library, billing, purchasing, school admin, etc)  The  interface to provide, for example, &#8220;StudentsByCourse&#8221; is the SAME for all of these applications. This represents a common API that all these applications can use. </p>
<p>You will probably argue that this layer should be exposed using another technology, i.e. a webservice or similar, but why? There is no need to do so. I can give each system the rights to retrieve the data as necessary from a common interface. </p>
<p>I do understand that if, for example, the library app needed DIFFERENT fields than say, billing,  it could be beneficial to have a layer in between, however it makes no logical difference to create a new SP or to add a function to a class to fit this custom need. In fact, adding the SP is easier.</p>
<p>All that said, I do enjoy your blog, and it is good to read arguments for/against topics such as this. I would be interested in seeing/trying some of the SQL generation frameworks mentioned  (just to see how the &#8220;other&#8221; side does it and to keep an open mind). </p>
<p>Just one last question &#8211; did you have a bad experience with SPs as a small child? I can understand being forcefully &#8220;for&#8221; something, but so forcefully against an obviously useful (and, I admit, sometimes misused) functionality?  I don&#8217;t understand.   </p>
<p>Cheers. R.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-27">
                    <div id="dsq-comment-header-27" class="dsq-comment-header">
                        <cite id="dsq-cite-27">
                                <span id="dsq-author-user-27">Chad Myers</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-27" class="dsq-comment-body">
                        <div id="dsq-comment-message-27" class="dsq-comment-message"><p>@Roman:  It&#8217;s not that SPs aren&#8217;t useful, it&#8217;s just that the end up causing a lot more problems than they solve and they end up being a much more difficult and problematic way of doing things.</p>
<p>There are a few limited use cases where SPs are the best way of accomplishing a particular task, but none of these cases involve putting business logic in the SPs.</p>
<p>Use of SPs for business logic usually reflect a larger problem in the organization.  The example you described is clearly the &#8220;integrate through the database&#8221; anti-pattern which is fraught with many problems. SPs are a way of addressing some of these problems, but they are an inferior way of doing it because SPs themselves cause other problems.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-28">
                    <div id="dsq-comment-header-28" class="dsq-comment-header">
                        <cite id="dsq-cite-28">
                                <span id="dsq-author-user-28">Gennadi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-28" class="dsq-comment-body">
                        <div id="dsq-comment-message-28" class="dsq-comment-message"><p>It looks like you never support any system you wrote. It is very sad. You will damn yourself</p>
<p>Can you please explain how you manage capacity planning for the application for next, say 5 years and growing data 10 times? </p>
<p>How you monitor that hardware is sufficient to handle increasing of user activity? How to find when system will require hardware upgrade? And for how long this upgrade will last to next upgrade? I’m asking not only about HDD capacity – I’m about processor(s) capacity and RAM.</p>
<p>Or how you will deal with situation when your application that run on middle tier started depredates in performance because set of data in tables changed and some query should revised?</p>
<p>How to fix it in case of embedded sql if hundreds users must have 24&#215;7 access to the system? </p>
<p>With SP I will localize the particular problem SP in 5 minutes and after solution  would be found – upgrade of application will take several milliseconds without any interruption of users activity – just apply ALTER PROCEDURE. </p>
<p>Last time when we had the situation like this it took 3 (three) days for preparation to stop application server (after fix been found – that also took couple of days, application recompiled and so one) and several hours of outage for all users. Of course this happens in most busy for business time. Business owners were absolutely happy – screaming users for week time, lost of money for business interruption. It was real pleasure.</p>
<p>BTW – have you red this article? <a href="http://www.sommarskog.se/dynamic_sql.html" rel="nofollow">http://www.sommarskog.se/dynamic_sql.html</a> What do you think about memory usage for execution plans? Especially in situation when these plans consume 70% of RAM and used only ones? (if you don’t know – two statements like “id=1” and “id= 1” will be recognized as different and compiled separately)   </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-29">
                    <div id="dsq-comment-header-29" class="dsq-comment-header">
                        <cite id="dsq-cite-29">
    http://chadmyers.lostechies.com                            <span id="dsq-author-user-29">Chad Myers</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-29" class="dsq-comment-body">
                        <div id="dsq-comment-message-29" class="dsq-comment-message"><p>@Gennadi:</p>
<p>It&#8217;s bad form to just assume the other guy is an idiot with no experience.   Perhaps you should challenge your preconceived notions and false assumptions instead of insulting other people.</p>
<p>It is precisely BECAUSE I have maintained such large systems that I don&#8217;t use stored procs.  In my experience, except in a very few circumstances, stored procs represent a failure at some point either during development, organization, team cooperation, etc.  They&#8217;re usually used to prevent &#8220;those stupid guys&#8221; from doing something &#8220;stupid&#8221; rather than adding any value.  Whether it be insecure DBAs or over-bearing managers wishing to keep members of his team separate or distrusting teams working on different projects, but sharing a database, etc.</p>
<p>Integration of applications through the database is the least-common-denominator and is generally the worst way to do it. There are much better ways.</p>
<p>RE: Embedded SQL &#8211; Embedded SQL is evil. Worse than Sprocs, I think.  So I agree with you there, don&#8217;t use embedded SQL.</p>
<p>RE: that-article  I haven&#8217;t read that one in particular, but I&#8217;ve heard the argument before.  Once again, I&#8217;m not doing dynamic SQL like that, and, at any rate, I use 100% parameterized queries that are consistently generated from an ORM so the procedure cache argument is out the window.</p>
<p>I suggest you do a little more investigation and try doing some apps my way before just dismissing it.  I&#8217;ve done them your way and the better way and have drawn my conclusions. You have dismissed my arguments without having even considered my way and then threw in a red herring (i.e. not embedded/dynamic SQL).</p>
<p>-Chad</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-30">
                    <div id="dsq-comment-header-30" class="dsq-comment-header">
                        <cite id="dsq-cite-30">
                                <span id="dsq-author-user-30">Gennadi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-30" class="dsq-comment-body">
                        <div id="dsq-comment-message-30" class="dsq-comment-message"><p>Rather then teach me with manner you better answer the questions. It is ordinary questions that rise every day/month/quarter if you support &#8220;large systems&#8221;. BTW what is the penalty for breaching SLA written in contract? Just number of zeros in penalty for one hour of outage above SLA and percentage of up time according SLA – this will be a good answer how large the systems are. Basically I was talking about 99.6% per month (24&#215;7 uptime) and six zeros number for one hour in my case.</p>
<p>>  They&#8217;re usually used to prevent &#8220;those stupid guys&#8221; from doing something &#8220;stupid&#8221; rather than adding any value. </p>
<p>Have you got any idea why I wrote about 70% RAM consumed for execution plans? What do you think &#8211; how this correlate with your phrase I quoted? There is a direct connection between them. But if you think that you can sacrifice 70% of RAM to nothing having in database tables that keeps millions of records &#8211; probably I’ve asked stupid question.</p>
<p>>  So I agree with you there, don&#8217;t use embedded SQL.</p>
<p>Do you think it somehow change the meaning of my question:</p>
<p>How to fix it in case of embedded sql if hundreds users must have 24&#215;7 access to the system? </p>
<p>if I will change &#8220;embedded&#8221; to &#8220;prepared&#8221;? </p>
<p>Again – just imagine that your application is middle tier. Hundreds of users are connected to it 24 hours per day. 1 hour of outage cost you six zeros in penalty. And you have to fix one (only one!!!) query in this application where this query is hardcoded (embedded or dynamic – doesn’t matter) in your EXE/DLL/ets. This means you have to disconnect hundreds users, stop the middle tier service, replace EXE/DLL for new version, start service, check that application is working as expected. And run the same  procedure to rollback if upgrade is failed. Just compare this with one ALTER PROCEDURE clause (say 10-20 milliseconds) for fix upgrade and another ALTER PROCEDURE (again 10-20 milliseconds) for rollback. All users still connected and likely even don’t mention that they are working with new version of SP.  Again – keep in mind that the business we are talking about loosing physically, say, 10 grands per minute. BTW it is ordinary number, say, for GM assembly belt line. Can you compare “cost” of “your” solution and “mine”?</p>
<p>>  I use 100% parameterized queries </p>
<p>This exactly what I meant. Thank you for good example. Can you give ANY IDEA why the query like this </p>
<p>SELECT id FROM table WHERE Active = 1 </p>
<p>will run zero milliseconds but this query </p>
<p>DECLARE @Active_val int<br />
SET @Active_val = 1<br />
SELECT id FROM table WHERE Active = @Active_val </p>
<p>will run more then 6 minutes? It is real example and real timing. Table is completely the same and untouched between queries, server is the same, no other application or users on the server, any SQL Server cache is flushed before each call. As you can see &#8211; second query logic is absolutely the same like the first one. The difference is one &#8211; second one is acting as prepared statement (be careful &#8211; I did not say that it is prepared statement – I said that this statement will act the same way as prepared statement. FYI &#8211;  I know in details how works optimizer in SQL Server). Last time when I&#8217;ve seen the developer with the attitude like yours (“I will not put any business logic into a stored procedure”) and who used only prepared statements as you &#8211; he came to me with exactly this queries and request to put this query in SP. For my question where is a problem from his point of view he answered: &#8220;it is JDBC/ODBC driver error. Through SP this would be faster&#8221;. I did SP for him and show that there is no performance improvement at all using SP. But in QA he still able to run the query in 0 milliseconds. He was amazed and had no answer.  Now is your shot. Any idea? I know the answer why the timing is so different. I can proof it and explain it. (this link can give you some light in the dark but it has no full answer: <a href="http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure" rel="nofollow">http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure</a>)</p>
<p>Also – have you got any experience how to find what particular prepared statement started to slow down application that running against SQL Server 2000? I had – I spent more then half a day to find the real script that hidden under handle of temporary SP that wraps real query. Just try to catch these calls in profiler – you will be happy. I can translate this trace in plain English like this: the SP with handle 15 runs 300 seconds. Very informative and useful – but you can test it by yourself if you don’t believe me. BTW it is not only “mine” problem: <a href="http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql" rel="nofollow">http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql</a>  Please, pay attention to this words in the message ”The statement is prepared before I start the profiler and the client<br />
keeps that connection &#8211; so I can&#8217;t see its preparation without restarting the server (it&#8217;s a web application).” Can you imagine how to restart, say ebay.com? (FYI &#8211; AFAIK ebay is using SQL Server as database server)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-31">
                    <div id="dsq-comment-header-31" class="dsq-comment-header">
                        <cite id="dsq-cite-31">
                                <span id="dsq-author-user-31">Gennadi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-31" class="dsq-comment-body">
                        <div id="dsq-comment-message-31" class="dsq-comment-message"><p>Rather then teach me with manner you better answer the questions. It is ordinary questions that rise every day/month/quarter if you support &#8220;large systems&#8221;. BTW what is the penalty for breaching SLA written in contract? Just number of zeros in penalty for one hour of outage above SLA and percentage of up time according SLA – this will be a good answer how large the systems are. Basically I was talking about 99.6% per month (24&#215;7 uptime) and six zeros number for one hour in my case.</p>
<p>>  They&#8217;re usually used to prevent &#8220;those stupid guys&#8221; from doing something &#8220;stupid&#8221; rather than adding any value. </p>
<p>Have you got any idea why I wrote about 70% RAM consumed for execution plans? What do you think &#8211; how this correlate with your phrase I quoted? There is a direct connection between them. But if you think that you can sacrifice 70% of RAM to nothing having in database tables that keeps millions of records &#8211; probably I’ve asked stupid question.</p>
<p>>  So I agree with you there, don&#8217;t use embedded SQL.</p>
<p>Do you think it somehow change the meaning of my question:</p>
<p>How to fix it in case of embedded sql if hundreds users must have 24&#215;7 access to the system? </p>
<p>if I will change &#8220;embedded&#8221; to &#8220;prepared&#8221;? </p>
<p>Again – just imagine that your application is middle tier. Hundreds of users are connected to it 24 hours per day. 1 hour of outage cost you six zeros in penalty. And you have to fix one (only one!!!) query in this application where this query is hardcoded (embedded or dynamic – doesn’t matter) in your EXE/DLL/ets. This means you have to disconnect hundreds users, stop the middle tier service, replace EXE/DLL for new version, start service, check that application is working as expected. And run the same  procedure to rollback if upgrade is failed. Just compare this with one ALTER PROCEDURE clause (say 10-20 milliseconds) for fix upgrade and another ALTER PROCEDURE (again 10-20 milliseconds) for rollback. All users still connected and likely even don’t mention that they are working with new version of SP.  Again – keep in mind that the business we are talking about loosing physically, say, 10 grands per minute. BTW it is ordinary number, say, for GM assembly belt line. Can you compare “cost” of “your” solution and “mine”?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-32">
                    <div id="dsq-comment-header-32" class="dsq-comment-header">
                        <cite id="dsq-cite-32">
                                <span id="dsq-author-user-32">Gennadi1</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-32" class="dsq-comment-body">
                        <div id="dsq-comment-message-32" class="dsq-comment-message"><p>Rather then teach me with manner you better answer the questions. It is ordinary questions that rise every day/month/quarter if you support &#8220;large systems&#8221;. BTW what is the penalty for breaching SLA written in contract? Just number of zeros in penalty for one hour of outage above SLA and percentage of up time according SLA – this will be a good answer how large the systems are. Basically I was talking about 99.6% per month (24&#215;7 uptime) and six zeros number for one hour in my case.</p>
<p>>  They&#8217;re usually used to prevent &#8220;those stupid guys&#8221; from doing something &#8220;stupid&#8221; rather than adding any value. </p>
<p>Have you got any idea why I wrote about 70% RAM consumed for execution plans? What do you think &#8211; how this correlate with your phrase I quoted? There is a direct connection between them. But if you think that you can sacrifice 70% of RAM to nothing having in database tables that keeps millions of records &#8211; probably I’ve asked stupid question.</p>
<p>>  So I agree with you there, don&#8217;t use embedded SQL.</p>
<p>Do you think it somehow change the meaning of my question:</p>
<p>How to fix it in case of embedded sql if hundreds users must have 24&#215;7 access to the system? </p>
<p>if I will change &#8220;embedded&#8221; to &#8220;prepared&#8221;? </p>
<p>Again – just imagine that your application is middle tier. Hundreds of users are connected to it 24 hours per day. 1 hour of outage cost you six zeros in penalty. And you have to fix one (only one!!!) query in this application where this query is hardcoded (embedded or dynamic – doesn’t matter) in your EXE/DLL/ets. This means you have to disconnect hundreds users, stop the middle tier service, replace EXE/DLL for new version, start service, check that application is working as expected. And run the same  procedure to rollback if upgrade is failed. Just compare this with one ALTER PROCEDURE clause (say 10-20 milliseconds) for fix upgrade and another ALTER PROCEDURE (again 10-20 milliseconds) for rollback. All users still connected and likely even don’t mention that they are working with new version of SP.  Again – keep in mind that the business we are talking about loosing physically, say, 10 grands per minute. BTW it is ordinary number, say, for GM assembly belt line. Can you compare “cost” of “your” solution and “mine”?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-33">
                    <div id="dsq-comment-header-33" class="dsq-comment-header">
                        <cite id="dsq-cite-33">
                                <span id="dsq-author-user-33">AAA</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-33" class="dsq-comment-body">
                        <div id="dsq-comment-message-33" class="dsq-comment-message"><p>Rather then teach me with manner you better answer the questions. It is ordinary questions that rise every day/month/quarter if you support &#8220;large systems&#8221;. BTW what is the penalty for breaching SLA written in contract? Just number of zeros in penalty for one hour of outage above SLA and percentage of up time according SLA – this will be a good answer how large the systems are. Basically I was talking about 99.6% per month (24&#215;7 uptime) and six zeros number for one hour in my case.</p>
<p>>  They&#8217;re usually used to prevent &#8220;those stupid guys&#8221; from doing something &#8220;stupid&#8221; rather than adding any value. </p>
<p>Have you got any idea why I wrote about 70% RAM consumed for execution plans? What do you think &#8211; how this correlate with your phrase I quoted? There is a direct connection between them. But if you think that you can sacrifice 70% of RAM to nothing having in database tables that keeps millions of records &#8211; probably I’ve asked stupid question.</p>
<p>>  So I agree with you there, don&#8217;t use embedded SQL.</p>
<p>Do you think it somehow change the meaning of my question:</p>
<p>How to fix it in case of embedded sql if hundreds users must have 24&#215;7 access to the system? </p>
<p>if I will change &#8220;embedded&#8221; to &#8220;prepared&#8221;? </p>
<p>Again – just imagine that your application is middle tier. Hundreds of users are connected to it 24 hours per day. 1 hour of outage cost you six zeros in penalty. And you have to fix one (only one!!!) query in this application where this query is hardcoded (embedded or dynamic – doesn’t matter) in your EXE/DLL/ets. This means you have to disconnect hundreds users, stop the middle tier service, replace EXE/DLL for new version, start service, check that application is working as expected. And run the same  procedure to rollback if upgrade is failed. Just compare this with one ALTER PROCEDURE clause (say 10-20 milliseconds) for fix upgrade and another ALTER PROCEDURE (again 10-20 milliseconds) for rollback. All users still connected and likely even don’t mention that they are working with new version of SP.  Again – keep in mind that the business we are talking about loosing physically, say, 10 grands per minute. BTW it is ordinary number, say, for GM assembly belt line. Can you compare “cost” of “your” solution and “mine”?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-34">
                    <div id="dsq-comment-header-34" class="dsq-comment-header">
                        <cite id="dsq-cite-34">
                                <span id="dsq-author-user-34">Gennadi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-34" class="dsq-comment-body">
                        <div id="dsq-comment-message-34" class="dsq-comment-message"><p>>  I use 100% parameterized queries </p>
<p>This exactly what I meant. Thank you for good example. Can you give ANY IDEA why the query like this </p>
<p>SELECT id FROM table WHERE Active = 1 </p>
<p>will run zero milliseconds but this query </p>
<p>DECLARE @Active_val int<br />
SET @Active_val = 1<br />
SELECT id FROM table WHERE Active = @Active_val </p>
<p>will run more then 6 minutes? It is real example and real timing. Table is completely the same and untouched between queries, server is the same, no other application or users on the server, any SQL Server cache is flushed before each call. As you can see &#8211; second query logic is absolutely the same like the first one. The difference is one &#8211; second one is acting as prepared statement (be careful &#8211; I did not say that it is prepared statement – I said that this statement will act the same way as prepared statement. FYI &#8211;  I know in details how works optimizer in SQL Server). Last time when I&#8217;ve seen the developer with the attitude like yours (“I will not put any business logic into a stored procedure”) and who used only prepared statements as you &#8211; he came to me with exactly this queries and request to put this query in SP. For my question where is a problem from his point of view he answered: &#8220;it is JDBC/ODBC driver error. Through SP this would be faster&#8221;. I did SP for him and show that there is no performance improvement at all using SP. But in QA he still able to run the query in 0 milliseconds. He was amazed and had no answer.  Now is your shot. Any idea? I know the answer why the timing is so different. I can proof it and explain it. (this link can give you some light in the dark but it has no full answer: <a href="http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure" rel="nofollow">http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure</a>)</p>
<p>Also – have you got any experience how to find what particular prepared statement started to slow down application that running against SQL Server 2000? I had – I spent more then half a day to find the real script that hidden under handle of temporary SP that wraps real query. Just try to catch these calls in profiler – you will be happy. I can translate this trace in plain English like this: the SP with handle 15 runs 300 seconds. Very informative and useful – but you can test it by yourself if you don’t believe me. BTW it is not only “mine” problem: <a href="http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql" rel="nofollow">http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql</a>  Please, pay attention to this words in the message ”The statement is prepared before I start the profiler and the client<br />
keeps that connection &#8211; so I can&#8217;t see its preparation without restarting the server (it&#8217;s a web application).” Can you imagine how to restart, say ebay.com? (BTW AFAIK ebay is using SQL Server as database server)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-35">
                    <div id="dsq-comment-header-35" class="dsq-comment-header">
                        <cite id="dsq-cite-35">
                                <span id="dsq-author-user-35">gennadi</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-35" class="dsq-comment-body">
                        <div id="dsq-comment-message-35" class="dsq-comment-message"><p>>  I use 100% parameterized queries </p>
<p>This exactly what I meant. Thank you for good example. Can you give ANY IDEA why the query like this </p>
<p>SELECT id FROM table WHERE Active = 1 </p>
<p>will run zero milliseconds but this query </p>
<p>DECLARE @Active_val int<br />
SET @Active_val = 1<br />
SELECT id FROM table WHERE Active = @Active_val </p>
<p>will run more then 6 minutes? It is real example and real timing. Table is completely the same and untouched between queries, server is the same, no other application or users on the server, any SQL Server cache is flushed before each call. As you can see &#8211; second query logic is absolutely the same like the first one. The difference is one &#8211; second one is acting as prepared statement (be careful &#8211; I did not say that it is prepared statement – I said that this statement will act the same way as prepared statement. FYI &#8211;  I know in details how works optimizer in SQL Server). Last time when I&#8217;ve seen the developer with the attitude like yours (“I will not put any business logic into a stored procedure”) and who used only prepared statements as you &#8211; he came to me with exactly this queries and request to put this query in SP. For my question where is a problem from his point of view he answered: &#8220;it is JDBC/ODBC driver error. Through SP this would be faster&#8221;. I did SP for him and show that there is no performance improvement at all using SP. But in QA he still able to run the query in 0 milliseconds. He was amazed and had no answer.  Now is your shot. Any idea? I know the answer why the timing is so different. I can proof it and explain it. (this link can give you some light in the dark but it has no full answer: <a href="http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure" rel="nofollow">http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure</a>)</p>
<p>Also – have you got any experience how to find what particular prepared statement started to slow down application that running against SQL Server 2000? I had – I spent more then half a day to find the real script that hidden under handle of temporary SP that wraps real query. Just try to catch these calls in profiler – you will be happy. I can translate this trace in plain English like this: the SP with handle 15 runs 300 seconds. Very informative and useful – but you can test it by yourself if you don’t believe me. BTW it is not only “mine” problem: <a href="http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql" rel="nofollow">http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql</a>  Please, pay attention to this words in the message ”The statement is prepared before I start the profiler and the client<br />
keeps that connection &#8211; so I can&#8217;t see its preparation without restarting the server (it&#8217;s a web application).” Can you imagine how to restart, say ebay.com? (BTW AFAIK ebay is using SQL Server as database server)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-36">
                    <div id="dsq-comment-header-36" class="dsq-comment-header">
                        <cite id="dsq-cite-36">
                                <span id="dsq-author-user-36">WhyIcannotSendMessages</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-36" class="dsq-comment-body">
                        <div id="dsq-comment-message-36" class="dsq-comment-message"><p>>  I use 100% parameterized queries </p>
<p>This exactly what I meant. Thank you for good example. Can you give ANY IDEA why the query like this </p>
<p>SELECT id FROM table WHERE Active = 1 </p>
<p>will run zero milliseconds but this query </p>
<p>DECLARE @Active_val int<br />
SET @Active_val = 1<br />
SELECT id FROM table WHERE Active = @Active_val </p>
<p>will run more then 6 minutes? It is real example and real timing. Table is completely the same and untouched between queries, server is the same, no other application or users on the server, any SQL Server cache is flushed before each call. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-37">
                    <div id="dsq-comment-header-37" class="dsq-comment-header">
                        <cite id="dsq-cite-37">
                                <span id="dsq-author-user-37">WhyIcannotSendMessages1</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-37" class="dsq-comment-body">
                        <div id="dsq-comment-message-37" class="dsq-comment-message"><p>As you can see &#8211; second query logic is absolutely the same like the first one. The difference is one &#8211; second one is acting as prepared statement (be careful &#8211; I did not say that it is prepared statement – I said that this statement will act the same way as prepared statement. FYI &#8211;  I know in details how works optimizer in SQL Server). Last time when I&#8217;ve seen the developer with the attitude like yours (“I will not put any business logic into a stored procedure”) and who used only prepared statements as you &#8211; he came to me with exactly this queries and request to put this query in SP. For my question where is a problem from his point of view he answered: &#8220;it is JDBC/ODBC driver error. Through SP this would be faster&#8221;. I did SP for him and show that there is no performance improvement at all using SP. But in QA he still able to run the query in 0 milliseconds. He was amazed and had no answer.  Now is your shot. Any idea? I know the answer why the timing is so different. I can proof it and explain it. (this link can give you some light in the dark but it has no full answer: <a href="http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure" rel="nofollow">http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure</a>)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-38">
                    <div id="dsq-comment-header-38" class="dsq-comment-header">
                        <cite id="dsq-cite-38">
                                <span id="dsq-author-user-38">WhyIcannotSend</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-38" class="dsq-comment-body">
                        <div id="dsq-comment-message-38" class="dsq-comment-message"><p>As you can see &#8211; second query logic is absolutely the same like the first one. The difference is one &#8211; second one is acting as prepared statement (be careful &#8211; I did not say that it is prepared statement – I said that this statement will act the same way as prepared statement. FYI &#8211;  I know in details how works optimizer in SQL Server). Last time when I&#8217;ve seen the developer with the attitude like yours (“I will not put any business logic into a stored procedure”) and who used only prepared statements as you &#8211; he came to me with exactly this queries and request to put this query in SP. For my question where is a problem from his point of view he answered: &#8220;it is JDBC/ODBC driver error. Through SP this would be faster&#8221;. I did SP for him and show that there is no performance improvement at all using SP. But in QA he still able to run the query in 0 milliseconds. He was amazed and had no answer.  Now is your shot. Any idea? I know the answer why the timing is so different. I can proof it and explain it. (this link can give you some light in the dark but it has no full answer: <a href="http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure" rel="nofollow">http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/12612/Prepared-Statement-vs-Stored-Procedure</a>)</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-39">
                    <div id="dsq-comment-header-39" class="dsq-comment-header">
                        <cite id="dsq-cite-39">
                                <span id="dsq-author-user-39">OMG</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-39" class="dsq-comment-body">
                        <div id="dsq-comment-message-39" class="dsq-comment-message"><p>Also – have you got any experience how to find what particular prepared statement started to slow down application that running against SQL Server 2000? I had – I spent more then half a day to find the real script that hidden under handle of temporary SP that wraps real query. Just try to catch these calls in profiler – you will be happy. I can translate this trace in plain English like this: the SP with handle 15 runs 300 seconds. Very informative and useful – but you can test it by yourself if you don’t believe me. BTW it is not only “mine” problem: <a href="http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql" rel="nofollow">http://bytes.com/topic/sql-server/answers/497441-finding-prepared-statement-sql</a>  Please, pay attention to this words in the message ”The statement is prepared before I start the profiler and the client<br />
keeps that connection &#8211; so I can&#8217;t see its preparation without restarting the server (it&#8217;s a web application).” Can you imagine how to restart, say ebay.com? (BTW AFAIK ebay is using SQL Server as database server)</p>
<p>PS Sorry &#8211; I&#8217;m not spaming &#8211; only aproximately every third message appears in several minutes after send</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6856">
                    <div id="dsq-comment-header-6856" class="dsq-comment-header">
                        <cite id="dsq-cite-6856">
                                <span id="dsq-author-user-6856">Prez</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6856" class="dsq-comment-body">
                        <div id="dsq-comment-message-6856" class="dsq-comment-message"><p>Hi,<br />
i am working with one application which has almost 4000 lines of code in sproc&#8230;and there are many sproc like that&#8230;<br />
We are continuously adding requirement in tht system&#8230;<br />
But complication here is..tht&#8230;each stored proc uses almost 5-10 tables many times&#8230;and some of tables have millions of records&#8230;we make multiple joins in such tables many times&#8230;<br />
Now if we think to seperate our business logic in to another Business layer then i have doubt that system will perform as of now&#8230;.</p>
<p>Regards,<br />
Prez.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6857">
                    <div id="dsq-comment-header-6857" class="dsq-comment-header">
                        <cite id="dsq-cite-6857">
                                <span id="dsq-author-user-6857">Anonymous</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6857" class="dsq-comment-body">
                        <div id="dsq-comment-message-6857" class="dsq-comment-message"><p>what kind of test coverage do you have for all that logic?</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2005/06/09/the-worst-possible-way-to-use-a-stored-procedure/';
    var disqus_identifier = '13 /blogs/jeremy.miller/archive/2005/06/09/129562.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "The Worst Possible Way to use a Stored Procedure";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=13');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2005\/06\/09\/the-worst-possible-way-to-use-a-stored-procedure\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.875 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 14:51:18 -->
<!-- super cache -->