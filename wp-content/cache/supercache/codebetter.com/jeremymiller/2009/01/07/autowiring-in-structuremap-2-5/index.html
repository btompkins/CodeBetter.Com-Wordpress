<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>AutoWiring in StructureMap 2.5+ | Jeremy D. Miller</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/jeremymiller/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/jeremymiller/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='It’s been years since I’ve gone on an Anti-Singleton rant' href='http://codebetter.com/jeremymiller/2009/01/06/it-s-been-years-since-i-ve-gone-on-an-anti-singleton-rant/' />
<link rel='next' title='A Challenge to the VB.Net Community at Large on OSS' href='http://codebetter.com/jeremymiller/2009/01/08/a-challenge-to-the-vb-net-community-at-large-on-oss/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/jeremymiller/?p=638' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,140] -->
<link rel="canonical" href="http://codebetter.com/jeremymiller/2009/01/07/autowiring-in-structuremap-2-5/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-638" class="post-638 post type-post status-publish format-standard hentry category-structuremap">
					<h1 class="entry-title">AutoWiring in StructureMap 2.5+</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">Jeremy Miller</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/jeremymiller/2009/01/07/autowiring-in-structuremap-2-5/" title="6:06 pm" rel="bookmark"><span class="entry-date">January 7, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/jeremymiller/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/jeremymiller/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>Getting the StructureMap docs a going.&nbsp; Here’s an excerpt:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The best way to use an IoC container is to allow &#8220;Auto Wiring&#8221; to do most of the work for you.&nbsp; IoC Containers like StructureMap are an infrastructure concern, and as such, should be isolated from as much of your code as possible.&nbsp; Before examining Auto Wiring in depth, let&#8217;s look at a common anti pattern of IoC usage:</p>
<h2>IoC Container Anti-Pattern</h2>
<p>One of the worst, but sadly&nbsp; most common, usages of an IoC container is shown below:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// This is the way to write a Constructor Function with an IoC tool</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Let the IoC container &#8220;inject&#8221; services from outside, and keep</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// ShippingScreenPresenter ignorant of the IoC infrastructure</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> ShippingScreenPresenter(<span>IShippingService</span> service, <span>IRepository</span> repository)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _service = service;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _repository = repository;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// FAIL!</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// This is the wrong way to use an IoC container.&nbsp; Do NOT invoke the container from</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// the constructor function.&nbsp; This tightly couples the ShippingScreenPresenter to</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// the IoC container in a harmful way.&nbsp; This class cannot be used in either</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// production or testing without a valid IoC configuration.&nbsp; Plus, you&#8217;re writing more</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// code</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> ShippingScreenPresenter()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _service = <span>ObjectFactory</span>.GetInstance&lt;<span>IShippingService</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _repository = <span>ObjectFactory</span>.GetInstance&lt;<span>IRepository</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</p></div>
<p> <!--EndFragment--><br />
<hr />
<h2>Example</h2>
<p>Typically, you’ll try to minimize the number of <a href="http://codebetter.com/controlpanel/blogs/%20%20%20%20%20%20%20%20%20%20%20%20Typically,%20you%E2%80%99ll%20try%20to%20minimize%20the%20number%20of%20Service%20Locator%20usages%20in%20">Service Locator</a> (Container.Get*****) usages in your system to a bare minimum (I found 8 in my current system, but I think I’ll find a way to prune half of those later).&nbsp; Most of the value of an IoC tool is in automatically doing Dependency Injection.&nbsp; I’m working with the new MVC framework at the moment, so it’s a handy sample.&nbsp; Let’s say that we have a Controller class for a typical CRUD screen.&nbsp; That Controller class will generally need to interact with both validation services and the data access functionality of the Repository.&nbsp; Here’s a representative Controller class:</p>
<div class="code-sample">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>SomeScreenController</span> : <span>IController</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span>IRepository</span> _repository;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span>IValidator</span> _validator;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// SomeScreenController depends on both IRepository and IValidator</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> SomeScreenController(<span>IRepository</span> repository, <span>IValidator</span> validator)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _repository = repository;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _validator = validator;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</p></div>
<p>So let’s get StructureMap set up for this SomeScreenController class:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;overflow: scroll;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>ObjectFactory</span>.Initialize(x =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Set up the IValidator</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x.ForRequestedType&lt;<span>IValidator</span>&gt;().TheDefaultIsConcreteType&lt;<span>Validator</span>&gt;();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Set up the IRepository</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x.ForRequestedType&lt;<span>IRepository</span>&gt;().TheDefault.Is.OfConcreteType&lt;<span>Repository</span>&gt;()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithCtorArg(<span>&#8220;connectionString&#8221;</span>).EqualToAppSetting(<span>&#8220;CONNECTION-STRING&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
</p></div>
<p>You’ll notice that we didn’t make any explicit configuration for the SomeScreenController class, but yet we could now call:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;overflow: scroll;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> controller = <span>ObjectFactory</span>.GetInstance&lt;<span>SomeScreenController</span>&gt;();</p>
</p></div>
<p>and StructureMap will happily create a new instance of the SomeScreenController class by invoking its constructor and passing in a new Validator object and a new Repository object created with the connection string from the App.config file.&nbsp; We didn’t need to tell StructureMap how to construct SomeScreenController because: </p>
<ul>
<li>StructureMap can look at the constructor function of SomeScreenController and see that it depends on IValidator and IRepository </li>
<li>StructureMap “knows” about the default way to create and return an IValidator and an IRepository </li>
</ul>
<p>This feature is known as “auto wiring,” and all the mainstream IoC containers support this feature to some extent or another.&nbsp; </p>
<hr />
<h2>StructureMap&#8217;s Policies for Auto Wiring</h2>
<p>By default, as long as an object is being created by invoking its constructor function, StructureMap will try to create/resolve/find an object for each non-primitive dependency in the requested concrete type.&nbsp; If StructureMap doesn&#8217;t &#8220;know&#8221; how to find a requested dependency, it will throw an exception.&nbsp; By design, StructureMap cannot auto wire primitive arguments like strings and numbers.&nbsp; The Auto Wiring can be overriden by explicit configuration (this might actually be easier with Xml configuration):</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; registry.InstanceOf&lt;<span>Rule</span>&gt;()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Is.OfConcreteType&lt;<span>WidgetRule</span>&gt;()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithName(<span>&#8220;TheWidgetRule&#8221;</span>)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CtorDependency&lt;<span>IWidget</span>&gt;().Is(i =&gt; i.TheInstanceNamed(<span>&#8220;Yellow&#8221;</span>));</p>
</p></div>
<p> <!--EndFragment-->
<p>In the example above, the IWidget dependency of the WidgetRule class is overriden.</p>
<hr />
<h4>Object Identity within a Single Request</h4>
<p>Within a single object request, StructureMap will only create a single object for a single Instance configuration.&nbsp; What that means in effect is that if two or more objects in a single request need the same dependency, those two objects will get the exact same instance of that dependency.&nbsp; Let&#8217;s immediately jump into code to demonstrate this.</p>
<p>This auto wiring policy was intended for objects that need to be shared by lots of other objects.&nbsp; A common example of this is some sort of DataContext class:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>DataContext</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span>Guid</span> _id = <span>Guid</span>.NewGuid();</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">string</span> ToString()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span>&#8220;Id: {0}&#8221;</span>, _id);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</p></div>
<p> <!--EndFragment-->
<p>Now, let&#8217;s say that I have a hierarchy of classes that all need to work on a DataContext:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>Class1</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> Class1(<span>DataContext</span> context){}</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">string</span> ToString()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span>&#8220;Class1 has Context: {0}&#8221;</span>, _context);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>Class2</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> Class2(<span>Class1</span> class1, <span>DataContext</span> context) {}</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">string</span> ToString()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span>&#8220;Class2 has Context: {0}\n{1}&#8221;</span>, _context, _class1);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>Class3</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> Class3(<span>Class2</span> class2, <span>DataContext</span> context) {}</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">string</span> ToString()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span>&#8220;Class3 has Context: {0}\n{1}&#8221;</span>, _context, _class2);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</p></div>
<p> <!--EndFragment-->
<p>When you request an object of Class3 with a call to Container.GetInstance&lt;Class3&gt;() like this:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span>Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> demonstrate_session_identity()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> class3 = container.GetInstance&lt;<span>Class3</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(class3);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</p></div>
<p> <!--EndFragment-->
<p>The output is:</p>
<pre>Class3 has Context: Id: 3abe0330-e94f-48a3-b8c3-56d278eea07f<br />Class2 has Context: Id: 3abe0330-e94f-48a3-b8c3-56d278eea07f<br />Class1 has Context: Id: 3abe0330-e94f-48a3-b8c3-56d278eea07f</pre>
<p>In the sample above, when we write out the Class3, Class2, and Class1 objects to Debug.WriteLine, we find that each of these objects have a reference to the same DataContext. If we were to run this test again, the output might be:</p>
<pre>Class3 has Context: Id: 109329ce-4058-4a35-9fd1-46d47c1e69e7<br />Class2 has Context: Id: 109329ce-4058-4a35-9fd1-46d47c1e69e7<br />Class1 has Context: Id: 109329ce-4058-4a35-9fd1-46d47c1e69e7<br />        </pre>
<p>We see the exact same behavior, but it was a different object instance of DataContext for the new object graph.</p>
<p>This behavior also applies to objects passed in to the Container as an explicit argument:</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span>Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> demonstrate_session_identity_with_explicit_argument()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>DataContext</span> context = <span style="color: blue">new</span> <span>DataContext</span>();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(<span>&#8220;The context being passed in is &#8220;</span> + context);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> class3 = container.With(context).GetInstance&lt;<span>Class3</span>&gt;();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(class3);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>The output of this unit test is:</p>
<pre>The context being passed in is Id: 87ddccfd-a441-41fd-a86d-3f32987496ba<br />Class3 has Context: Id: 87ddccfd-a441-41fd-a86d-3f32987496ba<br />Class2 has Context: Id: 87ddccfd-a441-41fd-a86d-3f32987496ba<br />Class1 has Context: Id: 87ddccfd-a441-41fd-a86d-3f32987496ba<br />        </pre>
<p>The point of the sample above is just to show that the object instance of DataContext passed into the Container is used to create the Class3, Class2, and Class1 objects.</p>
<hr />
<h4>Injecting Arrays of Services</h4>
<p>StructureMap has always supported Dependency Injection of arrays of dependency objects.&nbsp; New in StructureMap 2.5+ is a policy that if any array of dependencies is not explicitly specified, StructureMap will inject all possible instances of that dependency type.&nbsp; The sample below illustrates this auto wiring policy.&nbsp; I have a class called &#8220;ClassThatUsesValidators&#8221; that needs an array of IValidator objects.&nbsp; Below, I&#8217;ve configured two different Instances of ClassThatUsesValidator, one that explicitly configures its children IValidator and another Instance that is just going to let auto wiring inject the IValidator&#8217;s.</p>
<div style="border: thin solid black;background: white none repeat scroll 0% 0%;font-size: 10pt;color: black;font-family: courier new">
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">interface</span> <span>IValidator</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>Validator</span> : <span>IValidator</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span style="color: blue">string</span> _name;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> Validator(<span style="color: blue">string</span> name)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _name = name;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">string</span> ToString()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span>&#8220;Name: {0}&#8221;</span>, _name);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>ClassThatUsesValidators</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">readonly</span> <span>IValidator</span>[] _validators;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> ClassThatUsesValidators(<span>IValidator</span>[] validators)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _validators = validators;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> Write()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">foreach</span> (<span>IValidator</span> validator <span style="color: blue">in</span> _validators)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(validator);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; [<span>TestFixture</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span>ValidatorExamples</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span>Container</span> container;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span>SetUp</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> SetUp()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container = <span style="color: blue">new</span> <span>Container</span>(x =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x.ForRequestedType&lt;<span>IValidator</span>&gt;().AddInstances(o =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>Validator</span>&gt;().WithCtorArg(<span>&#8220;name&#8221;</span>).EqualTo(<span>&#8220;Red&#8221;</span>).WithName(<span>&#8220;Red&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>Validator</span>&gt;().WithCtorArg(<span>&#8220;name&#8221;</span>).EqualTo(<span>&#8220;Blue&#8221;</span>).WithName(<span>&#8220;Blue&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>Validator</span>&gt;().WithCtorArg(<span>&#8220;name&#8221;</span>).EqualTo(<span>&#8220;Purple&#8221;</span>).WithName(<span>&#8220;Purple&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>Validator</span>&gt;().WithCtorArg(<span>&#8220;name&#8221;</span>).EqualTo(<span>&#8220;Green&#8221;</span>).WithName(<span>&#8220;Green&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x.ForRequestedType&lt;<span>ClassThatUsesValidators</span>&gt;().AddInstances(o =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Define an Instance of ClassThatUsesValidators that depends on AutoWiring</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>ClassThatUsesValidators</span>&gt;().WithName(<span>&#8220;WithAutoWiring&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Define an Instance of ClassThatUsesValidators that overrides AutoWiring</span></p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o.OfConcreteType&lt;<span>ClassThatUsesValidators</span>&gt;().WithName(<span>&#8220;ExplicitArray&#8221;</span>)</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .TheArrayOf&lt;<span>IValidator</span>&gt;().Contains(y =&gt;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y.TheInstanceNamed(<span>&#8220;Red&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y.TheInstanceNamed(<span>&#8220;Green&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span>Test</span>]</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">void</span> what_are_the_validators()</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(<span>&#8220;With Auto Wiring&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.GetInstance&lt;<span>ClassThatUsesValidators</span>&gt;(<span>&#8220;WithAutoWiring&#8221;</span>).Write();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(<span>&#8220;=================================&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>Debug</span>.WriteLine(<span>&#8220;With Explicit Configuration&#8221;</span>);</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.GetInstance&lt;<span>ClassThatUsesValidators</span>&gt;(<span>&#8220;ExplicitArray&#8221;</span>).Write();</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p>
</div>
<p><!--EndFragment--></p>
<p>The output of what_are_the_validators() is:</p>
<pre>With Auto Wiring<br />Name: Red<br />Name: Blue<br />Name: Purple<br />Name: Green<br />=================================<br />With Explicit Configuration<br />Name: Red<br />Name: Green</pre>
<hr />
<div class="shr-publisher-638"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->

					<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='http://1.gravatar.com/avatar/db65c5c5cf9f1c51e842f733892eace1?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=G' class='avatar avatar-60 photo' height='60' width='60' />						</div><!-- #author-avatar 	-->
						<div id="author-description">
							<h2>About Jeremy Miller</h2>
							Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.							<div id="author-link">
								<a href="http://codebetter.com/jeremymiller/author/jeremymiller/" title="View all posts by Jeremy Miller">View all posts by Jeremy Miller &rarr;</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description	-->
					</div><!-- .entry-author-info -->

					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/jeremymiller/category/structuremap/" title="View all posts in StructureMap" rel="category tag">StructureMap</a>. Bookmark the <a href="http://codebetter.com/jeremymiller/2009/01/07/autowiring-in-structuremap-2-5/" title="Permalink to AutoWiring in StructureMap 2.5+" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/jeremymiller/2009/01/07/autowiring-in-structuremap-2-5/feed/" title="Comments RSS to AutoWiring in StructureMap 2.5+" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-638 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/jeremymiller/2009/01/06/it-s-been-years-since-i-ve-gone-on-an-anti-singleton-rant/" rel="prev"><span class="meta-nav">&larr;</span> It’s been years since I’ve gone on an Anti-Singleton rant</a></div>
					<div class="nav-next"><a href="http://codebetter.com/jeremymiller/2009/01/08/a-challenge-to-the-vb-net-community-at-large-on-oss/" rel="next">A Challenge to the VB.Net Community at Large on OSS <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-5042">
                    <div id="dsq-comment-header-5042" class="dsq-comment-header">
                        <cite id="dsq-cite-5042">
    http://www.heliosfx.com                            <span id="dsq-author-user-5042">Travis</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5042" class="dsq-comment-body">
                        <div id="dsq-comment-message-5042" class="dsq-comment-message"><p>&#8220;// FAIL!<br />
 // This is the wrong way to use an IoC container.  Do NOT invoke the container from<br />
// the constructor function. &#8221;</p>
<p>That is all peachy in a rose colored world, but sometimes we don&#8217;t have the *luxury* of instantiating control of our objects. cough Web Form Page cough, until we can inject into the Page class&#8217;s constructor, those of us living in the Web Forms world have to live with this &#8220;FAIL&#8221;. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5043">
                    <div id="dsq-comment-header-5043" class="dsq-comment-header">
                        <cite id="dsq-cite-5043">
    http://blog@danielfernandes.net                            <span id="dsq-author-user-5043">Daniel Fernandes</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5043" class="dsq-comment-body">
                        <div id="dsq-comment-message-5043" class="dsq-comment-message"><p>According to you, is it  &#8220;IoC gone mad&#8221; to use the *Provider pattern to provide things as trivial as a configuration string ?<br />
I&#8217;ve done that in the past and I  just ended up with a plethora of very simple classes doing little things, I&#8217;m all for SRP but it sometimes feels we&#8217;re decomposing things too much.</p>
<p>On a different subject, what are your thoughts on Context objects that could definitely be injected by IoC but knowing you will need those throughout your layers (say a SecurityContext object) would you think this may be the wrong use case of a IoC?</p>
<p>Cheers<br />
Daniel</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5044">
                    <div id="dsq-comment-header-5044" class="dsq-comment-header">
                        <cite id="dsq-cite-5044">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5044">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5044" class="dsq-comment-body">
                        <div id="dsq-comment-message-5044" class="dsq-comment-message"><p>Travis,</p>
<p>I&#8217;ve got the &#8220;BuildUp()&#8221; functionality coming in 2.5.2 later this week to address the @#$$ed up ASP.Net architecture.  Even then, why would it have to be any more than:</p>
<p>_presenter = ObjectFactory.With<imyviewinterface>(this).GetInstance<imypresenter>();</p>
<p>in the constructor of the WebForms page.</imypresenter></imyviewinterface></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5045">
                    <div id="dsq-comment-header-5045" class="dsq-comment-header">
                        <cite id="dsq-cite-5045">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5045">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5045" class="dsq-comment-body">
                        <div id="dsq-comment-message-5045" class="dsq-comment-message"><p>@Daniel,</p>
<p>I think the ASP.Net Provider model is an automatic FAIL for anything but the delivered providers. </p>
<p>I actually like to use StructureMap as my configuration tool.  It keeps your code decoupled from the configuration for better reuse, simpler code, and better testability.</p>
<p>&#8220;On a different subject, what are your thoughts on Context objects that could definitely be injected by IoC but knowing you will need those throughout your layers (say a SecurityContext object) would you think this may be the wrong use case of a IoC?&#8221;</p>
<p>Maybe I&#8217;m not thinking about this hard enough, but I don&#8217;t see any problem with that.  </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5046">
                    <div id="dsq-comment-header-5046" class="dsq-comment-header">
                        <cite id="dsq-cite-5046">
                                <span id="dsq-author-user-5046">Pete Johanson</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5046" class="dsq-comment-body">
                        <div id="dsq-comment-message-5046" class="dsq-comment-message"><p>Touching on the subject of &#8220;minimize the number of Service Locator (Container.Get*****) usages in your system&#8221;, I&#8217;ve been struggling in my head recently with the approach to do just that in a rich client scenario. (This happens to be cross-platform Gtk#, but it could just as easily apply to SWF, whatever).</p>
<p>Let&#8217;s say in reaction to a certain user action (clicking a menu item), a certain amount of business logic happens, and then some dialog is supposed to appear.</p>
<p>At some point, the business logic needs to say &#8220;Show Foo Dialog&#8221;. The naive approach would be to do ObjectFactory.GetInstance<ifoodialog> () and act on it&#8230; But what&#8217;s the alternative? The best I can think of is a IFooDialogFactory that would be injected, and calling factory.CreateDialog ().</p>
<p>But then I&#8217;ve got a new factory for *every dialog I want to create*.</p>
<p>What are others doing to solve this situation?</ifoodialog></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5047">
                    <div id="dsq-comment-header-5047" class="dsq-comment-header">
                        <cite id="dsq-cite-5047">
    http://blog@danielfernandes.net                            <span id="dsq-author-user-5047">Daniel Fernandes</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5047" class="dsq-comment-body">
                        <div id="dsq-comment-message-5047" class="dsq-comment-message"><p>@Jeremy :<br />
By Context object, what would you think if one always had to inject HttpContext to any code that needs it even though such class is core to a platform.<br />
I&#8217;m sure you understood that, maybe I am seeing a smell when maybe there isn&#8217;t <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
So maybe to makes it clearer, do you think Singleton pattern to contain mostly Data oriented objects as a no-no and IoC should be used to provide the dependency resolution even from &#8220;within&#8221; a platform.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5048">
                    <div id="dsq-comment-header-5048" class="dsq-comment-header">
                        <cite id="dsq-cite-5048">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5048">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5048" class="dsq-comment-body">
                        <div id="dsq-comment-message-5048" class="dsq-comment-message"><p>@Daniel,</p>
<p>Ok, I&#8217;m with you a bit more.  Yes, absolutely you would inject a wrapper around the HttpContext, but there&#8217;s a bit more to it than that.  You want as little coupling as possible between your code and the HttpContext.  Ideally, you&#8217;d put a strongly typed wrapper around the HttpContext that&#8217;s expressed in terms of your application instead of dictionaries.  More testability, cleaner code, less duplication of the dictionary access, and you can reuse the code outside of ASP.Net if that&#8217;s valuable.</p>
<p>&#8220;So maybe to makes it clearer, do you think Singleton pattern to contain mostly Data oriented objects as a no-no and IoC should be used to provide the dependency resolution even from &#8220;within&#8221; a platform.&#8221;</p>
<p>Yes, I do.  It&#8217;s a small gain in many cases, but I&#8217;ve seen the ability to swap out something that used to be a Singleton become valuable later on.  Besides, using an IoC frees you from hand rolling Singleton code.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5049">
                    <div id="dsq-comment-header-5049" class="dsq-comment-header">
                        <cite id="dsq-cite-5049">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5049">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5049" class="dsq-comment-body">
                        <div id="dsq-comment-message-5049" class="dsq-comment-message"><p>@Pete Johanson,</p>
<p>One way to do it is to direct all requests like that to either a central EventAggregator / MessageBus and/or an ApplicationController.  Then you can bury the service locator stuff there.</p>
<p>You could inject the container itself into classes.  That at least makes the dependency on the Container more transparent and helps with testability.</p>
<p>In your case with the dialog box, I typically have the dialog form injected into the Presenter for later use anyway.</p>
<p>And that gives me an idea for a STructureMap feature for later&#8230;</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5050">
                    <div id="dsq-comment-header-5050" class="dsq-comment-header">
                        <cite id="dsq-cite-5050">
                                <span id="dsq-author-user-5050">Paco</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5050" class="dsq-comment-body">
                        <div id="dsq-comment-message-5050" class="dsq-comment-message"><p>I checked how many times I make a call to the container in the project I&#8217;m currently working on and I came to 12. 10 of those are done in attributes. Is there a way to cut that down?</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5051">
                    <div id="dsq-comment-header-5051" class="dsq-comment-header">
                        <cite id="dsq-cite-5051">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5051">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5051" class="dsq-comment-body">
                        <div id="dsq-comment-message-5051" class="dsq-comment-message"><p>@Paco,</p>
<p>Can you paste some sample code?  Or email it to me from the contact form?</p>
<p>Jeremy</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5052">
                    <div id="dsq-comment-header-5052" class="dsq-comment-header">
                        <cite id="dsq-cite-5052">
                                <span id="dsq-author-user-5052">Paco</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5052" class="dsq-comment-body">
                        <div id="dsq-comment-message-5052" class="dsq-comment-message"><p>An example in pseudo C#:</p>
<p>class LogAttribute<br />
{</p>
<p>    private ILogger logger;<br />
    public LogAttribute()<br />
    {<br />
           logger = IoC.Resolve<ilogger>();<br />
    }</p>
<p>    public void OnControllerActionExecuting(FilterContext)<br />
    {<br />
        var message = complexStuffToCreateLogentry(context);<br />
       logger.Log(message);<br />
    }<br />
}</p>
<p>I can already unit test it because an extra (non-default) constructor with the dependency in it.<br />
I don&#8217;t want to invoke the non-default constructor on the place where I use the attribute, because I have to inject the dependency on the calling class too and that will lead to constructors with lot&#8217;s of dependencies just to make the attribute usage possible. </p>
<p>When this is unclear, I can mail or post the actual code tomorrow.</ilogger></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5053">
                    <div id="dsq-comment-header-5053" class="dsq-comment-header">
                        <cite id="dsq-cite-5053">
                                <span id="dsq-author-user-5053">Steve Py</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5053" class="dsq-comment-body">
                        <div id="dsq-comment-message-5053" class="dsq-comment-message"><p>The one irk I have with IoC is I can&#8217;t seem to shake the smell of Soft-Coding. The price of IoC is complexity, and while it gives you the power to configure your dependencies, in real-world projects that leads to a quagmire of configuration values. Situations always seem to arise where the auto-wiring just isn&#8217;t right for this situation and these require smelly work-arounds.  Granted this is likely just a sign of a bad design, but I&#8217;m not the one that controls of the purse strings and delivery dates.</p>
<p>One thing I do tend to add to any constructor / method that accepts references is a null check on the arguments to throw an ArgumentNullException with the parameter name. I bloody HATE NullReferenceExceptions. The argument exception with the parameter name often is enough to find/fix any configuration issues that manage to find their way into testing/production.</p>
<p>The fact is that while IoC containers might look &#038; smell like a tasty sticky-bun, you still need to check the raisins.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5054">
                    <div id="dsq-comment-header-5054" class="dsq-comment-header">
                        <cite id="dsq-cite-5054">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5054">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5054" class="dsq-comment-body">
                        <div id="dsq-comment-message-5054" class="dsq-comment-message"><p>@Steve Py,</p>
<p>It&#8217;s a valid concern, but there are diagnostics in SM that would let you scan a configuration all at one time and report missing dependencies.  You wouldn&#8217;t get an NRE w/ SM.  You&#8217;d get more specific SM exceptions earlier.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5055">
                    <div id="dsq-comment-header-5055" class="dsq-comment-header">
                        <cite id="dsq-cite-5055">
    http://weblogs.asp.net/fbouma                            <span id="dsq-author-user-5055">Frans Bouma</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5055" class="dsq-comment-body">
                        <div id="dsq-comment-message-5055" class="dsq-comment-message"><p>While I agree that if possible, one should initiate DI from outside the object to create, it has one sad side-effect: you can&#8217;t use &#8216;new&#8217;. </p>
<p>the problem with that is that if you make a mistake and accidently use &#8216;new&#8217; instead of the factory, you don&#8217;t get the stuff injected, which could lead to hard-to-track down bugs. </p>
<p>This alone could make some people to decide to go for DI from the Ctor, to make things more transparent for the developer who uses the classes which will receive injectables. </p>
<p>I.o.w.: calling it an anti-pattern/FAIL etc. is much too strong, there are arguments for using a different approach. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5056">
                    <div id="dsq-comment-header-5056" class="dsq-comment-header">
                        <cite id="dsq-cite-5056">
    http://weblogs.asp.net/fbouma                            <span id="dsq-author-user-5056">Frans Bouma</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5056" class="dsq-comment-body">
                        <div id="dsq-comment-message-5056" class="dsq-comment-message"><p>(I forgot: with DI initiated from the CTor, I mean that the Ctor calls out to the IoC container to inject whatever has to be injected, so it&#8217;s a little different from what you showed as an example, but still ties the receiver to the IoC container, which can be a concern, however at the same time, it solves the problem to always use a factory. </p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5057">
                    <div id="dsq-comment-header-5057" class="dsq-comment-header">
                        <cite id="dsq-cite-5057">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5057">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5057" class="dsq-comment-body">
                        <div id="dsq-comment-message-5057" class="dsq-comment-message"><p>@Frans,</p>
<p>That comes up fairly often.  I think you&#8217;ll have to take that up with the CLR team.  An IoC tool is arguably a hack around the static type system anyway.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5058">
                    <div id="dsq-comment-header-5058" class="dsq-comment-header">
                        <cite id="dsq-cite-5058">
                                <span id="dsq-author-user-5058">jinksk</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5058" class="dsq-comment-body">
                        <div id="dsq-comment-message-5058" class="dsq-comment-message"><p>The 2nd code section contains</p>
<p>            ObjectFactory.Initialize(x =></p>
<p>            {</p>
<p>                // Set up the IValidator</p>
<p>                x.ForRequestedType<ivalidator>().TheDefaultIsConcreteType<validator>();</p>
<p>                // Set up the IRepository</p>
<p>                x.ForRequestedType<irepository>().TheDefault.Is.OfConcreteType<repository>()</p>
<p>                    .WithCtorArg(&#8220;connectionString&#8221;).EqualToAppSetting(&#8220;CONNECTION-STRING&#8221;);</p>
<p>            });<br />
Maybe I&#8217;m missing something, but that code won&#8217;t work anywhere. Is the browser not displaying everything? Please repost that snippet.</repository></irepository></validator></ivalidator></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5059">
                    <div id="dsq-comment-header-5059" class="dsq-comment-header">
                        <cite id="dsq-cite-5059">
    http://codebetter.com/blogs/jeremy.miller                            <span id="dsq-author-user-5059">Jeremy D. Miller</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5059" class="dsq-comment-body">
                        <div id="dsq-comment-message-5059" class="dsq-comment-message"><p>@jinksk,</p>
<p>Can you be more specific?  I don&#8217;t see anything wrong with that code.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5060">
                    <div id="dsq-comment-header-5060" class="dsq-comment-header">
                        <cite id="dsq-cite-5060">
                                <span id="dsq-author-user-5060">David</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5060" class="dsq-comment-body">
                        <div id="dsq-comment-message-5060" class="dsq-comment-message"><p>What if, in the first example, the implementation of IValidator accepts a parameter from the controller? My validator requires an instance of ModelState from the controller. I can&#8217;t seem to figure out how to inject a concrete Type for IValidator in this case.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-5061">
                    <div id="dsq-comment-header-5061" class="dsq-comment-header">
                        <cite id="dsq-cite-5061">
    http://holzerian.com                            <span id="dsq-author-user-5061">Justin Holzer</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-5061" class="dsq-comment-body">
                        <div id="dsq-comment-message-5061" class="dsq-comment-message"><p>I agree that auto-wiring should be taken advantage of when possible. One exception I have to take with the examples given here and in many other places is that they focus on only the case where the developer has full control over the API. In reality, there are many times when the developer writes applications, such as plugins, where they have no control over the instantiation of the class.</p>
<p>For instance, I am working on a plug-in module that is instantiated by the parent application. The plugin class must have a no-arg (default) constructor, and I have no way to tell the parent application to use StructureMap to create the instance of the plugin class. Therefore, if I want to use StructureMap in this case, I have no choice but to either call ObjectFactory directly, or create a facade/wrapper for calling it. I&#8217;d love to take adavantage of auto-wiring in this case, but I just see no way around using what has been deemed here as the &#8220;anti-pattern&#8221;.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-6879">
                    <div id="dsq-comment-header-6879" class="dsq-comment-header">
                        <cite id="dsq-cite-6879">
                                <span id="dsq-author-user-6879">Just2play</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-6879" class="dsq-comment-body">
                        <div id="dsq-comment-message-6879" class="dsq-comment-message"><p>new to structure map. very insightfull. thanks.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/jeremymiller/2009/01/07/autowiring-in-structuremap-2-5/';
    var disqus_identifier = '638 /blogs/jeremy.miller/archive/2009/01/07/autowiring-in-structuremap-2-5.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'theshadetreedeveloper';
    var disqus_title = "AutoWiring in StructureMap 2.5+";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=638');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/jeremymiller\/2009\/01\/07\/autowiring-in-structuremap-2-5\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title">The Shade Tree Developer</h3>Jeremy is the Chief Software Architect at Dovetail Software, the coolest ISV in Austin.  Jeremy began his IT career writing "Shadow IT" applications to automate his engineering documentation, then wandered into software development because it looked like more fun. Jeremy is the author of the open source StructureMap tool for Dependency Injection with .Net, StoryTeller for supercharged acceptance testing in .Net, and one of the principal developers behind FubuMVC.  Jeremy's thoughts on all things software can be found at The Shade Tree Developer at http://codebetter.com/jeremymiller.
</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Upcoming posts&#8230;</h3>			<div class="textwidget"><p>How I'm using StoryTeller to test FubuMVC<br />
Building a "Lookup" html convention w/ FubuMVC<br />
FubuMVC's Configuration Model "Special Sauce"<br />
Managing Script dependencies with FubuMVC<br />
Authorization and FubuMVC<br />
Continuations<br />
Composing Views with FubuMVC<br />
Extensible Model Binding with FubuMVC<br />
Introducing "Bottles"<br />
Modular Packaging with FubuMVC<br />
Self-Installing Apps w/ FubuMVC<br />
Routing and Behavioral Conventions with FubuMVC<br />
What Should I Learn?</p>
</div>
		</li><li id="linkcat-1046" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/jeremydmiller">Follow me on Twitter</a></li>
<li><a href="https://github.com/DarthFubuMVC/fubumvc" target="_blank">FubuMVC on GitHub</a></li>
<li><a href="https://github.com/jeremydmiller">My GitHub Page</a></li>
<li><a href="https://github.com/storyteller/storyteller">StoryTeller on GitHub</a></li>
<li><a href="https://github.com/structuremap/structuremap">StructureMap on GitHub</a></li>

	</ul>
</li>
		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
					<li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://codebetter.com/jeremymiller/2012/01/' title='January 2012'>January 2012</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/09/' title='September 2011'>September 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/07/' title='July 2011'>July 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/06/' title='June 2011'>June 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/05/' title='May 2011'>May 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/04/' title='April 2011'>April 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/03/' title='March 2011'>March 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2011/01/' title='January 2011'>January 2011</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/09/' title='September 2008'>September 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/08/' title='August 2008'>August 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/06/' title='June 2008'>June 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/05/' title='May 2008'>May 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/04/' title='April 2008'>April 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/03/' title='March 2008'>March 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/02/' title='February 2008'>February 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2008/01/' title='January 2008'>January 2008</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/11/' title='November 2007'>November 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/10/' title='October 2007'>October 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/09/' title='September 2007'>September 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/08/' title='August 2007'>August 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/10/' title='October 2006'>October 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/09/' title='September 2006'>September 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/09/' title='September 2005'>September 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/08/' title='August 2005'>August 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/07/' title='July 2005'>July 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/06/' title='June 2005'>June 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/05/' title='May 2005'>May 2005</a></li>
	<li><a href='http://codebetter.com/jeremymiller/2005/04/' title='April 2005'>April 2005</a></li>
		</ul>
</li><li id="recent-comments-3" class="widget-container widget_recent_comments"><h3 class="widget-title">What others have said&#8230;</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://zacherygaines.webstarts.com/' rel='external nofollow' class='url'>KadeemFulton</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7523">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments"><a href='http://jonsonbettly.wordpress.com/' rel='external nofollow' class='url'>ScottWorkman</a> on <a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/#comment-7517">The Build Your Own CAB Series Table of Contents</a></li><li class="recentcomments">haihao on <a href="http://codebetter.com/jeremymiller/2008/10/18/profile-s-in-structuremap/#comment-7513">Profile’s in StructureMap</a></li><li class="recentcomments">neon on <a href="http://codebetter.com/jeremymiller/2008/09/10/using-the-structuremap-container-independently-of-objectfactory/#comment-7512">Using the StructureMap Container independently of ObjectFactory</a></li><li class="recentcomments">weaponfan on <a href="http://codebetter.com/jeremymiller/2008/09/25/using-structuremap-2-5-to-inject-your-entity-objects-into-services/#comment-7511">Using StructureMap 2.5 to inject your Entity objects into Services</a></li></ul></li>				</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.576 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 14:27:43 -->
<!-- super cache -->