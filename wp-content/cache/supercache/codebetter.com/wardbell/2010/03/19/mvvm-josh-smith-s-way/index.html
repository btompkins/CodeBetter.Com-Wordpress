<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>MVVM, Josh Smith’s Way | Ward Bell</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/wardbell/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/wardbell/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='An IoC-Agnostic Prism Bootstrapper' href='http://codebetter.com/wardbell/2010/01/01/an-ioc-agnostic-prism-bootstrapper/' />
<link rel='next' title='Rob E’s Mini-MVVM Framework @ MIX10' href='http://codebetter.com/wardbell/2010/03/20/rob-e-s-mini-mvvm-framework-mix10/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/wardbell/?p=8' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,126] -->
<link rel="canonical" href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<!-- Shareaholic Notice: There is neither a featured nor gallery image set -->

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=5302176208">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-8" class="post-8 post type-post status-publish format-standard hentry category-mvvm">
					<h1 class="entry-title">MVVM, Josh Smith’s Way</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/wardbell/author/wardbell/" title="View all posts by wardbell">wardbell</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/" title="7:24 pm" rel="bookmark"><span class="entry-date">March 19, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/wardbell/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/wardbell/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>I&rsquo;ve long admired <a target="_blank" href="http://joshsmithonwpf.wordpress.com/">Josh Smith</a>&rsquo;s work. He&rsquo;s one of the best explainers on the web and he &ndash; together with Karl Shifflett and Andrew Smith &#8211; gave us <a target="_blank" href="http://joshsmithonwpf.wordpress.com/mole/">Mole</a>, the superb WPF Visual Studio debugger visualizer.</p>
<p>I heard recently that he&rsquo;d published an e-book on Model-View-ViewModel (MVVM). I met him for the first time at the Microsoft MVP Summit last week and he graciously handed me a printed copy. I devoured it on the plane home and spent the next day playing with the code and preparing this review. </p>
<p>It&rsquo;s called &ldquo;<strong>Advanced MVVM</strong>&rdquo; and you can buy a <a target="_blank" href="http://www.lulu.com/content/paperback-book/advanced-mvvm-(hard-copy)/8353355">printed copy</a> for $20 or get it for $15 <a target="_blank" href="http://www.amazon.com/Advanced-MVVM-ebook/dp/B0038KX9FW">on the Kindle</a>. The companion code is freely available at <a href="http://AdvancedMvvm.com">AdvancedMvvm.com</a> .</p>
<p><strong>$15 bucks for a 52 page &ldquo;book&rdquo;?</strong> It&rsquo;s more of an extended essay to be honest &hellip; an essay with code. After spending some pleasurable hours with both book and code I thought &ldquo;<em>where do you get that kind of entertainment / self-reflection for $15?</em>&rdquo; I have a surfeit of 600 page sleepers lounging on my bookshelf at home; paid more then $50 for each and hardly cracked them. Should we pay by the pound? So I&rsquo;m over it. I don&rsquo;t mind paying for the hours Josh poured in and the fun I got out. Set your expectations appropriately and you&rsquo;ll feel fine.</p>
<p>&#8212;- 19 March 2010 Note &#8212;</p>
<p>Ok, it&rsquo;s been a month or so since I wrote this. Life happens while you&rsquo;re making plans. I intended to be among the first to comment on it. I&rsquo;m late to that party (although I have deliberately NOT looked at what others may have said) so I&rsquo;m not sure if it&rsquo;s still timely. I also shared it with Josh last week to see if I had missed something and get his feedback, particularly in light of my critical remarks.</p>
<p>He encouraged me to publish it even at this late date. I hope he&rsquo;ll repost here some of his responses to the points I raised.</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>MVVM has spooked a lot of developers. There&rsquo;s more than a whiff of <a target="_blank" href="http://www.joelonsoftware.com/articles/fog0000000018.html">astronaut architecture</a> about it. There have to be at least 20 MVVM frameworks and no end of contentious arguments to confound and distress you. No wonder so many are put off.</p>
<h3>MVVM in a Nutshell</h3>
<p>In fact MVVM is fundamentally a simple idea. It starts with the realization that your application is an intractable mess in part because you dumped all of your UI logic into the code-behind &hellip; with the help of Microsoft tools. You discover the wisdom of pulling much of that logic out into a companion class (and some helpers) leaving the view class to concentrate on looking pretty and capturing user gestures. The view and its companion must talk; you can structure their conversation according to a variety of familiar patterns. Model-View-ViewModel is one such pattern.</p>
<p>The predominance of automated binding is the hallmark of MVVM. You bind a View&rsquo;s textbox to a string-providing property of the ViewModel so that a user&rsquo;s changes in the textbox flow to the property and so that programmatic changes to the ViewModel property flow back to the textbox. You bind View events (e.g., button click) to event handlers in the ViewModel enabling user gestures to be conveyed to the ViewModel.</p>
<p>You could write your own bindings by hand, pushing and pulling data and events with custom code. That&rsquo;s a lot of work. The XAML-based client technologies (WPF and Silverlight) provide a binding framework that requires little to no custom coding. In most cases you can &ldquo;connect the dots&rdquo; declaratively and it just works.</p>
<p>Now the View concentrates on appearance and the ViewModel feeds the view. This separation is both clarifying and liberating. You can start looking at that ViewModel to figure out what it should do and how it should do it without also worrying about the visuals. The subsequent examination of ViewModel&rsquo;s more limited responsibilities sets you on a more sustainable course. At least this has been my experience &hellip; and that of the hundreds (thousands?) of other developers who&rsquo;ve adopted this pattern.</p>
<p>Now you&rsquo;ll note that I said it &ldquo;sets you on course&rdquo;; I did not say it delivers you to the promised land. There are details to work out. If the View looks to the ViewModel for data, where does the ViewModel get that data? Are we talking about data values alone or the business rules that surround that data, rules about data validity, integrity, security, and persistence?</p>
<p>Many of us draw a circle around these concerns and call that circle &ldquo;the Model&rdquo;, the third element in the MVVM triad. Our guiding intuition is this: &ldquo;the persistent data are definitely in the model and if the rules about data are true for this and every possible UI, the rules belong in the model as well.&rdquo;</p>
<p>If the last name is required, it is required everywhere; that&rsquo;s a model rule. If gold customers can select from several thank-you gifts, that sounds like UI logic to me &hellip; and belongs in the ViewModel. The specifics have to be worked out.</p>
<h3>Back To Josh</h3>
<p>At this point the discussion risks slipping into theory and theater. We could run to the white board, scribble madly, and count angels on pins without writing a line of code. I love doing that.</p>
<p>Josh has taken another direction which is likely to be both more popular and more effective. He briefly presents his take on MVVM in clear, accessible prose &hellip; and then makes it tangible with an extended exploration of a meaty sample application. I&rsquo;ve read plenty of pattern papers; I don&rsquo;t remember any that were so thorough &hellip; and entertaining &hellip; in their examples. </p>
<p>For style and substance this is a remarkable achievement. I truly hope that Josh&rsquo;s book is widely read because I think it has a better chance of helping WPF and Silverlight developers feel comfortable about MVVM than anything else I&rsquo;ve seen. </p>
<p>I&rsquo;m a little worried that some will fear the word &ldquo;Advanced&rdquo; in the title. The term &ldquo;MVVM&rdquo; is forbidding enough and many folks are still looking for the introduction. I think this book is the introduction they really need. </p>
<p>In what sense is it &ldquo;advanced&rdquo;? It&rsquo;s far from the last word on the subject. It won&rsquo;t settle any arguments (least of all mine). But it does rise above the introductory level in two important respects. </p>
<p>First, it considers the implications of multiple, cooperating MVVM instances. Most MVVM articles present a single MVVM-triad: a single View and its companion ViewModel and Model. </p>
<p>No application needs a single MVVM triad. If you have a one-screen application, don&rsquo;t use MVVM; it&rsquo;s overkill. MVVM is for multi-screen applications consisting of multiple MVVM triads which spring to life somehow and somehow interoperate.</p>
<p>Second, as I noted earlier, Josh doesn&rsquo;t just talk about the pattern. Most of the pages describe the accompanying game, <strong>BubbleBurst</strong>, which is implemented in MVVM style. Instead of paeans to principles and their wondrous benefits, you see MVVM in action, warts and all. </p>
<p>BubbleBurst is &ldquo;advanced&rdquo; enough to both introduce MVVM and reveal important implementation challenges of multi-MVVM applications. Yet it&rsquo;s simple enough to be easily understood in the pages of a book or in a few hours spent trolling the code. It&rsquo;s also fun to play.</p>
<h3>Proceed with Caution</h3>
<p>I&rsquo;m about to begin my critical remarks. Before I do, I want to reemphasize my enthusiasm for what Josh has accomplished. This book is a wonderful place to begin your MVVM journey and I found it to be an enjoyable and insightful read. So, hell-yes, I&rsquo;m recommending it.</p>
<p>On the other hand, it would be a shame if developers stopped their education here. Important elements of the story are missing and many recommendations are seriously misguided in my view. Readers should take Josh seriously but, once they are comfortable with the pattern, they should become aware of starkly contrasting perspectives as well.</p>
<h3>Critical Omissions</h3>
<p>Four vital topics are neither covered nor illustrated in the <a target="_blank" href="http://bubbleburst.codeplex.com/">code</a>:</p>
<ul>
<li>Testing </li>
<li>Model (the first &lsquo;M&rsquo; in MVVM) </li>
<li>Dependency Injection </li>
<li>Event Aggregation </li>
</ul>
<h4>Testing</h4>
<p>Josh asks &ldquo;<em>What is the point of having ViewModels?</em>&rdquo; First among his reasons: &ldquo;<em>the ability to easily write unit and integration tests for the functionality of the user interface without having to get into the messy world of writing tests for live UIs.</em>&rdquo;</p>
<p>That&rsquo;s the last we hear of testing. There is not a single test in the code base. If testing is as important as he says, I&rsquo;d expect a thorough treatment starting with building a test regimen and showing, by example, how to write good tests. Instead, we get lip service.</p>
<p>I don&rsquo;t think testability is the only value of MVVM. I couldn&rsquo;t recommend it for this reason alone. MVVM is a significant architectural investment that introduces complexity. I wouldn&rsquo;t incur that complexity cost merely to make my UI testable. I&rsquo;d look for a less onerous route. Fortunately, I think it has other benefits such as clean separation of concerns, improved readability, and easier debugging (try break-pointing XAML!).</p>
<p>But testability is both a motivation for and a by-product of MVVM style and it should have been covered thoroughly in an &ldquo;advanced&rdquo; treatise on MVVM.</p>
<p>Moreover, the design would have benefitted greatly from attempts to test it. Many lines of view code-behind are both untestable and harder to follow than they should be. I see early signs of the spaghetti code that afflicts more complex and mature applications &hellip; a drum I&rsquo;ll beat furiously later in this review.</p>
<p>At almost 300 lines, the BubbleMatrixViewModel begs to be tested both for quality and to reveal the expectations latent in its 20+ public and internal members.</p>
<h4>The Missing Model</h4>
<p>The pattern is called <strong><em>Model</em></strong>-View-ViewModel. Josh&rsquo;s Model is nowhere to be found. Model and ViewModel are combined and it&rsquo;s not clear to me how one would disambiguate them.</p>
<p>The absence of Model isn&rsquo;t blatantly obvious in a simple game like BubbleBurst. The game doesn&rsquo;t to retrieve or save objects to a persistent store. We aren&rsquo;t expecting much in the way of business model logic either; there&rsquo;s nothing of interest to validate or secure. So the lack of a model is not a deep fault of this particular application. Indeed, it&rsquo;s a convenient way to concentrate our attention on the central issues for most students of MVVM:</p>
<ul>
<li>What code belongs in View and what code in ViewModel? </li>
<li>How do View and ViewModel interact? </li>
<li>How do you instantiate Views and ViewModels? </li>
</ul>
<p>Nonetheless, we can&rsquo;t pretend to provide a comprehensive guide to MVVP without talking about the Model and how it interacts with ViewModel and (to a lesser extent) View. A business application will demand a clear delineation of responsibilities and equally clear communication paths.</p>
<p>I&rsquo;m not letting BubbleBurst off the hook either. I felt on several occasions that some ViewModels were heavier and more complicated than they should be because an inchoate game model was not independently defined.</p>
<h4>Dependency Injection</h4>
<p>I appreciate that Dependency Injection frightens many developers. You can discover MVVM without learning about Dependency Injection. Josh can kind of get away without it as long as he doesn&rsquo;t test his ViewModels and doesn&rsquo;t have to think about the services required to manage a persistent model.</p>
<p>But I feel you can&rsquo;t call this &ldquo;Advanced MVVM&rdquo; &hellip; or even &ldquo;Intermediate MVVM&rdquo; &hellip; without introducing DI at some point. In Josh&rsquo;s application, every View and every ViewModel class is known to and instantiated by some other View or ViewModel class. That won&rsquo;t fly in real-world applications which have Views and ViewModels that are ignorant of each other.</p>
<p>The constructor of the BubbleMatrixViewModel instantiates three concrete bubble components: BubblesTaskManager, BubbleFactory, and BubbleGroup (twice) before making heavy use of them.&nbsp; That&rsquo;s a lot of dependencies that would make this ViewModel brittle and especially difficult to test.</p>
<p>Taking hard dependencies means Josh can freely assume that ViewModels will always have parameterless constructors and can always be instantiated in XAML, as he often does here. Someone new to MVVM might think this is the norm. It is not.</p>
<p>Josh himself alludes to DI as one of the avenues opened by the MVVM pattern: &ldquo;<em>[MVVM] means that you can use frameworks like MEF to dynamically compose your ViewModels, to easily support plug-in architectures &hellip;&rdquo;.</em> That&rsquo;s the last we hear of MEF or dynamic VM composition.</p>
<p>Again, I think we can ignore DI in an introduction to MVVM; we cannot ignore it in an advanced lesson on MVVM.</p>
<h4>Event Aggregation: communicating with the unknown</h4>
<p>All of Josh&rsquo;s MVVM triads are statically determined. Their relationships to each other are fixed and well known.</p>
<p>I was surprised to see a ViewModel for one view hold a reference to a ViewModel of a subordinate view. That&rsquo;s not how I do it; my general rule is that MVVM triads do not hold references to each other. I concede that the rule makes it difficult to organize cross-triad communication. Josh&rsquo;s approach is simple and elegant &hellip; when available.</p>
<p>In real-world business applications, the MVVM triads often can&rsquo;t know about each other. They are often defined in separate modules without mutual references. Views appear and disappear dynamically. Direct communication is frequently impossible.</p>
<p>That&rsquo;s why so many so-called MVVM frameworks include some kind of messaging or <a target="_blank" href="http://www.martinfowler.com/eaaDev/EventAggregator.html">Event Aggregation</a> infrastructure. You don&rsquo;t need them to understand MVVM triads in isolation. But you never see an application with a single MVVM triad and you rarely find an MVVM application with statically determined, session-permanent views. No &ldquo;advanced&rdquo; treatment of MVVM can neglect Event Aggregation.</p>
<h3>View First or ViewModel First?</h3>
<p>Here&rsquo;s an incendiary topic Josh leaves untouched.</p>
<p>I see two ways to ask this question:</p>
<ul>
<li>Do I <strong><em>design</em></strong> the View first or the ViewModel first? </li>
<li>Do I <strong><em>instantiate</em></strong> the View first or the ViewModel first (or does something else instantiate and wed them)? </li>
</ul>
<p>The answer to both questions need not be the same. For example, you could decide to <strong><em>design</em></strong> the ViewModel first and let the View <strong><em>instantiate</em></strong> that VM at runtime. This is plausibly the approach advocated in BubbleBurst although Josh never talks about it.</p>
<p>Again, it&rsquo;s important that readers new to MVVM learn that Josh&rsquo;s way is not the only way.</p>
<h4>View and ViewModel Design</h4>
<p>In my experience there is a &ldquo;dialog&rdquo; between View and ViewModel design. The VM exists to serve a view even as it strives for independence from any particular concrete view. A VM is useless if&nbsp; there is no view that will work with it; clearly the VM developer must heed the imprecations of the View developer.</p>
<p>On the other hand, in business applications the application&rsquo;s imperatives &ndash; what the view must do to satisfy business requirements &ndash; are the province of the programmer and are best articulated through the capabilities of the ViewModel. </p>
<p>Therein lies the necessary tension between View and ViewModel design. As a developer my allegiance is with the ViewModel (&ldquo;the application should do something worthwhile&rdquo;) but it would be silly to defend that allegiance at the expense of the View (&ldquo;a good UX is essential to making an application easy to learn and to use&rdquo;).</p>
<p>I&rsquo;d have liked to see this tension at least acknowledged and perhaps explored.</p>
<h4>Who begets Whom?</h4>
<p>Runtime construction is a question apart from the matter of who drives the design. WPF and Silverlight tooling push you toward &ldquo;View First&rdquo; construction in which the View instantiates the ViewModel. You&rsquo;ll often see the View&rsquo;s DataContext set by a ViewModel instantiated in the XAML as shown here:</p>
<pre>&nbsp; &lt;UserControl.DataContext&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;viewModel:<strong>BubbleBurstViewModel</strong> /&gt;<br />&nbsp; &lt;/UserControl.DataContext&gt;</pre>
<p>Contrast this with the ViewModel first, code-based approach (not seen in BubbleBurst) in which the ViewModel is assigned to the View&rsquo;s DataContext as follows:</p>
<pre> view.DataContext = viewModel;</pre>
<p>The View First approach assumes that the ViewModel can be created via a default, parameterless constructor. That&rsquo;s fine for BubbleBurst but wholly unrealistic in business applications whose ViewModels have dependencies (e.g., on the domain model).</p>
<p>Neither WPF nor Silverlight XAML support the dependency injection mechanisms that many of us prefer. I wish Josh had talked about this and perhaps discussed the interesting attempts to use MEF dependency injection (via properties rather than constructor arguments)</p>
<p>I&rsquo;m not trying to settle these questions. I am saying these questions could have been called out in an &ldquo;advanced&rdquo; book on MVVM patterns.</p>
<h3>What Belongs In Code-Behind?</h3>
<p>Do we allow or prohibit code-behind? That&rsquo;s a fist-fight topic. Josh looks for a Goldilocks solution, suggesting the amount of code-behind is just right if confined to &ldquo;logic scoped to the view&rdquo;.</p>
<p>Such guidance is far too loose in my opinion. It&rsquo;s not effective guidance at all.</p>
<p>We choose presentation separation patterns in part because we want to minimize testing of the view. We should test any custom logic we write &ndash; no matter how it is scoped. The poverty of our testing tools means that, in practice, we will not test the code in the view. Therefore, any code in the code-behind is suspect.</p>
<p>I am open to some code in the code-behind; the &ldquo;InitializeComponent&rdquo; method is inescapable. I&rsquo;ll accept a minimum of &ldquo;switch board&rdquo; code in the code behind; direct wiring to a ViewModel member is ok in small doses.</p>
<p>I draw the line at decision logic. I smell a rat when I see a conditional statement of any kind. That&rsquo;s where bugs breed. Conditional logic is code we should be testing.</p>
<p>I much prefer this rule: &ldquo;<strong>No conditional logic in the code-behind</strong>&rdquo;. </p>
<p>That&rsquo;s unambiguous. We don&rsquo;t have to wonder what &ldquo;<em>scope of the view</em>&rdquo; means. If there&rsquo;s an &ldquo;if&rdquo; or a &ldquo;switch&rdquo; statement, something is wrong. You can detect a violation with automation or visual inspection. It&rsquo;s a rule that&rsquo;s easy to follow and pretty easy to abide by &hellip; when you know how.</p>
<p>What happens when you don&rsquo;t follow this rule? You&rsquo;re lured into the kind of dodgy code that &hellip; well we see in the innocent seeming BubbleMatrixView.xaml.cs.</p>
<p>In fact, far from being &ldquo;best practices&rdquo;, I&rsquo;d say that the View code in BubbleBurst represents some of the worst practices.</p>
<p>Look at the HandleMatrixDimensionsAvailable method. This event handler is wired to a UI element in the BubbleBurstView. Unfortunately, the UI element happens to be in a different view, the BubbleMatrixView! One view&rsquo;s code-behind is wired to members of another view; that&rsquo;s the road to perdition. That would never pass my review.</p>
<p>I wanted to clean it up immediately. I tried to find the intention behind this practice. Usually I look to the name of a method to discover its purpose. Unfortunately the handler is named for the moment when it is called (&ldquo;Matrix dimensions available&rdquo;) rather than for what it does. That&rsquo;s conventional naming for event handlers but not terribly informative. Unless a handler is brain-dead-simple, I have it delegate immediately to methods with meaningful names. The handler tells me when something happens; the inner method tells me what will be done.</p>
<p>Had Josh adopted my suggestion, he&rsquo;d have realized that his handler has multiple responsibilities:</p>
<ul>
<li>wires the outer window&rsquo;s keydown event </li>
<li>picks up the dimensions of the related view&rsquo;s grid </li>
<li>starts the game </li>
</ul>
<p>That&rsquo;s too much work for code-behind in my book.</p>
<p>When we strive to apply the &ldquo;<em>no conditional logic in the code-behind</em>&rdquo; rule, we discover other design problems.</p>
<p>It appears that Undo logic is distributed between two ViewModels. One of them, the BubbleBurstViewModel, determines if undo is possible while the second, BubbleMatrixViewModel performs the undo. Probe further and we find that even the BubbleBurstViewModel test for undo-ability is delegated back to the BubbleMatrixViewModel. The ping-ponging among Views and ViewModels is confusing; it doesn&rsquo;t smell right.</p>
<p>All the signs suggest the real action is in BubbleMatrixView and its ViewModel.</p>
<p>BubbleMatrixView.xaml is short and sweet.The code-behind in BubbleMatrixView.xaml.cs is another story. Five Region tags sound the alarm. You shouldn&rsquo;t need region tags in code-behind. Here they barely disguise the complexity of 145 lines of code-behind. That can&rsquo;t be right.</p>
<h3>MicroControllers: BubblesTaskPresenter Example</h3>
<p>I was able to refactor the 53 lines dedicated to animating bubble tasks. Most of them went to a BubblesTaskPresenter class, a component Jeremy Miller calls the &ldquo;<a target="_blank" href="/blogs/jeremy.miller/archive/2007/10/21/build-your-own-cab-15-microcontrollers.aspx">MicroController</a>&rdquo;.</p>
<p>Every MVVM developer should become familiar with the &ldquo;MicroController&rdquo; approach.</p>
<p>A &ldquo;MicroController&rdquo; performs a narrow UI task on behalf of a view. We usually write one to encapsulate UI logic that is reused across multiple views. That&rsquo;s not the case here; the application is too small.</p>
<p>We also write MicroControllers to encapsulate UI-specific functionality in a UI-agnostic wrapper. They make it easy for non-UI components, such as ViewModels, to invoke the UI-specific behavior we find in Views. That&rsquo;s what we need here.</p>
<p>I noticed that the ViewModel holds a TaskManager which raises a PendingTasksAvailable event when there are bubble display tasks. This sets off a sequence of calls between View and ViewModel which collectively &ldquo;process tasks&rdquo; queued up by the ViewModel.</p>
<p>Josh&rsquo;s original code forwarded the event to the View&rsquo;s code-behind. That code-behind then extracted the VM&rsquo;s TaskManager and called into it. 53 lines of code-behind are dedicated to this entire process.</p>
<p>After my revision, the view merely provides the ViewModel with a configured MicroController, here called a &ldquo;BubblesTaskPresenter&rdquo;:</p>
<pre> _bubbleMatrix.BubblesTaskPresenter = new BubblesTaskPresenter(_bubbleCanvas);</pre>
<p>This is what switchboard code should look like. I&rsquo;d like to get rid of the instantiation but at least there is a bare minimum of logic and no conditionals.</p>
<p>The ViewModel receives the concrete presenter in the guise of a UI-agnostic interface, IBubblesTaskPresenter and wires itself to the presenter&rsquo;s events.</p>
<pre>&nbsp;&nbsp;&nbsp; public IBubblesTaskPresenter BubblesTaskPresenter {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _bubblesTaskPresenter;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bubblesTaskPresenter = value;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bubblesTaskPresenter.Completed += delegate { ProcessTasks(); };<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TaskManager.PendingTasksAvailable += delegate { ProcessTasks(); };<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }</pre>
<pre>&nbsp;&nbsp;&nbsp; private void ProcessTasks() {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var task = TaskManager.GetPendingTask();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BubblesTaskPresenter.PresentTask(task);<br />&nbsp;&nbsp;&nbsp; }</pre>
<p>IBubblesTaskPresenter uses simple .NET types and looks like this:</p>
<pre>&nbsp; /// &lt;summary&gt; <br />  /// Interface for a presenter of &lt;see cref="BubblesTask"/&gt;<br />  /// &lt;/summary&gt;&nbsp;&nbsp; <br />  public interface IBubblesTaskPresenter {<br />&nbsp;&nbsp;&nbsp;&nbsp; void PresentTask(BubblesTask task);<br />&nbsp;&nbsp;&nbsp;&nbsp; event EventHandler Completed;<br /> }</pre>
<p>Where did the 53 lines of code-behind go? Into the BubblesTaskPresenter.</p>
<p>What has been gained? Did I just hide the pea under another untestable cup called a &ldquo;presenter&rdquo;? Is this merely an academic exercise?</p>
<p>I don&rsquo;t think so. True, the presenter is dependent upon WPF and upon BubbleCanvas in particular. But it could be tested with a faked canvas and a faked factory. Testing aside, it&rsquo;s small and focused; it&rsquo;s easy to see what it does and how it works. It won&rsquo;t get lost amidst the other motions of the BubbleMatrixView. We might someday use it in another view that presented BubblesTasks.</p>
<p>The BubbleMatrixViewModel has grown a few lines but remains readable and testable; its imported IBubblesTaskPresenter is easy to fake.</p>
<p>The ViewModel no longer exposes the TaskManager. That&rsquo;s a good thing because the TaskManager is pretty complex piece of machinery with a rich API. We don&rsquo;t want the View or BubblesTaskPresenter to know about it.</p>
<p>And the View is 53 lines lighter, reducing the anxiety we might justifiably feel if we handed it over to a non-programming designer for styling.</p>
<p><strong>Homework Assignment</strong>: if you&rsquo;re playing along and are looking toward your own application design, you might want to linger over the BubblesTaskPresenter. It is specific to bubbles right now &hellip; which is appropriate in the absence of forces that would drive us to generalization. </p>
<p>But you can encapsulate storyboard animations in much this way to both determine state changes within the ViewModel and externalize the animations in &ldquo;View-space&rdquo; where they belong. Josh is spot-on when he insists on this separation. The MicroController &ldquo;presenter&rdquo; approach is one way to achieve that separation without polluting the code-behind.</p>
<p>Aside: my first presenter was more abstract and general purpose. My generalization was premature. Generalization made the code more complex than it needed to be in this application. I un-factored it to the current version that knows about BubbleCanvas and BubblesTaskStoryboardFactory.</p>
<h3>Views Shouldn&rsquo;t Talk To Views</h3>
<p>After clearing out the 53 lines, I was able to focus on what&rsquo;s left.</p>
<p>I was deeply troubled by the properties of BubbleMatrixView that are exposed to and consumed by the BubbleBurstView code-behind. That can&rsquo;t be right. Views shouldn&rsquo;t need custom properties. </p>
<p>If you have to expose a custom view member, you should do so through a view interface. We don&rsquo;t want any code &ndash; View or ViewModel &ndash; depending upon a concrete view class. That&rsquo;s asking for trouble and flies in the face of the testability which justifies MVVM.</p>
<p>It&rsquo;s also completely unnecessary in this application. As noted earlier the event loop from inner BubbleMatrixView to outer BubbleBurstView leads back around to BubbleMatrixView&rsquo;s ViewModel. We can cut all that nonsense out and simply update the BubbleMatrixViewModel directly in the code-behind &hellip; without any conditional logic.</p>
<p>I refactored as follows:</p>
<ul>
<li>Removed 30 lines from BubbleBurstView code-behind </li>
<li>Added &ldquo;StartTheGame&rdquo; to BubbleMatrixViewModel; it combines the functions of setting the dimensions (now private) and starting a new game. </li>
<li>Removed 61 lines from BubbleMatrixView code-behind which now calls StartTheGame when the canvas is loaded. Region tags are gone. </li>
</ul>
<p>The BubbleMatrixView code-behind is now a trim 30 lines with no conditionals, down from 145 (80% reduction). Of the 30, exactly 5 of them do work.</p>
<p>My cleanup involved eliminating several null checks. They never did anything useful. First, the variables could not be null in practice. Second, even if they were (e.g., someone broke the xaml), the application would not have functioned anyway. I don&rsquo;t think a blank screen is superior to an exception. The null checks were about as helpful as empty catch blocks.</p>
<h3>Tidy-up BubbleBurstView Code-Behind</h3>
<p>BubbleBurstView&rsquo;s code-behind had one remaining &ldquo;if&rdquo; and some other code that I felt didn&rsquo;t belong there.</p>
<p>Key monitoring logic contained an &ldquo;if&rdquo; statement. At first it seemed like key monitoring was a candidate for another MicroController. But there is only one key to handle, the key for Undo. That wasn&rsquo;t worth the overhead of another MicroController component. Instead I decided to enrich the BubbleBurstViewModel with an Undo method whose signature is:</p>
<pre>  public bool TryUndo(bool shouldTry) // returns True if undid</pre>
<p>The code-behind calculates whether the key presses amount to an undo request. The call is:</p>
<pre>  e.Handled |= _bubbleBurst.TryUndo(isUndoKey);</pre>
<p>I don&rsquo;t like the isUndoKey calculation but I&rsquo;ll leave it for another day.</p>
<p>My final bug-a-boo is the LoadBubbleViewResources method which instantiates a ResourceDictionary and plugs it into the application-level resources. </p>
<p>I expected this to be loaded by the App.xaml itself but I suspect Josh wants to simulate the notion that independent assemblies have their own resources. While the &ldquo;Bubble.View&rdquo; assembly is not independent &ndash; the App.xaml has access to it through its host assembly&rsquo;s references &ndash;, I&rsquo;ll play along.</p>
<p>In any case, the view&rsquo;s code-behind shouldn&rsquo;t know the details of ResourceDictionary construction and App.Resources update. Time for a MicroController: &ldquo;BubbleViewResourceLoader&rdquo; which we can invoke from within the code-behind&rsquo;s constructor for now. It still stinks but it stinks less.</p>
<p>The code-behind now stands at 41 lines, down from the original 86; only 9 of them do work.</p>
<h3>Picky, Picky</h3>
<p>I&rsquo;m a restless complainer. I&rsquo;ve got a few more bones to pick having nothing to do with MVVM.</p>
<p>Page numbers! You may have noticed that my citations lacked page numbers. That&rsquo;s because there aren&rsquo;t any in the printed document I&rsquo;m reading.</p>
<p>The abundance of Region tags annoys me. Hey, I use them too, especially in pedagogical code where I want to unveil new ideas didactically in the course of a presentation.</p>
<p>I appreciate that they seem to organize the code into nice buckets: &ldquo;constructors&rdquo;, &ldquo;methods&rdquo;, &ldquo;fields&rdquo;. But lately I&rsquo;ve come to believe that they&rsquo;re more of a code smell.</p>
<p>If the class is short &ndash; as it should be &ndash; they interfere with my ability to read and grasp the class at a glance. If the class is long, they suggest that my class implements too many distinct concerns and I&rsquo;m struggling &ndash; vainly &ndash; to keep them organized. These concerns would be better delegated to supporting classes. I suspect that automated testing would make this defect more obvious.</p>
<p>I&rsquo;m not thrilled with the data triggers. Data triggers are not available to Silverlight programmers probably for good reason. The Visual State Manager is the preferred choice for both WPF and Silverlight.</p>
<p>A particularly egregious data trigger can be found in BubbleBurstView.xaml where the GameOverView is collapsed when the BubbleBurstViewModel&rsquo;s GameOverViewModel is null. Could there be a more obscure way to signal that a modal dialog should be hidden? I suspect a bound IsGameOver property would be both simpler and more obvious.</p>
<h3>Where&rsquo;s The Code?</h3>
<p>Josh&rsquo;s original source is at <a target="_blank" href="http://advancedmvvm.com/">AdvancedMvvm.com</a> . I&rsquo;ve temporarily posted my refactored version <a target="_blank" href="http://www.ideablade.com/WardsBlog/JoshSmithBubbleBurst.ward.v2.zip">on my site</a>. I&rsquo;m not promising it will stay there- this <strong>is Josh&rsquo;s code</strong> and I&rsquo;ll do whatever he wants me to do with it (including burn it) &ndash; but it&rsquo;s there now and I&rsquo;ll let you know if I move it.</p>
<h3>Wrap Up</h3>
<p>I have high hopes for the conversation Josh has started with this book.</p>
<p>I see it as one place to begin your study of MVVM rather than as the definitive work on the subject. Some of the practices I find dubious and there are serious omissions. </p>
<p>But I gave it this much attention because it deserves it. It&rsquo;s a fine piece of writing, a carefully considered example, and a push in the right direction. Josh speaks to a broad audience with an authentic voice they understand and respect. He has my respect as well.</p>
<p>It&rsquo;s well worth the $15 bucks <a target="_blank" href="http://www.amazon.com/Advanced-MVVM-ebook/dp/B0038KX9FW">on the Kindle</a>.</p>
<p>Enjoy!</p>
<p>p.s.: Cross-posted to my other blog, &#8220;<a href="http://neverindoubtnet.blogspot.com/2010/03/mvvm-josh-smiths-way.html">Never In Doubt</a>&#8220;</p>
<div class="shr-publisher-8"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/wardbell/category/mvvm/" title="View all posts in MVVM" rel="category tag">MVVM</a>. Bookmark the <a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/" title="Permalink to MVVM, Josh Smith’s Way" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/feed/" title="Comments RSS to MVVM, Josh Smith’s Way" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-8 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/wardbell/2010/01/01/an-ioc-agnostic-prism-bootstrapper/" rel="prev"><span class="meta-nav">&larr;</span> An IoC-Agnostic Prism Bootstrapper</a></div>
					<div class="nav-next"><a href="http://codebetter.com/wardbell/2010/03/20/rob-e-s-mini-mvvm-framework-mix10/" rel="next">Rob E’s Mini-MVVM Framework @ MIX10 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

							<div id="comments">


			<h3 id="comments-title">8 Responses to <em>MVVM, Josh Smith’s Way</em> </h3>


			<ol class="commentlist">
						<li class="comment even thread-even depth-1" id="li-comment-34">
		<div id="comment-34">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">jhou</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-34">April 17, 2010 at 3:20 pm</a></div>

		<div class="comment-body"><p>Cannot agree more with your thoughts about Model. The relationship between M(odel) and other parts is not simple at all in real applications. I have felt that the entire community has neglected the model part of story. MVVM is probably considered as UI oriented pattern. But without serious consideration of model, it is sitting on sand. I would like to see MVVM as an application pattern instead of just UI pattern. There are discussions about view-first, view model first.  Where should be the model? Once you throw the model into the picture, the thing could change completely. </p>
<p>Prism seems suggesting model first. In the module initialization, views get wired up. This does not look right in the fact that model knows too much about anything else. But the initialization, which is basically configuration, can be extracted out from module.</p>
<p>There are talks about view composition, VM composition. Should we talk more about model composition? There are discussions about hierarchical structure of View and view model. Should we explore the hierarchical structure of model as well?</p>
<p>Like the idea to have a separated player to create/configure the MVVM triad. That is the configuration! For a complicated application, having separate configuration is needed. Then the configuration can be further transformed into DSL (internal or external).</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-33">
		<div id="comment-33">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">MinnowNoir</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-33">April 12, 2010 at 4:13 pm</a></div>

		<div class="comment-body"><p>Ward:</p>
<p>Thanks for the very substantial review.  Would you considering writing a similarly opinionated, but standalone article on the topic that answers some of the questions you raised?</p>
<p>Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-32">
		<div id="comment-32">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://tawani.posterous.com' rel='external nofollow' class='url'>tawani</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-32">April 1, 2010 at 1:58 pm</a></div>

		<div class="comment-body"><p>Best book analysis I&#8217;ve read in a while.  I especially like the beginning where you first refresh the reader&#8217;s mind about MVVM and patterns in general.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31">
		<div id="comment-31">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">bastien neyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-31">March 27, 2010 at 6:39 pm</a></div>

		<div class="comment-body"><p>despite Josh`s answer to your critics Ward they are still valid, because the questions are still open. Even if it was not the target of the advanced mvvm book to introduce DI, Units testing, Models etc&#8230; this critic is then valid for Josh`s msdn magazine article which is missing a lot. Me personally as someone buying books will give Josh another chance to prove how master-detail/aggregates can be done with mvvm pattern, because this is a minimum requirement for any yes for even any beginner application.</p>
<p>Great captcha!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-30">
		<div id="comment-30">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://MurrayOn.NET/' rel='external nofollow' class='url'>Mike Murray</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-30">March 26, 2010 at 10:57 pm</a></div>

		<div class="comment-body"><p>Great stuff!  I just purchased &#8220;Advanced MVVM&#8221; a few days ago after attending MIX &#8217;10 and seeing Laurent Bugnion&#8217;s and Rob Eisenberg&#8217;s sessions on MVVM.  I am just as impressed with the short book as you were, but I agree with the criticisms whole-heartedly.  A second edition of this book with many (if not all) of your suggestions would make it the best in-depth introduction to MVVM I would be able to find.</p>
<p>We have started a small Silverlight application, where we have decided to use Laurent&#8217;s MVVM Light framework along with Unity.  I do like the messaging system Laurent has made available, and  I&#8217;m still undecided how I feel about his static resource ViewModelLocator pattern.  It is great for what he calls &#8220;Blend-ability&#8221; and it also allows your DI framework to control the lifetime of the ViewModels.  I&#8217;m just not sure I can see a ViewModel sticking around longer than a View for my current needs.  How do you feel about his proposed pattern?</p>
<p>Thanks again for treating this subject so thoroughly, as I am up to my eyeballs in trying to learn this stuff right now and figure out a few best practices.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29">
		<div id="comment-29">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://www.imaginativeuniversal.com' rel='external nofollow' class='url'>James Ashley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-29">March 21, 2010 at 4:49 pm</a></div>

		<div class="comment-body"><p>Wonderful post, Ward.  It&#8217;s amazing how far we&#8217;ve gotten.  Last year we were all still talking about how best to architect a WPF or Silverlight application, and MVVM was just one of several options.  Now we are talking about how best to architect MVVM itself &#8211; thanks in large part to Josh&#8217;s evangelizing of the pattern.  I especially liked your observation that MVVM is ultimately a &#8216;simple&#8217; pattern for any platform that employs a DataContext.  The devil, however, seems to be in the details.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment even thread-even depth-1" id="li-comment-28">
		<div id="comment-28">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn"><a href='http://joshsmithonwpf.wordpress.com' rel='external nofollow' class='url'>Josh Smith</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-28">March 20, 2010 at 3:57 pm</a></div>

		<div class="comment-body"><p>Thanks for the thought provoking review, Ward.  I&#8217;ve posted my reply to your review, here: <a href="http://joshsmithonwpf.wordpress.com/2010/03/20/response-to-ward-bells-review-of-advanced-mvvm/" rel="nofollow">http://joshsmithonwpf.wordpress.com/2010/03/20/response-to-ward-bells-review-of-advanced-mvvm/</a></p>
<p>Thanks,<br />
Josh</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-27">
		<div id="comment-27">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />			<cite class="fn">Bill Campbell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://codebetter.com/wardbell/2010/03/19/mvvm-josh-smith-s-way/#comment-27">March 20, 2010 at 11:49 am</a></div>

		<div class="comment-body"><p>Ward,<br />
I couldn&#8217;t agree  more. I also purchased Josh&#8217;s book knowing the quality of the work he does. I find lots of discussions about Testablility when it comes to MVVM and what I&#8217;d give to see some good examples of this. TDD examples would blow me away, let alone just some good tests to prove the functionality.<br />
There was lots of good discussions about MVVM at Mix10, but had you also noticed that tests were MIA? Of course, I&#8217;ve grown to rather expect that from the MS camp.<br />
Thanks much for your thought provoking article! We need so much more on such an important topic.<br />
regards,<br />
Bill</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/wardbell/2010/03/19/mvvm-josh-smith-s-way/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="http://codebetter.com/wardbell/wp-login.php?redirect_to=http%3A%2F%2Fcodebetter.com%2Fwardbell%2F2010%2F03%2F19%2Fmvvm-josh-smith-s-way%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
						
</div><!-- #comments -->

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.416 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 20:53:13 -->
<!-- super cache -->