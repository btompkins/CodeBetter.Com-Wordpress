<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Building Hello MEF – Part IV – DeploymentCatalog | Glenn Block</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/glennblock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='http://codebetter.com/glennblock/wp-includes/js/l10n.js?ver=20101110'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/glennblock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://codebetter.com/glennblock/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Glenn Block' href='http://codebetter.com/glennblock/' />
<link rel='start' title='IoC.AddComponent&lt;IBloggingStrategy, CodeBetterBloggingStrategy&gt;();' href='http://codebetter.com/glennblock/2008/01/03/ioc-addcomponent-lt-ibloggingstrategy-codebetterbloggingstrategy-gt/' />
<link rel='prev' title='Learning about MEF in SL4 from Mike Taulty' href='http://codebetter.com/glennblock/2010/02/16/learning-about-mef-in-sl4-from-mike-taulty/' />
<link rel='next' title='Building HelloMEF – Part V – Refactoring to ViewModel' href='http://codebetter.com/glennblock/2010/03/08/building-hellomef-part-v-refactoring-to-viewmodel/' />
<meta name="generator" content="WordPress 3.1-beta1-16732" />
<link rel='canonical' href='http://codebetter.com/glennblock/2010/03/08/building-hello-mef-part-iv-deploymentcatalog/' />
<link rel='shortlink' href='http://codebetter.com/glennblock/?p=118' />
<meta name="_awb_version" content="2.0.3" /><link rel="stylesheet" href="http://codebetter.com/glennblock/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.0.6" type="text/css" media="screen" /><link rel="stylesheet" href="http://disqus.com/stylesheets/mytechnobabble/disqus.css?v=2.0" type="text/css" media="screen" /><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
                <script type="text/javascript" src="http://codebetter.com/glennblock/wp-content/uploads/spacker-cache/a8046d2f1fc1c08af413701218a11c1d.js">/*Is Cache!*/</script>
                	<style type="text/css">body { padding-top:0px !important; }</style>

</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">			</div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-118" class="post-118 post type-post status-publish format-standard hentry category-hellomef category-mef category-silverlight category-sl4">
					<h1 class="entry-title">Building Hello MEF – Part IV – DeploymentCatalog</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/glennblock/author/glennblock/" title="View all posts by Glenn Block">Glenn Block</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/glennblock/2010/03/08/building-hello-mef-part-iv-deploymentcatalog/" title="1:50 am" rel="bookmark"><span class="entry-date">March 8, 2010</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/glennblock/feed/rss/"  rel="nofollow"><img src="http://codebetter.com/glennblock/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/glennblock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><p>Continuing on with the series. In <a href="http://codebetter.com/blogs/glenn.block/archive/2009/12/15/building-hello-mef-part-iii-xap-partitioning-with-the-host-s-permission-and-the-sweetness-of-recomposition.aspx">part III</a> we introduced the concept of application partitioning through the use of the PackageCatalog which ships in the Silverlight toolkit. In this post we’ll take a look at a new API known as the DeploymentCatalog which ships in the box! We also look at some changes to our hosting APIs. If you are following along, the completed code from that post is available <a href="http://cid-f8b2fd72406fb218.skydrive.live.com/self.aspx/blog/Hello%20MEF/HelloMEF%5E_Part%5E_III%20Completed.zip">here</a>.</p>
<p>Note: Instead of using the MEF binaries that ship as part of SL4 beta, we’re going to use our newer bits available on Codeplex from this point forward. It is very likely these same APIs will be available in the box when SL4 ships <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_wink.gif' alt=';-)' class='wp-smiley' /> </p>
<h1>DeploymentCatalog</h1>
<p>With our latest codeplex drop we introduced a new API called DeploymentCatalog. DeploymentCatalog is basically a redesign of the catalog that we included in the toolkit. As part of the redesign we address some thread-safety issues as well as made the catalog more robust.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_6DC1CE6E.png"><img style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_5AFCAEEA.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=vfTN9s%2byR07fAY0LJsvxFtIU0XA%3d" width="268" height="305" /></a> </p>
<p>DeploymentCatalog (DC) is used for dynamically downloading MEF catalogs in an async fashion. To use it you call the DownloadAsync method passing in a uri with the default overload accepting a relative uri. The uri should point to a XAP which contains MEF parts. Once you initiate the download, DC will start the download. Upon completion DC will rip open the XAP, load all the assemblies within and add any attributed parts to the catalog. You’ll notice that unlike PackageCatalog which holds a collection of packages for multiple XAPs, each DC corresponds to a single XAP. </p>
<p>Below is a snippet of how to use it.</p>
<pre>
<pre>var catalog = <span style="color: #0000ff">new</span> DeploymentCatalog(&quot;<span style="color: #8b0000">Extensions.xap</span>&quot;);
</pre>
<pre>catalog.DownloadAsync();</pre>
</pre>
<h2>Passing deployment catalogs to PartInitializer</h2>
<p>In the previous bits, CompositionHost.InitializerContainer was called in order to pass a container configured with a PackageCatalog which PartInitializer could use.In the new bits PartInitializer has been renamed to CompositionInitializer (more on that later). Additionally we’ve renamed InitializeContainer to Initializer and added a new convenience overload which accepts a param array of catalogs. When you use this overload you need to decide if you want the default XAP’s parts to be added. To do this pass in a DeploymentCatalog created with the default constructor such as the example below:</p>
<pre>
<pre>CompositionHost.Initialize(<span style="color: #0000ff">new</span> DeploymentCatalog(), catalog);</pre>
</pre>
<p>Using the catalog from the previous example this will add all of the parts from the current XAP as well as any parts that are discovered in “Extensions.xap”.</p>
<h2>Recomposition in DeploymentCatalog</h2>
<p>Each DC downloads in an asynchronous manner. Because DC is recomposable (implements INotifyComposablePartCatalogChanged), it will notify whenever the download completes. This means that you are not required to subscribe to the DownloadCompleted event, as because the catalog is recomposable, it will force the container to recompose upon the receipt of parts. In the previous example, adding a catalog to DC does not mean that it’s parts have been downloaded yet. However once those parts are downloaded, the container will recompose. </p>
<h2>Tracking completion, errors and progress.</h2>
<p>You can, and we recommend you do track download completion and errors. Whenever a download completes, the catalog will raise a “DownloadCompleted” event. If the download fails for some reason, then DownloadCompleted will be fired setting the Error to the download error. You can also track overall progress of the download by subscribing to the DownloadProgressChanged event. Finally if your application logic requires it you can even cancel the download by calling CancelAsync.</p>
<p>For example see the snippet below.</p>
<pre>
<pre><span style="color: #0000ff">void</span> DownloadCatalog(<span style="color: #0000ff">string</span> uri) {
</pre>
<pre>    var catalog = <span style="color: #0000ff">new</span> DeploymentCatalog(uri);
</pre>
<pre>    catalog.DownloadCompleted += <span style="color: #0000ff">new</span> EventHandler&lt;AsyncCompletedEventArgs&gt;(DownloadCompleted);
</pre>
<pre>    catalog.DownloadProgress += <span style="color: #0000ff">new</span> EventHandler&lt;DownloadProgressChangedEventArgs&gt;(DownloadProgressChanged);
</pre>
<pre>    catalog.DownloadAsync();
</pre>
<pre></pre>
<pre>    <span style="color: #008000">//cancel the catalog download due to a timeout</span>
</pre>
<pre>    catalog.CancelAsync();
</pre>
<pre>}
</pre>
<pre></pre>
<pre><span style="color: #0000ff">void</span> DownloadCompleted(<span style="color: #0000ff">object</span> sender, AsyncCompletedEventArgs e)
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">if</span> (e.Error != <span style="color: #0000ff">null</span>)
</pre>
<pre>         <span style="color: #0000ff">throw</span> e.Error;
</pre>
<pre>}
</pre>
<pre></pre>
<pre><span style="color: #0000ff">void</span> catalog_DownloadProgressChanged(<span style="color: #0000ff">object</span> sender, DownloadProgressChangedEventArgs e)
</pre>
<pre>{
</pre>
<pre>  <span style="color: #008000">//progress logic here</span>
</pre>
<pre>}
</pre>
</pre>
<h2>Allowing parts to download XAPs.</h2>
<p>In the last post we added the PackageCatalog directly to the container in order to allow parts to import it. A cleaner approach is to encapsulate the catalog management into a nice service that other parts can depend on. This allows the host to have more fine-grained control over how and what enters the container. In the sections that follow you’ll see I’ve introduced a DeploymentCatalogService for this purpose.</p>
<h1>Migrating the code</h1>
<p>OK, let’s start migrating the code to use the new DeploymentCatalog apis. Again the starter code is available <a href="http://cid-f8b2fd72406fb218.skydrive.live.com/self.aspx/blog/Hello%20MEF/HelloMEF%5E_Part%5E_III%20Completed.zip">here</a></p>
<h2>Download MEF bits</h2>
<p>First we need to go download the latest MEF bits from Codeplex from <a href="http://mef.codeplex.com/releases/view/40606">here</a>. Extract the zip (make sure to unblock all files if you are letting windows extract it for you). Next open the HelloMEF solution in Visual Studio and go and remove all references to SystemComponentModel.Composition.dll, System ComponentModel.Composition.Initialization.dll, and SystemComponentModel.Composition.Packaging.Toolkit.dll from each project.</p>
<h2>Fix MEF References</h2>
<p>Now go add references to the newer binaries located in the .\bin\SL folder. Here are the projects and references.</p>
<ul>
<li>HelloMEF –&gt; Add System.ComponentModel.Composition.dll and System.ComponentModel.Composition.Initialization.dll. </li>
<li>HelloMEF.Contracts –&gt; Add System.ComponentModel.Composition.dll. </li>
<li>HelloMEF.Extensions –&gt; Add System.ComponentModel.Composition.dll. </li>
</ul>
<h2>Introducing DeploymentCatalog service.</h2>
<p>In order to handle initializing the host as well allowing other parts to download, we’ll create DeploymentCatalogService.</p>
<p>First add a new interface to HelloMEF.Contracts using the following code.</p>
<pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">interface</span> IDeploymentCatalogService
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">void</span> AddXap(<span style="color: #0000ff">string</span> uri, Action&lt;AsyncCompletedEventArgs&gt; completedAction = <span style="color: #0000ff">null</span>);
</pre>
<pre>    <span style="color: #0000ff">void</span> RemoveXap(<span style="color: #0000ff">string</span> uri);
</pre>
<pre>

}
</pre>
</pre>
<p>Next add a new DeploymentCatalogService to the HelloMEF project.</p>
<pre>
<pre>[Export(<span style="color: #0000ff">typeof</span>(IDeploymentCatalogService))]
</pre>
<pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> DeploymentCatalogService : IDeploymentCatalogService
</pre>
<pre>{
</pre>
<pre>    <span style="color: #0000ff">private</span> <span style="color: #0000ff">static</span> AggregateCatalog _aggregateCatalog;
</pre>
<pre></pre>
<pre>    Dictionary&lt;<span style="color: #0000ff">string</span>, DeploymentCatalog&gt; _catalogs;
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> DeploymentCatalogService()
</pre>
<pre>    {
</pre>
<pre>        _catalogs = <span style="color: #0000ff">new</span> Dictionary&lt;<span style="color: #0000ff">string</span>, DeploymentCatalog&gt;();
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">void</span> Initialize()
</pre>
<pre>    {
</pre>
<pre>        _aggregateCatalog = <span style="color: #0000ff">new</span> AggregateCatalog();
</pre>
<pre>        _aggregateCatalog.Catalogs.Add(<span style="color: #0000ff">new</span> DeploymentCatalog());
</pre>
<pre>        CompositionHost.Initialize(_aggregateCatalog);
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> AddXap(<span style="color: #0000ff">string</span> uri, Action&lt;AsyncCompletedEventArgs&gt; completedAction = <span style="color: #0000ff">null</span> )
</pre>
<pre>    {
</pre>
<pre>        DeploymentCatalog catalog;
</pre>
<pre>        <span style="color: #0000ff">if</span> (!_catalogs.TryGetValue(uri, <span style="color: #0000ff">out</span> catalog))
</pre>
<pre>        {
</pre>
<pre>            catalog = <span style="color: #0000ff">new</span> DeploymentCatalog(uri);
</pre>
<pre>            <span style="color: #0000ff">if</span> (completedAction != <span style="color: #0000ff">null</span>)
</pre>
<pre>                catalog.DownloadCompleted += (s, e) =&gt; completedAction(e);
</pre>
<pre>            <span style="color: #0000ff">else</span>
</pre>
<pre>                catalog.DownloadCompleted += <span style="color: #0000ff">new</span> EventHandler&lt;System.ComponentModel.AsyncCompletedEventArgs&gt;(catalog_DownloadCompleted);
</pre>
<pre></pre>
<pre>            catalog.DownloadAsync();
</pre>
<pre>            _catalogs[uri] = catalog;
</pre>
<pre>        }
</pre>
<pre>        _aggregateCatalog.Catalogs.Add(catalog);
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">void</span> catalog_DownloadCompleted(<span style="color: #0000ff">object</span> sender, System.ComponentModel.AsyncCompletedEventArgs e)
</pre>
<pre>    {
</pre>
<pre>        <span style="color: #0000ff">if</span> (e.Error != <span style="color: #0000ff">null</span>)
</pre>
<pre>            <span style="color: #0000ff">throw</span> e.Error;
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> RemoveXap(<span style="color: #0000ff">string</span> uri)
</pre>
<pre>    {
</pre>
<pre>        DeploymentCatalog catalog;
</pre>
<pre>        <span style="color: #0000ff">if</span> (_catalogs.TryGetValue(uri, <span style="color: #0000ff">out</span> catalog))
</pre>
<pre>        {
</pre>
<pre>            _aggregateCatalog.Catalogs.Remove(catalog);
</pre>
<pre>        }
</pre>
<pre>    }
</pre>
<pre>}
</pre>
<pre></pre>
</pre>
<p>DeploymentCatalogService handles adding / removal of DeploymentCatalogs. It also exposes a static Initialize method which handles setting up the host to allow dynamic download. This method creates an aggregate catalog, and adds the parts in the default XAP to it. It then calls CompositionHost.Initialize to pass that catalog to the host. Once the host has been configured, any catalogs added to the aggregate will then automatically show up in the host.</p>
<p>Note: DeploymentCatalogService is simply a helper, it is <strong>NOT</strong> required in order to use DeploymentCatalog.</p>
<h2>Initializing the host</h2>
<p>Now that DeploymentCatalogService is added, go remove the old Initialization code which used PackageCatalog from the App class and have it call Initialize. </p>
<pre>
<pre><span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> Application_Startup(<span style="color: #0000ff">object</span> sender, StartupEventArgs e)
</pre>
<pre>{
</pre>
<pre>    DeploymentCatalogService.Initialize();
</pre>
<pre>    <span style="color: #0000ff">this</span>.RootVisual = <span style="color: #0000ff">new</span> MainPage();
</pre>
<pre>}
</pre>
</pre>
<h2>Refactoring Widget1 to use DeploymentCatalogService</h2>
<p>Next go change Widget1.xaml.cs replacing the importing PackageCatalog with IDeploymentCatalogService.</p>
<pre>
<pre>[ExportWidget(Location=WidgetLocation.Top)]
</pre>
<pre><span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget1 : UserControl
</pre>
<pre>{
</pre>
<pre>    [Import]
</pre>
<pre>    <span style="color: #0000ff">public</span> IDeploymentCatalogService CatalogService { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">public</span> Widget1()
</pre>
<pre>    {
</pre>
<pre>        InitializeComponent();
</pre>
<pre>        Button.Click += <span style="color: #0000ff">new</span> RoutedEventHandler(Button_Click);
</pre>
<pre>    }
</pre>
<pre></pre>
<pre>    <span style="color: #0000ff">void</span> Button_Click(<span style="color: #0000ff">object</span> sender, RoutedEventArgs e)
</pre>
<pre>    {
</pre>
<pre>        CatalogService.AddXap(&quot;<span style="color: #8b0000">HelloMEF.Extensions.xap</span>&quot;);
</pre>
<pre>    }
</pre>
<pre>}
</pre>
<pre></pre>
</pre>
<h2>Build it!</h2>
<p>Go build the project and run it. Press the top “Hello MEF” button and you should see a new green part appear which was dynamically downloaded through the new DeploymentCatalog.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_07A568C4.png"><img style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" border="0" alt="image" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_69E3DE04.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566611&amp;Signature=4PYLz%2f6icmL2JlHfUNWphd%2byrFM%3d" width="487" height="348" /></a> </p>
<p>&#160;</p>
<h1>A few caveats about DeploymentCatalog.</h1>
<p>DeploymentCatalog is a very exciting addition to the MEF box. There are a few caveats to it’s usage.</p>
<ul>
<li>Does not support Silverlight cached assemblies. (Otherwise known as TPEs). This means that DC will not download referenced assemblies that are packaged with the Silverlight caching infrastructure (.extmap).
<ul>
<li>This includes cached assemblies in the main xap. </li>
<li>If the cached assemblies are referenced by the main app, they will be available to the assemblies in a downloaded XAP. </li>
<li>You can create shared xaps which contain assemblies to be used by other xaps and download those with the DeploymentCatalog. As long as the shared xaps are downloaded first they will be available to others. </li>
<li>If you do decide to use either of the previous approaches, be sure to set your references to “Copy Local = False” in your XAPs otherwise you will be embedding the shared assemblies again.Does not support localization. </li>
<li>We are looking into cached assembly support in the future. </li>
</ul>
</li>
<li>Does not support non-embedded resources. </li>
<li>Local resource references in XAML also are not supported i.e. using pack URIs. You can programatically access embedded resources though. </li>
</ul>
<h1>Summary</h1>
<p>Used properly, DeploymentCatalog is a great way to partition your Silverlight applications in order to improve startup time as well as allowing third-parties to extend your Silverlight applications.</p>
<p>Completed code is attached.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/glennblock/category/hellomef/" title="View all posts in HelloMEF" rel="category tag">HelloMEF</a>, <a href="http://codebetter.com/glennblock/category/mef/" title="View all posts in MEF" rel="category tag">MEF</a>, <a href="http://codebetter.com/glennblock/category/silverlight/" title="View all posts in silverlight" rel="category tag">silverlight</a>, <a href="http://codebetter.com/glennblock/category/sl4/" title="View all posts in SL4" rel="category tag">SL4</a>. Bookmark the <a href="http://codebetter.com/glennblock/2010/03/08/building-hello-mef-part-iv-deploymentcatalog/" title="Permalink to Building Hello MEF – Part IV – DeploymentCatalog" rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/glennblock/2010/03/08/building-hello-mef-part-iv-deploymentcatalog/feed/" title="Comments RSS to Building Hello MEF – Part IV – DeploymentCatalog" rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-118 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/glennblock/2010/02/16/learning-about-mef-in-sl4-from-mike-taulty/" rel="prev"><span class="meta-nav">&larr;</span> Learning about MEF in SL4 from Mike Taulty</a></div>
					<div class="nav-next"><a href="http://codebetter.com/glennblock/2010/03/08/building-hellomef-part-v-refactoring-to-viewmodel/" rel="next">Building HelloMEF – Part V – Refactoring to ViewModel <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
					<div id="dsq-content">
			<ul id="dsq-comments">
					<li id="dsq-comment-518">
					<div id="dsq-comment-header-518" class="dsq-comment-header">
						<cite id="dsq-cite-518">
								<span id="dsq-author-user-518">Przemek</span>
							</cite>
					</div>
					<div id="dsq-comment-body-518" class="dsq-comment-body">
						<div id="dsq-comment-message-518" class="dsq-comment-message"><p>Hi,</p>
<p>I have been following the tutorial, downloaded MEF Preview 9 and replaced the bits as requested. There are problems with resolving the DeploymentCatalog type. So, I downloaded the sample application and opened it up. Again, there is something wrong with the DeploymentCatalog. Please see at the attached image. Object Browser shows that the namespace System.ComponentModel.Composition.Hosting does not contain type DeploymentCatalog. What can be wrong? Strangely enough, in the MEF9 Preview  bits that I referenced in the previous solution , DC shows up. Unfortunately, when I try tu build I get an exception: &#8220;System.NotSupportedException: An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework.&#8221;</p>
<p><a href="http://picasaweb.google.com/psoszynski/Technical#5446359783362067474" rel="nofollow">http://picasaweb.google.com/psoszynski/Technical#5446359783362067474</a></p>
</div>
					</div>
				</li>
					<li id="dsq-comment-519">
					<div id="dsq-comment-header-519" class="dsq-comment-header">
						<cite id="dsq-cite-519">
	http://codebetter.com/members/gblock/default.aspx							<span id="dsq-author-user-519">Glenn Block</span>
							</cite>
					</div>
					<div id="dsq-comment-body-519" class="dsq-comment-body">
						<div id="dsq-comment-message-519" class="dsq-comment-message"><p>Hi</p>
<p>Did you right click the MEF Preview bits and unblock all files? If not you will get that error.</p>
<p>As far as DC, you need to be using the version of MEF that ships on Codeplex as the post describes.</p>
<p>Glenn</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-520">
					<div id="dsq-comment-header-520" class="dsq-comment-header">
						<cite id="dsq-cite-520">
								<span id="dsq-author-user-520">Przemek</span>
							</cite>
					</div>
					<div id="dsq-comment-body-520" class="dsq-comment-body">
						<div id="dsq-comment-message-520" class="dsq-comment-message"><p>Thanks,</p>
<p>removing the blocks on the dlls helped. Although, surprisingly it did not build for some time, only after 3 or 4 attempts, without any changes in the source, it all of a sudden ran without any problems. That is in the project that I created on my own basing on the tutorial.<br />
In the downloaded solution, I removed the existing references and replaced them with the same unblocked bits and it still doesn&#8217;t build. The error I get is this:</p>
<p>Error	1	The &#8220;ValidateXaml&#8221; task failed unexpectedly.<br />
System.IO.FileLoadException: Could not load file or assembly &#8216;file:///C:\Users\Przemek\Downloads\HelloMEF_Part_IV\HelloMEF\Bin\Debug\System.ComponentModel.Composition.dll&#8217; or one of its dependencies. Operation is not supported. (Exception from HRESULT: 0&#215;80131515)<br />
File name: &#8216;file:///C:\Users\Przemek\Downloads\HelloMEF_Part_IV\HelloMEF\Bin\Debug\System.ComponentModel.Composition.dll&#8217; &#8212;> System.NotSupportedException: An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous. If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch. See <a href="http://go.microsoft.com/fwlink/?LinkId=155569" rel="nofollow">http://go.microsoft.com/fwlink/?LinkId=155569</a> for more information.</p>
<p>   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&#038; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)<br />
   at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&#038; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)<br />
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark&#038; stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)<br />
   at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark&#038; stackMark)<br />
   at System.Reflection.Assembly.LoadFrom(String assemblyFile)<br />
   at Microsoft.Silverlight.Build.Tasks.ValidateXaml.XamlValidator.Execute(ITask task)<br />
   at Microsoft.Silverlight.Build.Tasks.ValidateXaml.XamlValidator.Execute(ITask task)<br />
   at Microsoft.Silverlight.Build.Tasks.ValidateXaml.Execute()<br />
   at Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()<br />
   at Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask, Boolean&#038; taskResult)</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-521">
					<div id="dsq-comment-header-521" class="dsq-comment-header">
						<cite id="dsq-cite-521">
								<span id="dsq-author-user-521">Przemek</span>
							</cite>
					</div>
					<div id="dsq-comment-body-521" class="dsq-comment-body">
						<div id="dsq-comment-message-521" class="dsq-comment-message"><p>Oof, I have managed to run the sample project as well. I had to go and unblock each file that was blocked in it. Took me some time, but that was it. Now, it compiles and runs as well.<br />
Przemek</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-522">
					<div id="dsq-comment-header-522" class="dsq-comment-header">
						<cite id="dsq-cite-522">
								<span id="dsq-author-user-522">Lorenzo</span>
							</cite>
					</div>
					<div id="dsq-comment-body-522" class="dsq-comment-body">
						<div id="dsq-comment-message-522" class="dsq-comment-message"><p>Hi Glenn, absolutely fantastic!! Thanks a lot for your tutorial.</p>
<p>I have two question for you.</p>
<p>1) In this sample you have Widget1. This UserControl allows to download Widget3. ok? Now, I would have only Widget3 (contained into HelloMEF.Extensions) and download it from HelloMEF project without using Widget1. Is it possible?</p>
<p>2) Once, Widget3 is downloaded, how can I obtain a its reference from MainPage.xaml.cs (of HelloMEF project)? Is it possible to obtain a reference of all the components included in the downloaded XAP from HelloMEF project?</p>
<p>Thanks in advance. Regards.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-523">
					<div id="dsq-comment-header-523" class="dsq-comment-header">
						<cite id="dsq-cite-523">
								<span id="dsq-author-user-523">Nk54</span>
							</cite>
					</div>
					<div id="dsq-comment-body-523" class="dsq-comment-body">
						<div id="dsq-comment-message-523" class="dsq-comment-message"><p>When you clic the first time on the button, it dowloads the xap.<br />
Try to click the button again, you get a white page <img src='http://codebetter.com/glennblock/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
does that means that we always have to check if the xap is already download ?<br />
What does that change in a scenario where you get a menu where each item are linked to a xap ? -> if i click another time on the menu, what will that make ?</p>
<p>Thanks.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-524">
					<div id="dsq-comment-header-524" class="dsq-comment-header">
						<cite id="dsq-cite-524">
								<span id="dsq-author-user-524">Frank</span>
							</cite>
					</div>
					<div id="dsq-comment-body-524" class="dsq-comment-body">
						<div id="dsq-comment-message-524" class="dsq-comment-message"><p>Very interesting article.</p>
<p>I&#8217;m using the deployment service in my own project.<br />
I have one question though. During testing I saw that after removing a xap from the container (method RemoveXap) it will not be added to the container if it&#8217;s downloaded again. Doesn&#8217;t the method RemoveXap need a statement like _catalogs.Remove(uri); to remove it from the dictionary also so that it will be added to the container again on a future download?</p>
<p>Frank.</p>
</div>
					</div>
				</li>
					<li id="dsq-comment-525">
					<div id="dsq-comment-header-525" class="dsq-comment-header">
						<cite id="dsq-cite-525">
								<span id="dsq-author-user-525">phi</span>
							</cite>
					</div>
					<div id="dsq-comment-body-525" class="dsq-comment-body">
						<div id="dsq-comment-message-525" class="dsq-comment-message"><p>Hi Glenn,</p>
<p>first of all a BIG thank you &#8211; you provided the kick start I needed.<br />
One minor comment:<br />
In the DeploymentCatalogService.AddXap method you alwasy add a new instance of the DeploymentCatalog to the AggregateCatalog.<br />
When you call AddXap twice for the same uri an error is thrown.<br />
So changing that to </p>
<p>           if  (_catalogs.ContainsKey(uri))<br />
                return;</p>
<p>would make sense I guess.</p>
<p>As I told &#8211; a minor comment.</p>
<p>phi</p>
</div>
					</div>
				</li>
				</ul>
		</div>
	</div>

<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* <![CDATA[ */
	var disqus_url = 'http://codebetter.com/glennblock/2010/03/08/building-hello-mef-part-iv-deploymentcatalog/ ';
	var disqus_identifier = '118 /blogs/glenn.block/archive/2010/03/07/building-hello-mef-part-iv-deploymentcatalog.aspx';
	var disqus_container_id = 'disqus_thread';
	var disqus_domain = 'disqus.com';
	var disqus_shortname = 'mytechnobabble';
	var disqus_title = "Building Hello MEF – Part IV – DeploymentCatalog";
		var disqus_config = function () {
	    var config = this; // Access to the config object

	    /* 
	       All currently supported events:
	        * preData — fires just before we request for initial data
	        * preInit - fires after we get initial data but before we load any dependencies
	        * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
	        * afterRender - fires when template is rendered but before we show it
	        * onReady - everything is done
	     */

		config.callbacks.preData.push(function() {
			// clear out the container (its filled for SEO/legacy purposes)
			document.getElementById(disqus_container_id).innerHTML = '';
		});
				config.callbacks.onReady.push(function() {
			// sync comments in the background so we don't block the page
			DISQUS.request.get('?cf_action=sync_comments&post_id=118');
		});
					};
	var facebookXdReceiverPath = 'http://codebetter.com/glennblock/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
	var DsqLocal = {
		'trackbacks': [
		],
		'trackback_url': "http:\/\/codebetter.com\/glennblock\/2010\/03\/08\/building-hello-mef-part-iv-deploymentcatalog\/trackback\/"	};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript';
	dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.61';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
					<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-new-features?utm_source=cb&utm_medium=button&utm_term=4328&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="125" height="125" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/ANTSPP5_125x125_M1.gif"></a>
					<embed width="125" height="125" flashvars="clickTARGET=_blank&amp;clickTAG=http%3A%2F%2Fd1.openx.org%2Fck.php%3Foaparams%3D2__bannerid%3D62753__zoneid%3D29419__cb%3Da0471ce5e8__r_id%3Dd42118811971f057012db20aa261c5c1__r_ts%3Dldef6x__oadest%3Dhttp%253A%252F%252Fwww.jetbrains.com%252Fresharper%252F%253Frs4cb125" allowscriptaccess="always" quality="high" name="Advertisement" id="Advertisement" style="" src="http://s3.amazonaws.com/CodeBetter/Creative/tc_125x125_simple2.swf" type="application/x-shockwave-flash">
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				<script type="text/javascript" src="http://engine.theloungenet.com/z/15/adzerk1_2_5"></script>
				<div id="adzerk1"></div>
				
				<ul class="xoxo">		
									</ul>	
				
				<a target="_blank" href="http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/entrypage/version-6-csharp?utm_source=cb&utm_medium=rectangle&utm_term=4327&utm_content=app6release&utm_campaign=antsperformanceprofiler"><img width="300" height="250" border="0" title="" alt="" src="http://s3.amazonaws.com/CodeBetter/Creative/APP6_Launch_C%23_Jun10_300x250_M1.gif?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1458095516&amp;Signature=BIBDilUaLnZe1uKfVKyyTBxr%2BvE%3D"></a>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/" title="About">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/" title="CodeBetter CI">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/" title="Community">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/" title="Editors">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/" title="Search Results">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="/blogs/products/pages/64386.aspx">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="/blogs/products/pages/64615.aspx">Telerik</a></li>
<li><a href="/blogs/products/pages/142174.aspx">JetBrains - ReSharper</a></li>
<li><a href="/blogs/products/pages/Beyond-Compare.aspx">Beyond Compare</a></li>
<li><a href="/blogs/products/pages/.NET-Memory-Profiler.aspx">.NET Memory Profiler</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a> &lt;-- NEW Friend!</li>

	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '11<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter//third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = false; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.259 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-01-18 16:09:28 -->
<!-- super cache -->