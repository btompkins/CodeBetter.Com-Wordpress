<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
	<meta charset="UTF-8" />
    <title>Building Hello MEF – Part II – Metadata and why being Lazy is a good thing. | Glenn Block</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	
	<link href="http://feeds.feedburner.com/CodeBetter" title="CodeBetter.Com &raquo; Feed" type="application/rss+xml" rel="alternate">
	
		<link rel="pingback" href="http://codebetter.com/glennblock/xmlrpc.php" />
	                <link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/ea73517eb74a545f51c376487c94dc9f.css?v=3912785705" type="text/css" media="all" /><!-- Is Cache! -->
                <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js?ver=3.4.2'></script>
<script type='text/javascript' src='http://dtym7iokkjlif.cloudfront.net/dough/1.0/recipe.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://codebetter.com/glennblock/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn1.codebetter.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='MEF and Prism, to be or not to be.' href='http://codebetter.com/glennblock/2009/12/02/mef-and-prism-to-be-or-not-to-be/' />
<link rel='next' title='Building Hello MEF – Part III – XAP Partitioning (with the host’s permission) and the sweetness of recomposition.' href='http://codebetter.com/glennblock/2009/12/15/building-hello-mef-part-iii-xap-partitioning-with-the-host-s-permission-and-the-sweetness-of-recomposition/' />
<meta name="generator" content="WordPress 3.4.2" />
<link rel='shortlink' href='http://codebetter.com/glennblock/?p=108' />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[83,183] -->
<link rel="canonical" href="http://codebetter.com/glennblock/2009/12/05/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing/" />
<!-- /all in one seo pack -->
<link rel="stylesheet" href="http://cdn1.codebetter.com/wp-content/plugins/digg-digg/include/../css/diggdigg-style.css?ver=4.5.3.3" type="text/css" media="screen" />

<!-- Start Shareaholic OgTags -->

	<meta property='og:image' content='http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_193D9AA8.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=d30n%2fBURjJJXKHGay8lkQ%2bx912Q%3d' />

<!-- End Shareaholic OgTags -->

<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
                <script type="text/javascript" src="http://cdn1.codebetter.com/wp-content/uploads/spacker-cache/dc168cf39155d7b5d39f696ca94d5980.js?v=3981720249">/*Is Cache!*/</script>
                	
	<script type='text/javascript' src='http://d1.openx.org/spcjs.php?id=7744&amp;target=_blank'></script>
	<style type="text/css">body { padding-top:0px !important; } html { margin-top: 0px !important; }</style>
<!-- BuySellAds Ad Code -->
<script type="text/javascript">
(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = 'http://s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();
</script>
<!-- End BuySellAds Ad Code -->
</head>

<body>

			
		<div class="container_12 ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">			
			<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
				<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#ui-tabs-1">CodeBetter.Com</a></li>
				<li class="ui-state-default ui-corner-top"><a href="http://devlicio.us">Devlicio.Us</a></li>				
				<div id="top-search">
				<form action="http://codebetter.com/globalsearch/" id="cse-search-box">
  <div>
   <fieldset id="search">
		<input type="hidden" name="cx" value="005178204031477491434:2bg5jtwgsfe" />
		<input type="hidden" name="cof" value="FORID:9" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text"  class="text-input" id="s" name="q" size="31" />
		<input type="image" src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/search-img.png" class="form-button" id="searchsubmit" value="GO" name="">				   	
	</fieldset>
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en&sitesearch=true"></script>
				</div>				
			</ul><div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div><div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
		</div>
			
		<div id="main" class="container_12">
		
			<div id="logo" class="grid_3"><a href="/" title="CodeBetter.Com - Stuff you need to Code Better!"><image src="http://cdn1.codebetter.com/wp-content/themes/codebetter/images/codebetter_logo.png" height="48" width="223"></image></a></div>
			<div id="ad_leaderboard" class="grid_9">
			<!-- BuySellAds Zone Code -->
<div id="bsap_1276080" class="bsarocks bsap_4fe632babdccc2b4b049e4f08cc3c549"></div>
<!-- End BuySellAds Zone Code --></div>
			
			<div id="globalNav" class="grid_12">
				<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=EFEFEF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
				</ul>
								
			</div><!-- end div#globalNav.container_12 -->				
	
		<div id="content" class="container_12">
			<div id="main" class="grid_8">


				<div id="post-108" class="post-108 post type-post status-publish format-standard hentry category-hellomef category-mef category-silverlight category-sl category-sl4">
					<h1 class="entry-title">Building Hello MEF – Part II – Metadata and why being Lazy is a good thing.</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted by </span>
						<span class="author vcard"><a class="url fn n" href="http://codebetter.com/glennblock/author/glennblock/" title="View all posts by Glenn Block">Glenn Block</a></span>
						<span class="meta-sep"> on  </span>
						<a href="http://codebetter.com/glennblock/2009/12/05/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing/" title="1:51 am" rel="bookmark"><span class="entry-date">December 5, 2009</span></a>
											</div><!-- .entry-meta -->

					<div class="entry-content">
						<div id="greet_block"><noscript><div class="greet_block wpgb_cornered"><div class="greet_text"><div class="greet_image"><a href="http://codebetter.com/glennblock/feed/rss/"  rel="nofollow"><img src="http://cdn1.codebetter.com/wp-content/plugins/wp-greet-box/images/rss_icon.png" alt="WP Greet Box icon"/></a></div>Hello there! If you are new here, you might want to <a href="http://codebetter.com/glennblock/feed/rss/" rel="nofollow"><strong>subscribe to the RSS feed</strong></a> for updates on this topic.<div style="clear:both"></div><div class="greet_block_powered_by">Powered by <a href="http://omninoggin.com/projects/wordpress-plugins/wp-greet-box-wordpress-plugin/" title="WP Greet Box WordPress Plugin" style="text-decoration:none;">WP Greet Box</a> <a href="http://omninoggin.com/" title="WordPress Plugin" style="text-decoration:none;">WordPress Plugin</a></div><div style="clear:both"></div></div></div></noscript></div><!-- Start Shareaholic LikeButtonSetTop Automatic --><!-- End Shareaholic LikeButtonSetTop Automatic --><p>In Part I of the series we built the basics of our dashboard end ended with our app displaying a single widget. In this post we&rsquo;ll show two widgets,&nbsp; sensing a pattern here?&nbsp; <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' />  We will show two, but we&rsquo;ll put them in different places on our dashboard. We&rsquo;ll explore two ways of doing this including a very powerful feature in MEF called metadata. Then we&rsquo;ll see how we can use custom exports to provide our own &ldquo;language&rsquo; of sorts for our extenders.&nbsp; </p>
<p>If you are just jumping into this post, you can grab the code for where we left off <a href="http://cid-f8b2fd72406fb218.skydrive.live.com/self.aspx/blog/Hello%20MEF/HelloMEF%5E_Part%5E_I.zip">here</a>.</p>
<h1>Adding a second widget</h1>
<p>OK, here we go. Now that we have our dashboard infrastructure in place, should be easy to add a second widget right? Right. Let&rsquo;s do it, this time we&rsquo;ll add a text box.</p>
<p>First we&rsquo;ll go create a new user control called Widget2</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_13CF2A04.png"><img height="380" width="517" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_193D9AA8.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=d30n%2fBURjJJXKHGay8lkQ%2bx912Q%3d" alt="image" border="0" style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" /></a> </p>
<p>Next we&rsquo;ll go into the Widget2.xaml and add a button with the content &ldquo;Hello MEF&rdquo;.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">&lt;</span><span style="color: #800000">UserControl</span> <span style="color: #ff0000">x</span>:<span style="color: #ff0000">Class</span>=<span style="color: #0000ff">"HelloMEF.Widget2"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">xmlns</span>=<span style="color: #0000ff">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">x</span>=<span style="color: #0000ff">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">d</span>=<span style="color: #0000ff">"http://schemas.microsoft.com/expression/blend/2008"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">mc</span>=<span style="color: #0000ff">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">mc</span>:<span style="color: #ff0000">Ignorable</span>=<span style="color: #0000ff">"d"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #ff0000">d</span>:<span style="color: #ff0000">DesignHeight</span>=<span style="color: #0000ff">"300"</span> <span style="color: #ff0000">d</span>:<span style="color: #ff0000">DesignWidth</span>=<span style="color: #0000ff">"400"</span><span style="color: #0000ff">&gt;</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">&lt;</span><span style="color: #800000">Grid</span> <span style="color: #ff0000">x</span>:<span style="color: #ff0000">Name</span>=<span style="color: #0000ff">"LayoutRoot"</span> <span style="color: #ff0000">Height</span>=<span style="color: #0000ff">"Auto"</span><span style="color: #0000ff">&gt;</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">&lt;</span><span style="color: #800000">TextBox</span> <span style="color: #ff0000">Text</span>=<span style="color: #0000ff">"Hello MEF!"</span> <span style="color: #ff0000">TextAlignment</span>=<span style="color: #0000ff">"Center"</span> <span style="color: #ff0000">Height</span>=<span style="color: #0000ff">"100"</span> <span style="color: #ff0000">Width</span>=<span style="color: #0000ff">"300"</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">Grid</span><span style="color: #0000ff">&gt;</span>
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">&lt;/</span><span style="color: #800000">UserControl</span><span style="color: #0000ff">&gt;</span></pre>
<p>Then we&rsquo;ll jump into Widget2.xaml.cs and add our export.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.ComponentModel.Composition;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [Export(<span style="color: #0000ff">typeof</span>(UserControl))]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget1 : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Widget1()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}</pre>
<p>All we did was create a new control and drop an export (the only MEF port). Let&rsquo;s run it.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_45E65481.png"><img height="387" width="653" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_6B6FD1E2.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=ngHIxpXyz6mXqIaH8JNAE58B1s0%3d" alt="image" border="0" style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" /></a> </p>
<p><strong>Presto! </strong>The second widget shows up. No app.config editing, no explicit registration code. Just add it to the project and we&rsquo;re done. Not bad!</p>
<h1>Adding a second widget where we want it, and why being Lazy is a good thing.</h1>
<p>OK well that&rsquo;s pretty nice. But if you read my first post, we want to have widgets showing up in different places as we have 2 panels for widgets in our screen. One which is blue, and one which is yellow but currently invisible. So what can we do? Well one option is to create different interfaces, ITopWidget, IBottomWidget. Then we can check if the class implements those interfaces once we get it and just put it in the right place.</p>
<p>If we did, our code would in our MainPage would look something like this</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">public</span> MainPage()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    PartInitializer.SatisfyImports(<span style="color: #0000ff">this</span>);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">foreach</span> (var widget <span style="color: #0000ff">in</span> Widgets)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">if</span> (widget <span style="color: #0000ff">is</span> ITopWidget)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            TopWidgets.Items.Add(widget);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (widget <span style="color: #0000ff">is</span> IBottomWidget)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            BottomWidgets.Items.Add(widget);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<p>That works, however it forces us to ship new interfaces every time I we want to enhance the UI. For example, if want to add a left pane, we need to ship ILeftWidget.. A different problem is that we are creating all widgets even if they don&rsquo;t implement any of our interfaces. But what else can we do?</p>
<h2>Lazy</h2>
<p>The answer is to become Lazy. Yes folks, this is the one time when Lazy is a good thing. If you are not familar, <a href="http://msdn.microsoft.com/en-us/library/dd642331(VS.96).aspx">Lazy&lt;T&gt;</a> is new type in the SL4 and FX4 BCL that allows you to delay the creation of an instance. MEF fully supports Lazy, thus you can import single values and collections in a delayed manner. For example we can change our ImportMany to use Lazy, by pasting the following code in MainPage.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.ComponentModel.Composition;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> MainPage : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> MainPage()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            PartInitializer.SatisfyImports(<span style="color: #0000ff">this</span>);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            <span style="color: #0000ff">foreach</span> (var widget <span style="color: #0000ff">in</span> Widgets)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">                TopWidgets.Items.Add(widget.Value);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        [ImportMany]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Lazy&lt;UserControl&gt;[] Widgets { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}
</pre>
<p>Two things you should notice above, first our Widgets import is now an array of Lazy&lt;UserControl&gt;, and second in the loop we are adding widget.Value rather than the widget value directly. What is going on here is instead of importing UserControl instances we are importing lazy references to our widgets. The first time Value is accessed, the UserControl is created, thus we access .Value to add the widgest to the TopWidgets ItemsControl.</p>
<h2>Metadata</h2>
<p>Well that&rsquo;s nice, because now we&rsquo;ve delayed creating the controls until we actually need them. The downside is we have no way to determine which one&rsquo;s we should put where which was our goal. And THAT is where metadata comes to the rescue. Not only does MEF support lazy instantiation, but it also supports a concept called export metadata. This means that a MEF export can give off additional information about itself that the importer can use for several reasons, whether it be determining whether or not it should be created, or in our case determining where it will show on the screen. The importer can access this information BEFORE the instance has actually been activate. This means if the particular export does not match the requirements, then it does not have to be created.</p>
<p>Metadata is arbitrary in MEF, that means you can use it however you see fit according to your application needs. Using metadata has two parts, first there is the exporter who defines which metadata is available for importers to look at. Then there is the importer who is able to access the metadata at the time of import. </p>
<h2>Defining the metadata for widgets</h2>
<p>In our case we want our widgets to provide us a location. In order to do that, we&rsquo;ll first create a new enum called WidgetLocation.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> <span style="color: #0000ff">enum</span> WidgetLocation {Top, Bottom}
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}
</pre>
<p>Then we&rsquo;ll go add a piece of metadata called Location to our widgets. There are several ways to do this in MEF, the easiest of which to start with is simple adding an ExportMetadata attribute. First we&rsquo;ll go to Widget1.xaml.cs and set the widget&rsquo;s location to the top as you can see below. Notice, the key and value are arbitary to my specific needs. </p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [ExportMetadata("<span style="color: #8b0000">Location</span>", WidgetLocation.Top)]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [Export(<span style="color: #0000ff">typeof</span>(UserControl))]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget1 : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Widget1()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }</pre>
<p>Next we&rsquo;ll go to Widget2 and tell it to set it&rsquo;s location to the bottom.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [ExportMetadata("<span style="color: #8b0000">Location</span>", WidgetLocation.Bottom)]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [Export(<span style="color: #0000ff">typeof</span>(UserControl))]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget2 : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Widget2()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><p>    }</p></pre>
<p>Now we can move on to the importer</p>
<h2>Giving the dashboard access to the widget metadata and why Lazy has a brother.</h2>
<p>Now that we&rsquo;ve defined the metadata we just need to use it. We talked about Lazy&lt;T&gt;, let&rsquo;s talk about it&rsquo;s brother <a href="http://msdn.microsoft.com/en-us/library/dd986615(VS.96).aspx">Lazy&lt;T,M&gt;</a>. In order to allow us to access the metadata, MEF introduces a special kind of Lazy, one that has attached metadata. M in this case is an interface (we call it a metadata view)&nbsp; that contains only getter properties where the property name corresponds to the key of a piece of metadata. MEF will automatically general a proxy class that implements this interface and it will plug all the metadata in for you. This is very cool! You need to see it to believe it (and understand it).</p>
<p>So let&rsquo;s just do it rather than talking about it.</p>
<p>First, we&rsquo;ll create a new interface call IWidgetMetadata which contains our Location metadata.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> <span style="color: #0000ff">interface</span> IWidgetMetadata
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> WidgetLocation Location {<span style="color: #0000ff">get</span>;}
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}</pre>
<p>Next we&rsquo;ll go into our MainPage.xaml.cs, and change our Widgets import to use the new metadata. We&rsquo;ll also change the logic to place the widgets in the appropriate place. </p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.ComponentModel.Composition;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> MainPage : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> MainPage()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            PartInitializer.SatisfyImports(<span style="color: #0000ff">this</span>);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            <span style="color: #0000ff">foreach</span> (var widget <span style="color: #0000ff">in</span> Widgets)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">                <span style="color: #0000ff">if</span> (widget.Metadata.Location == WidgetLocation.Top)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">                    TopWidgets.Items.Add(widget.Value);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">                <span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (widget.Metadata.Location == WidgetLocation.Bottom)
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">                    BottomWidgets.Items.Add(widget.Value);
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        [ImportMany]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Lazy&lt;UserControl,IWidgetMetadata&gt;[] Widgets { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}
</pre>
<p>Above you can see that Widget&rsquo;s item type is now Lazy&lt;UserControl,IWidgetMetadata&gt;. Also in the for loop we&rsquo;re accessing widget.Metadata.Location in a compile safe manner, but we never created a concrete class that implements IWidgetMetadata, did we? We didn&rsquo;t, but MEF did <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' />  The result is no magic strings on the importer side, we get intellisense, refactoring and compile time checking! Also notice we still need to access the .Value to get the widget to be created. This is actually an advantage though because if we get a widget with a different location, it won&rsquo;t get created wastefully. Here it makes no big difference, but if we had 50 widgets that is a different story.</p>
<p>Now we&rsquo;ll go run the app.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_31145C01.png"><img height="375" width="653" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_33DA10F4.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=l9r9WW%2ftjbmkz1Rw2CzGFpKJWzo%3d" alt="image" border="0" style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" /></a> </p>
<p>And Voila we see our widgets are now going in the right place, and we didn&rsquo;t have to do 1000 back flips.</p>
<h3>Magic strings are bad! And MEF has an answer.</h3>
<p>Notice above I mentioned we get all this compile time safety and intellisense support for the importer. But what about the exporter? Our widgets are still specifying magic strings for the keys. Not only that, but imagine if I have multiple pieces of metadata, then it&rsquo;s not just one string, it&rsquo;s many strings for each part. Plus I lose a lot of discoverability because I don&rsquo;t know intuitively when I create a widget, what metadata keys make sense. Even if we create constants for the keys, we don&rsquo;t know the type.</p>
<p>Wouldn&rsquo;t it be really nice if we could just do this:&nbsp; [ExportWidget(Location=WidgetLocation.Top)] ? We wouldn&rsquo;t need Export, and we wouldn&rsquo;t need all those loose ExportMetadata attributes. It would be cleaner, and our code would be less noisy.</p>
<p>The good news is you can. </p>
<h1>Custom exports</h1>
<p>MEF let&rsquo;s you create custom exports that include metadata. A custom export is just that, it&rsquo;s your own export attribute with metadata, and it&rsquo;s strongly typed.</p>
<p>Let&rsquo;s create our new ExportWidgetAttribute.</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.ComponentModel.Composition;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [MetadataAttribute]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [AttributeUsage(AttributeTargets.Class, AllowMultiple=<span style="color: #0000ff">false</span>)]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> ExportWidgetAttribute : ExportAttribute
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> ExportWidgetAttribute()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            :<span style="color: #0000ff">base</span>(<span style="color: #0000ff">typeof</span>(UserControl))
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> WidgetLocation Location { <span style="color: #0000ff">get</span>; <span style="color: #0000ff">set</span>; }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}</pre>
<p>If we look above there are a few things to note:</p>
<ol>
<li>ExportWidgetAttribute inherits from ExportAttribute. This is what tells MEF &ldquo;Hey I am an export attribute&rdquo; </li>
<li>The base constructor on Export is called passing in UserControl. This step is critical or MEF will default to the concrete implementation that the attribute was dropped on. </li>
<li>The attribute has a [MetadataAttribute] on it, this tells MEF this is not only an export but it also provides metadata. Now that this is applied, MEF will look at each public property on the attribute that I added, and will assume it is metadata, with the name being the key. In essence it will add an [ExportMetadata(&ldquo;Location&rdquo;,&hellip;)] with whatever value is specified for the property. </li>
<li>The attribute has an [AttributeUsage] attribute specifying the acceptable targets i.e. class in this case and that AllowMultiple = false. If we don&rsquo;t do this, then MEF will assume multiple sets of metadata can exist and will return the metadata as an array. </li>
</ol>
<p>Now we can go and change each of our widgets to use the new attribute. </p>
<p>First Widget1.xaml.cs</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [ExportWidget(Location=WidgetLocation.Top)]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget1 : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Widget1()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<p>And then Widget2.xaml.cs</p>
<pre><pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">using</span> System.Windows.Controls;
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"></pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px"><span style="color: #0000ff">namespace</span> HelloMEF
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">{
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    [ExportWidget(Location=WidgetLocation.Bottom)]
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    <span style="color: #0000ff">public</span> partial <span style="color: #0000ff">class</span> Widget2 : UserControl
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        <span style="color: #0000ff">public</span> Widget2()
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        {
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">            InitializeComponent();
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">        }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">    }
</pre>
<pre style="background-color: #ffffff;margin: 0em;width: 100%;font-family: consolas,'Courier New',courier,monospace;font-size: 10px">}</pre>
<p>Our custom attributes our quite nice. No more specifying a contract, no more loose&nbsp; metadata, and it&rsquo;s nice and compact. Also notice our usings above as well, no more need to specify System.ComponentModel.Composition&hellip;..it&rsquo;s our attribute. This means our customers can get going using MEF without even knowing they are using it. We just send them OUR attributes and OUR interfaces, and they are good to go.</p>
<p>Go and press the magic run button and this what you get.</p>
<p><a href="/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/glenn.block/image_5F00_31145C01.png"><img height="375" width="653" src="http://s3.amazonaws.com:80/CodeBetter/CommunityServer.Blogs.Components.WeblogFiles/glenn/block/image_thumb_33DA10F4.png?AWSAccessKeyId=0KMA35HT86EVXB99Z302&amp;Expires=1920566610&amp;Signature=l9r9WW%2ftjbmkz1Rw2CzGFpKJWzo%3d" alt="image" border="0" style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" /></a> </p>
<h2>Any questions? <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </h2>
<h1>&nbsp;</h1>
<h1>In Summary</h1>
<p>In this post we learned how we can use metadata and Lazy to do some pretty nice things with MEF. We can annotate our exports with information that importers can use to determine whether they want to use us, and how they should us (i.e. put me in the top location). We also learned how can create our own custom expors to offer a nice experience.</p>
<p>&nbsp;</p>
<h1>What&rsquo;s next?</h1>
<p>In the next post we&rsquo;ll explore how to partition our apps into multiple XAPs and use MEF to deliver them on-demand. We&rsquo;ll also learn a few other aspects of MEF that may not be obvious. There&rsquo;s much more to come after that, the series is shaping up!</p>
<div class="shr-publisher-108"></div><!-- Start Shareaholic LikeButtonSetBottom Automatic --><!-- End Shareaholic LikeButtonSetBottom Automatic -->											</div><!-- .entry-content -->


					<div class="entry-utility">
					This entry was posted in <a href="http://codebetter.com/glennblock/category/hellomef/" title="View all posts in HelloMEF" rel="category tag">HelloMEF</a>, <a href="http://codebetter.com/glennblock/category/mef/" title="View all posts in MEF" rel="category tag">MEF</a>, <a href="http://codebetter.com/glennblock/category/silverlight/" title="View all posts in silverlight" rel="category tag">silverlight</a>, <a href="http://codebetter.com/glennblock/category/sl/" title="View all posts in SL" rel="category tag">SL</a>, <a href="http://codebetter.com/glennblock/category/sl4/" title="View all posts in SL4" rel="category tag">SL4</a>. Bookmark the <a href="http://codebetter.com/glennblock/2009/12/05/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing/" title="Permalink to Building Hello MEF – Part II – Metadata and why being Lazy is a good thing." rel="bookmark">permalink</a>. Follow any comments here with the <a href="http://codebetter.com/glennblock/2009/12/05/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing/feed/" title="Comments RSS to Building Hello MEF – Part II – Metadata and why being Lazy is a good thing." rel="alternate" type="application/rss+xml">RSS feed for this post</a>.
					</div><!-- .entry-utility -->
				</div><!-- #post-108 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codebetter.com/glennblock/2009/12/02/mef-and-prism-to-be-or-not-to-be/" rel="prev"><span class="meta-nav">&larr;</span> MEF and Prism, to be or not to be.</a></div>
					<div class="nav-next"><a href="http://codebetter.com/glennblock/2009/12/15/building-hello-mef-part-iii-xap-partitioning-with-the-host-s-permission-and-the-sweetness-of-recomposition/" rel="next">Building Hello MEF – Part III – XAP Partitioning (with the host’s permission) and the sweetness of recomposition. <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
<div id="disqus_thread">
                    <div id="dsq-content">
            <ul id="dsq-comments">
                    <li id="dsq-comment-463">
                    <div id="dsq-comment-header-463" class="dsq-comment-header">
                        <cite id="dsq-cite-463">
    http://weblogs.asp.net/lkempe                            <span id="dsq-author-user-463">Laurent Kemp&#233;</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-463" class="dsq-comment-body">
                        <div id="dsq-comment-message-463" class="dsq-comment-message"><p>Excellent posts Glenn! It helps me getting into MEF.</p>
<p>Looks like on the part &#8220;Defining the metadata for widgets&#8221; you might remove the interfaces ITopWidget, IBottomWidget. It might be confusing as your goal in this part is to use metadata. </p>
<p>public partial class Widget1 : UserControl, ITopWidget</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-464">
                    <div id="dsq-comment-header-464" class="dsq-comment-header">
                        <cite id="dsq-cite-464">
    http://non                            <span id="dsq-author-user-464">rovsen</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-464" class="dsq-comment-body">
                        <div id="dsq-comment-message-464" class="dsq-comment-message"><p>great article. thanks.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-465">
                    <div id="dsq-comment-header-465" class="dsq-comment-header">
                        <cite id="dsq-cite-465">
    http://codebetter.com/members/gblock/default.aspx                            <span id="dsq-author-user-465">Glenn Block</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-465" class="dsq-comment-body">
                        <div id="dsq-comment-message-465" class="dsq-comment-message"><p>@Laurent thanks for catching that! Nice to know people are actually reviewing the code <img src='http://cdn1.codebetter.com/wp-includes/images/smilies/icon_smile.gif' alt=':-)' class='wp-smiley' /> </p>
<p>I updated it.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-466">
                    <div id="dsq-comment-header-466" class="dsq-comment-header">
                        <cite id="dsq-cite-466">
    http://www.calabonga.com                            <span id="dsq-author-user-466">calabonga</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-466" class="dsq-comment-body">
                        <div id="dsq-comment-message-466" class="dsq-comment-message"><p>thanks, that&#8217;s great!</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-467">
                    <div id="dsq-comment-header-467" class="dsq-comment-header">
                        <cite id="dsq-cite-467">
                                <span id="dsq-author-user-467">Rob</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-467" class="dsq-comment-body">
                        <div id="dsq-comment-message-467" class="dsq-comment-message"><p>Thanks for the post &#8211; </p>
<p>I&#8217;m trying to port this to VB.Net and I&#8217;m tripping over the Custom Attriubtes section.  Once I make what I think are the correct changed to the code, PartInitializer.SatifyImports no longer sets the Widgets &#8211; the collection is empty.  Here&#8217;s a copy of the Main Page code &#8211; </p>
<p>    <importmany ()> _<br />
    Public Widgets() As Lazy(Of UserControl, IWidgetMetaData)</p>
<p>     Public Sub New()<br />
        InitializeComponent()<br />
        PartInitializer.SatisfyImports(Me)<br />
        For Each w In Widgets<br />
            If w.Metadata.Location = WidgetLocation.Top Then<br />
                TopWidgets.Items.Add(w.Value)<br />
            Else &#8216; w.Metadata.Location = WidgetLocation.Bottom Then<br />
                BottomWidgets.Items.Add(w.Value)<br />
            End If<br />
        Next<br />
    End Sub</p>
<p>Here&#8217;s a copy of the Attribute code &#8211;<br />
<metadataattribute ()> _<br />
<attributeusage (AttributeTargets.Class, AllowMultiple:=False)> _<br />
Public Class ExportWidgetAttribute<br />
    Inherits ExportAttribute</p>
<p>    Public Sub New()<br />
        MyBase.New(GetType(UserControl))<br />
    End Sub</p>
<p>    Public Location As WidgetLocation</p>
<p>End Class</p>
<p>And a copy of one of the Widgets &#8211; </p>
<p>&#8216;Imports System<br />
Imports System.Windows.Controls<br />
&#8216;Imports System.ComponentModel.Composition<br />
&#8216;Imports System.Windows</p>
<p><exportwidget (Location:=WidgetLocation.Top)> _<br />
Partial Public Class Widget1<br />
    Inherits UserControl</p>
<p>    Public Sub New()<br />
        InitializeComponent()<br />
    End Sub</p>
<p>End Class</p>
<p>Any ideas how to debug this or a solution would be great.</p>
<p>Thanks &#8211; Rob</exportwidget></attributeusage></metadataattribute></importmany></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-468">
                    <div id="dsq-comment-header-468" class="dsq-comment-header">
                        <cite id="dsq-cite-468">
    http://codebetter.com/members/gblock/default.aspx                            <span id="dsq-author-user-468">Glenn Block</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-468" class="dsq-comment-body">
                        <div id="dsq-comment-message-468" class="dsq-comment-message"><p>Hi Rob</p>
<p>Is your widget library referenced by the main app? If not it won&#8217;t end up in the main XAP and be discoverable by PI.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-469">
                    <div id="dsq-comment-header-469" class="dsq-comment-header">
                        <cite id="dsq-cite-469">
                                <span id="dsq-author-user-469">Springy</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-469" class="dsq-comment-body">
                        <div id="dsq-comment-message-469" class="dsq-comment-message"><p>If you let ExportWidgetAttribute  implement IWidgetMetadata (the required members are already in place) then you are working even more strong typed.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-470">
                    <div id="dsq-comment-header-470" class="dsq-comment-header">
                        <cite id="dsq-cite-470">
                                <span id="dsq-author-user-470">aftab.ahmed@live.com</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-470" class="dsq-comment-body">
                        <div id="dsq-comment-message-470" class="dsq-comment-message"><p>The code sample here is using</p>
<p>PartInitializer.SatifyImports(this);</p>
<p>in final release of Silverlight 4, this has been replaced by</p>
<p>CompositionInitializer.SatisfyImports(this);</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-471">
                    <div id="dsq-comment-header-471" class="dsq-comment-header">
                        <cite id="dsq-cite-471">
    http://codebetter.com/members/gblock/default.aspx                            <span id="dsq-author-user-471">Glenn Block</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-471" class="dsq-comment-body">
                        <div id="dsq-comment-message-471" class="dsq-comment-message"><p>Thanks @Aftab</p>
<p>If you see the posts later in the series, I update to the latest bits. I think at HelloMef_IV</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-472">
                    <div id="dsq-comment-header-472" class="dsq-comment-header">
                        <cite id="dsq-cite-472">
                                <span id="dsq-author-user-472">Paul</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-472" class="dsq-comment-body">
                        <div id="dsq-comment-message-472" class="dsq-comment-message"><p>Thanks Glen, only learning C# and very interested in MEF, would not compile using the public accesor in the interface, just in case any other nubies run into this.<br />
Thanks again</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-473">
                    <div id="dsq-comment-header-473" class="dsq-comment-header">
                        <cite id="dsq-cite-473">
    http://dissipatedHeat.com                            <span id="dsq-author-user-473">Kerem</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-473" class="dsq-comment-body">
                        <div id="dsq-comment-message-473" class="dsq-comment-message"><p>Lazy&#8217;s brother is what I was looking for. </p>
<p>Thanks.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-763">
                    <div id="dsq-comment-header-763" class="dsq-comment-header">
                        <cite id="dsq-cite-763">
    http://profiles.google.com/gishu.pillai                            <span id="dsq-author-user-763">Gishu Pillai</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-763" class="dsq-comment-body">
                        <div id="dsq-comment-message-763" class="dsq-comment-message"><p>Super Post! Thanks a ton.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-785">
                    <div id="dsq-comment-header-785" class="dsq-comment-header">
                        <cite id="dsq-cite-785">
    http://qmsconsultants.com/NABH.html                            <span id="dsq-author-user-785">NABH</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-785" class="dsq-comment-body">
                        <div id="dsq-comment-message-785" class="dsq-comment-message"><p>I really appreciate your post and you explain each and every point very well.Thanks for sharing this information.And I’ll love to read your next post too.<br />
Regards:<br />
<a>NABH</a></p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1101">
                    <div id="dsq-comment-header-1101" class="dsq-comment-header">
                        <cite id="dsq-cite-1101">
    http://blogs.msdn.com/gblock                            <span id="dsq-author-user-1101">Glenn Block</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1101" class="dsq-comment-body">
                        <div id="dsq-comment-message-1101" class="dsq-comment-message"><p>Well you can create a custom ImportAttribute that specifies a contract, but you can&#8217;t supply a metadata contraint for the import. This might have changed in MEF 2.0 though.</p>
</div>
                    </div>
                </li>
                    <li id="dsq-comment-1102">
                    <div id="dsq-comment-header-1102" class="dsq-comment-header">
                        <cite id="dsq-cite-1102">
    http://blogs.msdn.com/gblock                            <span id="dsq-author-user-1102">Glenn Block</span>
                            </cite>
                    </div>
                    <div id="dsq-comment-body-1102" class="dsq-comment-body">
                        <div id="dsq-comment-message-1102" class="dsq-comment-message"><p>You don&#8217;t need the Attribute, as the compiler supports the shortcut.</p>
</div>
                    </div>
                </li>
                </ul>
        </div>
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://codebetter.com/glennblock/2009/12/05/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing/';
    var disqus_identifier = '108 /blogs/glenn.block/archive/2009/12/04/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing.aspx';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'mytechnobabble';
    var disqus_title = "Building Hello MEF – Part II – Metadata and why being Lazy is a good thing.";
        var disqus_config = function () {
        var config = this; // Access to the config object

        /* 
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            DISQUS.request.get('?cf_action=sync_comments&post_id=108');
        });
                    };
    var facebookXdReceiverPath = 'http://cdn1.codebetter.com/wp-content/plugins/disqus-comment-system/xd_receiver.htm';
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/codebetter.com\/glennblock\/2009\/12\/05\/building-hello-mef-part-ii-metadata-and-why-being-lazy-is-a-good-thing\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.67';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>

		</div><!-- #main -->
			<div id="sidebar" class="grid_4">

		<div id="primary" class="widget-area">
			<ul class="xoxo">
				<div class="ad-container">
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29416);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=2782afb'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29416&amp;n=2782afb' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29417);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=e94cea6'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29417&amp;n=e94cea6' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29418);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=9ba3022'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29418&amp;n=9ba3022' /></a></noscript><script type='text/javascript'><!--// <![CDATA[
    OA_show(29419);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=f467b52'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29419&amp;n=f467b52' /></a></noscript>
				</div>
			
				<li id="user_bio-2" class="widget-container widget_user_bio"><h3 class="widget-title"></h3>One of these days I will add something to my user profile! For now, I shall remain mysterious.
</li>		
						
			</ul>
			
		</div><!-- #primary .widget-area -->
		
		<div id="secondary" class="widget-area">
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(220407);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=68b8307'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=220407&amp;n=68b8307' /></a></noscript>				
				
				<ul class="xoxo">		
									</ul>	
				
<script type='text/javascript'><!--// <![CDATA[
    OA_show(29421);
// ]]> --></script><noscript><a target='_blank' href='http://d1.openx.org/ck.php?n=3f8e353'><img border='0' alt='' src='http://d1.openx.org/avw.php?zoneid=29421&amp;n=3f8e353' /></a></noscript>
				
		</div><!-- #secondary .widget-area -->			</div><!--sidebar-->
		</div><!-- #container -->
</div><!-- end div tabs see header.php -->
	
	<div id="footer">
		<div class="container_12">
		<div id="footer-widget-area">
				<div class="grid_4">					
					<ul>
					<li><a href="http://codebetter.com" title="home">Home</a></li>
					<li class="page_item page-item-2"><a href="http://codebetter.com/about/">About</a></li>
<li class="page_item page-item-8"><a href="http://codebetter.com/codebetter-ci/">CodeBetter CI</a></li>
<li class="page_item page-item-6"><a href="http://codebetter.com/community/">Community</a></li>
<li class="page_item page-item-10"><a href="http://codebetter.com/editors/">Editors</a></li>
<li class="page_item page-item-41"><a href="http://codebetter.com/globalsearch/">Search Results</a></li>
					<li><a href="http://feeds.feedburner.com/CodeBetter" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a><a href="http://feeds.feedburner.com/CodeBetter"><img src="http://feeds.feedburner.com/~fc/CodeBetter?bg=FFFFFF&amp;fg=2E9BD2&amp;anim=1" height="26" width="88" style="vertical-align:middle;border:0"/></a></li>
					</ul>
				</div><!-- #second .widget-area -->
				<div class="grid_4">
					
					<h3>Friends of CodeBetter.Com</h3>
<ul>

<li><a href="http://red-gate.com/">Red-Gate Tools For SQL and .NET</a></li>
<li><a href="http://telerik.com">Telerik .NET Tools</a></li>
<li><a href="http://jetbrains.com/resharper/">JetBrains - ReSharper</a></li>
<li><a href="http://scootersoftware.com">Beyond Compare</a></li>
<li><a href="http://www.ndepend.com/">NDepend</a></li>
<li><a href="http://www.sapphiresteel.com/">Ruby In Steel</a></li>
<li><a href="http://www.slickedit.com/">SlickEdit</a></li>
<li><a href="http://www.gurock.com/products/smartinspect/">SmartInspect .NET Logging</a></li>
<li>NGEDIT: <a href="http://www.viemu.com/">ViEmu</a> and <a href="http://www.codekana.com/">Codekana</a> </li>
<li><a href="http://www.devexpress.com/" target="_blank">DevExpress</a></li>
<li><a href="http://nhprof.com" target="_blank">NHibernate Profiler</a></li>
<li><a href="http://unfuddle.com" target="_blank">Unfuddle</a></li>
<li><a href="http://www.balsamiq.com/products/mockups" target="_blank">Balsamiq Mockups</a></li>
<li><a href="http://scrumy.com" target="_blank">Scrumy</a></li>
<li><a href="http://umbraco.com" target="_blank">Umbraco</a></li>
<li><a href="http://nservicebus.com" target="_blank">NServiceBus</a></li>
<li><a href="http://ravendb.net" target="_blank">RavenDb</a></li>
<li><a href="http://www.websequencediagrams.com/" target="_blank">Web Sequence Diagrams</a></li>
	</ul>				
				</div><!-- #third .widget-area -->
				<div class="grid_4">
					CodeBetter.Com &copy; '12<br />
						Stuff you need to Code Better!<br />
				Proudly powered by <span id="generator-link"><a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">WordPress</a></span>.					
				</div><!-- #fourth .widget-area -->
			</div><!-- #footer-widget-area -->		
		
			</div><!-- end div.container_12 -->

	</div><!-- end div#footer -->
		
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-531207-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://cdn1.codebetter.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['tab-size'] = 2;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.defaults['wrap-lines'] = true; 
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>

<script type='text/javascript'>//<![CDATA[
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
    }//]]></script>
<script type='text/javascript' language='Javascript' src='http://s1.lqcdn.com/m.min.js?dt=2.3.110202.1'></script>
<script type='text/javascript' language='Javascript'> if(jQuery.LqmAds)jQuery.LqmAds();</script>
 
</body>
</html>
<!-- Dynamic page generated in 0.510 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2012-11-09 19:34:14 -->
<!-- super cache -->